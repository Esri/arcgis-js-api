// COPYRIGHT Â© 2015 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.15/esri/copyright.txt for details.

define(["dojo/_base/array","dojo/_base/lang","dojo/has","../kernel","../Color","./colors"],function(e,r,l,o,i,a){function n(r,l){return e.map(r,function(e){var r=new i(e);return null!=l&&(r.a=l),r})}function t(e,r){return e.r===r.r&&e.g===r.g&&e.b===r.b}function g(r,l){var o,i=0;if(r.length===l.length)if(o=e.every(r,function(e,r){return t(e,l[r])}))i=1;else{var a=r.slice(0).reverse();o=e.every(a,function(e,r){return t(e,l[r])}),o&&(i=-1)}return i}function s(r,l){var o,i;if(i=g(l,r.colors))o=i>0?r:f.flipColors(r,!0);else{var a;e.some(r.colorsForClassBreaks,function(e){return e.numClasses===l.length&&(a=e.colors),!!a}),a&&(i=g(l,a),i&&(o=i>0?r:f.flipColors(r,!0)))}return o}function m(r,l){var o,i,a,n=r&&r.basemapGroups,t=r&&r.basemaps;if(n)for(o in n)if(t=n[o],i=e.indexOf(t,l),i>-1){a=o;break}return a=a||l,r&&a?r.schemes[a]:null}function h(e){var r,l=e.basemapGroups,o=e.basemaps,i=[];if(l)for(r in l)i=i.concat(l[r]);else o&&(i=i.concat(o));return i}function d(r,l,o,t,g){var s,m,h,d=a[r];if(d){s={id:t+"/"+g+"/"+r,theme:t},h=l.fillOpacity,null==h&&-1!==e.indexOf(w,r)&&(h=.8),s.opacity=h||1,s.colors=n(d.stops),s.colorsForClassBreaks=[];for(m in d)"stops"!==m&&(m=+m,s.colorsForClassBreaks.push({numClasses:m,colors:n(d[m])}));switch(s.noDataColor=new i(-1!==e.indexOf(w,r)?b:c),o){case"point":s.outline={color:new i(l.outline.color),width:l.outline.width},s.size=l.size;break;case"line":s.width=l.width;break;case"polygon":s.outline={color:new i(l.outline.color),width:l.outline.width}}}return s}function p(e){var r=e;return"esriGeometryPoint"===r||"esriGeometryMultipoint"===r?r="point":"esriGeometryPolyline"===r?r="line":"esriGeometryPolygon"===r&&(r="polygon"),r}var y={light:{color:[128,128,128,1],width:.5},lighter:{color:[153,153,153,1],width:.5}},u={lightBasemaps:{outline:y.lighter,fillOpacity:.8,width:2,size:8},darkBasemaps:{outline:y.light,fillOpacity:.6,width:2,size:8}},c="#aaaaaa",b="#ffffff",w=["highlight-orange-gray","highlight-bluegreen-gray","highlight-purple-gray","highlight-pink-gray","highlight-blue-gray","highlight-red-gray","highlight-orange-gray-dark","highlight-blue-gray-dark","highlight-orange-gray-bright","highlight-blue-gray-bright","extremes-orange-gray","extremes-bluegreen-gray","extremes-purple-gray","extremes-pink-gray","extremes-blue-gray","extremes-red-gray","extremes-orange-gray-dark","extremes-blue-gray-dark","extremes-orange-gray-bright","extremes-blue-gray-bright"],v=["seq-single-blues","seq-single-greens","seq-single-grays","seq-single-oranges","seq-single-purples","seq-single-reds","seq-multi-bugn","seq-multi-bupu","seq-multi-gnbu","seq-multi-orrd","seq-multi-pubu","seq-multi-pubugn","seq-multi-purd","seq-multi-rdpu","seq-multi-ylgn","seq-multi-ylgnbu","seq-multi-ylorbr","seq-multi-ylorrd"],x=["div-brbg","div-piyg","div-prgn","div-puor","div-rdbu","div-rdgy","div-rdylbu","div-rdylgn","div-spectral"],k=["tropical-bliss","desert-blooms","under-the-sea","vibrant-rainbow","ocean-bay","prairie-summer","pastel-chalk"],q={"high-to-low":{name:"high-to-low",label:"TODO",description:"TODO",basemaps:["streets","gray","topo","terrain","national-geographic","oceans","osm","satellite","hybrid","dark-gray"],schemes:{streets:{common:u.lightBasemaps,primary:"seq-yellow-orange-red",secondary:["seq-yellow-red-purple","seq-yellow-pink-purple","seq-yellow-purple-blue","seq-yellow-green-blue"].concat(v)},gray:{common:u.lightBasemaps,primary:"seq-yellow-orange-red",secondary:["seq-orange-red-light","seq-yellow-red-purple","seq-yellow-pink-purple","seq-yellow-purple-blue"].concat(v)},topo:{common:u.lightBasemaps,primary:"seq-yellow-green-blue",secondary:["seq-yellow-pink-purple","seq-yellow-purple-blue","seq-yellow-red-purple","seq-yellow-orange-red"].concat(v)},terrain:{common:u.lightBasemaps,primary:"seq-pink-red",secondary:["seq-yellow-pink-purple","seq-yellow-red-purple","seq-yellow-orange-red","seq-orange-red-light"].concat(v)},"national-geographic":{common:u.lightBasemaps,primary:"seq-yellow-orange-red",secondary:["seq-yellow-red-purple","seq-yellow-pink-purple","seq-yellow-purple-blue","seq-yellow-green-blue"].concat(v)},oceans:{common:u.lightBasemaps,primary:"seq-yellow-green-blue",secondary:["seq-yellow-red-purple","seq-yellow-orange-red","seq-yellow-pink-purple","seq-yellow-purple-blue"].concat(v)},osm:{common:u.lightBasemaps,primary:"seq-red-blue-green",secondary:["seq-yellow-pink-purple","seq-yellow-red-purple","seq-yellow-purple-blue"].concat(v)},satellite:{common:u.darkBasemaps,primary:"seq-orange-red-dark",secondary:["seq-yellow-green-blue","seq-red-blue-green","seq-yellow-purple-blue"].concat(v)},hybrid:{common:u.darkBasemaps,primary:"seq-orange-red-dark",secondary:["seq-yellow-green-blue","seq-red-blue-green","seq-yellow-purple-blue"].concat(v)},"dark-gray":{common:u.darkBasemaps,primary:"seq-yellow-orange-red-bright",secondary:[].concat(v)}}},"above-and-below":{name:"above-and-below",label:"TODO",description:"TODO",basemaps:["streets","gray","topo","terrain","national-geographic","oceans","osm","satellite","hybrid","dark-gray"],schemes:{streets:{common:u.lightBasemaps,primary:"div-bluegreen-yellow-orange",secondary:["div-orange-yellow-blue-light","div-green-yellow-redpurple","div-green-yellow-orange"].concat(x)},gray:{common:u.lightBasemaps,primary:"div-bluegreen-orange",secondary:["div-orange-purple","div-bluegreen-purple","div-orange-pink"].concat(x)},topo:{common:u.lightBasemaps,primary:"div-orange-pink",secondary:["div-redpurple-blue","div-orange-blue","div-green-pink"].concat(x)},terrain:{common:u.lightBasemaps,primary:"div-bluegreen-orange",secondary:["div-bluegreen-redpurple","div-green-redpurple","div-green-orange"].concat(x)},"national-geographic":{common:u.lightBasemaps,primary:"div-orange-yellow-blue-light",secondary:["div-bluegreen-yellow-orange","div-green-yellow-redpurple"].concat(x)},oceans:{common:u.lightBasemaps,primary:"div-red-yellow-pink",secondary:["div-blue-green","div-bluegreen-yellow-redpurple","div-bluegreen-yellow-orange"].concat(x)},osm:{common:u.lightBasemaps,primary:"div-bluegreen-pink",secondary:["div-bluegreen-redpurple","div-bluegreen-orange","div-orange-pink"].concat(x)},satellite:{common:u.darkBasemaps,primary:"div-orange-yellow-blue-dark",secondary:["div-red-yellow-purple","div-orange-yellow-pink","div-orange-yellow-blue-light"].concat(x)},hybrid:{common:u.darkBasemaps,primary:"div-orange-yellow-blue-dark",secondary:["div-red-yellow-purple","div-orange-yellow-pink","div-orange-yellow-blue-light"].concat(x)},"dark-gray":{common:u.darkBasemaps,primary:"div-orange-gray-blue",secondary:["div-yellow-gray-purple","div-red-gray-blue","div-green-gray-purple"].concat(x)}}},"centered-on":{name:"centered-on",label:"TODO",description:"TODO",basemaps:["streets","gray","topo","terrain","national-geographic","oceans","osm","satellite","hybrid","dark-gray"],schemes:{streets:{common:{outline:y.lighter,width:2,size:8},primary:"highlight-orange",secondary:["highlight-bluegreen","highlight-orange-gray","highlight-bluegreen-gray"]},gray:{common:{outline:y.lighter,width:2,size:8},primary:"highlight-orange",secondary:["highlight-purple","highlight-orange-gray","highlight-purple-gray"]},topo:{common:{outline:y.lighter,width:2,size:8},primary:"highlight-orange",secondary:["highlight-pink","highlight-orange-gray","highlight-pink-gray"]},terrain:{common:{outline:y.lighter,width:2,size:8},primary:"highlight-orange",secondary:["highlight-bluegreen","highlight-orange-gray","highlight-bluegreen-gray"]},"national-geographic":{common:{outline:y.lighter,width:2,size:8},primary:"highlight-orange",secondary:["highlight-blue","highlight-orange-gray","highlight-blue-gray"]},oceans:{common:{outline:y.lighter,width:2,size:8},primary:"highlight-red",secondary:["highlight-pink","highlight-red-gray","highlight-pink-gray"]},osm:{common:{outline:y.lighter,width:2,size:8},primary:"highlight-pink",secondary:["highlight-bluegreen","highlight-pink-gray","highlight-bluegreen-gray"]},satellite:{common:{outline:y.light,width:2,size:8},primary:"highlight-orange-dark",secondary:["highlight-blue-dark","highlight-orange-gray-dark","highlight-blue-gray-dark"]},hybrid:{common:{outline:y.light,width:2,size:8},primary:"highlight-orange-dark",secondary:["highlight-blue-dark","highlight-orange-gray-dark","highlight-blue-gray-dark"]},"dark-gray":{common:{outline:y.light,width:2,size:8},primary:"highlight-orange-bright",secondary:["highlight-blue-bright","highlight-orange-gray-bright","highlight-blue-gray-bright"]}}},extremes:{name:"extremes",label:"TODO",description:"TODO",basemaps:["streets","gray","topo","terrain","national-geographic","oceans","osm","satellite","hybrid","dark-gray"],schemes:{streets:{common:{outline:y.lighter,width:2,size:8},primary:"extremesdiv-bluegreen-yellow-orange",secondary:["extremesdiv-orange-yellow-blue-light","extremesdiv-green-yellow-redpurple","extremesdiv-green-yellow-orange","extremes-orange","extremes-bluegreen","extremes-orange-gray","extremes-bluegreen-gray"]},gray:{common:{outline:y.lighter,width:2,size:8},primary:"extremesdiv-orange-purple",secondary:["extremesdiv-bluegreen-purple","extremesdiv-bluegreen-orange","extremesdiv-orange-pink","extremes-orange","extremes-purple","extremes-orange-gray","extremes-purple-gray"]},topo:{common:{outline:y.lighter,width:2,size:8},primary:"extremesdiv-orange-pink",secondary:["extremesdiv-redpurple-blue","extremesdiv-orange-blue","extremesdiv-green-pink","extremes-orange","extremes-pink","extremes-orange-gray","extremes-pink-gray"]},terrain:{common:{outline:y.lighter,width:2,size:8},primary:"extremesdiv-bluegreen-orange",secondary:["extremesdiv-bluegreen-redpurple","extremesdiv-green-redpurple","extremesdiv-green-orange","extremes-orange","extremes-bluegreen","extremes-orange-gray","extremes-bluegreen-gray"]},"national-geographic":{common:{outline:y.lighter,width:2,size:8},primary:"extremesdiv-orange-yellow-blue-light",secondary:["extremesdiv-bluegreen-yellow-orange","extremesdiv-green-yellow-redpurple","extremes-orange","extremes-blue","extremes-orange-gray","extremes-blue-gray"]},oceans:{common:{outline:y.lighter,width:2,size:8},primary:"extremesdiv-red-yellow-pink",secondary:["extremesdiv-blue-green","extremesdiv-bluegreen-yellow-redpurple","extremesdiv-bluegreen-yellow-orange","extremes-red","extremes-pink","extremes-red-gray","extremes-pink-gray"]},osm:{common:{outline:y.lighter,width:2,size:8},primary:"extremesdiv-bluegreen-pink",secondary:["extremesdiv-bluegreen-redpurple","extremesdiv-bluegreen-orange","extremesdiv-orange-pink","extremes-pink","extremes-bluegreen","extremes-pink-gray","extremes-bluegreen-gray"]},satellite:{common:{outline:y.light,width:2,size:8},primary:"extremesdiv-orange-yellow-blue-dark",secondary:["extremesdiv-red-yellow-purple","extremesdiv-orange-yellow-pink","extremesdiv-orange-yellow-blue-light","extremes-orange-dark","extremes-blue-dark","extremes-orange-gray-dark","extremes-blue-gray-dark"]},hybrid:{common:{outline:y.light,width:2,size:8},primary:"extremesdiv-orange-yellow-blue-dark",secondary:["extremesdiv-red-yellow-purple","extremesdiv-orange-yellow-pink","extremesdiv-orange-yellow-blue-light","extremes-orange-dark","extremes-blue-dark","extremes-orange-gray-dark","extremes-blue-gray-dark"]},"dark-gray":{common:{outline:y.light,width:2,size:8},primary:"extremesdiv-orange-gray-blue",secondary:["extremesdiv-yellow-gray-purple","extremesdiv-red-gray-blue","extremesdiv-green-gray-purple","extremes-orange-bright","extremes-blue-bright","extremes-orange-gray-bright","extremes-blue-gray-bright"]}}},"group-similar":{name:"group-similar",label:"TODO",description:"TODO",basemapGroups:{light:["streets","gray","topo","terrain","national-geographic","oceans","osm"],dark:["satellite","hybrid","dark-gray"]},schemes:{light:{common:u.lightBasemaps,primary:"spectral",secondary:["cat-dark","cat-light"].concat(k)},dark:{common:u.darkBasemaps,primary:"spectral",secondary:["cat-dark","cat-light"].concat(k)}}}},f={};return r.mixin(f,{getAvailableThemes:function(r){var l,o,i,a=[];for(l in q)o=q[l],i=h(o),r&&-1===e.indexOf(i,r)||a.push({name:o.name,label:o.label,description:o.description,basemaps:i});return a},getSchemes:function(r){var l,o,i=r.theme,a=r.basemap,n=p(r.geometryType),t=q[i];return l=m(t,a),l&&(o={primaryScheme:d(l.primary,l.common,n,i,a),secondarySchemes:e.map(l.secondary,function(e){return d(e,l.common,n,i,a)})}),o},getSchemeById:function(e){var r,l,o,i,a,n=e.id,t=p(e.geometryType);return n&&(n=n.split("/"),n&&(l=n[0],o=n[1],i=n[2])),a=m(q[l],o),a&&(r=d(i,a.common,t,l,o)),r},cloneScheme:function(l){var o;return l&&(o=r.mixin({},l),o.colors=n(o.colors),o.colorsForClassBreaks=e.map(o.colorsForClassBreaks,function(e){return{numClasses:e.numClasses,colors:n(e.colors)}}),o.noDataColor&&(o.noDataColor=new i(o.noDataColor)),o.outline&&(o.outline={color:o.outline.color&&new i(o.outline.color),width:o.outline.width})),o},flipColors:function(r,l){var o=l?r:f.cloneScheme(r);return o.colors.reverse(),e.forEach(o.colorsForClassBreaks,function(e){e.colors.reverse()}),o},getMatchingSchemes:function(r){var l,o=r.theme,i=p(r.geometryType),a=r.colors,n=q[o],t=h(n),g=[];return e.forEach(t,function(r){var t=m(n,r);t&&(l=s(d(t.primary,t.common,i,o,r),a),l&&g.push(l),e.forEach(t.secondary,function(e){l=s(d(e,t.common,i,o,r),a),l&&g.push(l)}))}),g}}),l("extend-esri")&&r.setObject("styles.choropleth",f,o),f});