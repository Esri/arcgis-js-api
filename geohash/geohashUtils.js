/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports"],(function(t){"use strict";const e=16,n=new Float64Array(2),o=new Float64Array(2);function r(t){return t<=57?t-48:t<=104?t-88:t<=107?t-89:t<=110?t-90:t-91}function h(t){return"0123456789bcdefghjkmnpqrstuvwxyz"[t]}function c(t){return(t[0]+t[1])/2}function a(t,e,n){return t[0]=e,t[1]=n,t}function s(t,e){const n=c(t),o=e,r=!e;t[0]=r*t[0]+o*n,t[1]=r*n+o*t[1]}function f(t,e){const n=e>c(t);return s(t,n),n}function l(t,h){const f=a(n,-90,90),l=a(o,-180,180);for(let t=0;t<h.length;t++){const n=r(h.charCodeAt(t));t%2==0?(s(l,!!(e&n)),s(l,!!(4&n)),s(l,!!(1&n)),s(f,!!(8&n)),s(f,!!(2&n))):(s(f,!!(e&n)),s(f,!!(4&n)),s(f,!!(1&n)),s(l,!!(8&n)),s(l,!!(2&n)))}return t[0]=c(f),t[1]=c(l),t}function u(t,e,r){let c="";const s=a(n,-90,90),l=a(o,-180,180);for(let n=0;n<r;n++){let o=0;!(n%2)?(o|=f(l,e)<<4,o|=f(s,t)<<3,o|=f(l,e)<<2,o|=f(s,t)<<1,o|=f(l,e)<<0):(o|=f(s,t)<<4,o|=f(l,e)<<3,o|=f(s,t)<<2,o|=f(l,e)<<1,o|=f(s,t)<<0),c+=h(o)}return c}function i(t){const e=Math.floor(5*t/2);return 180/Math.pow(2,e)}function M(t){const e=Math.ceil(5*t/2);return 360/Math.pow(2,e)}function g(t,n){return n?1&t|(4&t)>>1|(e&t)>>2:(2&t)>>1|(8&t)>>2}function d(t,n){return n?(2&t)>>1|(8&t)>>2:1&t|(4&t)>>1|(e&t)>>2}function G(t,n,o){const c=!((t.length-1)%2),a=t.substring(0,t.length-1),s=r(t.charCodeAt(t.length-1));let f=0,l=0,u=0,i=0;c?(f=8,l=4,u=1&s|(4&s)>>1|(e&s)>>2,i=(2&s)>>1|(8&s)>>2):(f=4,l=8,i=1&s|(4&s)>>1|(e&s)>>2,u=(2&s)>>1|(8&s)>>2);const M=u+n,g=i+o,d=Math.floor(M/f),b=Math.floor(g/l),p=h(function(t,e,n){return n?1&t|(1&e)<<1|(2&t)<<1|(2&e)<<2|(4&t)<<2:1&e|(1&t)<<1|(2&e)<<1|(2&t)<<2|(4&e)<<2}(M-d*f,g-b*l,c));return t.length>1&&(d||b)?G(a,d,b)+p:a+p}t.convertGeohash32ToXY=function(t,e){let n=0,o=0,h=30,c=30;for(let t=0;t<e.length;t++){const a=r(e.charCodeAt(t)),s=t%2==0;h-=s?3:2,c-=s?2:3,n|=g(a,s)<<h,o|=d(a,s)<<c}return{geohashX:n,geohashY:o}},t.decodeBase32Char=r,t.decodeGeohash=l,t.decodeGeohashXY=function(t,e){let n=-90,o=90,r=-180,h=180;for(let c=0;c<e;c++){const e=Math.ceil((c+1)/2),a=Math.floor((c+1)/2),s=1-c%2,f=30-(3*e+2*a),l=30-(2*e+3*a),u=3*s+2*(1-s),i=2*s+3*(1-s),M=3*s+7*(1-s)<<l,g=(7*s+3*(1-s)<<f&t.geohashX)>>f,d=(M&t.geohashY)>>l;for(let t=u-1;t>=0;t--){const e=(r+h)/2,n=g&1<<t?1:0;r=(1-n)*r+n*e,h=(1-n)*e+n*h}for(let t=i-1;t>=0;t--){const e=(n+o)/2,r=d&1<<t?1:0;n=(1-r)*n+r*e,o=(1-r)*e+r*o}}return[r,n,h,o]},t.encodeBase32Char=h,t.encodeGeohash=u,t.forEachIntersectingGeohash=function(t,e,n,o,r,h){const c=Math.abs(n-t),a=Math.abs(o-e),s=i(r),f=M(r),g=Math.ceil(a/f),d=Math.ceil(c/s),b=u(t,e,r);for(let r=0;r<g;r++)for(let c=0;c<d;c++){const a=G(b,r,c),[u,i]=l([0,0],a),M=u-s/2,g=i-f/2,d=u+s/2,p=i+f/2,X=s*f,Y=Math.max(t,M),w=Math.max(e,g),A=Math.min(n,d)-Y,m=Math.min(o,p)-w;h(a,Math.abs(A*m)/X)}},t.getIntersectingGeohashes=function(t,e,n,o,r){const h=Math.abs(n-t),c=Math.abs(o-e),a=i(r),s=M(r),f=Math.ceil(c/s),l=Math.ceil(h/a),g=u(t,e,r),d=new Array;for(let t=0;t<f;t++)for(let e=0;e<l;e++)d.push(G(g,t,e));return d},t.getRelativeGeohash=G,t.latDistPerGeohash=i,t.lonDistPerGeohash=M,t.setGeohashBuf=function(t,e,n,o,r){r%2&&(r+=1);let h=0,c=0,a=-90,s=90,f=-180,l=180;for(let t=0;t<r/2;t++){for(let e=0;e<5;e++){const n=(f+l)/2,r=o>n?1:0;h|=r<<29-(e+5*t),f=(1-r)*f+r*n,l=(1-r)*n+r*l}for(let e=0;e<5;e++){const o=(a+s)/2,r=n>o?1:0;c|=r<<29-(e+5*t),a=(1-r)*a+r*o,s=(1-r)*o+r*s}}t[2*e]=h,t[2*e+1]=c},t.setGeohashXY=function(t,e,n,o){o%2&&(o+=1);let r=0,h=0,c=-90,a=90,s=-180,f=180;for(let t=0;t<o/2;t++){for(let e=0;e<5;e++){const o=(s+f)/2,h=n>o?1:0;r|=h<<29-(e+5*t),s=(1-h)*s+h*o,f=(1-h)*o+h*f}for(let n=0;n<5;n++){const o=(c+a)/2,r=e>o?1:0;h|=r<<29-(n+5*t),c=(1-r)*c+r*o,a=(1-r)*o+r*a}}t.geohashX=r,t.geohashY=h},t.unpackXBits=g,t.unpackYBits=d,Object.defineProperty(t,"__esModule",{value:!0})}));
