/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/events","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/accessorSupport/decorators/subclass","./Widget","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory","./Swipe/SwipeViewModel"],(function(e,t,i,n,r,o,s,a,l,d,c,p){"use strict";const u="esri-swipe",v={base:u,baseDisabled:`${u}--disabled`,vertical:`${u}--vertical`,horizontal:`${u}--horizontal`,container:`${u}__container`,divider:`${u}__divider`,handle:`${u}__handle`,handleHidden:`${u}__handle--hidden`,widgetIcon:"esri-icon-up-down-arrows",handleIcon:`${u}__handle-icon`,dragIconHorizontal:"esri-icon-drag-horizontal",dragIconVertical:"esri-icon-drag-vertical",widget:"esri-widget",disabled:"esri-disabled"},h={handle:!0,divider:!0};let _=function(t){function n(i,n){var r;return(r=t.call(this,i,n)||this).disabled=!1,r.iconClass=v.widgetIcon,r.messages=null,r.viewModel=new p,r._pointerOffset=0,r._container=null,r._onContainerPointerDown=r._onContainerPointerDown.bind(e._assertThisInitialized(r)),r._onContainerPointerMove=r._onContainerPointerMove.bind(e._assertThisInitialized(r)),r._onContainerPointerUp=r._onContainerPointerUp.bind(e._assertThisInitialized(r)),r}e._inheritsLoose(n,t);var r=n.prototype;return r.render=function(){const{state:e,direction:t}=this.viewModel,i="disabled"===e||this.disabled,n={[v.disabled]:i,[v.baseDisabled]:i,[v.vertical]:"vertical"===t,[v.horizontal]:"horizontal"===t};return c.tsx("div",{class:this.classes(v.base,v.widget,n)},"disabled"===e?null:this.renderContainer())},r.renderHandle=function(){const{direction:e}=this.viewModel,{visibleElements:t}=this,i={[v.dragIconHorizontal]:"vertical"===e,[v.dragIconVertical]:"horizontal"===e},n=this.classes(v.handle,!t.handle&&v.handleHidden);return c.tsx("div",{key:"handle",role:"presentation",class:n},c.tsx("span",{"aria-hidden":"true",class:this.classes(v.handleIcon,i)}))},r.renderDivider=function(){const{visibleElements:e}=this;return e&&e.divider?c.tsx("div",{key:"divider",role:"presentation",class:v.divider}):null},r.renderContent=function(){return[this.renderDivider(),this.renderHandle()]},r.renderContainer=function(){const{disabled:e,dragLabel:t,viewModel:i}=this,{max:n,min:r,direction:o,position:s}=i,a=`${s}%`,l={top:"vertical"===o?a:void 0,left:"vertical"===o?void 0:a},d=this.renderContent();return e?c.tsx("div",{key:"container",role:"presentation",styles:l,class:v.container},d):c.tsx("div",{tabIndex:0,key:"container",bind:this,afterCreate:this._afterContainerCreate,onkeydown:this._onContainerKeyDown,"touch-action":"none",role:"slider",title:t,"aria-label":t,"aria-orientation":o,"aria-valuemax":`${n}`,"aria-valuemin":`${r}`,"aria-valuenow":`${s}`,"aria-valuetext":a,styles:l,class:v.container},d)},r._afterContainerCreate=function(e){this._container=e,e.addEventListener("pointerdown",this._onContainerPointerDown)},r._calculatePointerOffset=function(e){const{direction:t}=this,i=e.target,n=("vertical"===t?i.clientHeight:i.clientWidth)/2,r=i.getBoundingClientRect(),o=e.clientX-r.left,s=e.clientY-r.top;this._pointerOffset="vertical"===t?s-n:o-n},r._onContainerPointerDown=function(e){e.preventDefault(),this._container&&document.activeElement!==this.container&&this._container.focus(),this._calculatePointerOffset(e),document.addEventListener("pointerup",this._onContainerPointerUp),document.addEventListener("pointermove",this._onContainerPointerMove)},r._onContainerPointerUp=function(e){e.preventDefault(),document.removeEventListener("pointerup",this._onContainerPointerUp),document.removeEventListener("pointermove",this._onContainerPointerMove)},r._onContainerPointerMove=function(e){e.preventDefault();const{_pointerOffset:t,container:i,direction:n}=this,{clientX:r,clientY:o}=e,{top:s,left:a,width:l,height:d}=i.getBoundingClientRect(),c=("vertical"===n?o-s-t:r-a-t)/("vertical"===n?d:l)*100;this.position=c},r._getKeyPosition=function(e){const t=i.eventKey(e),{position:n}=this,{max:r,min:o,step:s,stepMultiplier:a,direction:l}=this.viewModel,d=s*a;["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"].includes(t)&&(e.preventDefault(),e.stopPropagation());if("vertical"===l?"ArrowDown"===t||"ArrowRight"===t:"ArrowUp"===t||"ArrowRight"===t){return n+(e.shiftKey?d:s)}if("vertical"===l?"ArrowUp"===t||"ArrowLeft"===t:"ArrowDown"===t||"ArrowLeft"===t){return n-(e.shiftKey?d:s)}if("Home"===t)return o;if("End"===t)return r;if("vertical"===l?"PageDown"===t:"PageUp"===t)return n+d;return("vertical"===l?"PageUp"===t:"PageDown"===t)?n-d:null},r._onContainerKeyDown=function(e){const t=this._getKeyPosition(e);"number"==typeof t&&(this.position=t)},e._createClass(n,[{key:"direction",get:function(){return this.viewModel.direction},set:function(e){this.viewModel.direction=e}},{key:"dragLabel",get:function(){return this.messages?.dragLabel??""},set:function(e){this._overrideIfSome("dragLabel",e)}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(e){this._overrideIfSome("label",e)}},{key:"leadingLayers",get:function(){return this.viewModel.leadingLayers},set:function(e){this.viewModel.leadingLayers=e}},{key:"position",get:function(){return this.viewModel.position},set:function(e){this.viewModel.position=e}},{key:"trailingLayers",get:function(){return this.viewModel.trailingLayers},set:function(e){this.viewModel.trailingLayers=e}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"visibleElements",get:function(){return this._get("visibleElements")||h},set:function(e){this._set("visibleElements",{...h,...e})}}]),n}(a);t.__decorate([n.property()],_.prototype,"direction",null),t.__decorate([n.property()],_.prototype,"disabled",void 0),t.__decorate([n.property()],_.prototype,"dragLabel",null),t.__decorate([n.property()],_.prototype,"iconClass",void 0),t.__decorate([n.property()],_.prototype,"label",null),t.__decorate([n.property()],_.prototype,"leadingLayers",null),t.__decorate([n.property(),d.messageBundle("esri/widgets/Swipe/t9n/Swipe")],_.prototype,"messages",void 0),t.__decorate([n.property()],_.prototype,"position",null),t.__decorate([n.property()],_.prototype,"trailingLayers",null),t.__decorate([n.property()],_.prototype,"view",null),t.__decorate([n.property({type:p})],_.prototype,"viewModel",void 0),t.__decorate([n.property()],_.prototype,"visibleElements",null),_=t.__decorate([s.subclass("esri.widgets.Swipe")],_);return _}));
