/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["require","exports","../../../core/promiseUtils","../../../Color","./utils"],(function(e,l,o,n,t){"use strict";const r=new n([64,64,64]);function a(e,l){const o=[],n=e.length-1;return 5===e.length?o.push(0,2,4):o.push(0,n),e.map(((e,r)=>o.indexOf(r)>-1?t.createStopLabel(e,r,n,l):null))}function u(e,l){const{startIndex:o,endIndex:t,weight:r}=function(e,l){let o=0,n=l.length-1;return l.some(((l,t)=>e<l.value?(n=t,!0):(o=t,!1))),{startIndex:o,endIndex:n,weight:(e-l[o].value)/(l[n].value-l[o].value)}}(e,l);if(o===t)return l[o].color;const a=n.blendColors(l[o].color,l[t].color,r);return new n(a)}l.getColorFromPointCloudStops=u,l.getRampStops=async function(l,u,i,s){let c=!1,p=[],v=[];if(l.stops){const e=null==s?void 0:s.authoringInfo,o="univariate-color-size"===(null==e?void 0:e.type)&&"above-and-below"===(null==e?void 0:e.univariateTheme),n=l.stops;p=o&&"color"===l.type?t.getUnivariateAboveAndBelowStopValues(l,e):n.map((e=>e.value)),c=n.some((e=>!!e.label)),c&&(v=n.map((e=>e.label)))}const m=p[0],f=p[p.length-1];if(null==m&&null==f)return null;const h=c?null:a(p,i);return(await o.all(p.map((async(o,t)=>({value:o,color:"opacity"===l.type?await async function(l,o,t=r){const a=new n(t),u=(await new Promise((function(l,o){e(["../../../renderers/visualVariables/support/visualVariableUtils"],l,o)}))).getOpacity(o,l);null!=u&&(a.a=u);return a}(o,l,u):(await new Promise((function(l,o){e(["../../../renderers/visualVariables/support/visualVariableUtils"],l,o)}))).getColor(l,o),label:c?v[t]:h[t]}))))).reverse()},l.getRampStopsForPointCloud=function(e){let l=!1,o=[],n=[];o=e.map((e=>e.value)),l=e.some((e=>!!e.label)),l&&(n=e.map((e=>e.label)));const t=o[0],r=o[o.length-1];if(null==t&&null==r)return null;const i=l?null:a(o,!1);return o.map(((o,t)=>({value:o,color:u(o,e),label:l?n[t]:i[t]}))).reverse()},l.getStrectchRampStops=function(e,l){let o=[];if(e&&"multipart"===e.type)e.colorRamps.reverse().forEach((function(t,r){0===r?o.push({value:l.max,color:new n(t.toColor),label:"high"}):o.push({value:null,color:new n(t.toColor),label:""}),r===e.colorRamps.length-1?o.push({value:l.min,color:new n(t.fromColor),label:"low"}):o.push({value:null,color:new n(t.fromColor),label:""})}));else{let t,r;e&&"algorithmic"===e.type?(t=e.fromColor,r=e.toColor):(t=[0,0,0,1],r=[255,255,255,1]),o=[{value:l.max,color:new n(r),label:"high"},{value:l.min,color:new n(t),label:"low"}]}return o},Object.defineProperty(l,"__esModule",{value:!0})}));
