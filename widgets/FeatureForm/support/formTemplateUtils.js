/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import e from"../../../layers/support/RangeDomain.js";import i from"../FieldConfig.js";import n from"../FieldGroupConfig.js";function t(e){const i={},n=[];return e.expressionInfos?.map((e=>i[e.name]=e.expression)),{config:a(e.elements,i,n),encounteredUnsupportedTypes:n}}function o(n,t,o){const{description:a,domain:l,editable:s,fieldName:p,hint:r,input:u,label:m,requiredExpression:d,visibilityExpression:f}=n,c=t[d]||null,y=t[f]||null,x=new i({description:a,domain:l,editable:s,hint:r,label:m,name:p,requiredExpression:c,visibilityExpression:y});if(u)if("barcode-scanner"===u.type||"text-area"===u.type||"text-box"===u.type)x.minLength=u.minLength,x.maxLength=u.maxLength;else if("combo-box"===u.type||"radio-buttons"===u.type)x.noValueOptionLabel=u.noValueOptionLabel,x.showNoValueOption=u.showNoValueOption;else if("switch"===u.type)x.offValue=u.offValue,x.onValue=u.onValue;else if("datetime-picker"===u.type){x.includeTime=u.includeTime;const{max:i,min:n}=u;if(i||n){const t="range"===l?.type?Math.min(i?.getTime(),l.maxValue):i?.getTime(),o="range"===l?.type?Math.max(n?.getTime(),l.minValue):n?.getTime();x.domain=new e({maxValue:t,minValue:o,name:"__internal-range-domain-based-on-datetime-picker-input__"})}}else o.push({type:"unsupported-input-type",details:u});return x}function a(e,i,t,l=!0){return e.map((e=>{if("field"===e.type)return o(e,i,t);if("group"===e.type){if(!l)return t.push({type:"nested-group",details:e}),null;const o=i[e.visibilityExpression]||null;return new n({description:e.description,state:e.initialState,fieldConfig:a(e.elements,i,t,!1),label:e.label,visibilityExpression:o})}return t.push({type:"unsupported-element-type",details:e}),null})).filter((e=>!!e))}export{t as fieldConfigsFromFormTemplate};
