/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/has","../core/Logger","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/aliasOf","../core/accessorSupport/decorators/cast","../core/accessorSupport/decorators/subclass","../core/urlUtils","../core/uuid","../portal/support/resourceExtension","../core/screenUtils","../core/watchUtils","./support/widgetUtils","./support/decorators/messageBundle","./support/decorators/renderable","../chunks/index","./Widget","./ScaleBar/ScaleBarViewModel"],(function(e,s,r,t,a,i,o,l,n,c,d,u,p,_,b,h,v,w,y){"use strict";const f="esri-scale-bar esri-widget",g="esri-scale-bar__label-container",m="esri-scale-bar__label-container--ruler",x="esri-scale-bar__label-container--line",j="esri-scale-bar__label-container--top",S="esri-scale-bar__label-container--bottom",U="esri-scale-bar__label",k="esri-scale-bar__line",B="esri-scale-bar__line--top",M="esri-scale-bar__line--bottom",O="esri-scale-bar__ruler",R="esri-scale-bar__ruler-block",C="esri-scale-bar__bar-container",L="esri-scale-bar__bar-container--ruler",$="esri-scale-bar__bar-container--line",P="esri-disabled";function z(e){return 2*e}let E=function(s){function r(e,r){var t;return(t=s.call(this,e,r)||this).label=void 0,t.messages=null,t.unit="non-metric",t.view=null,t.viewModel=new y,t}e._inheritsLoose(r,s);var t=r.prototype;return t.initialize=function(){this.own([p.whenTrue(this,"view.stationary",(()=>this.scheduleRender())),p.watch(this,["view.center","view.scale","view.zoom"],(()=>{this.view.stationary&&this.scheduleRender()}))])},t.castStyle=function(e){return"line"===e?e:"ruler"},t.castUnit=function(e){return"metric"===e||"dual"===e?e:"non-metric"},t.render=function(){const e="disabled"===this.get("viewModel.state"),s={[P]:e};let r,t;if(!e){const{unit:e,style:s}=this,a="metric"===e||"dual"===e,i=50;if("non-metric"===e||"dual"===e){const e=this.viewModel.getScaleBarProperties(i,"non-metric");e&&(t="ruler"===s?this._renderRuler(e):this._renderLine(e,"bottom"))}if(a){const e=this.viewModel.getScaleBarProperties(i,"metric");e&&(r="ruler"===s?this._renderRuler(e):this._renderLine(e,"top"))}}return v.jsx("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(f,s)},r,t)},t._renderRuler=function(e){const s=z(Math.round(e.length)),{messages:r}=this,t=r[e.unit]||r.unknownUnit,a=`${z(e.value)} ${t}`;return v.jsx("div",{class:this.classes(C,L),key:"esri-scale-bar__ruler"},v.jsx("div",{class:O,styles:{width:`${s}px`}},v.jsx("div",{class:R}),v.jsx("div",{class:R}),v.jsx("div",{class:R}),v.jsx("div",{class:R})),v.jsx("div",{class:this.classes(g,m)},v.jsx("div",{class:U},"0"),v.jsx("div",{class:U},a)))},t._renderLine=function(e,s){const{messages:r}=this,t=r[e.unit]||r.unknownUnit,a=`${z(e.value)} ${t}`,i={[j]:"top"===s,[S]:"bottom"===s},o=v.jsx("div",{class:this.classes(g,x,i),key:"esri-scale-bar__label"},v.jsx("div",{class:U},a)),l={[B]:"top"===s,[M]:"bottom"===s},n=z(Math.round(e.length)),c=v.jsx("div",{class:this.classes(k,l),key:"esri-scale-bar__line",styles:{width:`${n}px`}});return v.jsx("div",{class:this.classes(C,$),key:"esri-scale-bar__line-container"},[c,o])},t._handleRootCreateOrUpdate=function(e){const s=this.viewModel;if(s){const r=e.getBoundingClientRect(),t=r.left+window.pageXOffset,a=r.top+window.pageYOffset;s.scaleComputedFrom=u.createScreenPoint(t,a)}},e._createClass(r,[{key:"style",set:function(e){const s="dual"===this.unit?"line":e;this._set("style",s)}}]),r}(w);return s.__decorate([a.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],E.prototype,"label",void 0),s.__decorate([a.property(),h.renderable(),b.messageBundle("esri/widgets/ScaleBar/t9n/ScaleBar")],E.prototype,"messages",void 0),s.__decorate([a.property({dependsOn:["unit"]}),h.renderable()],E.prototype,"style",null),s.__decorate([o.cast("style")],E.prototype,"castStyle",null),s.__decorate([a.property(),h.renderable()],E.prototype,"unit",void 0),s.__decorate([o.cast("unit")],E.prototype,"castUnit",null),s.__decorate([i.aliasOf("viewModel.view"),h.renderable()],E.prototype,"view",void 0),s.__decorate([a.property(),h.renderable(["viewModel.state"])],E.prototype,"viewModel",void 0),E=s.__decorate([l.subclass("esri.widgets.ScaleBar")],E),E}));
