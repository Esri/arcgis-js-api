/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/reactiveUtils","../core/screenUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/arrayUtils","../core/accessorSupport/decorators/subclass","./Widget","./ScaleBar/css","./ScaleBar/ScaleBarViewModel","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory"],(function(e,t,s,r,i,o,n,a,l,c,d,u,p,S){"use strict";function h(e){return 2*e}let C=function(t){function i(e,s){var r;return(r=t.call(this,e,s)||this).messages=null,r.unit="non-metric",r.viewModel=new d,r}e._inheritsLoose(i,t);var o=i.prototype;return o.initialize=function(){this.addHandles([s.watch((()=>{const{view:e}=this;return[e?.stationary,e?.center,e?.scale,e?.zoom]}),(([e])=>{e&&this.scheduleRender()}))])},o.castStyle=function(e){return"line"===e?e:"ruler"},o.castUnit=function(e){return"metric"===e||"dual"===e?e:"non-metric"},o.render=function(){const e="disabled"===this.get("viewModel.state"),t={[c.CSS.disabled]:e};let s,r;if(!e){const{unit:e,style:t}=this,i="metric"===e||"dual"===e,o=50;if("non-metric"===e||"dual"===e){const e=this.viewModel.getScaleBarProperties(o,"non-metric");e&&(r="ruler"===t?this._renderRuler(e):this._renderLine(e,"bottom"))}if(i){const e=this.viewModel.getScaleBarProperties(o,"metric");e&&(s="ruler"===t?this._renderRuler(e):this._renderLine(e,"top"))}}return S.tsx("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(c.CSS.base,t)},s,r)},o._renderRuler=function(e){const t=h(Math.round(e.length)),{messages:s}=this,r=s[e.unit]||s.unknownUnit,i=`${h(e.value)} ${r}`;return S.tsx("div",{class:this.classes(c.CSS.barContainer,c.CSS.rulerBarContainer),key:"esri-scale-bar__ruler"},S.tsx("div",{class:c.CSS.ruler,styles:{width:`${t}px`}},S.tsx("div",{class:c.CSS.rulerBlock}),S.tsx("div",{class:c.CSS.rulerBlock}),S.tsx("div",{class:c.CSS.rulerBlock}),S.tsx("div",{class:c.CSS.rulerBlock})),S.tsx("div",{class:this.classes(c.CSS.labelContainer,c.CSS.rulerLabelContainer)},S.tsx("div",{class:c.CSS.label},"0"),S.tsx("div",{class:c.CSS.label},i)))},o._renderLine=function(e,t){const{messages:s}=this,r=s[e.unit]||s.unknownUnit,i=`${h(e.value)} ${r}`,o={[c.CSS.topLabelContainer]:"top"===t,[c.CSS.bottomLabelContainer]:"bottom"===t},n=S.tsx("div",{class:this.classes(c.CSS.labelContainer,c.CSS.lineLabelContainer,o),key:"esri-scale-bar__label"},S.tsx("div",{class:c.CSS.label},i)),a={[c.CSS.topLine]:"top"===t,[c.CSS.bottomLine]:"bottom"===t},l=h(Math.round(e.length)),d=S.tsx("div",{class:this.classes(c.CSS.line,a),key:"esri-scale-bar__line",styles:{width:`${l}px`}});return S.tsx("div",{class:this.classes(c.CSS.barContainer,c.CSS.lineBarContainer),key:"esri-scale-bar__line-container"},[d,n])},o._handleRootCreateOrUpdate=function(e){const t=this.viewModel;if(!t)return;const s=e.getBoundingClientRect(),i=s.left+window.pageXOffset,o=s.top+window.pageYOffset,n=r.createScreenPoint(i,o);(n.x!==t.scaleComputedFrom.x||n.y!==t.scaleComputedFrom.y)&&(t.scaleComputedFrom=n)},e._createClass(i,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(e){this._overrideIfSome("label",e)}},{key:"style",set:function(e){const t="dual"===this.unit?"line":e;this._set("style",t)}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}}]),i}(l);t.__decorate([i.property()],C.prototype,"label",null),t.__decorate([i.property(),p.messageBundle("esri/widgets/ScaleBar/t9n/ScaleBar")],C.prototype,"messages",void 0),t.__decorate([i.property()],C.prototype,"style",null),t.__decorate([o.cast("style")],C.prototype,"castStyle",null),t.__decorate([i.property()],C.prototype,"unit",void 0),t.__decorate([o.cast("unit")],C.prototype,"castUnit",null),t.__decorate([i.property()],C.prototype,"view",null),t.__decorate([i.property()],C.prototype,"viewModel",void 0),C=t.__decorate([a.subclass("esri.widgets.ScaleBar")],C);return C}));
