/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/reactiveUtils","../core/screenUtils","../core/accessorSupport/decorators/property","../core/arrayUtils","../core/accessorSupport/decorators/cast","../core/accessorSupport/decorators/subclass","./Widget","./ScaleBar/ScaleBarViewModel","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory"],(function(e,t,r,s,a,i,l,n,o,c,u,d,b){"use strict";const p={base:"esri-scale-bar esri-widget",labelContainer:"esri-scale-bar__label-container",rulerLabelContainer:"esri-scale-bar__label-container--ruler",lineLabelContainer:"esri-scale-bar__label-container--line",topLabelContainer:"esri-scale-bar__label-container--top",bottomLabelContainer:"esri-scale-bar__label-container--bottom",label:"esri-scale-bar__label",line:"esri-scale-bar__line",topLine:"esri-scale-bar__line--top",bottomLine:"esri-scale-bar__line--bottom",ruler:"esri-scale-bar__ruler",rulerBlock:"esri-scale-bar__ruler-block",barContainer:"esri-scale-bar__bar-container",rulerBarContainer:"esri-scale-bar__bar-container--ruler",lineBarContainer:"esri-scale-bar__bar-container--line",disabled:"esri-disabled"};function _(e){return 2*e}let h=function(t){function a(e,r){var s;return(s=t.call(this,e,r)||this).messages=null,s.unit="non-metric",s.viewModel=new c,s}e._inheritsLoose(a,t);var i=a.prototype;return i.initialize=function(){this.addHandles([r.watch((()=>{const{view:e}=this;return[e?.stationary,e?.center,e?.scale,e?.zoom]}),(([e])=>{e&&this.scheduleRender()}))])},i.castStyle=function(e){return"line"===e?e:"ruler"},i.castUnit=function(e){return"metric"===e||"dual"===e?e:"non-metric"},i.render=function(){const e="disabled"===this.get("viewModel.state"),t={[p.disabled]:e};let r,s;if(!e){const{unit:e,style:t}=this,a="metric"===e||"dual"===e,i=50;if("non-metric"===e||"dual"===e){const e=this.viewModel.getScaleBarProperties(i,"non-metric");e&&(s="ruler"===t?this._renderRuler(e):this._renderLine(e,"bottom"))}if(a){const e=this.viewModel.getScaleBarProperties(i,"metric");e&&(r="ruler"===t?this._renderRuler(e):this._renderLine(e,"top"))}}return b.tsx("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(p.base,t)},r,s)},i._renderRuler=function(e){const t=_(Math.round(e.length)),{messages:r}=this,s=r[e.unit]||r.unknownUnit,a=`${_(e.value)} ${s}`;return b.tsx("div",{class:this.classes(p.barContainer,p.rulerBarContainer),key:"esri-scale-bar__ruler"},b.tsx("div",{class:p.ruler,styles:{width:`${t}px`}},b.tsx("div",{class:p.rulerBlock}),b.tsx("div",{class:p.rulerBlock}),b.tsx("div",{class:p.rulerBlock}),b.tsx("div",{class:p.rulerBlock})),b.tsx("div",{class:this.classes(p.labelContainer,p.rulerLabelContainer)},b.tsx("div",{class:p.label},"0"),b.tsx("div",{class:p.label},a)))},i._renderLine=function(e,t){const{messages:r}=this,s=r[e.unit]||r.unknownUnit,a=`${_(e.value)} ${s}`,i={[p.topLabelContainer]:"top"===t,[p.bottomLabelContainer]:"bottom"===t},l=b.tsx("div",{class:this.classes(p.labelContainer,p.lineLabelContainer,i),key:"esri-scale-bar__label"},b.tsx("div",{class:p.label},a)),n={[p.topLine]:"top"===t,[p.bottomLine]:"bottom"===t},o=_(Math.round(e.length)),c=b.tsx("div",{class:this.classes(p.line,n),key:"esri-scale-bar__line",styles:{width:`${o}px`}});return b.tsx("div",{class:this.classes(p.barContainer,p.lineBarContainer),key:"esri-scale-bar__line-container"},[c,l])},i._handleRootCreateOrUpdate=function(e){const t=this.viewModel;if(!t)return;const r=e.getBoundingClientRect(),a=r.left+window.pageXOffset,i=r.top+window.pageYOffset,l=s.createScreenPoint(a,i);(l.x!==t.scaleComputedFrom.x||l.y!==t.scaleComputedFrom.y)&&(t.scaleComputedFrom=l)},e._createClass(a,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(e){this._overrideIfSome("label",e)}},{key:"style",set:function(e){const t="dual"===this.unit?"line":e;this._set("style",t)}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}}]),a}(o);t.__decorate([a.property()],h.prototype,"label",null),t.__decorate([a.property(),d.messageBundle("esri/widgets/ScaleBar/t9n/ScaleBar")],h.prototype,"messages",void 0),t.__decorate([a.property()],h.prototype,"style",null),t.__decorate([l.cast("style")],h.prototype,"castStyle",null),t.__decorate([a.property()],h.prototype,"unit",void 0),t.__decorate([l.cast("unit")],h.prototype,"castUnit",null),t.__decorate([a.property()],h.prototype,"view",null),t.__decorate([a.property()],h.prototype,"viewModel",void 0),h=t.__decorate([n.subclass("esri.widgets.ScaleBar")],h);return h}));
