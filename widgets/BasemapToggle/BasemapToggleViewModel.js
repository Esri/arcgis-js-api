/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/compilerUtils","../../core/Logger","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/cast","../../core/accessorSupport/decorators/subclass","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../core/Evented","../../support/basemapDefinitions","../../support/basemapUtils","../../core/watchUtils"],(function(e,t,a,s,r,o,i,n,p,c,l,u,d,m,h){"use strict";let y=function(t){function a(a){var s;return(s=t.call(this,a)||this)._basemapCache={},s.nextBasemap=m.ensureType("hybrid",s._basemapCache),s.view=null,s.toggle=s.toggle.bind(e._assertThisInitialized(s)),s}e._inheritsLoose(a,t);var r=a.prototype;return r.initialize=function(){h.init(this,"nextBasemap",(e=>{e&&!e.loaded&&e.load().catch((()=>{}))}))},r.destroy=function(){this.view=null,m.destroyCache(this._basemapCache),this._basemapCache=null},r.castNextBasemap=function(e){return m.ensureType(e,this._basemapCache)},r.toggle=function(){if("disabled"===this.state)return;const e=this.activeBasemap,t=this.nextBasemap;this.view.map.basemap=t,this.nextBasemap=e,this.emit("toggle",{previous:e,current:t})},a.getThumbnailUrl=function(e){if(!e)return null;const{thumbnailUrl:t}=e;if(t)return t;const a=m.getWellKnownBasemapId(e);if(a)return d.esriBasemapDefinitions[a].thumbnailUrl;const r=e.baseLayers.find((e=>!!s.typeCast(e)().get("portalItem.thumbnailUrl")));return r?s.typeCast(r)().get("portalItem.thumbnailUrl"):null},e._createClass(a,[{key:"activeBasemap",get:function(){return m.ensureType(this.get("view.map.basemap")||"topo",this._basemapCache)}},{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}}]),a}(u.EventedAccessor);return t.__decorate([o.property({dependsOn:["view.map.basemap"],readOnly:!0})],y.prototype,"activeBasemap",null),t.__decorate([o.property()],y.prototype,"nextBasemap",void 0),t.__decorate([i.cast("nextBasemap")],y.prototype,"castNextBasemap",null),t.__decorate([o.property({dependsOn:["view.ready"],readOnly:!0})],y.prototype,"state",null),t.__decorate([o.property()],y.prototype,"view",void 0),t.__decorate([o.property()],y.prototype,"toggle",null),y=t.__decorate([n.subclass("esri.widgets.BasemapToggle.BasemapToggleViewModel")],y),y}));
