/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/compilerUtils","../../core/Logger","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/cast","../../core/accessorSupport/decorators/subclass","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../core/Evented","../../support/basemapDefinitions","../../support/basemapUtils","../../core/watchUtils"],(function(e,t,a,r,s,o,i,n,p,c,l,u,d,h,m){"use strict";let y=function(t){function a(a){var r;return(r=t.call(this,a)||this)._basemapCache={},r.nextBasemap=h.ensureType("hybrid",r._basemapCache),r.view=null,r.toggle=r.toggle.bind(e._assertThisInitialized(r)),r}e._inheritsLoose(a,t);var s=a.prototype;return s.initialize=function(){m.init(this,"nextBasemap",(e=>{e&&!e.loaded&&e.load().catch((()=>{}))}))},s.destroy=function(){this.view=null,h.destroyCache(this._basemapCache),this._basemapCache=null},s.castNextBasemap=function(e){return h.ensureType(e,this._basemapCache)},s.toggle=function(){if("disabled"===this.state)return;const e=this.activeBasemap,t=this.nextBasemap;this.view.map.basemap=t,this.nextBasemap=e,this.emit("toggle",{previous:e,current:t})},a.getThumbnailUrl=function(e){if(!e)return null;const{thumbnailUrl:t}=e;if(t)return t;const a=h.getWellKnownBasemapId(e);if(a)return d.esriBasemapDefinitions[a].thumbnailUrl;const s=e.baseLayers.find((e=>!!r.typeCast(e)().get("portalItem.thumbnailUrl")));return s?r.typeCast(s)().get("portalItem.thumbnailUrl"):null},e._createClass(a,[{key:"activeBasemap",get:function(){return h.ensureType(this.get("view.map.basemap")||"topo",this._basemapCache)}},{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}}]),a}(u.EventedAccessor);return t.__decorate([o.property({readOnly:!0})],y.prototype,"activeBasemap",null),t.__decorate([o.property()],y.prototype,"nextBasemap",void 0),t.__decorate([i.cast("nextBasemap")],y.prototype,"castNextBasemap",null),t.__decorate([o.property({readOnly:!0})],y.prototype,"state",null),t.__decorate([o.property()],y.prototype,"view",void 0),t.__decorate([o.property()],y.prototype,"toggle",null),y=t.__decorate([n.subclass("esri.widgets.BasemapToggle.BasemapToggleViewModel")],y),y}));
