/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/Logger","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/subclass","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../core/Accessor","../../core/Handles","../../core/watchUtils","../support/GoTo"],(function(e,t,o,i,r,a,n,s,c,d,p,h,u,l){"use strict";let _=function(t){function o(o){var i;return(i=t.call(this,o)||this)._handles=new h,i.orientation={x:0,y:0,z:0},i.view=null,i._updateForCamera=i._updateForCamera.bind(e._assertThisInitialized(i)),i._updateForRotation=i._updateForRotation.bind(e._assertThisInitialized(i)),i._updateRotationWatcher=i._updateRotationWatcher.bind(e._assertThisInitialized(i)),i.view,i}e._inheritsLoose(o,t);var i=o.prototype;return i.initialize=function(){this._handles.add(u.init(this,"view",this._updateRotationWatcher))},i.destroy=function(){this._handles.destroy(),this._handles=null,this.view=null},i.reset=function(){if(!this.get("view.ready"))return;const e={};"2d"===this.view.type?e.rotation=0:e.heading=0,this.callGoTo({target:e})},i._updateForRotation=function(e){null!=e&&(this.orientation={z:e})},i._updateForCamera=function(e){if(!e)return;const t=-e.heading;this.orientation={x:0,y:0,z:t}},i._updateRotationWatcher=function(e){this._handles.removeAll(),e&&("2d"===e.type?this._handles.add(u.init(this,"view.rotation",this._updateForRotation)):this._handles.add(u.init(this,"view.camera",this._updateForCamera)))},e._createClass(o,[{key:"canShowNorth",get:function(){const e=this.get("view.spatialReference");return!(!e||!e.isWebMercator&&!e.isGeographic)}},{key:"state",get:function(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}}]),o}(l.GoToMixin(p));return t.__decorate([a.property({dependsOn:["view.spatialReference.isWebMercator","view.spatialReference.wkid"],readOnly:!0})],_.prototype,"canShowNorth",null),t.__decorate([a.property()],_.prototype,"orientation",void 0),t.__decorate([a.property({dependsOn:["view.ready","canShowNorth"],readOnly:!0})],_.prototype,"state",null),t.__decorate([a.property()],_.prototype,"view",void 0),_=t.__decorate([n.subclass("esri.widgets.CompassViewModel")],_),_}));
