/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/Accessor","../../core/Handles","../../core/watchUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/accessorSupport/ensureType","../../core/Logger","../../core/accessorSupport/decorators/subclass","../support/GoTo"],(function(t,e,o,i,r,a,n,s,c,d,h){"use strict";const p="esri.widgets.CompassViewModel";let u=function(e){function o(o){var r;return(r=e.call(this,o)||this)._handles=new i,r.orientation={x:0,y:0,z:0},r.view=null,r._updateForCamera=r._updateForCamera.bind(t._assertThisInitialized(r)),r._updateForRotation=r._updateForRotation.bind(t._assertThisInitialized(r)),r._updateRotationWatcher=r._updateRotationWatcher.bind(t._assertThisInitialized(r)),r}t._inheritsLoose(o,e);var a=o.prototype;return a.initialize=function(){this._handles.add(r.init(this,"view",this._updateRotationWatcher))},a.destroy=function(){this._handles.destroy(),this._handles=null,this.view=null},a.reset=function(){if(!this.get("view.ready"))return;const t={};"2d"===this.view.type?t.rotation=0:t.heading=0,this.callGoTo({target:t})},a._updateForRotation=function(t){null!=t&&(this.orientation={z:t})},a._updateForCamera=function(t){if(!t)return;const e=-t.heading;this.orientation={x:0,y:0,z:e}},a._updateRotationWatcher=function(t){this._handles.removeAll(),t&&("2d"===t.type?this._handles.add(r.init(this,"view.rotation",this._updateForRotation)):this._handles.add(r.init(this,"view.camera",this._updateForCamera)))},t._createClass(o,[{key:"canShowNorth",get:function(){const t=this.get("view.spatialReference");return!(!t||!t.isWebMercator&&!t.isGeographic)}},{key:"state",get:function(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}}]),o}(h.GoToMixin(o));return e.__decorate([a.property({readOnly:!0})],u.prototype,"canShowNorth",null),e.__decorate([a.property()],u.prototype,"orientation",void 0),e.__decorate([a.property({readOnly:!0})],u.prototype,"state",null),e.__decorate([a.property()],u.prototype,"view",void 0),u=e.__decorate([d.subclass(p)],u),u}));
