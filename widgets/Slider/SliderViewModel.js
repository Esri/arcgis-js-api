/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/maybe","../../core/Logger","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/subclass","../../core/Error","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../core/Accessor"],(function(t,e,o,n,r,i,s,a,u,l,c,p,m){"use strict";const h="esri.widgets.Slider.SliderViewModel",d=r.getLogger(h);let y=function(e){function o(t){var o;return(o=e.call(this,t)||this).precision=4,o.thumbsConstrained=!0,o}t._inheritsLoose(o,e);var r=o.prototype;return r.toPrecision=function(t){return parseFloat(t.toFixed(this.precision))},r.defaultLabelFormatFunction=function(t){const{max:e,min:o,precision:n}=this,r=e-o>10?2:n;return parseFloat(t.toFixed(r)).toString()},r.defaultInputFormatFunction=function(t){return t.toString()},r.defaultInputParseFunction=function(t){return parseFloat(t)},r.getBoundsForValueAtIndex=function(t){const{thumbsConstrained:e,max:o,min:r,values:i}=this;if(e){const e=t-1,s=t+1;return{min:n.isSome(i[e])?i[e]:r,max:n.isSome(i[s])?i[s]:o}}return{min:r,max:o}},r.getLabelForValue=function(t,e,o){return n.isSome(t)?this.labelFormatFunction?this.labelFormatFunction(t,e,o):this.defaultLabelFormatFunction(t):null},r.setMax=function(t){const{max:e,values:o}=this;if(isNaN(t))return void this._logError("slider:invalid-value","Property 'max' must of type 'number'.");if(null===t)return void this._set("max",null);const n=this.toPrecision(t);if(e!==n&&(this._set("max",n),o&&o.length))for(let t=0;t<o.length;t++)n<o[t]&&this.setValue(t,n)},r.setMin=function(t){const{min:e,values:o}=this;if(isNaN(t))return void this._logError("slider:invalid-value","Property 'min' must of type 'number'.");if(null===t)return void this._set("min",null);const n=this.toPrecision(t);if(e!==n&&(this._set("min",n),o&&o.length))for(let t=0;t<o.length;t++)n>o[t]&&this.setValue(t,n)},r.setValue=function(t,e){if(isNaN(e))return void this._logError("slider:invalid-value","Members of property 'values' must of type 'number'.");const{values:o}=this,n=o[t],r=this.toPrecision(e);if(n===r)return;const i=[...o];i[t]=r,this._set("values",i),this.notifyChange("labels")},r._logError=function(t,e,o){d.error(new u(t,e,o))},t._createClass(o,[{key:"labelFormatFunction",set:function(t){this._set("labelFormatFunction",t)}},{key:"inputFormatFunction",set:function(t){this._set("inputFormatFunction",t)}},{key:"inputParseFunction",set:function(t){this._set("inputParseFunction",t)}},{key:"labels",get:function(){const{max:t,min:e,values:o}=this,n=o&&o.length?o.map(((t,e)=>this.getLabelForValue(t,"value",e))):[];return{max:this.getLabelForValue(t,"max"),min:this.getLabelForValue(e,"min"),values:n}}},{key:"max",set:function(t){this.setMax(t)}},{key:"min",set:function(t){this.setMin(t)}},{key:"state",get:function(){const{max:t,min:e}=this;return n.isSome(t)&&n.isSome(e)?"ready":"disabled"}},{key:"values",set:function(t){const{max:e,min:o}=this,r=this.values;r&&t&&r.length===t.length&&r.every(((e,o)=>e===t[o]))||(this._set("values",null),t&&t.length&&(n.isSome(o)&&t.some((t=>t<o))&&(this.min=Math.min(...t)),n.isSome(e)&&t.some((t=>t>e))&&(this.max=Math.max(...t))),this._set("values",t))}}]),o}(m);return e.__decorate([s.property()],y.prototype,"labelFormatFunction",null),e.__decorate([s.property()],y.prototype,"inputFormatFunction",null),e.__decorate([s.property()],y.prototype,"inputParseFunction",null),e.__decorate([s.property({dependsOn:["labelFormatFunction","max","min","values"],readOnly:!0})],y.prototype,"labels",null),e.__decorate([s.property()],y.prototype,"max",null),e.__decorate([s.property()],y.prototype,"min",null),e.__decorate([s.property()],y.prototype,"precision",void 0),e.__decorate([s.property({dependsOn:["max","min"],readOnly:!0})],y.prototype,"state",null),e.__decorate([s.property()],y.prototype,"thumbsConstrained",void 0),e.__decorate([s.property()],y.prototype,"values",null),y=e.__decorate([a.subclass(h)],y),y}));
