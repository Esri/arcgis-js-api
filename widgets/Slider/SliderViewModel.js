// COPYRIGHT Â© 2020 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.17/esri/copyright.txt for details.

define(["require","exports","tslib","../../core/Accessor","../../core/Error","../../core/Logger","../../core/maybe","../../core/accessorSupport/decorators"],(function(e,t,r,o,n,i,s,a){"use strict";var l=i.getLogger("esri.widgets.Slider.SliderViewModel");return function(e){function t(t){var r=e.call(this,t)||this;return r.precision=4,r.thumbsConstrained=!0,r}return r.__extends(t,e),Object.defineProperty(t.prototype,"labelFormatFunction",{set:function(e){this._set("labelFormatFunction",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputFormatFunction",{set:function(e){this._set("inputFormatFunction",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputParseFunction",{set:function(e){this._set("inputParseFunction",e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"labels",{get:function(){var e=this,t=this.max,r=this.min,o=this.values,n=o&&o.length?o.map((function(t,r){return e.getLabelForValue(t,"value",r)})):[];return{max:this.getLabelForValue(t,"max"),min:this.getLabelForValue(r,"min"),values:n}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{set:function(e){this.setMax(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"min",{set:function(e){this.setMin(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){var e=this.max,t=this.min;return s.isSome(e)&&s.isSome(t)?"ready":"disabled"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"values",{set:function(e){var t=this.max,r=this.min,o=this.values;o&&e&&o.length===e.length&&o.every((function(t,r){return t===e[r]}))||(this._set("values",null),e&&e.length&&(s.isSome(r)&&e.some((function(e){return e<r}))&&(this.min=Math.min.apply(Math,e)),s.isSome(t)&&e.some((function(e){return e>t}))&&(this.max=Math.max.apply(Math,e))),this._set("values",e))},enumerable:!1,configurable:!0}),t.prototype.toPrecision=function(e){return parseFloat(e.toFixed(this.precision))},t.prototype.defaultLabelFormatFunction=function(e){var t=this.max,r=this.min,o=this.precision,n=t-r>10?2:o;return parseFloat(e.toFixed(n)).toString()},t.prototype.defaultInputFormatFunction=function(e){return e.toString()},t.prototype.defaultInputParseFunction=function(e){return parseFloat(e)},t.prototype.getBoundsForValueAtIndex=function(e){var t=this.thumbsConstrained,r=this.max,o=this.min,n=this.values;if(t){var i=e-1,a=e+1;return{min:s.isSome(n[i])?n[i]:o,max:s.isSome(n[a])?n[a]:r}}return{min:o,max:r}},t.prototype.getLabelForValue=function(e,t,r){return s.isSome(e)?this.labelFormatFunction?this.labelFormatFunction(e,t,r):this.defaultLabelFormatFunction(e):null},t.prototype.setMax=function(e){var t=this.max,r=this.values;if(isNaN(e))this._logError("slider:invalid-value","Property 'max' must of type 'number'.");else if(null!==e){var o=this.toPrecision(e);if(t!==o&&(this._set("max",o),r&&r.length))for(var n=0;n<r.length;n++)o<r[n]&&this.setValue(n,o)}else this._set("max",null)},t.prototype.setMin=function(e){var t=this.min,r=this.values;if(isNaN(e))this._logError("slider:invalid-value","Property 'min' must of type 'number'.");else if(null!==e){var o=this.toPrecision(e);if(t!==o&&(this._set("min",o),r&&r.length))for(var n=0;n<r.length;n++)o>r[n]&&this.setValue(n,o)}else this._set("min",null)},t.prototype.setValue=function(e,t){if(isNaN(t))this._logError("slider:invalid-value","Members of property 'values' must of type 'number'.");else{var o=this.values,n=o[e],i=this.toPrecision(t);if(n!==i){var s=r.__spreadArrays(o);s[e]=i,this._set("values",s),this.notifyChange("labels")}}},t.prototype._logError=function(e,t,r){l.error(new n(e,t,r))},r.__decorate([a.property()],t.prototype,"labelFormatFunction",null),r.__decorate([a.property()],t.prototype,"inputFormatFunction",null),r.__decorate([a.property()],t.prototype,"inputParseFunction",null),r.__decorate([a.property({dependsOn:["labelFormatFunction","max","min","values"],readOnly:!0})],t.prototype,"labels",null),r.__decorate([a.property()],t.prototype,"max",null),r.__decorate([a.property()],t.prototype,"min",null),r.__decorate([a.property()],t.prototype,"precision",void 0),r.__decorate([a.property({dependsOn:["max","min"],readOnly:!0})],t.prototype,"state",null),r.__decorate([a.property()],t.prototype,"thumbsConstrained",void 0),r.__decorate([a.property()],t.prototype,"values",null),t=r.__decorate([a.subclass("esri.widgets.Slider.SliderViewModel")],t)}(o)}));