/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/Accessor","../../core/Error","../../core/Logger","../../core/maybe","../../core/accessorSupport/decorators/property","../../core/arrayUtils","../../core/has","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/subclass"],(function(t,e,o,r,n,i,s,a,u,l,c){"use strict";const p="esri.widgets.Slider.SliderViewModel",m=n.getLogger(p);let h=function(e){function o(t){var o;return(o=e.call(this,t)||this).precision=4,o.thumbsConstrained=!0,o}t._inheritsLoose(o,e);var n=o.prototype;return n.toPrecision=function(t){return parseFloat(t.toFixed(this.precision))},n.defaultLabelFormatFunction=function(t){const{max:e,min:o,precision:r}=this,n=e-o>10?2:r;return parseFloat(t.toFixed(n)).toString()},n.defaultInputFormatFunction=function(t){return t.toString()},n.defaultInputParseFunction=function(t){return parseFloat(t)},n.getBoundsForValueAtIndex=function(t){const{thumbsConstrained:e,max:o,min:r,values:n}=this;if(e){const e=t-1,s=t+1;return{min:i.isSome(n[e])?n[e]:r,max:i.isSome(n[s])?n[s]:o}}return{min:r,max:o}},n.getLabelForValue=function(t,e,o){return i.isSome(t)?this.labelFormatFunction?this.labelFormatFunction(t,e,o):this.defaultLabelFormatFunction(t):null},n.setMax=function(t){const{max:e,values:o}=this;if(isNaN(t))return void this._logError("slider:invalid-value","Property 'max' must of type 'number'.");if(null===t)return void this._set("max",null);const r=this.toPrecision(t);if(e!==r&&(this._set("max",r),o&&o.length))for(let n=0;n<o.length;n++)r<o[n]&&this.setValue(n,r)},n.setMin=function(t){const{min:e,values:o}=this;if(isNaN(t))return void this._logError("slider:invalid-value","Property 'min' must of type 'number'.");if(null===t)return void this._set("min",null);const r=this.toPrecision(t);if(e!==r&&(this._set("min",r),o&&o.length))for(let n=0;n<o.length;n++)r>o[n]&&this.setValue(n,r)},n.setValue=function(t,e){if(isNaN(e))return void this._logError("slider:invalid-value","Members of property 'values' must of type 'number'.");const{values:o}=this,r=o[t],n=this.toPrecision(e);if(r===n)return;const i=[...o];i[t]=n,this._set("values",i),this.notifyChange("labels")},n._logError=function(t,e,o){m.error(new r(t,e,o))},t._createClass(o,[{key:"labelFormatFunction",set:function(t){this._set("labelFormatFunction",t)}},{key:"inputFormatFunction",set:function(t){this._set("inputFormatFunction",t)}},{key:"inputParseFunction",set:function(t){this._set("inputParseFunction",t)}},{key:"labels",get:function(){const{max:t,min:e,values:o}=this,r=o&&o.length?o.map(((t,e)=>this.getLabelForValue(t,"value",e))):[];return{max:this.getLabelForValue(t,"max"),min:this.getLabelForValue(e,"min"),values:r}}},{key:"max",set:function(t){this.setMax(t)}},{key:"min",set:function(t){this.setMin(t)}},{key:"state",get:function(){const{max:t,min:e}=this;return i.isSome(t)&&i.isSome(e)&&t>e?"ready":"disabled"}},{key:"values",set:function(t){const{max:e,min:o}=this,r=this.values;r&&t&&r.length===t.length&&r.every(((e,o)=>e===t[o]))||(this._set("values",null),t&&t.length&&(i.isSome(o)&&t.some((t=>t<o))&&(this.min=Math.min(...t)),i.isSome(e)&&t.some((t=>t>e))&&(this.max=Math.max(...t))),this._set("values",t))}}]),o}(o);e.__decorate([s.property()],h.prototype,"labelFormatFunction",null),e.__decorate([s.property()],h.prototype,"inputFormatFunction",null),e.__decorate([s.property()],h.prototype,"inputParseFunction",null),e.__decorate([s.property({readOnly:!0})],h.prototype,"labels",null),e.__decorate([s.property()],h.prototype,"max",null),e.__decorate([s.property()],h.prototype,"min",null),e.__decorate([s.property()],h.prototype,"precision",void 0),e.__decorate([s.property({readOnly:!0})],h.prototype,"state",null),e.__decorate([s.property()],h.prototype,"thumbsConstrained",void 0),e.__decorate([s.property()],h.prototype,"values",null),h=e.__decorate([c.subclass(p)],h);return h}));
