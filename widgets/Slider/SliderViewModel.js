/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/Accessor","../../core/Error","../../core/Logger","../../core/maybe","../../core/accessorSupport/decorators/property","../../core/arrayUtils","../../core/has","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/subclass"],(function(e,t,i,o,n,r,s,a,u,l,c){"use strict";const p="esri.widgets.Slider.SliderViewModel",f=n.getLogger(p);let h=function(t){function i(e){var i;return(i=t.call(this,e)||this).precision=4,i.thumbsConstrained=!0,i}e._inheritsLoose(i,t);var n=i.prototype;return n.toPrecision=function(e){return parseFloat(e.toFixed(this.precision))},n.defaultLabelFormatFunction=function(e){const{max:t,min:i,precision:o}=this,n=t-i>10?2:o;return parseFloat(e.toFixed(n)).toString()},n.defaultInputFormatFunction=function(e){return e.toString()},n.defaultInputParseFunction=function(e){return parseFloat(e)},n.getBounds=function(){const{effectiveMax:e,effectiveMin:t,max:i,min:o}=this;return{min:r.isSome(t)?Math.max(o,t):o,max:r.isSome(e)?Math.min(i,e):i}},n.getBoundsForValueAtIndex=function(e){const{thumbsConstrained:t,values:i}=this,{min:o,max:n}=this.getBounds();if(t){const t=e-1,s=e+1;return{min:r.isSome(i[t])?i[t]:o,max:r.isSome(i[s])?i[s]:n}}return{min:o,max:n}},n.getLabelForValue=function(e,t,i){return r.isSome(e)?this.labelFormatFunction?this.labelFormatFunction(e,t,i):this.defaultLabelFormatFunction(e):null},n.setMax=function(e){const{max:t,values:i}=this;if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'max' is NaN.");if(null===e)return void this._set("max",null);const o=this.toPrecision(e);if(t!==o&&(this._set("max",o),i&&i.length))for(let n=0;n<i.length;n++)o<i[n]&&this.setValue(n,o)},n.setMin=function(e){const{min:t,values:i}=this;if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'min' is NaN.");if(null===e)return void this._set("min",null);const o=this.toPrecision(e);if(t!==o&&(this._set("min",o),i&&i.length))for(let n=0;n<i.length;n++)o>i[n]&&this.setValue(n,o)},n.setEffectiveMax=function(e){if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMax' is NaN.");if(null===e)return void this._set("effectiveMax",null);const t=this.toPrecision(e);this.effectiveMax!==t&&this._set("effectiveMax",this._applyBoundsToValue(t))},n.setEffectiveMin=function(e){if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMin' is NaN.");if(null===e)return void this._set("effectiveMin",null);const t=this.toPrecision(e);this.effectiveMin!==t&&this._set("effectiveMin",this._applyBoundsToValue(t))},n.setValue=function(e,t){if(isNaN(t))return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is NaN.");const{values:i}=this,o=i[e],n=this.toPrecision(t);if(o===n)return;const r=[...i];r[e]=n,this._set("values",r),this.notifyChange("labels")},n._applyBoundsToValue=function(e){const{max:t,min:i}=this;return r.isSome(i)&&e<i?i:r.isSome(t)&&e>t?t:e},n._logError=function(e,t,i){f.error(new o(e,t,i))},e._createClass(i,[{key:"effectiveMax",set:function(e){this.setEffectiveMax(e)}},{key:"effectiveMin",set:function(e){this.setEffectiveMin(e)}},{key:"labelFormatFunction",set:function(e){this._set("labelFormatFunction",e)}},{key:"inputFormatFunction",set:function(e){this._set("inputFormatFunction",e)}},{key:"inputParseFunction",set:function(e){this._set("inputParseFunction",e)}},{key:"labels",get:function(){const{max:e,min:t,values:i}=this,o=i&&i.length?i.map(((e,t)=>this.getLabelForValue(e,"value",t))):[];return{max:this.getLabelForValue(e,"max"),min:this.getLabelForValue(t,"min"),values:o}}},{key:"max",set:function(e){this.setMax(e)}},{key:"min",set:function(e){this.setMin(e)}},{key:"state",get:function(){const{max:e,min:t}=this;return r.isSome(e)&&r.isSome(t)&&e>t?"ready":"disabled"}},{key:"values",set:function(e){const{max:t,min:i}=this,o=this.values;o&&e&&o.length===e.length&&o.every(((t,i)=>t===e[i]))||(this._set("values",null),e&&e.length&&(r.isSome(i)&&e.some((e=>e<i))&&(this.min=Math.min(...e)),r.isSome(t)&&e.some((e=>e>t))&&(this.max=Math.max(...e))),this._set("values",e))}}]),i}(i);t.__decorate([s.property()],h.prototype,"effectiveMax",null),t.__decorate([s.property()],h.prototype,"effectiveMin",null),t.__decorate([s.property()],h.prototype,"labelFormatFunction",null),t.__decorate([s.property()],h.prototype,"inputFormatFunction",null),t.__decorate([s.property()],h.prototype,"inputParseFunction",null),t.__decorate([s.property({readOnly:!0})],h.prototype,"labels",null),t.__decorate([s.property()],h.prototype,"max",null),t.__decorate([s.property()],h.prototype,"min",null),t.__decorate([s.property()],h.prototype,"precision",void 0),t.__decorate([s.property({readOnly:!0})],h.prototype,"state",null),t.__decorate([s.property()],h.prototype,"thumbsConstrained",void 0),t.__decorate([s.property()],h.prototype,"values",null),h=t.__decorate([c.subclass(p)],h);return h}));
