/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/Accessor","../../core/Error","../../core/Logger","../../core/maybe","../../core/accessorSupport/decorators/property","../../core/has","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/subclass"],(function(t,e,o,n,r,i,s,a,u,l){"use strict";const c="esri.widgets.Slider.SliderViewModel",p=r.getLogger(c);let m=function(e){function o(t){var o;return(o=e.call(this,t)||this).precision=4,o.thumbsConstrained=!0,o}t._inheritsLoose(o,e);var r=o.prototype;return r.toPrecision=function(t){return parseFloat(t.toFixed(this.precision))},r.defaultLabelFormatFunction=function(t){const{max:e,min:o,precision:n}=this,r=e-o>10?2:n;return parseFloat(t.toFixed(r)).toString()},r.defaultInputFormatFunction=function(t){return t.toString()},r.defaultInputParseFunction=function(t){return parseFloat(t)},r.getBoundsForValueAtIndex=function(t){const{thumbsConstrained:e,max:o,min:n,values:r}=this;if(e){const e=t-1,s=t+1;return{min:i.isSome(r[e])?r[e]:n,max:i.isSome(r[s])?r[s]:o}}return{min:n,max:o}},r.getLabelForValue=function(t,e,o){return i.isSome(t)?this.labelFormatFunction?this.labelFormatFunction(t,e,o):this.defaultLabelFormatFunction(t):null},r.setMax=function(t){const{max:e,values:o}=this;if(isNaN(t))return void this._logError("slider:invalid-value","Property 'max' must of type 'number'.");if(null===t)return void this._set("max",null);const n=this.toPrecision(t);if(e!==n&&(this._set("max",n),o&&o.length))for(let r=0;r<o.length;r++)n<o[r]&&this.setValue(r,n)},r.setMin=function(t){const{min:e,values:o}=this;if(isNaN(t))return void this._logError("slider:invalid-value","Property 'min' must of type 'number'.");if(null===t)return void this._set("min",null);const n=this.toPrecision(t);if(e!==n&&(this._set("min",n),o&&o.length))for(let r=0;r<o.length;r++)n>o[r]&&this.setValue(r,n)},r.setValue=function(t,e){if(isNaN(e))return void this._logError("slider:invalid-value","Members of property 'values' must of type 'number'.");const{values:o}=this,n=o[t],r=this.toPrecision(e);if(n===r)return;const i=[...o];i[t]=r,this._set("values",i),this.notifyChange("labels")},r._logError=function(t,e,o){p.error(new n(t,e,o))},t._createClass(o,[{key:"labelFormatFunction",set:function(t){this._set("labelFormatFunction",t)}},{key:"inputFormatFunction",set:function(t){this._set("inputFormatFunction",t)}},{key:"inputParseFunction",set:function(t){this._set("inputParseFunction",t)}},{key:"labels",get:function(){const{max:t,min:e,values:o}=this,n=o&&o.length?o.map(((t,e)=>this.getLabelForValue(t,"value",e))):[];return{max:this.getLabelForValue(t,"max"),min:this.getLabelForValue(e,"min"),values:n}}},{key:"max",set:function(t){this.setMax(t)}},{key:"min",set:function(t){this.setMin(t)}},{key:"state",get:function(){const{max:t,min:e}=this;return i.isSome(t)&&i.isSome(e)&&t>e?"ready":"disabled"}},{key:"values",set:function(t){const{max:e,min:o}=this,n=this.values;n&&t&&n.length===t.length&&n.every(((e,o)=>e===t[o]))||(this._set("values",null),t&&t.length&&(i.isSome(o)&&t.some((t=>t<o))&&(this.min=Math.min(...t)),i.isSome(e)&&t.some((t=>t>e))&&(this.max=Math.max(...t))),this._set("values",t))}}]),o}(o);return e.__decorate([s.property()],m.prototype,"labelFormatFunction",null),e.__decorate([s.property()],m.prototype,"inputFormatFunction",null),e.__decorate([s.property()],m.prototype,"inputParseFunction",null),e.__decorate([s.property({readOnly:!0})],m.prototype,"labels",null),e.__decorate([s.property()],m.prototype,"max",null),e.__decorate([s.property()],m.prototype,"min",null),e.__decorate([s.property()],m.prototype,"precision",void 0),e.__decorate([s.property({readOnly:!0})],m.prototype,"state",null),e.__decorate([s.property()],m.prototype,"thumbsConstrained",void 0),e.__decorate([s.property()],m.prototype,"values",null),m=e.__decorate([l.subclass(c)],m),m}));
