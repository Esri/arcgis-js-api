/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../Viewpoint","../../core/Error","../../core/Evented","../../core/promiseUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/accessorSupport/ensureType","../../core/Logger","../../core/accessorSupport/decorators/subclass","../support/GoTo"],(function(e,t,o,i,n,r,s,l,c,a,p,u){"use strict";let h=function(t){function o(o){var i;return(i=t.call(this,o)||this)._initialViewpoint=null,i._goingHomeController=null,i.go=i.go.bind(e._assertThisInitialized(i)),i}e._inheritsLoose(o,t);var n=o.prototype;return n.destroy=function(){this._cancelGo(),this.view=null},n.go=function(){var t=e._asyncToGenerator((function*(){if(!this.get("view.ready"))throw new i("home:disabled-state","Cannot go when disabled.");this._cancelGo(),this.emit("go");const e=r.createAbortController();this._goingHomeController=e;try{yield this.view.when(),yield this.callGoTo({target:this.viewpoint,options:{signal:e.signal}})}catch(t){}this._goingHomeController=null}));function o(){return t.apply(this,arguments)}return o}(),n.cancelGo=function(){this._cancelGo()},n._cancelGo=function(){const{_goingHomeController:e}=this;e&&e.abort(),this._goingHomeController=null},e._createClass(o,[{key:"state",get:function(){return this.get("view.ready")?this._goingHomeController?"going-home":"ready":"disabled"}},{key:"view",set:function(e){this._initialViewpoint=null,this._set("view",e),e&&e.when().then((()=>{this.view===e&&(this._initialViewpoint=e.viewpoint.clone(),this.notifyChange("viewpoint"))}))}},{key:"viewpoint",get:function(){return this._get("viewpoint")||this._initialViewpoint},set:function(e){this._set("viewpoint",e)}}]),o}(u.GoToMixin(n.EventedAccessor));return t.__decorate([s.property()],h.prototype,"_goingHomeController",void 0),t.__decorate([s.property({readOnly:!0})],h.prototype,"state",null),t.__decorate([s.property()],h.prototype,"view",null),t.__decorate([s.property({type:o})],h.prototype,"viewpoint",null),t.__decorate([s.property()],h.prototype,"go",null),t.__decorate([s.property()],h.prototype,"cancelGo",null),h=t.__decorate([p.subclass("esri.widgets.Home.HomeViewModel")],h),h}));
