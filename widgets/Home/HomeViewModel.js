/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/Logger","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/subclass","../../core/Error","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../core/promiseUtils","../../core/Evented","../../Viewpoint","../support/GoTo"],(function(e,o,t,i,n,r,s,l,c,a,p,u,h,g,_){"use strict";let d=function(o){function t(t){var i;return(i=o.call(this,t)||this)._initialViewpoint=null,i._goingHomeController=null,i.go=i.go.bind(e._assertThisInitialized(i)),i}e._inheritsLoose(t,o);var i=t.prototype;return i.destroy=function(){this._cancelGo(),this.view=null},i.go=async function(){if(!this.get("view.ready"))throw new l("home:disabled-state","Cannot go when disabled.");this._cancelGo(),this.emit("go");const e=u.createAbortController();this._goingHomeController=e;try{await this.view.when(),await this.callGoTo({target:this.viewpoint,options:{signal:e.signal}})}catch(e){}this._goingHomeController=null},i.cancelGo=function(){this._cancelGo()},i._cancelGo=function(){const{_goingHomeController:e}=this;e&&e.abort(),this._goingHomeController=null},e._createClass(t,[{key:"state",get:function(){return this.get("view.ready")?this._goingHomeController?"going-home":"ready":"disabled"}},{key:"view",set:function(e){this._initialViewpoint=null,this._set("view",e),e&&e.when().then((()=>{this.view===e&&(this._initialViewpoint=e.viewpoint.clone(),this.notifyChange("viewpoint"))}))}},{key:"viewpoint",get:function(){return this._get("viewpoint")||this._initialViewpoint},set:function(e){this._set("viewpoint",e)}}]),t}(_.GoToMixin(h.EventedAccessor));return o.__decorate([r.property()],d.prototype,"_goingHomeController",void 0),o.__decorate([r.property({dependsOn:["_goingHomeController","view.ready"],readOnly:!0})],d.prototype,"state",null),o.__decorate([r.property()],d.prototype,"view",null),o.__decorate([r.property({type:g})],d.prototype,"viewpoint",null),o.__decorate([r.property()],d.prototype,"go",null),o.__decorate([r.property()],d.prototype,"cancelGo",null),d=o.__decorate([s.subclass("esri.widgets.Home.HomeViewModel")],d),d}));
