/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/Accessor","../../core/Collection","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/arrayUtils","../../core/accessorSupport/decorators/subclass","../../views/layers/support/ClipRect"],(function(e,t,i,r,n,o,s,l,a,p){"use strict";function c(e,t){const i=10**t;return Math.round(e*i)/i}const y={left:0,right:0,top:0,bottom:0};let u=function(t){function i(e){var i;return(i=t.call(this,e)||this)._leadingClips=new Map,i._trailingClips=new Map,i.direction="horizontal",i.leadingLayers=new r,i.max=100,i.min=0,i.precision=4,i.step=.5,i.stepMultiplier=10,i.trailingLayers=new r,i.view=null,i}e._inheritsLoose(i,t);var o=i.prototype;return o.initialize=function(){this.addHandles([n.watch((()=>[this.view,this.view?.ready,this.position,this.direction]),(()=>this._clipLayers()),n.initial),n.on((()=>this.leadingLayers),"change",(()=>this._clipLeadingLayers())),n.on((()=>this.trailingLayers),"change",(()=>this._clipTrailingLayers()))])},o.destroy=function(){this._removeExistingClips()},o._clipLayers=function(){this._clipLeadingLayers(),this._clipTrailingLayers()},o._clipLeadingLayers=function(){this._removeClips("leading");const{leadingLayers:e}=this;e.forEach((e=>this._clipLayer({layer:e,type:"leading"})))},o._clipTrailingLayers=function(){this._removeClips("trailing");const{trailingLayers:e}=this;e.forEach((e=>this._clipLayer({layer:e,type:"trailing"})))},o._getLayerView=function(){var t=e._asyncToGenerator((function*(e){const{view:t}=this;if(!e||!t)return null;const i=yield t.whenLayerView(e);return"clips"in i?i:null}));function i(e){return t.apply(this,arguments)}return i}(),o._getVerticalClipRect=function(e){const{position:t}=this;return"leading"===e?new p({...y,bottom:100-t+"%"}):"trailing"===e?new p({...y,top:`${t}%`}):null},o._getHorizontalClipRect=function(e){const{position:t}=this;return"leading"===e?new p({...y,right:100-t+"%"}):"trailing"===e?new p({...y,left:`${t}%`}):null},o._getClipRect=function(e){const{direction:t}=this;return"vertical"===t?this._getVerticalClipRect(e):"horizontal"===t?this._getHorizontalClipRect(e):null},o._clipLayer=function(){var t=e._asyncToGenerator((function*(e){const{_leadingClips:t,_trailingClips:i}=this,{layer:r,type:n}=e,o="trailing"===n?i:"leading"===n?t:null,s=yield this._getLayerView(r);if(!(s&&"clips"in s&&o&&s.hasOwnProperty("clips")))return;const l=o.get(s);l&&s.clips.remove(l);const a=this._getClipRect(n);a&&(o.set(s,a),s.clips.add(a))}));function i(e){return t.apply(this,arguments)}return i}(),o._removeClips=function(e){const{_leadingClips:t,_trailingClips:i}=this,r="trailing"===e?i:"leading"===e?t:null;r&&(r.forEach(((e,t)=>{t&&t.hasOwnProperty("clips")&&t.clips.remove(e)})),r.clear())},o._removeExistingClips=function(){this._removeClips("leading"),this._removeClips("trailing")},e._createClass(i,[{key:"position",get:function(){return 25},set:function(e){const{precision:t,min:i,max:r}=this;this._set("position",c(Math.max(Math.min(e,r),i),t))}},{key:"state",get:function(){const{view:e}=this;return e&&e.ready?"ready":"disabled"}}]),i}(i);t.__decorate([o.property()],u.prototype,"direction",void 0),t.__decorate([o.property({type:r,nonNullable:!0})],u.prototype,"leadingLayers",void 0),t.__decorate([o.property({readOnly:!0})],u.prototype,"max",void 0),t.__decorate([o.property({readOnly:!0})],u.prototype,"min",void 0),t.__decorate([o.property()],u.prototype,"position",null),t.__decorate([o.property()],u.prototype,"precision",void 0),t.__decorate([o.property({readOnly:!0})],u.prototype,"state",null),t.__decorate([o.property()],u.prototype,"step",void 0),t.__decorate([o.property()],u.prototype,"stepMultiplier",void 0),t.__decorate([o.property({type:r,nonNullable:!0})],u.prototype,"trailingLayers",void 0),t.__decorate([o.property()],u.prototype,"view",void 0),u=t.__decorate([a.subclass("esri.widgets.Swipe.SwipeViewModel")],u);return u}));
