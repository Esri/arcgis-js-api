/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/maybe","../core/memoize","../core/accessorSupport/decorators/aliasOf","../core/arrayUtils","../core/has","../core/accessorSupport/ensureType","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/subclass","../views/3d/environment/weather","./Widget","./support/Heading","./support/widgetUtils","./support/decorators/messageBundle","../core/Logger","./support/jsxFactory","./Weather/CoverageSlider","./Weather/css","./Weather/enums","./Weather/WeatherViewModel"],(function(e,r,t,o,s,n,i,a,l,d,c,u,g,h,v,p,y,C,w,_,b,S){"use strict";const m={sunny:"brightness",cloudy:"partly-cloudy",rainy:"rain",snowy:"snow",foggy:"fog"};let f=function(t){function n(e){var r;return(r=t.call(this,e)||this).viewModel=new S,r.headingLevel=4,r.iconClass=_.CSS.widgetIcon,r.label=void 0,r._renderWeatherTypeButton=e=>{var t,o;const s=r.viewModel,n=null==(t=r.messages)||null==(o=t[e])?void 0:o.label,i=s.state===b.WeatherState.Disabled,a=!i&&s.current.type===e;return C.tsx("calcite-button",{appearance:a?"solid":"outline","aria-checked":a?"true":"false",color:a?"blue":"neutral",disabled:i,"icon-start":m[e],key:`${e}-type-button`,label:n,role:"radio",scale:"l",title:n,onclick:()=>{a||s.setWeatherByType(e)}})},r._getOnSunnyChange=s.memoize((e=>r=>{e.cloudCover=r})),r._getOnCloudyChange=s.memoize((e=>r=>{e.cloudCover=r})),r._getOnRainyChange=s.memoize((e=>r=>{e.cloudCover=r})),r._getOnSnowyChange=s.memoize((e=>r=>{e.cloudCover=r})),r._getOnFoggyChange=s.memoize((e=>r=>{e.fogStrength=r})),r}r._inheritsLoose(n,t);var i=n.prototype;return i.render=function(){var e;const r=this.viewModel.state===b.WeatherState.Disabled;return C.tsx("div",{class:this.classes(_.CSS.base,_.CSS.esriWidget,r&&_.CSS.esriWidgetDisabled),role:"region","aria-label":null==(e=this.messages)?void 0:e.widgetLabelAccessible},this._renderContent())},i.loadDependencies=function(){var t=r._asyncToGenerator((function*(){yield Promise.all([new Promise(((r,t)=>e(["../chunks/calcite-button"],r,t))),new Promise(((r,t)=>e(["../chunks/calcite-icon"],r,t))),new Promise(((r,t)=>e(["../chunks/calcite-label"],r,t)))])}));function o(){return t.apply(this,arguments)}return o}(),i._renderContent=function(){if(this.viewModel.state===b.WeatherState.Error)return C.tsx("div",{key:"error",class:_.CSS.error},this._errorMessage);const e=this.messages,r=this._warningMessage;return C.tsx(C.tsxFragment,null,C.tsx(h.Heading,{level:this.headingLevel},null==e?void 0:e.widgetLabel),C.tsx("div",{class:_.CSS.content},C.tsx("div",{class:_.CSS.selector,role:"radiogroup","aria-label":null==e?void 0:e.weatherType},u.getWeatherTypes().map(this._renderWeatherTypeButton)),this._renderOptions(),o.isSome(r)&&this._renderWarning(r)))},i._renderOptions=function(){const e=this.viewModel,r=e.state===b.WeatherState.Disabled,t=e.current,o=this.messages;switch(t.type){case"sunny":return C.tsx(w.CoverageSlider,{key:"sunny-slider",disabled:r,label:null==o?void 0:o.sunny.cloudCover,value:t.cloudCover,onChange:this._getOnSunnyChange(t)});case"cloudy":return C.tsx(w.CoverageSlider,{key:"cloudy-slider",disabled:r,label:null==o?void 0:o.cloudy.cloudCover,value:t.cloudCover,onChange:this._getOnCloudyChange(t)});case"rainy":return C.tsx(w.CoverageSlider,{key:"rainy-slider",disabled:r,label:null==o?void 0:o.rainy.cloudCover,value:t.cloudCover,onChange:this._getOnRainyChange(t)});case"snowy":return C.tsx(w.CoverageSlider,{key:"snowy-slider",disabled:r,label:null==o?void 0:o.rainy.cloudCover,value:t.cloudCover,onChange:this._getOnSnowyChange(t)});case"foggy":return C.tsx(w.CoverageSlider,{key:"foggy-slider",disabled:r,label:null==o?void 0:o.foggy.fogStrength,value:t.fogStrength,onChange:this._getOnFoggyChange(t)})}},i._renderWarning=function(e){return C.tsx("div",{key:"warning",class:_.CSS.warning},C.tsx("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),e)},r._createClass(n,[{key:"view",get:function(){var e;return null==(e=this.viewModel)?void 0:e.view},set:function(e){this.viewModel&&(this.viewModel.view=e)}},{key:"_errorMessage",get:function(){var e;const r=null==(e=this.messages)?void 0:e.error;switch(this.viewModel.error){case"unsupported-view":return r.unsupported;case"local-scene":return r.localScene;default:return null}}},{key:"_warningMessage",get:function(){if("not-visible"===this.viewModel.error){var e,r;return o.isSome(this.view)&&"3d"===(null==(e=this.view)?void 0:e.type)&&this.view.environment.atmosphereEnabled?null==(r=this.messages)?void 0:r.error.notVisible:null}return null}}]),n}(g);t.__decorate([d.property()],f.prototype,"viewModel",void 0),t.__decorate([d.property()],f.prototype,"view",null),t.__decorate([d.property()],f.prototype,"headingLevel",void 0),t.__decorate([d.property()],f.prototype,"iconClass",void 0),t.__decorate([n.aliasOf("messages.widgetLabel",{overridable:!0})],f.prototype,"label",void 0),t.__decorate([d.property(),p.messageBundle("esri/widgets/Weather/t9n/Weather")],f.prototype,"messages",void 0),t.__decorate([d.property()],f.prototype,"_errorMessage",null),t.__decorate([d.property()],f.prototype,"_warningMessage",null),f=t.__decorate([c.subclass("esri.widgets.Weather")],f);return f}));
