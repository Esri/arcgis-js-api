/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/maybe","../core/memoize","../core/accessorSupport/decorators/property","../core/arrayUtils","../core/accessorSupport/ensureType","../core/accessorSupport/decorators/subclass","../views/3d/environment/weather","./Widget","./support/Heading","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory","./Weather/css","./Weather/enums","./Weather/LabeledSlider","./Weather/VisibleElements","./Weather/WeatherViewModel"],(function(e,t,r,o,n,s,a,i,l,c,d,u,p,h,g,y,v,b,C,w){"use strict";const S={sunny:"brightness",cloudy:"partly-cloudy",rainy:"rain",snowy:"snow",foggy:"fog"};let m=function(r){function s(e){var t;return(t=r.call(this,e)||this).viewModel=new w,t.headingLevel=4,t.visibleElements=new C,t.iconClass=y.CSS.widgetIcon,t._renderWeatherTypeButton=e=>{const r=t.viewModel,o=t.messages[e].label,n=r.state===v.WeatherState.Disabled,s=!n&&r.current.type===e;return g.tsx("calcite-button",{appearance:s?"solid":"outline","aria-checked":s?"true":"false",color:s?"blue":"neutral",disabled:n,"icon-start":S[e],key:`${e}-type-button`,label:o,role:"radio",scale:"l",title:o,onclick:()=>{s||r.setWeatherByType(e)}})},t._memoizedCallbacks=n.memoize((e=>({onCloudCoverChange:t=>{"cloudCover"in e&&(e.cloudCover=t)},onPrecipitationChange:t=>{"precipitation"in e&&(e.precipitation=t)},onFogStrengthChange:t=>{"fogStrength"in e&&(e.fogStrength=t)},onSnowCoverChange:e=>{t.viewModel.setSnowCoverEnabled(e.target.checked)}}))),t}t._inheritsLoose(s,r);var a=s.prototype;return a.render=function(){const e=this.viewModel.state===v.WeatherState.Disabled;return g.tsx("div",{class:this.classes(y.CSS.base,y.CSS.esriWidget,e&&y.CSS.esriWidgetDisabled),role:"region","aria-label":this.messages.widgetLabelAccessible},this._renderContent())},a.loadDependencies=function(){return Promise.all([new Promise(((t,r)=>e(["../chunks/calcite-button"],t,r))),new Promise(((t,r)=>e(["../chunks/calcite-checkbox"],t,r))),new Promise(((t,r)=>e(["../chunks/calcite-icon"],t,r))),new Promise(((t,r)=>e(["../chunks/calcite-label"],t,r)))])},a._renderContent=function(){const e=this.messages,t=this._warningMessage,r=this.viewModel.state===v.WeatherState.Error;return g.tsx(g.tsxFragment,null,this.visibleElements.header&&g.tsx(u.Heading,{level:this.headingLevel},e.widgetLabel),r&&g.tsx("div",{key:"error",class:y.CSS.error},this._errorMessage),g.tsx("div",{key:"content",class:p.classes({[y.CSS.content]:!0,[y.CSS.hasError]:r})},g.tsx("div",{class:y.CSS.selector,role:"radiogroup","aria-label":e.weatherType},c.weatherTypesArray.map(this._renderWeatherTypeButton)),g.tsx("div",{class:y.CSS.options},this._renderOptions()),o.isSome(t)&&this._renderWarning(t)))},a._renderOptions=function(){const{viewModel:e,messages:t}=this,r=e.state===v.WeatherState.Disabled,o=e.current,n=this._memoizedCallbacks(o);switch(o.type){case"sunny":return g.tsx(b.LabeledSlider,{key:"sunny-cover",disabled:r,label:t.sunny.cloudCover,value:o.cloudCover,onChange:n.onCloudCoverChange});case"cloudy":return g.tsx(b.LabeledSlider,{key:"cloudy-cover",disabled:r,label:t.cloudy.cloudCover,value:o.cloudCover,onChange:n.onCloudCoverChange});case"rainy":return g.tsx(g.tsxFragment,null,g.tsx(b.LabeledSlider,{key:"rainy-cover",disabled:r,label:t.rainy.cloudCover,value:o.cloudCover,onChange:n.onCloudCoverChange}),g.tsx(b.LabeledSlider,{key:"rainy-precipitation",disabled:r,label:t.rainy.precipitation,value:o.precipitation,onChange:n.onPrecipitationChange}));case"snowy":return g.tsx(g.tsxFragment,null,g.tsx(b.LabeledSlider,{key:"snowy-cloud-cover",disabled:r,label:t.snowy.cloudCover,value:o.cloudCover,onChange:n.onCloudCoverChange}),g.tsx(b.LabeledSlider,{key:"snowy-precipitation",disabled:r,label:t.snowy.precipitation,value:o.precipitation,onChange:n.onPrecipitationChange}),g.tsx("calcite-label",{key:"snow-cover",scale:"s",disabled:r,layout:"inline",title:t.snowy.snowCoverTooltip},g.tsx("calcite-checkbox",{checked:"enabled"===o.snowCover,onCalciteCheckboxChange:n.onSnowCoverChange}),t.snowy.snowCover));case"foggy":return g.tsx(b.LabeledSlider,{key:"foggy-cover",disabled:r,label:t.foggy.fogStrength,value:o.fogStrength,onChange:n.onFogStrengthChange})}},a._renderWarning=function(e){return g.tsx("div",{key:"warning",class:y.CSS.warning},g.tsx("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),e)},t._createClass(s,[{key:"view",get:function(){return this.viewModel?.view},set:function(e){this.viewModel&&(this.viewModel.view=e)}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(e){this._overrideIfSome("label",e)}},{key:"_errorMessage",get:function(){const e=this.messages.error;switch(this.viewModel.error){case v.WeatherError.LocalScene:return e.localScene;case v.WeatherError.NoAtmosphere:return e.noAtmosphere;case v.WeatherError.UnsupportedView:return e.unsupported;default:return null}}},{key:"_warningMessage",get:function(){if(this.viewModel.error===v.WeatherError.NotVisible){return o.isSome(this.view)&&"3d"===this.view?.type&&this.view.environment.atmosphereEnabled?this.messages.error.notVisible:null}return null}}]),s}(d);r.__decorate([s.property()],m.prototype,"viewModel",void 0),r.__decorate([s.property()],m.prototype,"view",null),r.__decorate([s.property()],m.prototype,"headingLevel",void 0),r.__decorate([s.property({type:C,nonNullable:!0})],m.prototype,"visibleElements",void 0),r.__decorate([s.property()],m.prototype,"iconClass",void 0),r.__decorate([s.property()],m.prototype,"label",null),r.__decorate([s.property(),h.messageBundle("esri/widgets/Weather/t9n/Weather")],m.prototype,"messages",void 0),r.__decorate([s.property()],m.prototype,"_errorMessage",null),r.__decorate([s.property()],m.prototype,"_warningMessage",null),m=r.__decorate([l.subclass("esri.widgets.Weather")],m);return m}));
