/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/maybe","../../core/Logger","../../core/accessorSupport/ensureType","../../core/handleUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/subclass","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../Color","../../core/memoize","./ElevationProfileLine","./support/elevationQuerySourceUtils"],(function(e,r,o,n,t,i,u,l,s,a,c,p,d,y,v,_){"use strict";let g=function(r){function o(e){var o;return(o=r.call(this,e)||this).type="ground",o.color=new d("#ff7f00"),o.numSamplesForPreview=50,o.numSamplesPerChunk=1e3,o._getQueryElevationDependencies=y.memoize(((e,r)=>({ground:e,groundLayers:r}))),o}e._inheritsLoose(o,r);var t=o.prototype;return t.queryElevation=async function(e,r){const o=this.queryElevationDependencies;if(n.isNone(o))throw new Error("ElevationProfileLineGround: no dependencies");const{ground:t}=o;if(n.isNone(t))throw new Error("No ground configured in the view");return t.queryElevation(e,r)},t.attach=function(e){return u.handlesGroup([r.prototype.attach.call(this,e),this.watch("queryElevationDependencies",(()=>this._onChange()))])},e._createClass(o,[{key:"available",get:function(){const e=this._ground;return!n.isNone(e)&&e.layers.some((e=>e.visible))}},{key:"minDemResolution",get:function(){return _.getGroundMinDemResolution(this._ground)}},{key:"queryElevationDependencies",get:function(){return this._getQueryElevationDependencies(this._ground,this._groundLayers)}},{key:"_ground",get:function(){var e;return n.applySome(null==(e=this._viewModel)?void 0:e.view,(e=>{var r;return null==(r=e.map)?void 0:r.ground}))}},{key:"_groundLayers",get:function(){const e=this._ground,r=n.applySome(e,(e=>{var r;return null==(r=e.layers)?void 0:r.toArray()}));return n.unwrapOr(r,[])}}]),o}(v.ElevationProfileLine);return r.__decorate([l.property({type:d,nonNullable:!0})],g.prototype,"color",void 0),r.__decorate([l.property()],g.prototype,"available",null),r.__decorate([l.property({readOnly:!0})],g.prototype,"minDemResolution",null),r.__decorate([l.property()],g.prototype,"queryElevationDependencies",null),r.__decorate([l.property()],g.prototype,"_ground",null),r.__decorate([l.property()],g.prototype,"_groundLayers",null),g=r.__decorate([s.subclass("esri.widgets.ElevationProfile.ElevationProfileLineGround")],g),g}));
