/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{_ as e}from"../../../chunks/tslib.es6.js";import o from"../../../core/Accessor.js";import t from"../../../core/Collection.js";import{applySome as r,removeMaybe as s}from"../../../core/maybe.js";import{watch as i,syncAndInitial as n}from"../../../core/reactiveUtils.js";import{property as c}from"../../../core/accessorSupport/decorators/property.js";import"../../../core/arrayUtils.js";import"../../../core/has.js";import"../../../core/accessorSupport/ensureType.js";import{subclass as a}from"../../../core/accessorSupport/decorators/subclass.js";import{HOVERED_POINTS_STYLE as d}from"./constants.js";import p from"../../support/AnchorElementViewModel.js";let h=class extends o{constructor(e){super(e),this._hoveredPoints=new t}initialize(){this._updateScreenLocationsHandle=i((()=>this._hoveredPoints.toArray().map((({anchor:e,element:o})=>({screenLocation:e.screenLocation,element:o})))),(e=>{for(const{screenLocation:o,element:t}of e)r(o,(({x:e,y:o})=>{t.style.transform=`translate(${e}px, ${o}px)`}))}),n)}destroy(){this._updateScreenLocationsHandle=s(this._updateScreenLocationsHandle),this._hoveredPoints.drain((e=>this._destroyHoveredPoint(e)))}update(e){const o=this.view,t=this._hoveredPoints,r=e.length;for(;this._hoveredPoints.length>r;)this._destroyHoveredPoint(this._hoveredPoints.pop());for(;this._hoveredPoints.length<r;){const e=this._makeHoveredPoint();t.push(e),o.surface.appendChild(e.element)}for(let s=0;s<r;++s){const o=t.getItemAt(r-1-s),i=e[s];this._updateHoveredPoint(o,i)}}_makeHoveredPoint(){const{size:e,borderStyle:o,borderColor:t,borderWidth:r,boxShadow:s}=d,i=this.view,n=new p({view:i,screenLocationEnabled:!0}),c=document.createElement("div"),a=c.style;return a.position="absolute",a.top="0",a.left="0",a.contain="strict",a.boxSizing="border-box",a.width=`${e}px`,a.height=`${e}px`,a.marginTop=`-${e/2}px`,a.marginLeft=`-${e/2}px`,a.border=`${o} ${r}px ${t}`,a.borderRadius=`${e}px`,a.boxShadow=s,{anchor:n,element:c}}_updateHoveredPoint({anchor:e,element:o},t){e.screenLocationEnabled=!0,e.location=t.hoveredPoint;const r=o.style;r.display="block",r.background=t.color.toCss()}_destroyHoveredPoint({anchor:e,element:o}){e.destroy(),this.view.surface.removeChild(o)}};e([c()],h.prototype,"view",void 0),e([c()],h.prototype,"_hoveredPoints",void 0),h=e([a("esri.widgets.ElevationProfile.support.HoveredPoints")],h);export{h as HoveredPoints};
