/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../core/maybe","../../../geometry/Polyline","../../../Color","../../../chunks/vec4f64","../../../core/throttle","./constants","../../../views/3d/interactive/visualElements/OutlineVisualElement"],(function(e,t,s,i,n,o,l,r){"use strict";let a=function(){function e(e){this._params=e,this._visualElements=[],this.updateGeometry=o.throttle((e=>this._updateGeometry(e)),100)}var a=e.prototype;return a.destroy=function(){this.updateGeometry.remove(),this._destroyVisualElements()},a._updateGeometry=function(e){if(t.isNone(e)||1!==e.progress)return void this._destroyVisualElements();const s=e.lines.length;for(;this._visualElements.length>s;)this._visualElements.pop().destroy();for(;this._visualElements.length<s;){const e=new r.OutlineVisualElement({view:this._params.view,elevationInfo:{mode:"absolute-height",offset:0},renderOccluded:4,innerWidth:l.PROFILE_LINES_STYLE_3D.width-l.PROFILE_LINES_STYLE_3D.outlineSize,width:l.PROFILE_LINES_STYLE_3D.width,falloff:l.PROFILE_LINES_STYLE_3D.falloff});this._visualElements.push(e)}for(let t=0;t<s;++t){const s=e.lines[t],o=this._visualElements[t];o.geometry=this._createLineGeometry(s),o.innerColor=n.fromArray(i.toUnitRGBA(s.color))}},a._createLineGeometry=function(e){const i=t.unwrapOr(e.samples,[]),n=i.length-1,o=[];let l=[];for(let e=0;e<=n;e++){const{x:s,y:r,z:a}=i[e];t.isSome(a)&&l.push([s,r,a]),(e===n||t.isNone(a))&&l.length&&(o.push(l),l=[])}return new s({paths:o,hasZ:!0,spatialReference:this._params.view.spatialReference})},a._destroyVisualElements=function(){this._visualElements.forEach((e=>e.destroy())),this._visualElements.length=0},e}();e.ProfileLines3D=a,Object.defineProperty(e,"__esModule",{value:!0})}));
