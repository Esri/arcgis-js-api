/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../core/maybe","../../../core/unitUtils"],(function(e,n,t){"use strict";function i(e,t){return n.isNone(t)?e:n.isSome(e)?Math.min(e,t):t}function o(e,t){return n.isNone(t)?e:n.isSome(e)?Math.max(e,t):t}function a(e,t){return n.isSome(e)&&n.isSome(t)?e*t:null}e.getBoundsInMeters=function(e){let l=null,s=null,r=null;for(const u of e){if(n.isNone(u))continue;const{statistics:e,spatialReference:c}=u;if(n.isNone(e))continue;const m=t.getMetersPerUnitForSR(c);l=o(l,a(e.maxDistance,m));const v=t.getMetersPerVerticalUnitForSR(c);r=i(r,a(e.minElevation,v)),s=o(s,a(e.maxElevation,v))}return{minDistance:0,maxDistance:n.unwrapOr(l,0),minElevation:n.unwrapOr(r,0),maxElevation:n.unwrapOr(s,0)}},e.getStatistics=function(e,a){const l=e.length;if(0===l)return null;const s=e[0].z;let r=s,u=s,c=0,m=0,v=null,S=null,g=n.isSome(s)?s:0,f=0,x=0,p=n.isSome(s)?1:0,E=0,N=0;for(let s=1;s<l;++s){const l=e[s-1],P=e[s],d=P.z,M=P.distance-l.distance;if(0===M||n.isNone(d))continue;p++,g+=d,r=i(r,d),u=o(u,d);const D=l.z;if(n.isNone(D))continue;const h=d-D,U=h*t.getMetersPerVerticalUnitForSR(a),R=M*t.getMetersPerUnitForSR(a),F=t.convertUnit(Math.atan2(U,R),"radians","degrees");F>0?(c+=h,f+=F,v=o(v,F),E++):F<0&&(m-=h,x-=F,S=o(S,-F),N++)}return 0===p?null:{maxDistance:e[l-1].distance,minElevation:r,maxElevation:u,avgElevation:0===p?null:g/p,elevationGain:c,elevationLoss:m,maxPositiveSlope:v,maxNegativeSlope:S,avgPositiveSlope:0===E?null:f/E,avgNegativeSlope:0===N?null:x/N}},e.mergeStatistics=function(e){const t=e.filter(n.isSome),a=t.length;if(0===a)return null;const l=t[0];if(1===a)return l;let s=l.maxDistance,r=l.minElevation,u=l.maxElevation,c=l.maxPositiveSlope,m=l.maxNegativeSlope;for(let e=1;e<t.length;++e){const n=t[e];s=o(s,n.maxDistance),r=i(r,n.minElevation),u=o(u,n.maxElevation),c=o(c,n.maxPositiveSlope),m=o(m,n.maxNegativeSlope)}return{maxDistance:s,minElevation:r,maxElevation:u,avgElevation:null,elevationGain:null,elevationLoss:null,maxPositiveSlope:c,maxNegativeSlope:m,avgPositiveSlope:null,avgNegativeSlope:null}},Object.defineProperty(e,"__esModule",{value:!0})}));
