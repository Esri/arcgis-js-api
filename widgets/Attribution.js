/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/has","../core/Logger","../core/accessorSupport/ensureType","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/aliasOf","../core/accessorSupport/decorators/subclass","../core/urlUtils","../core/uuid","../portal/support/resourceExtension","../core/watchUtils","./support/widgetUtils","./support/decorators/accessibleHandler","./support/decorators/messageBundle","./support/decorators/renderable","../chunks/index","./Widget","./Attribution/AttributionViewModel"],(function(e,t,r,i,o,s,n,a,c,d,l,u,p,_,h,b,v,g,w){"use strict";const f="esri-attribution esri-widget",y="esri-widget__anchor",O="esri-attribution__powered-by",S="esri-attribution__sources",m="esri-attribution--open",x="esri-attribution__sources--open",N="esri-attribution__link",T="esri-icon-description",k="esri-interactive";let H=function(t){function r(e,r){var i;return(i=t.call(this,e,r)||this)._isOpen=!1,i._attributionTextOverflowed=!1,i._prevSourceNodeHeight=0,i.iconClass=T,i.itemDelimiter=" | ",i.label=void 0,i.messages=null,i.view=null,i.viewModel=new w,i}e._inheritsLoose(r,t);var i=r.prototype;return i.initialize=function(){this.own(u.on(this,"viewModel.items","change",(()=>this.scheduleRender())))},i.render=function(){const e={[m]:this._isOpen};return v.jsx("div",{bind:this,class:this.classes(f,e),onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())},i.renderPoweredBy=function(){return v.jsx("div",{class:O},"Powered by"," ",v.jsx("a",{class:this.classes(N,y),href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))},i.renderSourcesNode=function(){const e=this._isOpen,t=this._isInteractive(),r=t?0:-1,{attributionText:i}=this,o=t?"button":void 0,s={[x]:e,[k]:t};return v.jsx("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes(S,s),innerHTML:i,role:o,tabIndex:r})},i._afterSourcesNodeCreate=function(e){this._prevSourceNodeHeight=e.clientWidth},i._afterSourcesNodeUpdate=function(e){let t=!1;const{clientHeight:r,clientWidth:i,scrollWidth:o}=e,s=o>=i,n=this._attributionTextOverflowed!==s;if(this._attributionTextOverflowed=s,n&&(t=!0),this._isOpen){const e=r<this._prevSourceNodeHeight;this._prevSourceNodeHeight=r,e&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()},i._toggleState=function(){this._isInteractive()&&(this._isOpen=!this._isOpen)},i._isInteractive=function(){return this._isOpen||this._attributionTextOverflowed},e._createClass(r,[{key:"attributionText",get:function(){return this.viewModel.items.reduce(((e,t)=>(-1===e.indexOf(t.text)&&e.push(t.text),e)),[]).join(this.itemDelimiter)}}]),r}(g);return t.__decorate([s.property({dependsOn:["viewModel.items.length","itemDelimiter"],readOnly:!0,autoTracked:!1}),b.renderable()],H.prototype,"attributionText",null),t.__decorate([s.property()],H.prototype,"iconClass",void 0),t.__decorate([s.property(),b.renderable()],H.prototype,"itemDelimiter",void 0),t.__decorate([s.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],H.prototype,"label",void 0),t.__decorate([s.property(),b.renderable(),h.messageBundle("esri/widgets/Attribution/t9n/Attribution")],H.prototype,"messages",void 0),t.__decorate([n.aliasOf("viewModel.view")],H.prototype,"view",void 0),t.__decorate([s.property({type:w}),b.renderable(["state","view.size"])],H.prototype,"viewModel",void 0),t.__decorate([_.accessibleHandler()],H.prototype,"_toggleState",null),H=t.__decorate([a.subclass("esri.widgets.Attribution")],H),H}));
