/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/has","../core/Logger","../core/accessorSupport/ensureType","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/aliasOf","../core/accessorSupport/decorators/subclass","../core/urlUtils","../core/uuid","../portal/support/resourceExtension","../assets","../core/Handles","../core/watchUtils","./support/widgetUtils","./support/decorators/accessibleHandler","./support/decorators/messageBundle","../chunks/index","./Widget","./BasemapGallery/BasemapGalleryViewModel"],(function(e,s,a,t,i,r,l,o,d,n,c,p,m,g,u,_,h,y,b,v){"use strict";const w={base:"esri-basemap-gallery esri-widget esri-widget--panel-height-only",sourceLoading:"esri-basemap-gallery--source-loading",loader:"esri-basemap-gallery__loader",item:"esri-basemap-gallery__item",itemContainer:"esri-basemap-gallery__item-container",itemTitle:"esri-basemap-gallery__item-title",itemThumbnail:"esri-basemap-gallery__item-thumbnail",selectedItem:"esri-basemap-gallery__item--selected",itemLoading:"esri-basemap-gallery__item--loading",itemError:"esri-basemap-gallery__item--error",emptyMessage:"esri-widget__content--empty",widgetIcon:"esri-icon-basemap",disabled:"esri-disabled",header:"esri-widget__heading"};let B=function(s){function a(e,a){var t;return(t=s.call(this,e,a)||this)._handles=new m,t.activeBasemap=null,t.disabled=!1,t.iconClass=w.widgetIcon,t.label=void 0,t.messages=null,t.source=null,t.view=null,t.viewModel=new v,t}e._inheritsLoose(a,s);var t=a.prototype;return t.initialize=function(){const e=this._handles;this.own([g.on(this,"viewModel.items","change",(s=>{const a="basemap-gallery-item-changes",{added:t,moved:i}=s;e.remove(a),e.add([...t,...i].map((e=>e.watch("state",(()=>this.scheduleRender())))),a),this.scheduleRender()})),e,g.whenOnce(this,"source",(()=>this.viewModel.load()))])},t.render=function(){const e="loading"===this.get("source.state"),s=this.disabled||"disabled"===this.get("viewModel.state"),a=this.get("viewModel.items").toArray().map(this._renderBasemapGalleryItem,this),t={[w.sourceLoading]:e,[w.disabled]:s},i=e?y.jsx("div",{class:w.loader,key:"esri-basemap-gallery__loader"}):null,r=e?null:a.length>0?y.jsx("ul",{class:w.itemContainer,key:"esri-basemap-gallery__item-container",role:"menu"},a):y.jsx("div",{class:w.emptyMessage,key:"esri-basemap-gallery__empty-message"},y.jsx("h2",{class:w.header},this.messages.noBasemaps));return y.jsx("div",{class:this.classes(w.base,t)},i,r)},t._handleClick=function(e){const s=e.currentTarget["data-item"];"ready"===s.state&&(this.activeBasemap=s.basemap)},t._renderBasemapGalleryItem=function(e){const s=e.get("basemap.thumbnailUrl")||p.getAssetUrl("esri/themes/base/images/basemap-toggle-64.svg"),a=e.get("basemap.title"),t=e.get("basemap.portalItem.snippet"),i=e.get("error.message")||t||a,{viewModel:r}=this,l=!this.disabled&&"ready"===r.state&&"ready"===e.state?0:-1,o=r.basemapEquals(e.basemap,this.activeBasemap),d={[w.selectedItem]:o,[w.itemLoading]:"loading"===e.state,[w.itemError]:"error"===e.state};return y.jsx("li",{"aria-selected":o.toString(),bind:this,class:this.classes(w.item,d),"data-item":e,onkeydown:this._handleClick,onclick:this._handleClick,role:"menuitem",tabIndex:l,title:i},y.jsx("img",{alt:"",class:w.itemThumbnail,src:s}),y.jsx("div",{class:w.itemTitle},a))},a}(b);return s.__decorate([l.aliasOf("viewModel.activeBasemap")],B.prototype,"activeBasemap",void 0),s.__decorate([r.property()],B.prototype,"disabled",void 0),s.__decorate([r.property()],B.prototype,"iconClass",void 0),s.__decorate([r.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],B.prototype,"label",void 0),s.__decorate([r.property(),h.messageBundle("esri/widgets/BasemapGallery/t9n/BasemapGallery")],B.prototype,"messages",void 0),s.__decorate([l.aliasOf("viewModel.source")],B.prototype,"source",void 0),s.__decorate([l.aliasOf("viewModel.view")],B.prototype,"view",void 0),s.__decorate([r.property()],B.prototype,"viewModel",void 0),s.__decorate([_.accessibleHandler()],B.prototype,"_handleClick",null),B=s.__decorate([o.subclass("esri.widgets.BasemapGallery")],B),B}));
