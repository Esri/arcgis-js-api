/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../assets","../core/Handles","../core/watchUtils","../core/accessorSupport/decorators/aliasOf","../core/has","../core/accessorSupport/ensureType","../core/Logger","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/subclass","./Widget","./BasemapGallery/BasemapGalleryViewModel","./support/Heading","./support/decorators/accessibleHandler","./support/decorators/messageBundle","./support/jsxFactory","./support/widgetUtils"],(function(e,s,a,t,i,r,l,o,d,n,c,p,m,g,u,_,h,y){"use strict";const b={base:"esri-basemap-gallery esri-widget esri-widget--panel-height-only",sourceLoading:"esri-basemap-gallery--source-loading",loader:"esri-basemap-gallery__loader",item:"esri-basemap-gallery__item",itemContainer:"esri-basemap-gallery__item-container",itemTitle:"esri-basemap-gallery__item-title",itemThumbnail:"esri-basemap-gallery__item-thumbnail",selectedItem:"esri-basemap-gallery__item--selected",itemLoading:"esri-basemap-gallery__item--loading",itemError:"esri-basemap-gallery__item--error",emptyMessage:"esri-widget__content--empty",widgetIcon:"esri-icon-basemap",disabled:"esri-disabled"};let v=function(s){function r(e,a){var i;return(i=s.call(this,e,a)||this)._handles=new t,i.activeBasemap=null,i.disabled=!1,i.headingLevel=2,i.iconClass=b.widgetIcon,i.label=void 0,i.messages=null,i.source=null,i.view=null,i.viewModel=new m,i}e._inheritsLoose(r,s);var l=r.prototype;return l.initialize=function(){const e=this._handles;this.own([i.on(this,"viewModel.items","change",(s=>{const a="basemap-gallery-item-changes",{added:t,moved:i}=s;e.remove(a),e.add([...t,...i].map((e=>e.watch("state",(()=>this.scheduleRender())))),a),this.scheduleRender()})),e,i.whenOnce(this,"source",(()=>this.viewModel.load()))])},l.render=function(){const e="loading"===this.get("source.state"),s=this.disabled||"disabled"===this.get("viewModel.state"),a=this.get("viewModel.items").toArray().map(this._renderBasemapGalleryItem,this),t={[b.sourceLoading]:e,[b.disabled]:s},i=e?h.tsx("div",{class:b.loader,key:"esri-basemap-gallery__loader"}):null,r=e?null:a.length>0?h.tsx("ul",{class:b.itemContainer,key:"esri-basemap-gallery__item-container",role:"menu"},a):h.tsx("div",{class:b.emptyMessage,key:"esri-basemap-gallery__empty-message"},h.tsx(g.Heading,{level:this.headingLevel},this.messages.noBasemaps));return h.tsx("div",{class:this.classes(b.base,t)},i,r)},l._handleClick=function(e){const s=e.currentTarget["data-item"];"ready"===s.state&&(this.activeBasemap=s.basemap)},l._renderBasemapGalleryItem=function(e){const s=e.get("basemap.thumbnailUrl")||a.getAssetUrl("esri/themes/base/images/basemap-toggle-64.svg"),t=e.get("basemap.title"),i=e.get("basemap.portalItem.snippet"),r=e.get("error.message")||i||t,{viewModel:l}=this,o=!this.disabled&&"ready"===l.state&&"ready"===e.state?0:-1,d=l.basemapEquals(e.basemap,this.activeBasemap),n={[b.selectedItem]:d,[b.itemLoading]:"loading"===e.state,[b.itemError]:"error"===e.state};return h.tsx("li",{"aria-selected":d.toString(),bind:this,class:this.classes(b.item,n),"data-item":e,onkeydown:this._handleClick,onclick:this._handleClick,role:"menuitem",tabIndex:o,title:r},h.tsx("img",{alt:"",class:b.itemThumbnail,src:s}),h.tsx("div",{class:b.itemTitle},t))},r}(p);return s.__decorate([r.aliasOf("viewModel.activeBasemap")],v.prototype,"activeBasemap",void 0),s.__decorate([n.property()],v.prototype,"disabled",void 0),s.__decorate([n.property()],v.prototype,"headingLevel",void 0),s.__decorate([n.property()],v.prototype,"iconClass",void 0),s.__decorate([n.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],v.prototype,"label",void 0),s.__decorate([n.property(),_.messageBundle("esri/widgets/BasemapGallery/t9n/BasemapGallery")],v.prototype,"messages",void 0),s.__decorate([r.aliasOf("viewModel.source")],v.prototype,"source",void 0),s.__decorate([r.aliasOf("viewModel.view")],v.prototype,"view",void 0),s.__decorate([n.property()],v.prototype,"viewModel",void 0),s.__decorate([u.accessibleHandler()],v.prototype,"_handleClick",null),v=s.__decorate([c.subclass("esri.widgets.BasemapGallery")],v),v}));
