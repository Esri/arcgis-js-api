/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/has","../core/Logger","../core/accessorSupport/ensureType","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/aliasOf","../core/accessorSupport/decorators/subclass","../core/urlUtils","../core/uuid","../portal/support/resourceExtension","../assets","../core/Handles","../core/watchUtils","./support/widgetUtils","./support/decorators/accessibleHandler","./support/decorators/messageBundle","./support/decorators/renderable","../chunks/index","./Widget","./BasemapGallery/BasemapGalleryViewModel"],(function(e,s,a,t,r,l,i,o,d,c,n,p,m,u,g,_,h,b,y,v,w){"use strict";const B=p.getAssetUrl("esri/themes/base/images/basemap-toggle-64.svg"),f="esri-basemap-gallery esri-widget esri-widget--panel-height-only",k="esri-basemap-gallery--source-loading",M="esri-basemap-gallery__loader",x="esri-basemap-gallery__item",j="esri-basemap-gallery__item-container",G="esri-basemap-gallery__item-title",C="esri-basemap-gallery__item-thumbnail",O="esri-basemap-gallery__item--selected",U="esri-basemap-gallery__item--loading",H="esri-basemap-gallery__item--error",I="esri-widget__content--empty",S="esri-icon-basemap",L="esri-disabled",A="esri-widget__heading";let E=function(s){function a(e,a){var t;return(t=s.call(this,e,a)||this)._handles=new m,t.activeBasemap=null,t.disabled=!1,t.iconClass=S,t.label=void 0,t.messages=null,t.source=null,t.view=null,t.viewModel=new w,t}e._inheritsLoose(a,s);var t=a.prototype;return t.initialize=function(){const e=this._handles;this.own([u.on(this,"viewModel.items","change",(s=>{const a="basemap-gallery-item-changes",{added:t,moved:r}=s;e.remove(a),e.add([...t,...r].map((e=>e.watch("state",(()=>this.scheduleRender())))),a),this.scheduleRender()})),e,u.whenOnce(this,"source",(()=>this.viewModel.load()))])},t.render=function(){const e="loading"===this.get("source.state"),s=this.disabled||"disabled"===this.get("viewModel.state"),a=this.get("viewModel.items").toArray().map(this._renderBasemapGalleryItem,this),t={[k]:e,[L]:s},r=e?y.jsx("div",{class:M,key:"esri-basemap-gallery__loader"}):null,l=e?null:a.length>0?y.jsx("ul",{class:j,key:"esri-basemap-gallery__item-container",role:"menu"},a):y.jsx("div",{class:I,key:"esri-basemap-gallery__empty-message"},y.jsx("h2",{class:A},this.messages.noBasemaps));return y.jsx("div",{class:this.classes(f,t)},r,l)},t._handleClick=function(e){const s=e.currentTarget["data-item"];"ready"===s.state&&(this.activeBasemap=s.basemap)},t._renderBasemapGalleryItem=function(e){const s=e.get("basemap.thumbnailUrl")||B,a=e.get("basemap.title"),t=e.get("basemap.portalItem.snippet"),r=e.get("error.message")||t||a,{viewModel:l}=this,i=!this.disabled&&"ready"===l.state&&"ready"===e.state?0:-1,o=l.basemapEquals(e.basemap,this.activeBasemap),d={[O]:o,[U]:"loading"===e.state,[H]:"error"===e.state};return y.jsx("li",{"aria-selected":o,bind:this,class:this.classes(x,d),"data-item":e,onkeydown:this._handleClick,onclick:this._handleClick,role:"menuitem",tabIndex:i,title:r},y.jsx("img",{alt:"",class:C,src:s}),y.jsx("div",{class:G},a))},a}(v);return s.__decorate([i.aliasOf("viewModel.activeBasemap"),b.renderable()],E.prototype,"activeBasemap",void 0),s.__decorate([l.property(),b.renderable()],E.prototype,"disabled",void 0),s.__decorate([l.property()],E.prototype,"iconClass",void 0),s.__decorate([l.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],E.prototype,"label",void 0),s.__decorate([l.property(),b.renderable(),h.messageBundle("esri/widgets/BasemapGallery/t9n/BasemapGallery")],E.prototype,"messages",void 0),s.__decorate([i.aliasOf("viewModel.source"),b.renderable("source.state")],E.prototype,"source",void 0),s.__decorate([i.aliasOf("viewModel.view"),b.renderable()],E.prototype,"view",void 0),s.__decorate([l.property(),b.renderable(["viewModel.state"])],E.prototype,"viewModel",void 0),s.__decorate([_.accessibleHandler()],E.prototype,"_handleClick",null),E=s.__decorate([o.subclass("esri.widgets.BasemapGallery")],E),E}));
