/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/maybe","../../core/Logger","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/aliasOf","../../core/accessorSupport/decorators/cast","../../core/accessorSupport/decorators/subclass","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../Color","../../renderers/support/ClassBreakInfo","../support/widgetUtils","../support/decorators/messageBundle","../support/decorators/renderable","../../chunks/index","./support/utils","./SmartMappingSliderBase","./ClassedSizeSlider/ClassedSizeSliderViewModel"],(function(e,r,s,t,i,a,o,l,n,d,c,p,u,m,h,b,g,f,w,k,y){"use strict";var v;const _="esri-classed-size-slider",S="esri-classed-size-slider__ramp",z="esri-classed-size-slider__slider-container",C="esri-classed-size-slider__histogram-container",M="esri-widget",x="esri-widget--panel",F="esri-disabled",B={trackFillColor:new u([149,149,149]),trackBackgroundColor:new u([224,224,224])};let L=v=function(r){function s(e,s){var t;return(t=r.call(this,e,s)||this)._rampNode=null,t.breaks=null,t.label=void 0,t.messages=null,t.style={...B},t.viewModel=new y,t}e._inheritsLoose(s,r);var i=s.prototype;return i.castStyle=function(e){return{...B,...e}},s.fromRendererResult=function(e,r){const{renderer:{classBreakInfos:s}}=e,t=s.map((e=>{const r=e.symbol;let s;switch(r.type){case"simple-line":s=r.width;break;case"simple-marker":s=r.size;break;case"picture-marker":s=r.height}return{min:e.minValue,max:e.maxValue,size:s}}));return new v({breaks:t,histogramConfig:{bins:r?r.bins:[]}})},i.updateClassBreakInfos=function(e){const r=this.breaks;if(r.length===e.length)return e.map(((e,s)=>{const t=e.symbol;switch(t.type){case"simple-line":t.width=r[s].size;break;case"simple-marker":t.size=r[s].size;break;case"picture-marker":{const e=r[s].size,i=t.width,a=t.height;t.height=e,t.width=e/a*i;break}}return new m({minValue:r[s].min,maxValue:r[s].max,symbol:t})}));console.error(`Number of input breakInfos must match number of slider breaks: ${r.length}`)},i.updateFromRendererResult=function(e,r){const{renderer:{classBreakInfos:s}}=e,t=s.map((e=>{const r=e.symbol;let s;switch(r.type){case"simple-line":s=r.width;break;case"simple-marker":s=r.size;break;case"picture-marker":s=r.height}return{min:e.minValue,max:e.maxValue,size:s}}));this.set({breaks:t}),null!=r&&r.bins&&(this.histogramConfig.bins=r.bins)},i.render=function(){const{state:e,label:r}=this,s="disabled"===e,t=this.classes(_,M,x,{[F]:s});return f.jsx("div",{"aria-label":r,class:t},s?null:this.renderContent(this.renderRamp(),z,C))},i.renderRamp=function(){const{style:{trackBackgroundColor:e}}=this;return f.jsx("div",{afterCreate:h.storeNode,bind:this,class:S,"data-node-ref":"_rampNode"},f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg"},f.jsx("rect",{x:"0",y:"0",fill:w.getFillFromColor(e),height:"100%",width:"100%"}),this.renderPath()))},i.renderPath=function(){if(!this._rampNode)return;const{offsetHeight:e=0,offsetWidth:r=0}=this._rampNode;if(!t.isSome(e)||!t.isSome(r))return;const{breaks:s,viewModel:{max:i,min:a},style:{trackFillColor:o}}=this,l=i-a,n=r/s.length,d=s.map((r=>e-Math.round((r.min-a)/l*e)+1)).reverse(),c=s[0].size>s[s.length-1].size||!1;let p=c?n:r,u=`M${p} 0 `;return d.forEach(((e,s)=>{const t=n*(s+1);u+=`L${p} ${e} `,p=c?n+t:r-t,u+=`L${p} ${e} `})),u+=`L0 ${e} L0 ${e} L0 0 Z`,f.jsx("path",{d:u,fill:w.getFillFromColor(o)})},s}(k.SmartMappingSliderBase);return r.__decorate([o.aliasOf("viewModel.breaks")],L.prototype,"breaks",void 0),r.__decorate([a.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],L.prototype,"label",void 0),r.__decorate([a.property(),g.renderable(),b.messageBundle("esri/widgets/smartMapping/ClassedSizeSlider/t9n/ClassedSizeSlider")],L.prototype,"messages",void 0),r.__decorate([a.property(),g.renderable()],L.prototype,"style",void 0),r.__decorate([l.cast("style")],L.prototype,"castStyle",null),r.__decorate([a.property(),g.renderable(["viewModel.hasTimeData","viewModel.inputFormatFunction","viewModel.inputParseFunction","viewModel.labelFormatFunction","viewModel.max","viewModel.min","viewModel.values"])],L.prototype,"viewModel",void 0),L=v=r.__decorate([n.subclass("esri.widgets.smartMapping.ClassedSizeSlider")],L),L}));
