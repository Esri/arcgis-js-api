/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../Color","../../core/maybe","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/cast","../../core/arrayUtils","../../core/accessorSupport/decorators/subclass","../../renderers/visualVariables/SizeVariable","../../renderers/visualVariables/support/SizeStop","./SmartMappingSliderBase","./SizeSlider/SizeSliderViewModel","./support/utils","../support/widgetUtils","../support/decorators/messageBundle","../support/jsxFactory"],(function(e,t,i,a,r,s,o,n,l,d,p,u,c,m,h,g){"use strict";var y;const v="esri-size-slider",b={base:v,rampElement:`${v}__ramp`,sliderContainer:`${v}__slider-container`,histogramContainer:`${v}__histogram-container`,zoomCapTop:`${v}__zoom-cap-top`,zoomCapBottom:`${v}__zoom-cap-bottom`,zoomCapLine:`${v}__zoom-cap-line`,zoomCapMask:`${v}__zoom-cap-mask`,zoomCapUnderline:`${v}__zoom-cap-underline`,primaryHandle:`${v}--primary-handle`,track:`${v}--interactive-track`,esriWidget:"esri-widget",esriWidgetPanel:"esri-widget--panel",widgetIcon:"esri-icon-edit",disabled:"esri-disabled"},z={trackFillColor:new i([149,149,149]),trackBackgroundColor:new i([224,224,224])};let _=y=function(t){function i(e,i){var a;return(a=t.call(this,e,i)||this)._maxRampFillWidth=1,a._minRampFillWidth=.2,a._rampNode=null,a.messages=null,a.style={...z},a.viewModel=new u,a}e._inheritsLoose(i,t);var r=i.prototype;return r.castStyle=function(e){return{...z,...e}},i.fromRendererResult=function(e,t){const{visualVariables:i,statistics:a}=e,{avg:r,stddev:s}=a,o=i[0],[n,l]=c.getSizesFromVariable(o),d=e.renderer.authoringInfo.visualVariables[0],p=d.minSliderValue,u=d.maxSliderValue;return new y({max:u,min:p,stops:[{value:o.minDataValue,size:l},{value:o.maxDataValue,size:n}],histogramConfig:{average:r,standardDeviation:s,bins:t?t.bins:[]}})},r.updateFromRendererResult=function(e,t){const{visualVariables:i,statistics:a}=e,{avg:r,stddev:s}=a,o=i[0],[n,l]=c.getSizesFromVariable(o),d=e.renderer.authoringInfo.visualVariables[0],p=d.minSliderValue,u=d.maxSliderValue;this.set({max:u,min:p,stops:[{value:o.minDataValue,size:l},{value:o.maxDataValue,size:n}],histogramConfig:{average:r,standardDeviation:s,bins:t?t.bins:[]}})},r.updateVisualVariable=function(e){const t=e.clone(),{stops:i}=this;if(!e||!i)return null;if(t.stops)return t.stops=i,t;const a=i[0],r=i[i.length-1];let s=t.maxSize,o=t.minSize;if(s instanceof l){const e=s.stops,t=r.size/e[0].size,i=e.map((e=>(e.size*=t,e)));s.stops=i}else s=r.size;if(o instanceof l){const e=o.stops,t=a.size/e[0].size,i=e.map((e=>(e.size*=t,e)));o.stops=i}else o=a.size;return t.set({maxDataValue:r.value,minDataValue:a.value,maxSize:s,minSize:o}),t},r.updateFromVisualVariable=function(e){if(!e)return;const{maxDataValue:t,minDataValue:i,stops:a}=e;if(a)this.stops=a;else{const[a,r]=c.getSizesFromVariable(e);this.stops=[new d({value:i,size:r}),new d({value:t,size:a})]}},r.render=function(){const{label:e,primaryHandleEnabled:t,state:i,visibleElements:a}=this,r="disabled"===i,s=this.classes(b.base,b.esriWidget,b.esriWidgetPanel,{[b.disabled]:r,[b.primaryHandle]:t,[b.track]:a.interactiveTrack});return g.tsx("div",{"aria-label":e,class:s},r?null:this.renderContent(this.renderRamp(),b.sliderContainer,b.histogramContainer))},r.renderRamp=function(){const{style:{trackBackgroundColor:e},zoomOptions:t}=this;return g.tsx("div",{afterCreate:m.storeNode,bind:this,class:b.rampElement,"data-node-ref":"_rampNode"},g.tsx("svg",{key:"ramp-svg",xmlns:"http://www.w3.org/2000/svg"},g.tsx("rect",{x:"0",y:"0",fill:c.getFillFromColor(e),height:"100%",width:"100%"}),this.renderPath()),t?this.renderZoomCaps():null)},r.renderPath=function(){if(!this._rampNode)return;const{offsetHeight:e=0,offsetWidth:t=0}=this._rampNode;if(a.isNone(e)||a.isNone(t))return;const{primaryHandleEnabled:i,stops:r,style:{trackFillColor:s},values:o,viewModel:{max:n,min:l},_maxRampFillWidth:d,_minRampFillWidth:p}=this,u=[d,p];r[0].size<r[r.length-1].size&&u.reverse();const m=o.slice().sort(((e,t)=>e>t?1:-1)),[h,y]=u,[v,b]=m,z=i?c.getDynamicPathForSizeStops({max:n,min:l,pathHeight:e,pathWidth:t,stops:r,padding:y}):c.getPathForSizeStops({bottomValue:v,bottomWidth:h,max:n,min:l,pathHeight:e,pathWidth:t,topValue:b,topWidth:y});return g.tsx("path",{d:z,fill:c.getFillFromColor(s)})},e._createClass(i,[{key:"handlesSyncedToPrimary",get:function(){return this.viewModel.handlesSyncedToPrimary},set:function(e){this.viewModel.handlesSyncedToPrimary=e}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(e){this._overrideIfSome("label",e)}},{key:"persistSizeRangeEnabled",get:function(){return this.viewModel.persistSizeRangeEnabled},set:function(e){this.viewModel.persistSizeRangeEnabled=e}},{key:"primaryHandleEnabled",get:function(){return this.viewModel.primaryHandleEnabled},set:function(e){this.viewModel.primaryHandleEnabled=e}},{key:"stops",get:function(){return this.viewModel.stops},set:function(e){this.viewModel.stops=e}}]),i}(p.SmartMappingSliderBase);t.__decorate([r.property()],_.prototype,"handlesSyncedToPrimary",null),t.__decorate([r.property()],_.prototype,"label",null),t.__decorate([r.property(),h.messageBundle("esri/widgets/smartMapping/SizeSlider/t9n/SizeSlider")],_.prototype,"messages",void 0),t.__decorate([r.property()],_.prototype,"persistSizeRangeEnabled",null),t.__decorate([r.property()],_.prototype,"primaryHandleEnabled",null),t.__decorate([r.property()],_.prototype,"stops",null),t.__decorate([r.property()],_.prototype,"style",void 0),t.__decorate([s.cast("style")],_.prototype,"castStyle",null),t.__decorate([r.property()],_.prototype,"viewModel",void 0),_=y=t.__decorate([n.subclass("esri.widgets.smartMapping.SizeSlider")],_);return _}));
