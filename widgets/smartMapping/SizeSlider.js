/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/maybe","../../core/Logger","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/aliasOf","../../core/accessorSupport/decorators/cast","../../core/accessorSupport/decorators/subclass","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../Color","../../renderers/visualVariables/support/SizeStop","../../renderers/visualVariables/SizeVariable","../support/widgetUtils","../support/decorators/messageBundle","../support/decorators/renderable","../../chunks/index","./support/utils","./SmartMappingSliderBase","./SizeSlider/SizeSliderViewModel"],(function(e,t,i,s,a,r,o,l,n,d,p,u,c,m,v,h,g,S,b,f,z,y){"use strict";var _;const w="esri-size-slider",V="esri-size-slider__ramp",x="esri-size-slider__slider-container",F="esri-size-slider__histogram-container",M="esri-widget",C="esri-widget--panel",D="esri-disabled",O={trackFillColor:new c([149,149,149]),trackBackgroundColor:new c([224,224,224])};let k=_=function(t){function i(e,i){var s;return(s=t.call(this,e,i)||this)._maxRampFillWidth=1,s._minRampFillWidth=.2,s._rampNode=null,s.handlesSyncedToPrimary=null,s.label=void 0,s.messages=null,s.primaryHandleEnabled=null,s.stops=null,s.style={...O},s.viewModel=new y,s.zoomOptions=null,s}e._inheritsLoose(i,t);var a=i.prototype;return a.castStyle=function(e){return{...O,...e}},i.fromRendererResult=function(e,t){const{visualVariables:i,statistics:s}=e,{avg:a,stddev:r}=s,o=i[0],[l,n]=f.getSizesFromVariable(o),d=e.renderer.authoringInfo.visualVariables[0],p=d.minSliderValue,u=d.maxSliderValue;return new _({max:u,min:p,stops:[{value:o.minDataValue,size:n},{value:o.maxDataValue,size:l}],histogramConfig:{average:a,standardDeviation:r,bins:t?t.bins:[]}})},a.updateFromRendererResult=function(e,t){const{visualVariables:i,statistics:s}=e,{avg:a,stddev:r}=s,o=i[0],[l,n]=f.getSizesFromVariable(o),d=e.renderer.authoringInfo.visualVariables[0],p=d.minSliderValue,u=d.maxSliderValue;this.set({max:u,min:p,stops:[{value:o.minDataValue,size:n},{value:o.maxDataValue,size:l}],histogramConfig:{average:a,standardDeviation:r,bins:t?t.bins:[]}})},a.updateVisualVariable=function(e){const t=e.clone(),{stops:i}=this;if(!e||!i)return null;if(t.stops)return t.stops=i,t;const s=i[0],a=i[i.length-1];let r=t.maxSize,o=t.minSize;if(r instanceof v){const e=r.stops,t=a.size/e[0].size,i=e.map((e=>(e.size*=t,e)));r.stops=i}else r=a.size;if(o instanceof v){const e=o.stops,t=s.size/e[0].size,i=e.map((e=>(e.size*=t,e)));o.stops=i}else o=s.size;return t.set({maxDataValue:a.value,minDataValue:s.value,maxSize:r,minSize:o}),t},a.updateFromVisualVariable=function(e){if(!e)return;const{maxDataValue:t,minDataValue:i,stops:s}=e;if(s)this.stops=s;else{const[s,a]=f.getSizesFromVariable(e);this.stops=[new m({value:i,size:a}),new m({value:t,size:s})]}},a.render=function(){const{state:e,label:t}=this,i="disabled"===e,s=this.classes(w,M,C,{[D]:i});return b.jsx("div",{"aria-label":t,class:s},i?null:this.renderContent(this.renderRamp(),x,F))},a.renderRamp=function(){const{style:{trackBackgroundColor:e},zoomOptions:t}=this;return b.jsx("div",{afterCreate:h.storeNode,bind:this,class:V,"data-node-ref":"_rampNode"},b.jsx("svg",{key:"ramp-svg",xmlns:"http://www.w3.org/2000/svg"},b.jsx("rect",{x:"0",y:"0",fill:f.getFillFromColor(e),height:"100%",width:"100%"}),this.renderPath()),t?this.renderZoomCaps():null)},a.renderPath=function(){if(!this._rampNode)return;const{offsetHeight:e=0,offsetWidth:t=0}=this._rampNode;if(!s.isSome(e)||!s.isSome(t))return;const{primaryHandleEnabled:i,stops:a,style:{trackFillColor:r},values:o,viewModel:{max:l,min:n},_maxRampFillWidth:d,_minRampFillWidth:p}=this,u=[d,p];a[0].size<a[a.length-1].size&&u.reverse();const[c,m]=u,[v,h]=o,g=i?f.getDynamicPathForSizeStops({max:l,min:n,pathHeight:e,pathWidth:t,stops:a,padding:m}):f.getPathForSizeStops({bottomValue:v,bottomWidth:c,max:l,min:n,pathHeight:e,pathWidth:t,topValue:h,topWidth:m});return b.jsx("path",{d:g,fill:f.getFillFromColor(r)})},i}(z.SmartMappingSliderBase);return t.__decorate([o.aliasOf("viewModel.handlesSyncedToPrimary")],k.prototype,"handlesSyncedToPrimary",void 0),t.__decorate([r.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],k.prototype,"label",void 0),t.__decorate([r.property(),S.renderable(),g.messageBundle("esri/widgets/smartMapping/SizeSlider/t9n/SizeSlider")],k.prototype,"messages",void 0),t.__decorate([o.aliasOf("viewModel.primaryHandleEnabled")],k.prototype,"primaryHandleEnabled",void 0),t.__decorate([o.aliasOf("viewModel.stops")],k.prototype,"stops",void 0),t.__decorate([r.property(),S.renderable()],k.prototype,"style",void 0),t.__decorate([l.cast("style")],k.prototype,"castStyle",null),t.__decorate([r.property(),S.renderable(["viewModel.hasTimeData","viewModel.inputFormatFunction","viewModel.inputParseFunction","viewModel.labelFormatFunction","viewModel.max","viewModel.min","viewModel.stops","viewModel.values","viewModel.zoomOptions"])],k.prototype,"viewModel",void 0),t.__decorate([o.aliasOf("viewModel.zoomOptions")],k.prototype,"zoomOptions",void 0),k=_=t.__decorate([n.subclass("esri.widgets.smartMapping.SizeSlider")],k),k}));
