/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{isSome as t,isNone as r}from"../../../core/maybe.js";import{generateUUID as n}from"../../../core/uuid.js";import i from"../../../layers/support/BuildingFilterBlock.js";import e from"../../../layers/support/BuildingFilterModeSolid.js";import o from"../../../layers/support/BuildingFilterModeXRay.js";const f="__BUILDING_EXPLORER_FILTER__";function s(){return`${n()}${f}`}function l(t){const r="string"==typeof t?t:t.id;return!!r&&r.includes(f)}function u(r,n){for(const i of r.items)for(const r of i.filters.items){if(!l(r))continue;const i=n(r);if(t(i))return i}return null}function c(r,n){r.forEach((r=>{const i=r.filters.filter((t=>!l(t)));t(n)&&i.push(n),p(r.filters,i)||(r.filters=i);const e=r.filters.find((t=>l(t)));r.activeFilterId=t(e)?e.id:null}))}function p(t,n){const i=n.length;if(r(t)||t.length!==i)return!1;for(let r=0;r<i;++r){const i=n.getItemAt(r).toJSON(),e=t.getItemAt(r).toJSON();if(i.id="",e.id="",JSON.stringify(i)!==JSON.stringify(e))return!1}return!0}function d(t){const r=g(t);return r?new i({filterExpression:r,filterMode:new o}):null}function m(t){const r=g(t);return r?new i({filterExpression:r,filterMode:new e}):null}function g(t){return t.filter((t=>!!t)).map((t=>`(${t})`)).join(" AND ")}export{s as generateFilterId,m as getFilterBlockSolid,d as getFilterBlockXRay,u as getValueFromFilters,l as isBuildingExplorerFilter,c as setFilterOnLayers};
