/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../core/has","../../../core/Logger","../../../core/accessorSupport/ensureType","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/decorators/subclass","../../../core/urlUtils","../../../core/uuid","../../../portal/support/resourceExtension","../../../core/watchUtils","../../support/widgetUtils","../../support/decorators/renderable","../../../chunks/index","../../Widget","../support/LayerTreeNode"],(function(e,i,s,o,t,l,r,n,a,d,c,h,g,p,u,b){"use strict";var _;const y={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},k="esri-building-disciplines-tree-node",x={base:`${k}`,root:`${k}--root`,leaf:`${k}--leaf`,label:`${k}__label`,checkbox:`${k}__checkbox`,checkboxChecked:`${k}__checkbox--checked esri-icon-check-mark`,checkboxIndeterminate:`${k}__checkbox--indeterminate esri-icon-minus`,collapseToggle:`${k}__collapse-toggle esri-icon-right`,collapseToggleCollapsed:`${k}__collapse-toggle--collapsed`,children:`${k}__children`,level:e=>`${k}--level-${e}`};let C=_=function(i){function s(e){var s;return(s=i.call(this,e)||this).messages=y,s.toggleSiblingsVisibility=!1,s._childWidgets=[],s._updateChildWidgets=()=>{s._destroyChildWidgets(),s._childWidgets=s.node.children.toArray().reverse().map((e=>new _({node:e,messages:s.messages,toggleSiblingsVisibility:s.toggleSiblingsVisibility})))},s}e._inheritsLoose(s,i);var o=s.prototype;return o.initialize=function(){this.own(c.on(this,"node.children","after-changes",this._updateChildWidgets,this._updateChildWidgets,this._updateChildWidgets),this.watch(["messages","toggleSiblingsVisibility"],this._updateChildWidgets))},o.destroy=function(){this._destroyChildWidgets()},o.render=function(){const e=this.node,i=e.isRoot,s=e.isLeaf;return e.isDiscipline&&s?[]:p.jsx("div",{key:e.id,class:this.classes(x.base,x.level(e.level),{[x.root]:i,[x.leaf]:s}),bind:this,onkeydown:this._onKeydown,tabIndex:s?null:0,role:"treeitem","aria-expanded":e.collapsed?"false":"true"},p.jsx("label",{bind:this,class:x.label,onclick:this._onCheckboxToggle},this._renderCollapseToggle(),this._renderCheckbox(),p.jsx("span",null,e.title)),this._renderChildren(e))},o._renderCheckbox=function(){var e,i;const s=this.node.visible,o=!0===s,t=null===s,l=o?null==(e=this.messages)?void 0:e.hideSublayer:null==(i=this.messages)?void 0:i.showSublayer;return p.jsx("button",{bind:this,class:this.classes(x.checkbox,{[x.checkboxChecked]:o,[x.checkboxIndeterminate]:t}),onclick:this._onCheckboxToggle,role:"checkbox","aria-checked":o?"true":"false","aria-label":l,title:l,type:"button"})},o._renderCollapseToggle=function(){var e,i;if(!this.node.hasChildren)return[];const s=this.node.collapsed,o=s?null==(e=this.messages)?void 0:e.expand:null==(i=this.messages)?void 0:i.collapse;return p.jsx("div",{bind:this,class:this.classes(x.collapseToggle,{[x.collapseToggleCollapsed]:s}),onclick:this._onCollapseToggle,"aria-label":o,title:o})},o._renderChildren=function(e){return!e.hasChildren||e.collapsed?[]:p.jsx("div",{class:x.children},this._childWidgets.map((e=>e.render())))},o._onKeydown=function(e){switch(e.key){case"Space":case"Enter":if(!e.target.classList.contains(x.base))return;e.stopPropagation(),this.node.toggleVisibility();break;case"ArrowLeft":e.stopPropagation(),this.node.toggleCollapsed(!h.isRTL());break;case"ArrowRight":e.stopPropagation(),this.node.toggleCollapsed(!!h.isRTL())}},o._onCheckboxToggle=function(e){e.preventDefault(),e.stopPropagation();(e.metaKey||e.ctrlKey)&&this.toggleSiblingsVisibility?this.node.toggleAllSiblingsVisibility():this.node.toggleVisibility()},o._onCollapseToggle=function(e){e.preventDefault(),e.stopPropagation(),this.node.toggleCollapsed()},o._destroyChildWidgets=function(){this._childWidgets.forEach((e=>e.destroy())),this._childWidgets=[]},s}(u);return i.__decorate([l.property({type:b.LayerTreeNode}),g.renderable(["node.hasChildren","node.isDiscipline","node.level","node.title","node.visible"])],C.prototype,"node",void 0),i.__decorate([l.property(),g.renderable()],C.prototype,"messages",void 0),i.__decorate([l.property({nonNullable:!0})],C.prototype,"toggleSiblingsVisibility",void 0),i.__decorate([l.property(),g.renderable()],C.prototype,"_childWidgets",void 0),C=_=i.__decorate([r.subclass("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesNode")],C),C}));
