/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{_ as e}from"../../../chunks/tslib.es6.js";import{on as s,watch as i,initial as t}from"../../../core/reactiveUtils.js";import{property as o}from"../../../core/accessorSupport/decorators/property.js";import"../../../core/arrayUtils.js";import"../../../core/has.js";import"../../../core/accessorSupport/ensureType.js";import{subclass as l}from"../../../core/accessorSupport/decorators/subclass.js";import r from"../../Widget.js";import{LayerTreeNode as a}from"../support/LayerTreeNode.js";import{isRTL as n}from"../../support/widgetUtils.js";import{tsx as d}from"../../support/jsxFactory.js";var c;const h={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},g="esri-building-disciplines-tree-node",p={base:`${g}`,root:`${g}--root`,leaf:`${g}--leaf`,label:`${g}__label`,checkbox:`${g}__checkbox`,checkboxChecked:`${g}__checkbox--checked esri-icon-check-mark`,checkboxIndeterminate:`${g}__checkbox--indeterminate esri-icon-minus`,collapseToggle:`${g}__collapse-toggle esri-icon-right`,collapseToggleCollapsed:`${g}__collapse-toggle--collapsed`,children:`${g}__children`,level:e=>`${g}--level-${e}`};let b=c=class extends r{constructor(e){super(e),this.messages=h,this.toggleSiblingsVisibility=!1,this._childWidgets=[],this._updateChildWidgets=()=>{this._destroyChildWidgets(),this._childWidgets=this.node.children.toArray().reverse().map((e=>new c({node:e,messages:this.messages,toggleSiblingsVisibility:this.toggleSiblingsVisibility})))}}initialize(){this.own([s((()=>this.node.children),"after-changes",this._updateChildWidgets,{onListenerAdd:this._updateChildWidgets,onListenerRemove:this._updateChildWidgets}),i((()=>[this.messages,this.toggleSiblingsVisibility]),this._updateChildWidgets,t)])}destroy(){this._destroyChildWidgets()}render(){const e=this.node,s=e.isRoot,i=e.isLeaf;return e.isDiscipline&&i?null:d("div",{key:e.id,class:this.classes(p.base,p.level(e.level),{[p.root]:s,[p.leaf]:i}),bind:this,onkeydown:this._onKeydown,tabIndex:i?null:0,role:"treeitem","aria-expanded":e.collapsed?"false":"true"},d("label",{bind:this,class:p.label,onclick:this._onCheckboxToggle},this._renderCollapseToggle(),this._renderCheckbox(),d("span",null,e.title)),this._renderChildren(e))}_renderCheckbox(){const e=this.node.visible,s=!0===e,i=null===e,t=s?this.messages?.hideSublayer:this.messages?.showSublayer;return d("button",{bind:this,class:this.classes(p.checkbox,{[p.checkboxChecked]:s,[p.checkboxIndeterminate]:i}),onclick:this._onCheckboxToggle,role:"checkbox","aria-checked":s?"true":"false","aria-label":t,title:t,type:"button"})}_renderCollapseToggle(){if(!this.node.hasChildren)return null;const e=this.node.collapsed,s=e?this.messages?.expand:this.messages?.collapse;return d("div",{bind:this,class:this.classes(p.collapseToggle,{[p.collapseToggleCollapsed]:e}),onclick:this._onCollapseToggle,"aria-label":s,title:s})}_renderChildren(e){return!e.hasChildren||e.collapsed?null:d("div",{class:p.children},this._childWidgets.map((e=>e.render())))}_onKeydown(e){switch(e.key){case"Space":case"Enter":if(!e.target.classList.contains(p.base))return;e.stopPropagation(),this.node.toggleVisibility();break;case"ArrowLeft":e.stopPropagation(),this.node.toggleCollapsed(!n(this.container));break;case"ArrowRight":e.stopPropagation(),this.node.toggleCollapsed(!!n(this.container))}}_onCheckboxToggle(e){e.preventDefault(),e.stopPropagation();(e.metaKey||e.ctrlKey)&&this.toggleSiblingsVisibility?this.node.toggleAllSiblingsVisibility():this.node.toggleVisibility()}_onCollapseToggle(e){e.preventDefault(),e.stopPropagation(),this.node.toggleCollapsed()}_destroyChildWidgets(){this._childWidgets.forEach((e=>e.destroy())),this._childWidgets=[]}};e([o({type:a})],b.prototype,"node",void 0),e([o()],b.prototype,"messages",void 0),e([o({nonNullable:!0})],b.prototype,"toggleSiblingsVisibility",void 0),e([o()],b.prototype,"_childWidgets",void 0),b=c=e([l("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesNode")],b);const u=b;export{u as default};
