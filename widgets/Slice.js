/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/maybe","../core/promiseUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/accessorSupport/decorators/subclass","./Widget","./Slice/SliceViewModel","./support/Heading","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory"],(function(e,t,i,s,l,r,o,n,c,a,u,d,p,y,_){"use strict";const h="esri-slice",v={buttonDisabled:"esri-button--disabled",layerIncludeButton:`${h}__cross`,widgetIcon:"esri-icon-slice",base:`${h} esri-widget esri-widget--panel`,layerList:`${h}__settings`,layerListHeading:`${h}__settings-title`,layerItem:`${h}__layer-item`,layerItemTitle:`${h}__layer-item__title`,container:`${h}__container`,actionSection:`${h}__actions`,hint:`${h}__hint`,hintText:`${h}__hint-text`,panelError:`${h}__panel--error`,newSliceButton:`${h}__clear-button esri-button esri-button--primary`,excludeButton:`${h}__exclude-button esri-button esri-button--secondary`,cancelButton:`${h}__cancel-button esri-button esri-button--secondary`};let x=function(i){function r(e,t){var s;return(s=i.call(this,e,t)||this).headingLevel=3,s.iconClass=v.widgetIcon,s.messages=null,s.viewModel=new u,s}t._inheritsLoose(r,i);var o=r.prototype;return o.loadDependencies=function(){return new Promise(((t,i)=>e(["../chunks/calcite-button"],t,i)))},o.render=function(){const e=this.viewModel.supported,t=this.viewModel.active,i="disabled"===this.viewModel.state,l="ready"===this.viewModel.state,r="slicing"===this.viewModel.state||"sliced"===this.viewModel.state,o="exclude"===this.viewModel.layersMode,{messages:n}=this,c=i&&v.buttonDisabled,a=!!s.isSome(this.viewModel.view)&&this.viewModel.view.allLayerViews.some((e=>"voxel-3d"===e.type)),u=t&&!r||o?null:_.tsx("button",{disabled:i,class:this.classes(v.newSliceButton,c),bind:this,onclick:this._onNewSliceClick,key:"esri-slice__clear",type:"button"},n.newSlice),p=r&&!o?_.tsx("button",{class:this.classes(v.excludeButton,c),bind:this,onclick:()=>{this.viewModel.enterExcludeLayerMode()},key:"esri-slice__exclude",type:"button"},n.excludeLayer):null,y=t&&o?_.tsx("button",{class:this.classes(v.cancelButton,c),bind:this,onclick:()=>{this.viewModel.exitExcludeLayerMode()},key:"esri-slice__cancel-exclude",type:"button"},n.cancel):null;let h=null;t&&(o?h=n.excludeHint:l&&(h=a?n.voxelHint:n.hint));const x=h?_.tsx("div",{class:v.hint,key:"esri-slice__hint"},_.tsx("p",{class:v.hintText},h),_.tsx("p",{class:v.hintText},n.verticalHint)):null,w=this.excludedLayers?this.excludedLayers.toArray().map((e=>this._renderLayerItem({uid:e.uid,title:e.title,onClick:()=>(this.excludedLayers.remove(e),!1)}))):[];this.excludeGroundSurface&&w.push(this._renderLayerItem({uid:"ground",title:n.ground,onClick:()=>(this.excludeGroundSurface=!1,!1)}));const b=!o&&r&&w.length>0?_.tsx("div",{class:v.layerList,key:"esri-slice__settings"},_.tsx(d.Heading,{class:v.layerListHeading,level:this.headingLevel},n.excludedLayers),_.tsx("ul",null,w)):null,g=_.tsx("div",{class:v.panelError,key:"esri-slice__unsupported"},_.tsx("p",null,n.unsupported)),M=_.tsx("div",{class:v.actionSection},p,y,u),f=this.visible?_.tsx("div",{class:v.container},e?[x,b,M]:g):null;return _.tsx("div",{class:v.base,role:"presentation"},f)},o._renderLayerItem=function(e){return _.tsx("li",{class:v.layerItem,key:e.uid},_.tsx("calcite-button",{appearance:"transparent",class:v.layerIncludeButton,iconStart:"x",scale:"s",title:this.messages.includeLayer,bind:this,onclick:e.onClick}),_.tsx("div",{class:v.layerItemTitle},e.title))},o._onNewSliceClick=function(){l.ignoreAbortErrors(this.viewModel.start())},t._createClass(r,[{key:"active",get:function(){return this.viewModel.active}},{key:"analysis",get:function(){return this.viewModel.analysis},set:function(e){this.viewModel.analysis=e}},{key:"excludedLayers",get:function(){return this.viewModel.excludedLayers},set:function(e){this.viewModel.excludedLayers=e}},{key:"excludeGroundSurface",get:function(){return this.viewModel.excludeGroundSurface},set:function(e){this.viewModel.excludeGroundSurface=e}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(e){this._overrideIfSome("label",e)}},{key:"view",get:function(){return this.viewModel.view},set:function(e){this.viewModel.view=e}},{key:"visible",get:function(){return this.viewModel.visible},set:function(e){this.viewModel.visible=e}}]),r}(a);i.__decorate([r.property()],x.prototype,"active",null),i.__decorate([r.property({constructOnly:!0,nonNullable:!0})],x.prototype,"analysis",null),i.__decorate([r.property()],x.prototype,"excludedLayers",null),i.__decorate([r.property()],x.prototype,"excludeGroundSurface",null),i.__decorate([r.property()],x.prototype,"headingLevel",void 0),i.__decorate([r.property()],x.prototype,"iconClass",void 0),i.__decorate([r.property()],x.prototype,"label",null),i.__decorate([r.property(),y.messageBundle("esri/widgets/Slice/t9n/Slice")],x.prototype,"messages",void 0),i.__decorate([r.property()],x.prototype,"view",null),i.__decorate([r.property({type:u})],x.prototype,"viewModel",void 0),i.__decorate([r.property()],x.prototype,"visible",null),x=i.__decorate([c.subclass("esri.widgets.Slice")],x);return x}));
