/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/promiseUtils","../core/accessorSupport/decorators/aliasOf","../core/arrayUtils","../core/has","../core/accessorSupport/ensureType","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/subclass","./Widget","./Slice/SliceViewModel","./support/Heading","./support/widgetUtils","./support/decorators/messageBundle","../core/Logger","./support/jsxFactory"],(function(e,t,s,i,l,r,o,n,c,a,d,u,p,_,y,v,h){"use strict";const b="esri-slice",x={buttonDisabled:"esri-button--disabled",layerIncludeButton:"esri-slice__cross",widgetIcon:"esri-icon-slice",base:`${b} esri-widget esri-widget--panel`,layerList:`${b}__settings`,layerListHeading:"esri-slice__settings-title",layerItem:`${b}__layer-item`,layerItemTitle:`${b}__layer-item__title`,container:`${b}__container`,actionSection:"esri-slice__actions",hint:`${b}__hint`,hintText:`${b}__hint-text`,panelError:`${b}__panel--error`,newSliceButton:`${b}__clear-button esri-button esri-button--primary`,excludeButton:`${b}__exclude-button esri-button esri-button--secondary`,cancelButton:`${b}__cancel-button esri-button esri-button--secondary`};let w=function(s){function l(e,t){var i;return(i=s.call(this,e,t)||this).headingLevel=3,i.iconClass=x.widgetIcon,i.label=void 0,i.messages=null,i.view=null,i.viewModel=new u,i}t._inheritsLoose(l,s);var r=l.prototype;return r.loadDependencies=function(){return Promise.all([new Promise(((t,s)=>e(["../chunks/calcite-button"],t,s))),new Promise(((t,s)=>e(["../chunks/calcite-icon"],t,s)))])},r.render=function(){const e=this.viewModel.supported,t=this.viewModel.active,s="disabled"===this.viewModel.state,i="ready"===this.viewModel.state,l="slicing"===this.viewModel.state||"sliced"===this.viewModel.state,r="exclude"===this.viewModel.layersMode,{messages:o}=this,n=s&&x.buttonDisabled,c=t&&!l||r?null:h.tsx("button",{disabled:s,class:this.classes(x.newSliceButton,n),bind:this,onclick:this._onNewSliceClick,key:"esri-slice__clear",type:"button"},o.newSlice),a=l&&!r?h.tsx("button",{class:this.classes(x.excludeButton,n),bind:this,onclick:()=>{this.viewModel.enterExcludeLayerMode()},key:"esri-slice__exclude",type:"button"},o.excludeLayer):null,d=t&&r?h.tsx("button",{class:this.classes(x.cancelButton,n),bind:this,onclick:()=>{this.viewModel.exitExcludeLayerMode()},key:"esri-slice__cancel-exclude",type:"button"},o.cancel):null;let u=null;t&&(r?u=o.excludeHint:i&&(u=o.hint));const _=u?h.tsx("div",{class:x.hint,key:"esri-slice__hint"},h.tsx("p",{class:x.hintText},u)):null,y=this.excludedLayers?this.excludedLayers.toArray().map((e=>this._renderLayerItem({uid:e.uid,title:e.title,onClick:()=>(this.excludedLayers.remove(e),!1)}))):[];this.excludeGroundSurface&&y.push(this._renderLayerItem({uid:"ground",title:o.ground,onClick:()=>(this.excludeGroundSurface=!1,!1)}));const v=!r&&l&&y.length>0?h.tsx("div",{class:x.layerList,key:"esri-slice__settings"},h.tsx(p.Heading,{class:x.layerListHeading,level:this.headingLevel},o.excludedLayers),h.tsx("ul",null,y)):null,b=h.tsx("div",{class:x.panelError,key:"esri-slice__unsupported"},h.tsx("p",null,o.unsupported)),w=h.tsx("div",{class:x.actionSection},a,d,c),g=this.visible?h.tsx("div",{class:x.container},e?[_,v,w]:b):null;return h.tsx("div",{class:x.base,role:"presentation"},g)},r._renderLayerItem=function(e){return h.tsx("li",{class:x.layerItem,key:e.uid},h.tsx("calcite-button",{appearance:"transparent",class:x.layerIncludeButton,"icon-start":"x",scale:"s",title:this.messages.includeLayer,bind:this,onclick:e.onClick}),h.tsx("div",{class:x.layerItemTitle},e.title))},r._onNewSliceClick=function(){i.ignoreAbortErrors(this.viewModel.start())},t._createClass(l,[{key:"analysis",get:function(){return this.viewModel.analysis},set:function(e){this.viewModel.analysis=e}}]),l}(d);s.__decorate([l.aliasOf("viewModel.active")],w.prototype,"active",void 0),s.__decorate([c.property({constructOnly:!0,nonNullable:!0})],w.prototype,"analysis",null),s.__decorate([l.aliasOf("viewModel.excludedLayers")],w.prototype,"excludedLayers",void 0),s.__decorate([l.aliasOf("viewModel.excludeGroundSurface")],w.prototype,"excludeGroundSurface",void 0),s.__decorate([c.property()],w.prototype,"headingLevel",void 0),s.__decorate([c.property()],w.prototype,"iconClass",void 0),s.__decorate([c.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],w.prototype,"label",void 0),s.__decorate([c.property(),y.messageBundle("esri/widgets/Slice/t9n/Slice")],w.prototype,"messages",void 0),s.__decorate([l.aliasOf("viewModel.view")],w.prototype,"view",void 0),s.__decorate([c.property({type:u})],w.prototype,"viewModel",void 0),s.__decorate([l.aliasOf("viewModel.visible")],w.prototype,"visible",void 0),w=s.__decorate([a.subclass("esri.widgets.Slice")],w);return w}));
