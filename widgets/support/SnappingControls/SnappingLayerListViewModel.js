/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../core/Collection","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/accessorSupport/ensureType","../../../core/Logger","../../../core/accessorSupport/decorators/subclass","../../../views/interactive/snapping/FeatureSnappingLayerSource","../../LayerList/LayerListViewModel","./snappingLayerListUtils","./SnappingListItem"],(function(e,t,r,i,s,n,o,a,p,c,l,u,y){"use strict";e.SnappingLayerListViewModel=function(e){function r(){var t;return(t=e.apply(this,arguments)||this).featureSnappingSources=new i,t}t._inheritsLoose(r,e);var s=r.prototype;return s._compileList=function(){const e=this.get("view.map.layers");if(!e)return;const t=e.filter(u.isValidSnappingLayer);this._watchLayersListMode(t);const r=this._getViewableLayers(t);r&&r.length?(this._createNewItems(r),this._modifyOrRemoveItems(r),this._sortItems(r)):this._removeAllItems()},s._createListItem=function(e){const{view:t}=this,r=L(this.featureSnappingSources,e),i=new y.SnappingListItem({layer:e,view:t,featureSource:r});for(const s of i.children)s.featureSource=L(this.featureSnappingSources,s.layer);return this._watchItemProperties(i),i},t._createClass(r,[{key:"operationalItemsFlat",get:function(){return this.operationalItems.flatten((e=>e.children))}}]),r}(l),r.__decorate([s.property()],e.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0),r.__decorate([s.property()],e.SnappingLayerListViewModel.prototype,"operationalItems",void 0),e.SnappingLayerListViewModel=r.__decorate([p.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],e.SnappingLayerListViewModel);const L=(e,t)=>{if(!u.isValidSnappingLayerSource(t))return null;let r=e.find((e=>e.layer===t));return r||(r=new c({layer:t,enabled:!1}),e.add(r)),r};Object.defineProperty(e,"__esModule",{value:!0})}));
