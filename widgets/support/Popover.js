/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/maybe","../../core/Logger","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/subclass","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../core/watchUtils","../../core/domUtils","./widgetUtils","./decorators/renderable","../../chunks/index","../Widget","../../chunks/popper"],(function(e,t,o,r,n,s,p,i,c,l,a,d,u,h,_,f,y,m){"use strict";const b=["bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","top","top-start","top-end"],v="esri-popover",C="esri-popover--open",g={position:"fixed","z-index":"1000"};let N=function(t){function o(e,o){var n;return(n=t.call(this,e,o)||this)._popper=null,n._contentNode=null,n._renderAttached=!1,n._rootNode=null,n.anchorElement=null,n.offset=[0,0],n.open=!1,n.renderContentFunction=null,n._afterRootCreate=e=>{n._rootNode=e},n._afterContentCreate=e=>{n._contentNode=e},n._updatePosition=()=>{r.isSome(n._popper)&&n._popper.update()},n}e._inheritsLoose(o,t);var n=o.prototype;return n.initialize=function(){this.when((()=>{this._projector.append(document.body,this.render),this._renderAttached=!0})),this.own(d.init(this,["open","anchorElement"],(()=>this._buildPopper())),d.init(this,["placement","offset"],(()=>this._setPopperOptions())))},n.destroy=function(){this.owner=null,this.anchorElement=null,this.renderContentFunction=null,this._renderAttached&&(this._projector.detach(this.render),this._renderAttached=!1),r.isSome(this._rootNode)&&(u.remove(this._rootNode),this._rootNode=null),this._contentNode=null,r.isSome(this._popper)&&(this._popper.destroy(),this._popper=null)},n.render=function(){const{open:e,owner:t,renderContentFunction:o}=this;return f.jsx("div",{afterCreate:this._afterRootCreate,class:this.classes(v,e?C:null),styles:g},f.jsx("div",{afterCreate:this._afterContentCreate,afterUpdate:this._updatePosition},e&&(null==o?void 0:o.call(t))))},n._buildPopper=function(){r.isSome(this._popper)&&(this._popper.destroy(),this._popper=null);const e=this._contentNode;if(r.isNone(e))return;if(!this.open||!this.renderContentFunction)return;const t=this._getAnchor();t&&(this._popper=m.createPopper(t,e),this._setPopperOptions())},n._setPopperOptions=function(){const{placement:e,offset:t,_popper:o}=this;r.isNone(o)||(o.setOptions({placement:e,modifiers:[{name:"offset",options:{offset:t}}]}),o.forceUpdate())},n._getAnchor=function(){const{anchorElement:e}=this;return u.byId("function"==typeof e?e():e)},e._createClass(o,[{key:"container",set:function(e){}},{key:"owner",set:function(e){this._set("owner",e)}},{key:"placement",get:function(){return"top"},set:function(e){-1!==b.indexOf(e)?this._override("placement",e):this._clearOverride("placement")}}]),o}(y);return t.__decorate([p.property(),_.renderable()],N.prototype,"anchorElement",void 0),t.__decorate([p.property()],N.prototype,"container",null),t.__decorate([p.property(),_.renderable()],N.prototype,"offset",void 0),t.__decorate([p.property(),_.renderable()],N.prototype,"open",void 0),t.__decorate([p.property(),_.renderable()],N.prototype,"owner",null),t.__decorate([p.property(),_.renderable()],N.prototype,"placement",null),t.__decorate([p.property(),_.renderable()],N.prototype,"renderContentFunction",void 0),N=t.__decorate([i.subclass("esri.widgets.support.Popover")],N),N}));
