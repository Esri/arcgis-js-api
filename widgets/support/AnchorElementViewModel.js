/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/Evented","../../core/Handles","../../core/maybe","../../core/watchUtils","../../core/accessorSupport/decorators/property","../../core/arrayUtils","../../core/has","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/subclass"],(function(e,t,n,o,i,r,s,a,c,l,d){"use strict";let p=function(t){function n(n){var i;return(i=t.call(this,n)||this)._anchorHandles=new o,i.location=null,i.screenLocation=null,i.screenLocationEnabled=!1,i.view=null,i._anchorHandles.add([r.watch(e._assertThisInitialized(i),["screenLocationEnabled","location","view.size","view.stationary"],(()=>i._updateScreenPointAndHandle())),r.watch(e._assertThisInitialized(i),["view","view.ready"],(()=>i._wireUpView()))]),i}e._inheritsLoose(n,t);var s=n.prototype;return s.destroy=function(){this.view=null,this._anchorHandles&&this._anchorHandles.destroy(),this._anchorHandles=null,this._viewpointHandle=null},s._wireUpView=function(){const e="view";this._anchorHandles.remove(e),this._viewpointHandle=null;if(!this.get("view.ready"))return;this._setScreenLocation();const{view:t}=this,n="3d"===t.type?"camera":"viewpoint",o=r.pausable(t,n,(()=>this._viewpointChange()));this._anchorHandles.add(o,e),this._viewpointHandle=o,this._toggleWatchingViewpoint()},s._viewpointChange=function(){this._setScreenLocation(),this.emit("view-change")},s._updateScreenPointAndHandle=function(){this._setScreenLocation(),this._toggleWatchingViewpoint()},s._toggleWatchingViewpoint=function(){const{_viewpointHandle:e,location:t,screenLocationEnabled:n}=this;if(!e)return;t&&n?e.resume():e.pause()},s._setScreenLocation=function(){const{location:e,view:t,screenLocationEnabled:n}=this,o=this.get("view.ready"),r=n&&o&&i.isSome(e)?t.toScreen(e):null;this._set("screenLocation",r)},n}(n.EventedAccessor);t.__decorate([s.property()],p.prototype,"location",void 0),t.__decorate([s.property({readOnly:!0})],p.prototype,"screenLocation",void 0),t.__decorate([s.property()],p.prototype,"screenLocationEnabled",void 0),t.__decorate([s.property()],p.prototype,"view",void 0),p=t.__decorate([d.subclass("esri.widgets.support.AnchorElementViewModel")],p);return p}));
