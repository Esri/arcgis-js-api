/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/Handles","../../core/Logger","../../core/maybe","../../core/unitUtils","../../core/watchUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/subclass","../../properties/defaultUnit","../../views/3d/interactive/measurementTools/directLineMeasurement3D/DirectLineMeasurement3DTool","../support/InteractiveToolViewModel"],(function(t,e,i,n,r,s,o,a,l,u,c,d,p,h){"use strict";const f=n.getLogger("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel");let _=function(e){function n(t){var n;return(n=e.call(this,t)||this).supportedViewType="3d",n._handles=new i,n._userUnitOptions=null,n._userUnit=null,n}t._inheritsLoose(n,e);var a=n.prototype;return a.initialize=function(){this._handles.add([o.init(this,"unit",(t=>{this.tool&&(this.tool.unit=t)}))])},a.destroy=function(){this._handles.destroy(),this._handles=null},a.start=function(){return this.createTool()},a.clear=function(){this.removeTool()},a.createToolParams=function(){return{toolConstructor:p,constructorArguments:()=>({unit:this.unit})}},a.logUnsupportedError=function(){f.error("DirectLineMeasurement3D widget is not implemented for MapView")},a.logError=function(...t){f.error(...t)},a._findSelectableUnit=function(t,e){const i=this.unitOptions;return-1!==i.indexOf(t)?t:e?this._findSelectableUnit(e):i[0]},a._filteredOrAllUnits=function(t){if(!t)return s.measurementLengthUnits.slice();const e=t.filter((t=>-1!==s.measurementLengthUnits.indexOf(t)));return 0===e.length?s.measurementLengthUnits.slice():e},t._createClass(n,[{key:"state",get:function(){return this.isDisabled?"disabled":this.tool?this.tool.state:"ready"}},{key:"measurement",get:function(){if(!this.tool)return null;const t={mode:"euclidean",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:null,state:"unavailable"},verticalDistance:{text:null,state:"unavailable"}},e=this.tool.measurementView.analysisView;if(r.isNone(e))return t;const i=e.actualVisualizedMeasurement,n=this.tool.measurementView,s=r.isSome(e.result)?"available":"unavailable";switch(i){case 1:return{mode:"euclidean",directDistance:{text:n.directLabelText,state:s},horizontalDistance:{text:n.horizontalLabelText,state:s},verticalDistance:{text:n.verticalLabelText,state:s}};case 2:return{mode:"geodesic",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:n.directLabelText,state:s},verticalDistance:{text:n.verticalLabelText,state:s}};default:return t}}},{key:"unitOptions",get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(t){this._userUnitOptions=t,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}},{key:"unit",get:function(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)},set:function(t){this._userUnit=t?this._findSelectableUnit(t,this._userUnit):null,this.notifyChange("unit")}}]),n}(h.InteractiveToolViewModel);return e.__decorate([a.property({readOnly:!0})],_.prototype,"state",null),e.__decorate([a.property({readOnly:!0})],_.prototype,"measurement",null),e.__decorate([a.property()],_.prototype,"tool",void 0),e.__decorate([a.property(d.defaultUnitPropertyMetadata)],_.prototype,"defaultUnit",void 0),e.__decorate([a.property()],_.prototype,"unitOptions",null),e.__decorate([a.property()],_.prototype,"unit",null),_=e.__decorate([c.subclass("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],_),_}));
