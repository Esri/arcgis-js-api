/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../core/screenUtils","./cimSymbolUtils","../cim/CIMSymbolRasterizer"],(function(e,t,l,a){"use strict";const i=new a.CIMSymbolRasterizer(null,!0);e.previewCIMSymbol=async function(e,a={}){const{size:n,maxSize:o,feature:s,fieldMap:c,geometryType:m,style:r,node:y,opacity:d}=a,u=l.getCIMSymbolSize(e),h=Math.min(null!=n?n:u,null!=o?o:t.px2pt(120));h!==u&&(e=e.clone(),l.scaleCIMSymbolTo(e,h,{preserveOutlineWidth:!0}));let p=3;e&&e.data&&e.data.symbol&&"CIMPointSymbol"!==e.data.symbol.type&&(p=1);const M=await i.rasterizeCIMSymbolAsync(e,s,c,m,{scaleFactor:p,style:r}),b=document.createElement("canvas");b.width=M.imageData.width,b.height=M.imageData.height,b.getContext("2d").putImageData(M.imageData,0,0);let g=b.width/p,S=b.height/p;if(null!=n&&(null==(null==a?void 0:a.scale)||(null==a?void 0:a.scale))){const e=g/S;g=e<=1?Math.ceil(h*e):h,S=e<=1?h:Math.ceil(h/e)}const C=new Image(g,S);return C.src=b.toDataURL(),null!=d&&(C.style.opacity=`${d}`),y&&y.appendChild(C),C},Object.defineProperty(e,"__esModule",{value:!0})}));
