/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../../assets","../../Color","../../request","../../core/ItemCache","../../core/screenUtils","./cimSymbolUtils"],(function(e,t,n,i,r,o,l){"use strict";const s="picture-fill",a="simple-fill",c="simple-line",u="simple-marker",p="text",d="cim",f={left:"start",center:"middle",right:"end",justify:"start"},g={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},m=new r(1e3);function h(e){let t=e.horizontalAlignment;return t=t&&f[t.toLowerCase()]||"middle",t}function y(e){const t=e.verticalAlignment;return t&&g[t.toLowerCase()]||"alphabetic"}function b(e){return"bottom"===e.verticalAlignment?"super":null}function x(e){const n=e.style;let i=null;if(e)switch(e.type){case u:"cross"!==n&&"x"!==n&&(i=e.color);break;case a:"solid"===n?i=e.color:"none"!==n&&(i={type:"pattern",x:0,y:0,src:t.getAssetUrl(`esri/symbols/patterns/${n}.png`),width:5,height:5});break;case s:i={type:"pattern",src:e.url,width:o.pt2px(e.width)*e.xscale,height:o.pt2px(e.height)*e.yscale,x:o.pt2px(e.xoffset),y:o.pt2px(e.yoffset)};break;case p:i=e.color;break;case d:i=l.getCIMSymbolColor(e)}return i}function w(e,t){const n=e+"-"+t;return void 0!==m.get(n)?Promise.resolve(m.get(n)):i(e,{responseType:"image"}).then((e=>{const i=e.data,r=i.naturalWidth,o=i.naturalHeight,l=document.createElement("canvas");l.width=r,l.height=o;const s=l.getContext("2d");s.fillStyle=t,s.fillRect(0,0,r,o),s.globalCompositeOperation="destination-in",s.drawImage(i,0,0);const a=l.toDataURL();return m.put(n,a),a}))}function S(e){if(!e)return null;let t;switch(e.type){case a:case s:case u:t=S(e.outline);break;case c:{const n=o.pt2px(e.width);"none"!==e.style&&0!==n&&(t={color:e.color,style:C(e.style),width:n,cap:e.cap,join:"miter"===e.join?o.pt2px(e.miterLimit):e.join});break}default:t=null}return t}const C=function(){const e={};return function(t){if(e[t])return e[t];const n=t.replace(/-/g,"");return e[t]=n,n}}(),k=new n([128,128,128]);e.defaultThematicColor=k,e.dekebabifyLineStyle=C,e.getFill=x,e.getPatternUrlWithColor=w,e.getSVGAlign=h,e.getSVGBaseline=y,e.getSVGBaselineShift=b,e.getStroke=S,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
