/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../core/promiseUtils","../../Color","../../core/screenUtils","../../request","../../assets","../../core/ItemCache","./cimSymbolUtils"],(function(e,t,n,r,i,o,l,s){"use strict";const c="picture-fill",a="simple-fill",p="simple-marker",u=o.getAssetUrl("esri/symbols/patterns/"),f={left:"start",center:"middle",right:"end",justify:"start"},d={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},g=new l(1e3);const m=function(){const e={};return function(t){if(e[t])return e[t];const n=t.replace(/-/g,"");return e[t]=n,n}}(),h=new n([128,128,128]);e.defaultThematicColor=h,e.getFill=function(e){const t=e.style;let n=null;if(e)switch(e.type){case p:"cross"!==t&&"x"!==t&&(n=e.color);break;case a:"solid"===t?n=e.color:"none"!==t&&(n={type:"pattern",x:0,y:0,src:u+t+".png",width:5,height:5});break;case c:n={type:"pattern",src:e.url,width:r.pt2px(e.width)*e.xscale,height:r.pt2px(e.height)*e.yscale,x:r.pt2px(e.xoffset),y:r.pt2px(e.yoffset)};break;case"text":n=e.color;break;case"cim":n=s.getCIMSymbolColor(e)}return n},e.getPatternUrlWithColor=function(e,n){const r=e+"-"+n;return void 0!==g.get(r)?t.resolve(g.get(r)):i(e,{responseType:"image"}).then((e=>{const t=e.data,i=t.naturalWidth,o=t.naturalHeight,l=document.createElement("canvas");l.width=i,l.height=o;const s=l.getContext("2d");s.fillStyle=n,s.fillRect(0,0,i,o),s.globalCompositeOperation="destination-in",s.drawImage(t,0,0);const c=l.toDataURL();return g.put(r,c),c}))},e.getSVGAlign=function(e){let t=e.horizontalAlignment;return t=t&&f[t.toLowerCase()]||"middle",t},e.getSVGBaseline=function(e){const t=e.verticalAlignment;return t&&d[t.toLowerCase()]||"alphabetic"},e.getSVGBaselineShift=function(e){return"bottom"===e.verticalAlignment?"super":null},e.getStroke=function e(t){if(!t)return null;let n;switch(t.type){case a:case c:case p:n=e(t.outline);break;case"simple-line":{const e=r.pt2px(t.width);"none"!==t.style&&0!==e&&(n={color:t.color,style:m(t.style),width:e,cap:t.cap,join:"miter"===t.join?r.pt2px(t.miterLimit):t.join});break}default:n=null}return n},Object.defineProperty(e,"__esModule",{value:!0})}));
