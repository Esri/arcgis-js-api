/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{getAssetUrl as e}from"../../assets.js";import t from"../../Color.js";import r from"../../request.js";import o from"../../core/ItemCache.js";import{pt2px as n}from"../../core/screenUtils.js";import{getCIMSymbolColor as i}from"./cimSymbolUtils.js";const s="picture-fill",l="simple-fill",a="simple-line",c="simple-marker",m="text",u="cim",p={left:"start",center:"middle",right:"end",justify:"start"},f={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},d=new o(1e3);function h(e){let t=e.horizontalAlignment;return t=t&&p[t.toLowerCase()]||"middle",t}function g(e){const t=e.verticalAlignment;return t&&f[t.toLowerCase()]||"alphabetic"}function y(e){return"bottom"===e.verticalAlignment?"super":null}function b(t){const r=t.style;let o=null;if(t)switch(t.type){case c:"cross"!==r&&"x"!==r&&(o=t.color);break;case l:"solid"===r?o=t.color:"none"!==r&&(o={type:"pattern",x:0,y:0,src:e(`esri/symbols/patterns/${r}.png`),width:5,height:5});break;case s:o={type:"pattern",src:t.url,width:n(t.width)*t.xscale,height:n(t.height)*t.yscale,x:n(t.xoffset),y:n(t.yoffset)};break;case m:o=t.color;break;case u:o=i(t)}return o}function w(e,t){const o=e+"-"+t;return void 0!==d.get(o)?Promise.resolve(d.get(o)):r(e,{responseType:"image"}).then((e=>{const r=e.data,n=r.naturalWidth,i=r.naturalHeight,s=document.createElement("canvas");s.width=n,s.height=i;const l=s.getContext("2d");l.fillStyle=t,l.fillRect(0,0,n,i),l.globalCompositeOperation="destination-in",l.drawImage(r,0,0);const a=s.toDataURL();return d.put(o,a),a}))}function j(e){if(!e)return null;let t;switch(e.type){case l:case s:case c:t=j(e.outline);break;case a:{const r=n(e.width);"none"!==e.style&&0!==r&&(t={color:e.color,style:x(e.style),width:r,cap:e.cap,join:"miter"===e.join?n(e.miterLimit):e.join});break}default:t=null}return t}const x=(()=>{const e={};return t=>{if(e[t])return e[t];const r=t.replace(/-/g,"");return e[t]=r,r}})(),k=new t([128,128,128]);export{k as defaultThematicColor,x as dekebabifyLineStyle,b as getFill,w as getPatternUrlWithColor,h as getSVGAlign,g as getSVGBaseline,y as getSVGBaselineShift,j as getStroke};
