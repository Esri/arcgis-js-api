/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["require","exports"],(function(e,t){"use strict";function r(e){return"function"==typeof e}function n(e,t,n,o){return r(e)?e(t,n,o):e}function o(e){return[e.r,e.g,e.b,e.a]}const i=" /-,\n";function l(e){let t=e.length;for(;t--;)if(!i.includes(e.charAt(t)))return!1;return!0}function a(e,t){const r=[];let n=0,o=-1;do{if(o=e.indexOf("[",n),o>=n){if(o>n){const t=e.substr(n,o-n);r.push([t,null,l(t)])}if(n=o+1,o=e.indexOf("]",n),o>=n){if(o>n){const i=t[e.substr(n,o-n)];i&&r.push([null,i,!1])}n=o+1}}}while(-1!==o);if(n<e.length-1){const t=e.substr(n);r.push([t,null,l(t)])}return r}function s(e,t,r){let n="",o=null;for(const i of t){const[t,r,l]=i;if(t)l?o=t:(o&&(n+=o,o=null),n+=t);else{const t=e.attributes[r];t&&(o&&(n+=o,o=null),n+=t)}}return u(n,r)}function c(e,t,r){const n=a(t,e);return e=>s(e,n,r)}function u(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function f(e,t,r,n,o,i,l=!0){const a=t/o,s=r/i,c=Math.ceil(a/2),u=Math.ceil(s/2);for(let f=0;f<i;f++)for(let r=0;r<o;r++){const y=4*(r+(l?i-f-1:f)*o);let M=0,C=0,m=0,b=0,I=0,d=0,g=0;const p=(f+.5)*s;for(let n=Math.floor(f*s);n<(f+1)*s;n++){const o=Math.abs(p-(n+.5))/u,i=(r+.5)*a,l=o*o;for(let s=Math.floor(r*a);s<(r+1)*a;s++){let r=Math.abs(i-(s+.5))/c;const o=Math.sqrt(l+r*r);o>=-1&&o<=1&&(M=2*o*o*o-3*o*o+1,M>0&&(r=4*(s+n*t),g+=M*e[r+3],m+=M,e[r+3]<255&&(M=M*e[r+3]/250),b+=M*e[r],I+=M*e[r+1],d+=M*e[r+2],C+=M))}}n[y]=b/C,n[y+1]=I/C,n[y+2]=d/C,n[y+3]=g/m}}function y(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function M(e){return e.data?.symbol??null}function C(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function m(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function b(e){return null!=e&&("CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type)}function I(e){return null!=e&&("CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type)}const d=(e,t=0)=>null==e||isNaN(e)?t:e,g=e=>e.tintColor?y(e.tintColor):{r:255,g:255,b:255,a:1},p=e=>{if(!e)return!1;for(const t of e)switch(t.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function S(){return new Promise(((t,r)=>e(["../../geometry/geometryEngineJSON"],t,r)))}function h(e){if(!e)return"normal";switch(e.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function k(e){if(!e)return"normal";switch(e.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function P(e){let t="",r="";if(e){const n=e.toLowerCase();n.includes("italic")?t="italic":n.includes("oblique")&&(t="oblique"),n.includes("bold")?r="bold":n.includes("light")&&(r="lighter")}return{style:t,weight:r}}function F(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}function w(e){if(!e)return null;switch(e.type){case"CIMPolygonSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=w(t);if(null!=e)return e}break;case"CIMTextSymbol":return w(e.symbol);case"CIMSolidFill":return e.color}}function L(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const t=e.symbolLayers;if(t)for(const e of t){const t=L(e);if(null!=t)return t}break}case"CIMTextSymbol":return L(e.symbol);case"CIMSolidStroke":case"CIMSolidFill":return e.color}}function T(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=T(t);if(void 0!==e)return e}break;case"CIMTextSymbol":return T(e.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return e.width}}function G(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function x(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function A(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"})))}const O=e=>e.includes("data:image/svg+xml");function V(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}t.adjustTextCase=u,t.analyzeTextParts=a,t.assignTextValuesFromFeature=s,t.attributesToFields=A,t.colorToArray=o,t.createLabelOverrideFunction=c,t.evaluateValueOrFunction=n,t.fromCIMColor=y,t.fromCIMFontDecoration=F,t.fromCIMFontStyle=P,t.fromCIMHorizontalAlignment=G,t.fromCIMVerticalAlignment=x,t.getFillColor=w,t.getFontStyle=h,t.getFontWeight=k,t.getStrokeColor=L,t.getStrokeWidth=T,t.getTintColor=g,t.getValue=d,t.importGeometryEngine=S,t.isCIMFill=b,t.isCIMMarker=C,t.isCIMMarkerStrokePlacement=I,t.isCIMStroke=m,t.isGeometryEngineRequired=p,t.isSVGImage=O,t.mapCIMSymbolToGeometryType=V,t.resampleHermite=f,t.toCIMSymbolJSON=M,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
