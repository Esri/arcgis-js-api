/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../CIMPlacements","../enums"],(function(t,i,s){"use strict";function e(t){return void 0!==t.rings}let n=function(){function t(){}return t.local=function(){return null===t.instance&&(t.instance=new t),t.instance},t.prototype.execute=function(t,i,s,e){return new h(t,i,s,e)},t}();n.instance=null;let h=function(){function t(t,n,h,_){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._stepX=(void 0!==n.stepX?Math.abs(n.stepX):16)*h,this._stepY=(void 0!==n.stepY?Math.abs(n.stepY):16)*h,0!==this._stepX&&0!==this._stepY&&t&&e(t)&&t.rings){if(this._gridType=void 0!==n.gridType?n.gridType:s.PlacementGridType.Fixed,this._gridType===s.PlacementGridType.Random)this._randomness=void 0!==n.randomness?n.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0;else{if(this._randomness=0,this._gridAngle=void 0!==n.gridAngle?n.gridAngle:0,this._shiftOddRows=void 0!==n.shiftOddRows&&n.shiftOddRows,this._offsetX=void 0!==n.offsetX?n.offsetX*h:0,this._offsetY=void 0!==n.offsetY?n.offsetY*h:0,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginX=0,this._graphicOriginY=0,this._internalPlacement=new i.Placement,this._calculateMinMax(t),this._geometry=t}}var n=t.prototype;return n.next=function(){return this._geometry?this._nextInside():null},n._calculateMinMax=function(t){let i,s,e,n,h,_,r,o;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,h=_=Number.MAX_VALUE,r=o=-Number.MAX_VALUE;for(const a of t.rings){const t=a?a.length:0;for(let f=0;f<t;++f)i=a[f][0]-this._graphicOriginX-this._offsetX,s=a[f][1]-this._graphicOriginY-this._offsetY,e=this._cosAngle*i-this._sinAngle*s,n=this._sinAngle*i+this._cosAngle*s,h=Math.min(h,e),r=Math.max(r,e),_=Math.min(_,n),o=Math.max(o,n)}h+=this._graphicOriginX,r+=this._graphicOriginX,_+=this._graphicOriginY,o+=this._graphicOriginY,this._xMin=Math.round(h/this._stepX),this._xMax=Math.round(r/this._stepX),this._yMin=Math.round(_/this._stepY),this._yMax=Math.round(o/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1},n._nextInside=function(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}let t=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(t+=.5*this._stepX);const i=this._currentY*this._stepY+this._offsetY;let e,n;return this._currentX++,this._gridType===s.PlacementGridType.Random?(e=this._graphicOriginX+t+this._stepX*this._randomness*(.5-Math.random())*2/3,n=this._graphicOriginY+i+this._stepY*this._randomness*(.5-Math.random())*2/3):(e=this._graphicOriginX+this._cosAngle*t+this._sinAngle*i,n=this._graphicOriginY-this._sinAngle*t+this._cosAngle*i),this._internalPlacement.setTranslate(e,n),this._internalPlacement}},t}();t.PlacementInsidePolygon=n,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
