/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../geometry","../../../core/maybe","../../../geometry/support/jsonUtils","../CIMEffects","../CurveHelper","../enums","../../../geometry/SpatialReference"],(function(e,t,i,n,s,r,o,l){"use strict";let f=function(){function e(){}return e.local=function(){return null===e.instance&&(e.instance=new e),e.instance},e.prototype.execute=function(e,t,i,n,s){return new u(e,t,i,n,s)},e}();f.instance=null;let u=function(){function e(e,t,i,n,s){this._inputGeometries=e,this._tileKey=n,this._geometryEngine=s,this._curveHelper=new r.CurveHelper,this._size=(void 0!==t.size?t.size:1)*i,this._offsetFlattenError=r.PIXEL_TOLERANCE*i}return e.prototype.next=function(){let e;for(;e=this._inputGeometries.next();){if(0===this._size)return e;if(n.isExtent(e))if(this._size>0){const t=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]],i=this._curveHelper.offset(t,this._size,o.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(i)return{rings:[i]}}else if(this._size<0&&Math.min(e.xmax-e.xmin,e.ymax-e.ymin)+2*this._size>0)return{xmin:e.xmin-this._size,xmax:e.xmax+this._size,ymin:e.ymin-this._size,ymax:e.ymax+this._size};const t=this._geometryEngine;if(i.isNone(t))return null;let r=e;if((!n.isPolygon(e)||!this._tileKey||(r=s.clipPolygonToTileExtent(e,Math.abs(this._size)+1),r&&r.rings&&0!==r.rings.length))&&(!n.isPolyline(e)||!this._tileKey||(r=s.clipPolylineToTileExtent(e,Math.abs(this._size)+1),r&&r.paths&&0!==r.paths.length)))return t.buffer(l.WebMercator,r,this._size,1)}return null},e}();e.EffectBuffer=f,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
