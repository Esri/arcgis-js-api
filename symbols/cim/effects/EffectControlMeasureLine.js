/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../geometry/support/jsonUtils","../CIMCursor","../enums"],(function(t,s,e,i){"use strict";let h=function(){function t(){}return t.local=function(){return null===t.instance&&(t.instance=new t),t.instance},t.prototype.execute=function(t,s,e,i){return new r(t,s,e)},t}();h.instance=null;let r=function(){function t(t,s,e){this._defaultPointSize=20,this._inputGeometries=t,this._geomUnitsPerPoint=e,this._rule=s.rule??i.GeometricEffectControlMeasureLineRule.FullGeometry,this._defaultSize=this._defaultPointSize*e}var h=t.prototype;return h.next=function(){let t;for(;t=this._inputGeometries.next();){let e;if(s.isPoint(t)?e=this._processGeom([[[t.x,t.y]]]):s.isMultipoint(t)?e=this._processGeom([t.points]):s.isPolyline(t)?e=this._processGeom(t.paths):s.isPolygon(t)&&(e=this._processGeom(t.rings)),e&&e.length)return{paths:e}}return null},h._clone=function(t){return[t[0],t[1]]},h._mid=function(t,s){return[(t[0]+s[0])/2,(t[1]+s[1])/2]},h._mix=function(t,s,e,i){return[t[0]*s+e[0]*i,t[1]*s+e[1]*i]},h._add=function(t,s){return[t[0]+s[0],t[1]+s[1]]},h._add2=function(t,s,e){return[t[0]+s,t[1]+e]},h._sub=function(t,s){return[t[0]-s[0],t[1]-s[1]]},h._dist=function(t,s){return Math.sqrt((t[0]-s[0])*(t[0]-s[0])+(t[1]-s[1])*(t[1]-s[1]))},h._norm=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},h._normalize=function(t,s=1){const e=s/this._norm(t);t[0]*=e,t[1]*=e},h._leftPerpendicular=function(t){const s=-t[1],e=t[0];t[0]=s,t[1]=e},h._leftPerp=function(t){return[-t[1],t[0]]},h._rightPerpendicular=function(t){const s=t[1],e=-t[0];t[0]=s,t[1]=e},h._rightPerp=function(t){return[t[1],-t[0]]},h._dotProduct=function(t,s){return t[0]*s[0]+t[1]*s[1]},h._crossProduct=function(t,s){return t[0]*s[1]-t[1]*s[0]},h._rotateDirect=function(t,s,e){const i=t[0]*s-t[1]*e,h=t[0]*e+t[1]*s;t[0]=i,t[1]=h},h._makeCtrlPt=function(t){const s=[t[0],t[1]];return e.setId(s,1),s},h._addAngledTicks=function(t,s,e,i){const h=this._sub(e,s);this._normalize(h);const r=this._crossProduct(h,this._sub(i,s));let o;o=r>0?this._rightPerp(h):this._leftPerp(h);const c=Math.abs(r)/2,u=[];u.push([s[0]+(o[0]-h[0])*c,s[1]+(o[1]-h[1])*c]),u.push(s),u.push(e),u.push([e[0]+(o[0]+h[0])*c,e[1]+(o[1]+h[1])*c]),t.push(u)},h._addBezier2=function(t,s,e,i,h){if(0==h--)return void t.push(i);const r=this._mid(s,e),o=this._mid(e,i),c=this._mid(r,o);this._addBezier2(t,s,r,c,h),this._addBezier2(t,c,o,i,h)},h._addBezier3=function(t,s,e,i,h,r){if(0==r--)return void t.push(h);const o=this._mid(s,e),c=this._mid(e,i),u=this._mid(i,h),n=this._mid(o,c),_=this._mid(c,u),a=this._mid(n,_);this._addBezier3(t,s,o,n,a,r),this._addBezier3(t,a,_,u,h,r)},h._add90DegArc=function(t,s,e,i,h){const r=h??this._crossProduct(this._sub(e,s),this._sub(i,s))>0,o=this._mid(s,e),c=this._sub(o,s);r?this._leftPerpendicular(c):this._rightPerpendicular(c),o[0]+=c[0],o[1]+=c[1],this._addBezier3(t,s,this._mix(s,.33333,o,.66667),this._mix(e,.33333,o,.66667),e,4)},h._addArrow=function(t,s,e){const i=s[0],h=s[1],r=s[s.length-1],o=this._sub(i,h);this._normalize(o);const c=this._crossProduct(o,this._sub(r,h)),u=.5*c,n=this._leftPerp(o),_=[r[0]-n[0]*c,r[1]-n[1]*c],a=s.length-1,l=[];l.push(e?[-n[0],-n[1]]:n);let p=[-o[0],-o[1]];for(let d=1;d<a-1;d++){const t=this._sub(s[d+1],s[d]);this._normalize(t);const e=this._dotProduct(t,p),i=this._crossProduct(t,p),h=Math.sqrt((1+e)/2),r=this._sub(t,p);this._normalize(r),r[0]/=h,r[1]/=h,l.push(i<0?[-r[0],-r[1]]:r),p=t}l.push(this._rightPerp(p));for(let d=l.length-1;d>0;d--)t.push([s[d][0]+l[d][0]*u,s[d][1]+l[d][1]*u]);t.push([_[0]+l[0][0]*u,_[1]+l[0][1]*u]),t.push([_[0]+l[0][0]*c,_[1]+l[0][1]*c]),t.push(i),t.push([_[0]-l[0][0]*c,_[1]-l[0][1]*c]),t.push([_[0]-l[0][0]*u,_[1]-l[0][1]*u]);for(let d=1;d<l.length;d++)t.push([s[d][0]-l[d][0]*u,s[d][1]-l[d][1]*u])},h._cp2=function(t,s,e){return t.length>=2?t[1]:this._add2(t[0],s*this._defaultSize,e*this._defaultSize)},h._cp3=function(t,s,e,i){if(t.length>=3)return t[2];const h=this._mix(t[0],1-e,s,e),r=this._sub(s,t[0]);return this._normalize(r),this._rightPerpendicular(r),[h[0]+r[0]*i*this._defaultSize,h[1]+r[1]*i*this._defaultSize]},h._arrowPath=function(t){if(t.length>2)return t;const s=t[0],e=this._cp2(t,-4,0),i=this._sub(s,e);this._normalize(i);const h=this._rightPerp(i);return[s,e,[s[0]+(h[0]-i[0])*this._defaultSize,s[1]+(h[1]-i[1])*this._defaultSize]]},h._arrowLastSeg=function(t){const s=t[0],e=this._cp2(t,-4,0);let i;if(t.length>=3)i=t[t.length-1];else{const t=this._sub(s,e);this._normalize(t);const h=this._rightPerp(t);i=[s[0]+(h[0]-t[0])*this._defaultSize,s[1]+(h[1]-t[1])*this._defaultSize]}return[e,i]},h._processGeom=function(t){if(!t)return null;const s=[];for(const h of t){if(!h||0===h.length)continue;const t=h.length;let r=h[0];switch(this._rule){case i.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:{const t=this._cp2(h,0,-1),e=this._cp3(h,t,.5,4),i=[];i.push(e),i.push(this._mid(r,t)),s.push(i);break}case i.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:{const t=this._cp2(h,0,-1);s.push([t,r]);break}case i.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:{const t=this._cp2(h,-4,1),e=this._cp3(h,t,.882353,-1.94),i=[];i.push(this._mid(t,e)),i.push(r),s.push(i);break}case i.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:{const t=this._cp2(h,-4,1),e=this._cp3(h,t,.882353,-1.94),i=this._sub(e,t);let o;o=this._crossProduct(i,this._sub(r,t))>0?this._rightPerp(o):this._leftPerp(i);const c=[];c.push([t[0]+(o[0]-i[0])/3,t[1]+(o[1]-i[1])/3]),c.push(t),c.push(e),c.push([e[0]+(o[0]+i[0])/3,e[1]+(o[1]+i[1])/3]),s.push(c);break}case i.GeometricEffectControlMeasureLineRule.DoublePerpendicular:{const t=this._cp2(h,0,-1),e=this._cp3(h,t,.5,3),i=this._mid(r,t),o=this._sub(i,e);this._normalize(o);const c=this._crossProduct(o,this._sub(r,e));this._leftPerpendicular(o);const u=[];u.push(r),u.push([e[0]+o[0]*c,e[1]+o[1]*c]),s.push(u);const n=[];n.push([e[0]-o[0]*c,e[1]-o[1]*c]),n.push(t),s.push(n);break}case i.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:{const t=this._cp2(h,0,-1),e=this._cp3(h,t,.5,3),i=this._mid(r,t),o=this._sub(i,e);this._normalize(o);const c=this._crossProduct(o,this._sub(r,e));this._leftPerpendicular(o);const u=[];u.push([e[0]+o[0]*c,e[1]+o[1]*c]),u.push([e[0]-o[0]*c,e[1]-o[1]*c]),s.push(u);break}case i.GeometricEffectControlMeasureLineRule.TriplePerpendicular:{const t=this._cp2(h,0,-1),e=this._cp3(h,t,.5,4),i=this._mid(r,t),o=this._sub(i,e);this._normalize(o);const c=this._crossProduct(o,this._sub(r,e));this._leftPerpendicular(o);const u=[];u.push([e[0]+o[0]*c*.8,e[1]+o[1]*c*.8]),u.push([i[0]+.8*(r[0]-i[0]),i[1]+.8*(r[1]-i[1])]),s.push(u),s.push([e,i]);const n=[];n.push([e[0]-o[0]*c*.8,e[1]-o[1]*c*.8]),n.push([i[0]+.8*(t[0]-i[0]),i[1]+.8*(t[1]-i[1])]),s.push(n);break}case i.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:{const t=this._cp2(h,0,-1),e=this._cp3(h,t,.5,4),i=this._mid(r,t);let o=this._sub(t,r);const c=Math.cos(Math.PI/18),u=Math.sin(Math.PI/18),n=Math.sqrt((1+c)/2),_=Math.sqrt((1-c)/2),a=[];let l;this._crossProduct(o,this._sub(e,r))>0?(a.push(r),o=this._sub(r,i),l=t):(a.push(t),o=this._sub(t,i),l=r),this._rotateDirect(o,n,_),o[0]/=n,o[1]/=n;for(let s=1;s<=18;s++)a.push(this._add(i,o)),this._rotateDirect(o,c,u);a.push(l),s.push(a);break}case i.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:{const t=this._cp2(h,0,-1),e=this._cp3(h,t,1,-1);let i=this._sub(r,t);this._normalize(i);const o=this._crossProduct(i,this._sub(e,t))/2;this._leftPerpendicular(i);const c=[t[0]+i[0]*o,t[1]+i[1]*o];i=this._sub(t,c);const u=Math.cos(Math.PI/18);let n=Math.sin(Math.PI/18);o>0&&(n=-n);const _=[t];for(let s=1;s<=18;s++)this._rotateDirect(i,u,n),_.push(this._add(c,i));s.push(_);break}case i.GeometricEffectControlMeasureLineRule.HalfCircleExtended:{const e=this._cp2(h,0,-2),i=this._cp3(h,e,1,-1);let o;if(t>=4)o=h[3];else{const t=this._sub(r,e);o=this._add(i,t)}const c=this._dist(e,i)/2/.75,u=this._sub(e,r);this._normalize(u,c);const n=this._sub(i,o);this._normalize(n,c);const _=[o,i];s.push(_);const a=[this._clone(i)];this._addBezier3(a,i,this._add(i,n),this._add(e,u),e,4),a.push(r),s.push(a);break}case i.GeometricEffectControlMeasureLineRule.OpenCircle:{const t=this._cp2(h,-2,0),e=this._sub(t,r),i=Math.cos(Math.PI/18),o=-Math.sin(Math.PI/18),c=[t];for(let s=1;s<=33;s++)this._rotateDirect(e,i,o),c.push(this._add(r,e));s.push(c);break}case i.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:{const e=this._cp2(h,0,-1);let i,o;if(t>=3)i=h[2];else{const t=this._sub(e,r),s=this._leftPerp(t);i=[r[0]+s[0]-.25*t[0],r[1]+s[1]-.25*t[1]]}if(t>=4)o=h[3];else{const t=this._mid(r,e),s=this._sub(r,e);this._normalize(s),this._leftPerpendicular(s);const h=this._crossProduct(s,this._sub(i,t));this._rightPerpendicular(s),o=[i[0]+s[0]*h*2,i[1]+s[1]*h*2]}const c=this._sub(e,r);let u,n;u=this._crossProduct(c,this._sub(i,r))>0?this._rightPerp(c):this._leftPerp(c),n=[],n.push(i),n.push(r),n.push([r[0]+(u[0]-c[0])/3,r[1]+(u[1]-c[1])/3]),s.push(n),u=this._crossProduct(c,this._sub(o,e))>0?this._rightPerp(u):this._leftPerp(c),n=[],n.push([e[0]+(u[0]+c[0])/3,e[1]+(u[1]+c[1])/3]),n.push(e),n.push(o),s.push(n);break}case i.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:{const e=this._cp2(h,0,2),i=this._cp3(h,e,0,1);let o;if(t>=4)o=h[3];else{const t=this._sub(e,r);o=this._add(i,t)}this._addAngledTicks(s,r,e,this._mid(i,o)),this._addAngledTicks(s,i,o,this._mid(r,e));break}case i.GeometricEffectControlMeasureLineRule.GapExtentMidline:{const e=this._cp2(h,2,0),i=this._cp3(h,e,0,1);let o;if(t>=4)o=h[3];else{const t=this._sub(e,r);o=this._add(i,t)}const c=[];c.push(this._mid(r,i)),c.push(this._mid(e,o)),s.push(c);break}case i.GeometricEffectControlMeasureLineRule.Chevron:{const e=this._cp2(h,-1,-1);let i;if(t>=3)i=h[2];else{const t=this._sub(e,r);this._leftPerpendicular(t),i=this._add(r,t)}s.push([e,this._makeCtrlPt(r),i]);break}case i.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:{const t=this._cp2(h,0,-2),e=this._cp3(h,t,.5,-1);let i=this._sub(t,r);const o=this._norm(i);i[0]/=o,i[1]/=o;const c=this._crossProduct(i,this._sub(e,r));let u=this._dotProduct(i,this._sub(e,r));u<.05*o?u=.05*o:u>.95*o&&(u=.95*o);const n=[r[0]+i[0]*u,r[1]+i[1]*u];this._leftPerpendicular(i);let _=[];_.push([n[0]-i[0]*c,n[1]-i[1]*c]),_.push([n[0]+i[0]*c,n[1]+i[1]*c]),s.push(_);const a=[t[0]+i[0]*c,t[1]+i[1]*c];i=this._sub(t,a);const l=Math.cos(Math.PI/18);let p=Math.sin(Math.PI/18);c<0&&(p=-p),_=[r,t];for(let s=1;s<=9;s++)this._rotateDirect(i,l,p),_.push(this._add(a,i));s.push(_);break}case i.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:{const t=this._cp2(h,2,0),e=this._mid(r,t),i=this._sub(t,e),o=Math.cos(Math.PI/18),c=Math.sin(Math.PI/18),u=[r,t];for(let s=1;s<=18;s++)this._rotateDirect(i,o,c),u.push(this._add(e,i));s.push(u);break}case i.GeometricEffectControlMeasureLineRule.TripleParallelExtended:{const t=this._cp2(h,0,-2),i=this._cp3(h,t,1,-2),o=this._mid(r,t),c=this._sub(i,t);this._normalize(c);const u=Math.abs(this._crossProduct(c,this._sub(o,t)))/2,n=this._dist(t,i),_=[t,r];_.push([r[0]+c[0]*n*.5,r[1]+c[1]*n*.5]),s.push(_);const a=[];a.push([o[0]-c[0]*u,o[1]-c[1]*u]),a.push([o[0]+c[0]*n*.375,o[1]+c[1]*n*.375]),e.setId(a[a.length-1],1),a.push([o[0]+c[0]*n*.75,o[1]+c[1]*n*.75]),s.push(a);const l=[t,i];s.push(l);break}case i.GeometricEffectControlMeasureLineRule.ParallelWithTicks:{const t=this._cp2(h,3,0),e=this._cp3(h,t,.5,-1),i=this._sub(e,t);this._normalize(i);const o=this._crossProduct(i,this._sub(e,r));this._leftPerpendicular(i),this._addAngledTicks(s,r,t,e),this._addAngledTicks(s,this._mix(r,1,i,o),this._mix(t,1,i,o),this._mid(r,t));break}case i.GeometricEffectControlMeasureLineRule.Parallel:{const t=this._cp2(h,3,0),e=this._cp3(h,t,.5,-1),i=this._sub(t,r);this._normalize(i);const o=this._leftPerp(i),c=this._crossProduct(i,this._sub(e,r));let u=[r,t];s.push(u),u=[],u.push([r[0]+o[0]*c,r[1]+o[1]*c]),u.push([t[0]+o[0]*c,t[1]+o[1]*c]),s.push(u);break}case i.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:{const t=this._cp2(h,3,0),e=this._cp3(h,t,.5,-1),i=this._mid(r,t),o=this._sub(t,r);this._normalize(o);const c=this._crossProduct(o,this._sub(e,r));this._leftPerpendicular(o);const u=[];u.push([i[0]-o[0]*c*.25,i[1]-o[1]*c*.25]),u.push([i[0]+o[0]*c*1.25,i[1]+o[1]*c*1.25]),s.push(u);break}case i.GeometricEffectControlMeasureLineRule.ParallelOffset:{const t=this._cp2(h,3,0),e=this._cp3(h,t,.5,-1),i=this._sub(t,r);this._normalize(i);const o=this._crossProduct(i,this._sub(e,r));this._leftPerpendicular(i);const c=[];c.push([r[0]-i[0]*o,r[1]-i[1]*o]),c.push([t[0]-i[0]*o,t[1]-i[1]*o]),s.push(c);const u=[];u.push([r[0]+i[0]*o,r[1]+i[1]*o]),u.push([t[0]+i[0]*o,t[1]+i[1]*o]),s.push(u);break}case i.GeometricEffectControlMeasureLineRule.OffsetOpposite:{const t=this._cp2(h,3,0),e=this._cp3(h,t,.5,-1),i=this._sub(t,r);this._normalize(i);const o=this._crossProduct(i,this._sub(e,r));this._leftPerpendicular(i);const c=[];c.push([r[0]-i[0]*o,r[1]-i[1]*o]),c.push([t[0]-i[0]*o,t[1]-i[1]*o]),s.push(c);break}case i.GeometricEffectControlMeasureLineRule.OffsetSame:{const t=this._cp2(h,3,0),e=this._cp3(h,t,.5,-1),i=this._sub(t,r);this._normalize(i);const o=this._crossProduct(i,this._sub(e,r));this._leftPerpendicular(i);const c=[];c.push([r[0]+i[0]*o,r[1]+i[1]*o]),c.push([t[0]+i[0]*o,t[1]+i[1]*o]),s.push(c);break}case i.GeometricEffectControlMeasureLineRule.CircleWithArc:{let i=this._cp2(h,3,0);const o=this._cp3(h,i,.5,-1);let c,u;if(t>=4)c=h[3],u=this._crossProduct(this._sub(c,i),this._sub(o,i))>0;else{c=i,u=this._crossProduct(this._sub(c,r),this._sub(o,r))>0;const t=24*this._geomUnitsPerPoint,s=this._sub(c,r);this._normalize(s,t);const e=Math.sqrt(2)/2;this._rotateDirect(s,e,u?e:-e),i=this._add(r,s)}const n=this._sub(i,r),_=Math.cos(Math.PI/18),a=Math.sin(Math.PI/18),l=[i];for(let t=1;t<=36;t++)this._rotateDirect(n,_,a),l.push(this._add(r,n));this._add90DegArc(l,i,c,o,u),e.setId(l[l.length-8],1),s.push(l);break}case i.GeometricEffectControlMeasureLineRule.DoubleJog:{let e,i,o=this._cp2(h,-3,1);if(e=t>=3?h[2]:this._add(r,this._sub(r,o)),t>=4)i=h[3];else{const t=r;r=o,i=e;const s=this._dist(r,t),h=this._dist(i,t);let c=30*this._geomUnitsPerPoint;.5*s<c&&(c=.5*s),.5*h<c&&(c=.5*h),o=this._mix(r,c/s,t,(s-c)/s),e=this._mix(i,c/h,t,(h-c)/h)}const c=this._mid(r,o),u=this._mid(i,e),n=this._dist(r,o),_=this._dist(e,i);let a=Math.min(n,_)/8;a=Math.min(a,24*this._geomUnitsPerPoint);const l=Math.cos(Math.PI/4);let p=this._sub(r,o);this._normalize(p,a),this._crossProduct(p,this._sub(i,o))>0?this._rotateDirect(p,l,-l):this._rotateDirect(p,l,l);let d=[];d.push(o),d.push(this._add(c,p)),d.push(this._sub(c,p)),d.push(r),s.push(d),p=this._sub(i,e),this._normalize(p,a),this._crossProduct(p,this._sub(r,e))<0?this._rotateDirect(p,l,l):this._rotateDirect(p,l,-l),d=[],d.push(e),d.push(this._add(u,p)),d.push(this._sub(u,p)),d.push(i),s.push(d);break}case i.GeometricEffectControlMeasureLineRule.PerpendicularOffset:{const t=this._cp2(h,-4,1),e=this._cp3(h,t,.882353,-1.94),i=this._sub(e,t);this._crossProduct(i,this._sub(r,t))>0?this._rightPerpendicular(i):this._leftPerpendicular(i);const o=[i[0]/8,i[1]/8],c=this._sub(this._mid(t,e),o);s.push([c,r]);break}case i.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:{const t=this._arrowPath(h),e=[];let i=t.length-2;for(;i--;)e.push(t[i]);s.push(e);break}case i.GeometricEffectControlMeasureLineRule.MultivertexArrow:{const t=this._arrowPath(h),e=[];this._addArrow(e,t,!1),s.push(e);break}case i.GeometricEffectControlMeasureLineRule.CrossedArrow:{const t=this._arrowPath(h),e=[];this._addArrow(e,t,!0),s.push(e);break}case i.GeometricEffectControlMeasureLineRule.ChevronArrow:{const[t,e]=this._arrowLastSeg(h),i=10*this._geomUnitsPerPoint,o=this._sub(r,t);this._normalize(o);const c=this._crossProduct(o,this._sub(e,t)),u=this._leftPerp(o),n=[e[0]-u[0]*c*2,e[1]-u[1]*c*2],_=[];_.push([e[0]+o[0]*i,e[1]+o[1]*i]),_.push(r),_.push([n[0]+o[0]*i,n[1]+o[1]*i]),s.push(_);break}case i.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:{const[t,e]=this._arrowLastSeg(h),i=this._sub(r,t);this._normalize(i);const o=this._crossProduct(i,this._sub(e,t));this._leftPerpendicular(i);const c=[e[0]-i[0]*o,e[1]-i[1]*o],u=[];u.push([c[0]+i[0]*o*.5,c[1]+i[1]*o*.5]),u.push(this._mid(c,r)),u.push([c[0]-i[0]*o*.5,c[1]-i[1]*o*.5]),s.push(u);break}case i.GeometricEffectControlMeasureLineRule.PartialFirstSegment:{const[t,e]=this._arrowLastSeg(h),i=this._sub(r,t);this._normalize(i);const o=this._crossProduct(i,this._sub(e,t));this._leftPerpendicular(i);const c=[e[0]-i[0]*o,e[1]-i[1]*o];s.push([t,c]);break}case i.GeometricEffectControlMeasureLineRule.Arch:{const t=this._cp2(h,0,-1),e=this._cp3(h,t,.5,1),i=this._sub(r,t),o=this._mix(e,1,i,.55),c=this._mix(e,1,i,-.55),u=[r];this._addBezier2(u,r,o,e,4),this._addBezier2(u,e,c,t,4),s.push(u);break}case i.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:{const t=this._cp2(h,-4,1),e=this._cp3(h,t,.882353,-1.94),i=this._sub(e,t);this._crossProduct(i,this._sub(r,t))>0?this._rightPerpendicular(i):this._leftPerpendicular(i);const o=[i[0]/8,i[1]/8],c=this._sub(this._mid(t,e),o),u=this._sub(this._mix(t,.75,e,.25),o),n=this._sub(this._mix(t,.25,e,.75),o),_=[t];this._addBezier2(_,t,u,c,3),this._addBezier2(_,c,n,e,3),s.push(_);for(let h=0;h<8;h++){const t=_[2*h+1],e=[this._clone(t)];e.push(this._add(t,[i[0]/4,i[1]/4])),s.push(e)}break}case i.GeometricEffectControlMeasureLineRule.Arc90Degrees:{const t=this._cp2(h,0,-1),e=this._cp3(h,t,.5,1),i=[t];this._add90DegArc(i,t,r,e),s.push(i);break}case i.GeometricEffectControlMeasureLineRule.FullGeometry:default:s.push(h)}}return s},t}();t.EffectControlMeasureLine=h,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
