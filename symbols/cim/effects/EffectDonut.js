/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../geometry","../../../core/maybe","../../../geometry/support/jsonUtils","../CIMEffects","../enums","../../../geometry/SpatialReference"],(function(t,e,i,n,o,s,h){"use strict";let r=function(){function t(){}return t.local=function(){return null===t.instance&&(t.instance=new t),t.instance},t.prototype.execute=function(t,e,i,n,o){return new c(t,e,i,n,o)},t}();r.instance=null;let c=function(){function t(t,e,i,n,o){switch(this._inputGeometries=t,this._tileKey=n,this._geometryEngine=o,this._width=(void 0!==e.width?e.width:2)*i,e.method){case s.GeometricEffectDonutMethod.Mitered:case s.GeometricEffectDonutMethod.Bevelled:case s.GeometricEffectDonutMethod.Rounded:case s.GeometricEffectDonutMethod.TrueBuffer:case s.GeometricEffectDonutMethod.Square:}this._option=e.option}return t.prototype.next=function(){let t;for(;t=this._inputGeometries.next();){if(n.isExtent(t)&&this._width>0){if(Math.min(t.xmax-t.xmin,t.ymax-t.ymin)-2*this._width<0)return t;const e=[];return e.push([[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]),e.push([[t.xmin+this._width,t.ymin+this._width],[t.xmax-this._width,t.ymin+this._width],[t.xmax-this._width,t.ymax-this._width],[t.xmin+this._width,t.ymax-this._width],[t.xmin+this._width,t.ymin+this._width]]),{rings:e}}if(n.isPolygon(t)){let e=null;const n=this._geometryEngine;let s=t;if(this._tileKey&&(s=o.clipPolygonToTileExtent(t,Math.abs(this._width)+1),!s||!s.rings||0===s.rings.length))continue;if(i.isSome(n)&&(e=n.buffer(h.WebMercator,s,-this._width,1)),this._width>0){const i=[];for(const e of t.rings)e&&i.push(e);if(e)for(const t of e.rings)t&&i.push(t.reverse());if(i.length)return{rings:i}}}}return null},t}();t.EffectDonut=r,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
