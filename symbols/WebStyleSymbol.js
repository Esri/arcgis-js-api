/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/Logger","../core/maybe","../core/promiseUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/accessorSupport/decorators/enumeration","../core/accessorSupport/decorators/subclass","../portal/Portal","../chunks/persistableUrlUtils","./Symbol","./support/Thumbnail"],(function(e,t,r,o,l,s,n,c,i,a,p,y,u,h,m){"use strict";var d;let f=d=function(e){function r(t){var r;return(r=e.call(this,t)||this).styleName=null,r.portal=null,r.styleUrl=null,r.thumbnail=null,r.name=null,r.type="web-style",r}t._inheritsLoose(r,e);var n=r.prototype;return n.read=function(t,r){this.portal=r?.portal,e.prototype.read.call(this,t,r)},n.clone=function(){return new d({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})},n.fetchSymbol=function(e){return this._fetchSymbol("webRef",e)},n.fetchCIMSymbol=function(e){return this._fetchSymbol("cimRef",e)},n._fetchSymbol=function(){var e=t._asyncToGenerator((function*(e,t){const r=l.isSome(t)?t.cache:null,n=r?this._fetchCacheKey:null;if(l.isSome(r)){const e=n&&r.get(n);if(e)return e.clone()}const c=yield b();s.throwIfAborted(t);const i=c.resolveWebStyleSymbol(this,{portal:this.portal},e,t);i.catch((e=>{o.getLogger(this.declaredClass).error("#fetchSymbol()","Failed to create symbol from style",e)}));const a=yield i;return"webRef"===e&&"point-3d"===a.type||"cimRef"===e&&"cim"===a.type?(l.isSome(r)&&r.set(n,a.clone()),a):null}));function r(t,r){return e.apply(this,arguments)}return r}(),t._createClass(r,[{key:"_fetchCacheKey",get:function(){const e=l.isSome(this.portal)?this.portal:y.getDefault(),t=e.user?e.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${t}:${e.url}`}}]),r}(h);function b(){return new Promise(((t,r)=>e(["./support/webStyleSymbolUtils"],t,r)))}r.__decorate([n.property({json:{write:!1}})],f.prototype,"color",void 0),r.__decorate([n.property({type:String,json:{write:!0}})],f.prototype,"styleName",void 0),r.__decorate([n.property({type:y,json:{write:!1}})],f.prototype,"portal",void 0),r.__decorate([n.property({type:String,json:{read:u.read,write:u.write}})],f.prototype,"styleUrl",void 0),r.__decorate([n.property({type:m.Thumbnail,json:{read:!1}})],f.prototype,"thumbnail",void 0),r.__decorate([n.property({type:String,json:{write:!0}})],f.prototype,"name",void 0),r.__decorate([a.enumeration({styleSymbolReference:"web-style"},{readOnly:!0})],f.prototype,"type",void 0),r.__decorate([n.property()],f.prototype,"_fetchCacheKey",null),f=d=r.__decorate([p.subclass("esri.symbols.WebStyleSymbol")],f);return f}));
