/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../request","../../../tasks/operations/urlUtils"],(function(e,t,o,r){"use strict";function n(e,t){const o=e.toJSON();return o.objectIds&&(o.objectIds=o.objectIds.join(",")),o.orderByFields&&(o.orderByFields=o.orderByFields.join(",")),!o.outFields||null!=t&&t.returnCountOnly?delete o.outFields:-1!==o.outFields.indexOf("*")?o.outFields="*":o.outFields=o.outFields.join(","),o.outSpatialReference&&(o.outSR=o.outSR.wkid||JSON.stringify(o.outSR.toJSON()),delete o.outSpatialReference),o.dynamicDataSource&&(o.layer=JSON.stringify({source:o.dynamicDataSource}),delete o.dynamicDataSource),o}function u(e,t,o){return s.apply(this,arguments)}function s(){return(s=t._asyncToGenerator((function*(e,t,o){const r=yield c(e,t,o),n=r.data,u=n.geometryType,s=n.spatialReference,a={};for(const i of n.relatedRecordGroups){const e={fields:void 0,objectIdFieldName:void 0,geometryType:u,spatialReference:s,hasZ:!!n.hasZ,hasM:!!n.hasM,features:i.relatedRecords};if(null!=i.objectId)a[i.objectId]=e;else for(const t in i)i.hasOwnProperty(t)&&"relatedRecords"!==t&&(a[i[t]]=e)}return{...r,data:a}}))).apply(this,arguments)}function a(e,t,o){return i.apply(this,arguments)}function i(){return(i=t._asyncToGenerator((function*(e,t,o){const r=yield c(e,t,o,{returnCountOnly:!0}),n=r.data,u={};for(const s of n.relatedRecordGroups)null!=s.objectId&&(u[s.objectId]=s.count);return{...r,data:u}}))).apply(this,arguments)}function c(e,t){return l.apply(this,arguments)}function l(){return(l=t._asyncToGenerator((function*(e,t,u={},s){const a=r.mapParameters({...e.query,f:"json",...s,...n(t,s)});return o(e.path+"/queryRelatedRecords",{...u,query:{...u.query,...a}})}))).apply(this,arguments)}e.executeRelationshipQuery=u,e.executeRelationshipQueryForCount=a,e.toQueryStringParameters=n,Object.defineProperty(e,"__esModule",{value:!0})}));
