/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../kernel","../../../request","../../../core/urlUtils","../../operations/urlUtils","../support/AttachmentInfo"],(function(t,e,n,o,a,r,s){"use strict";function c(t){const e=t.toJSON();return e.attachmentTypes&&(e.attachmentTypes=e.attachmentTypes.join(",")),e.keywords&&(e.keywords=e.keywords.join(",")),e.globalIds&&(e.globalIds=e.globalIds.join(",")),e.objectIds&&(e.objectIds=e.objectIds.join(",")),e.size&&(e.size=e.size.join(",")),e}function u(t,e){const o={};for(const r of e){const{parentObjectId:e,parentGlobalId:c,attachmentInfos:u}=r;for(const r of u){const{id:u}=r,l=a.addProxy(n.addTokenParameter(`${t.path}/${e}/attachments/${u}`)),p=s.fromJSON(r);p.set({url:l,parentObjectId:e,parentGlobalId:c}),o[e]?o[e].push(p):o[e]=[p]}}return o}function l(t,e,n){let a={query:r.mapParameters({...t.query,f:"json",...c(e)})};return n&&(a={...n,...a,query:{...n.query,...a.query}}),o(t.path+"/queryAttachments",a).then((t=>t.data.attachmentGroups))}function p(t,e,n){return i.apply(this,arguments)}function i(){return(i=e._asyncToGenerator((function*(t,e,n){const{objectIds:a}=e,r=[];for(const s of a)r.push(o(t.path+"/"+s+"/attachments",n));return Promise.all(r).then((t=>a.map(((e,n)=>({parentObjectId:e,attachmentInfos:t[n].data.attachmentInfos})))))}))).apply(this,arguments)}t.executeAttachmentQuery=l,t.fetchAttachments=p,t.processAttachmentQueryResult=u,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
