/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../core/maybe","../request","../geometry/support/normalizeUtils","./utils","../tasks/support/ImageIdentifyResult"],(function(t,e,s,n,a,o){"use strict";async function i(t,s,o){const i=a.parseUrl(t),r=s.geometry?[s.geometry]:[],c=await n.normalizeCentralMeridian(r),u=s.toJSON();!function(t){const e=null==t?void 0:t.time;if(e&&(null!=e.start||null!=e.end)){const s=[];null!=e.start&&s.push(e.start),null!=e.end&&-1===s.indexOf(e.end)&&s.push(e.end),t.time=s.join(",")}}(u);const m=c&&c[0];e.isSome(m)&&(u.geometry=m.toJSON());const l=a.encode({...i.query,f:"json",...u});return a.asValidOptions(l,o)}t.computeHistograms=async function(t,e,n){const o=await i(t,e,n),r=a.parseUrl(t),{data:c}=await s(`${r.path}/computeHistograms`,o);return{histograms:c.histograms}},t.computeStatisticsHistograms=async function(t,e,n){const o=await i(t,e,n),r=a.parseUrl(t),{data:c}=await s(`${r.path}/computeStatisticsHistograms`,o),{statistics:u}=c;return null!=u&&u.length&&u.forEach((t=>{t.avg=t.mean,t.stddev=t.standardDeviation})),{statistics:u,histograms:c.histograms}},t.identify=async function(t,i,r){const c=a.parseUrl(t),u=i.geometry?[i.geometry]:[];return n.normalizeCentralMeridian(u).then((t=>{const n=i.toJSON(),o=t&&t[0];e.isSome(o)&&(n.geometry=JSON.stringify(o.toJSON()));const u=a.encode({...c.query,f:"json",...n}),m=a.asValidOptions(u,r);return s(c.path+"/identify",m)})).then((t=>o.fromJSON(t.data)))},Object.defineProperty(t,"__esModule",{value:!0})}));
