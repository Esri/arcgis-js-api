/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../request","../geometry/support/normalizeUtils","./utils","../core/queryUtils","./networkUtils","../tasks/support/ClosestFacilitySolveResult"],(function(e,r,t,i,s,a,n){"use strict";const o=s.createQueryParamsHelper({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,directionsTimeAttribute:{name:"directionsTimeAttributeName"},impedanceAttribute:{name:"impedanceAttributeName"},facilities:!0,incidents:!0,outSpatialReference:{name:"outSR",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},returnPointBarriers:{name:"returnBarriers"},returnRoutes:{name:"returnCFRoutes"},travelMode:!0});async function u(e,s,u){const l=[],c=[],f={},m={},p=i.parseUrl(e);return s.incidents&&s.incidents.features&&a.collectGeometries(s.incidents.features,c,"incidents.features",f),s.facilities&&s.facilities.features&&a.collectGeometries(s.facilities.features,c,"facilities.features",f),s.pointBarriers&&s.pointBarriers.features&&a.collectGeometries(s.pointBarriers.features,c,"pointBarriers.features",f),s.polylineBarriers&&s.polylineBarriers.features&&a.collectGeometries(s.polylineBarriers.features,c,"polylineBarriers.features",f),s.polygonBarriers&&s.polygonBarriers.features&&a.collectGeometries(s.polygonBarriers.features,c,"polygonBarriers.features",f),t.normalizeCentralMeridian(c).then((e=>{for(const r in f){const t=f[r];l.push(r),m[r]=e.slice(t[0],t[1])}return a.isInputGeometryZAware(m,l)?a.fetchServiceDescription(p.path):Promise.resolve({dontCheck:!0})})).then((e=>{("dontCheck"in e?e.dontCheck:e.hasZ)||a.dropZValuesOffInputGeometry(m,l);for(const r in m)m[r].forEach(((e,t)=>{s.get(r)[t].geometry=e}));let t={query:{...p.query,f:"json",...o.toQueryParams(s)}};return u&&(t={...u,...t}),r(`${p.path}/solveClosestFacility`,t)})).then((e=>n.fromJSON(e.data)))}e.solve=u,Object.defineProperty(e,"__esModule",{value:!0})}));
