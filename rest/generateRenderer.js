/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../chunks/_rollupPluginBabelHelpers","../request","../renderers/support/jsonUtils","./query/executeQuery","./utils","../kernel","../core/urlUtils","./query/support/AttachmentInfo","./support/AttachmentQuery","../geometry/Extent","../geometry/Geometry","../geometry/Multipoint","../geometry/Point","../geometry/Polygon","../geometry/Polyline","../geometry/support/normalizeUtils","../core/Error","../core/pbf","../core/unitUtils","../geometry/support/spatialReferenceUtils","./support/Query","../geometry","./support/FeatureSet","../layers/graphics/featureConversionUtils","./support/RelationshipQuery","./support/TopFeaturesQuery","./support/StatisticDefinition"],(function(e,t,n,r,i,l,s,o,a,u,c,p,f,y,m,g,d,h,S,V,k,b,x,v,q,O,R,T){"use strict";function U(e,t,n,r){return B.apply(this,arguments)}function B(){return(B=t._asyncToGenerator((function*(e,t,r,i){const s=l.parseUrl(e),{source:o,checkValueRange:a}=t,{classificationDefinition:u}=r,c={...r.toJSON(),f:"json"};let p=null;if(p="esri.tasks.support.ClassBreaksDefinition"===u.declaredClass?u.classificationField:u.attributeField,o){const e={source:o?.toJSON()};c.layer=JSON.stringify(e)}c.classificationDef&&(c.classificationDef=JSON.stringify(c.classificationDef));let f={query:c};i&&(f={...i,...f});const y={url:s.path,field:p,checkValueRange:a},m=s.path+"/generateRenderer";return n(m,f).then((e=>D(y,e)))}))).apply(this,arguments)}function D(e,t){const{field:n,checkValueRange:r,url:l}=e,s=t&&t.data;if(!s)return;if(!r){const e=F(s);return Promise.resolve(e)}const o=new T({statisticType:"min",onStatisticField:n}),a=new T({statisticType:"max",onStatisticField:n}),u=new b({outStatistics:[o,a]});return i.executeQuery(l,u).then((e=>{const t=e.features[0].attributes;let n=null,r=null;for(const i in t)0===i.toLowerCase().indexOf("min")?n=t[i]:r=t[i];return F(s,n,r)}))}function F(e,t,n){if("classBreaks"===e.type){const i=r.fromJSON(e);return{classBreaks:i.classBreakInfos.map(((e,r)=>(0===r&&null!=t&&(e.minValue=t),r===i.classBreakInfos.length-1&&null!=n&&(e.maxValue=n),{minValue:e.minValue,maxValue:e.maxValue,label:e.label}))),normalizationTotal:i.normalizationTotal}}return{uniqueValues:e.uniqueValueInfos.map(((r,i)=>(0===i&&null!=t&&(r.value=t),i===e.uniqueValueInfos.length-1&&null!=n&&(r.value=n),{count:r.count,value:r.value,label:r.label})))}}e.generateRenderer=U,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
