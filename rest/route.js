/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../request","../geometry/support/normalizeUtils","./utils","../core/queryUtils","./networkUtils"],(function(e,r,t,s,i,o){"use strict";const a=i.createQueryParamsHelper({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,directionsTimeAttribute:{name:"directionsTimeAttributeName"},impedanceAttribute:{name:"impedanceAttributeName"},outSpatialReference:{name:"outSR",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},stops:!0,travelMode:!0});async function n(e,i,n){const u=[],l=[],c={},p={},m=s.parseUrl(e);return i.stops&&i.stops.features&&o.collectGeometries(i.stops.features,l,"stops.features",c),i.pointBarriers&&i.pointBarriers.features&&o.collectGeometries(i.pointBarriers.features,l,"pointBarriers.features",c),i.polylineBarriers&&i.polylineBarriers.features&&o.collectGeometries(i.polylineBarriers.features,l,"polylineBarriers.features",c),i.polygonBarriers&&i.polygonBarriers.features&&o.collectGeometries(i.polygonBarriers.features,l,"polygonBarriers.features",c),t.normalizeCentralMeridian(l).then((e=>{for(const r in c){const t=c[r];u.push(r),p[r]=e.slice(t[0],t[1])}return o.isInputGeometryZAware(p,u)?o.fetchServiceDescription(m.path):Promise.resolve({dontCheck:!0})})).then((e=>{("dontCheck"in e?e.dontCheck:e.hasZ)||o.dropZValuesOffInputGeometry(p,u);for(const r in p)p[r].forEach(((e,t)=>{i.get(r)[t].geometry=e}));const t={...n,query:{...m.query,...a.toQueryParams(i),f:"json"}},{path:s}=m,l="/solve",c=s.endsWith(l)?s:s+l;return r(c,t)})).then((e=>o.handleSolveResponse(e)))}e.solve=n,Object.defineProperty(e,"__esModule",{value:!0})}));
