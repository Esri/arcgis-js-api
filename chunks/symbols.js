/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../core/accessorSupport/ensureType","../core/accessorSupport/extensions/serializableProperty/reader","../core/Error","../symbols/Symbol","../symbols/CIMSymbol","../symbols/Symbol3DLayer","../symbols/ExtrudeSymbol3DLayer","../symbols/SimpleLineSymbol","../symbols/FillSymbol","../symbols/FillSymbol3DLayer","../symbols/Font","../symbols/IconSymbol3DLayer","../symbols/LineSymbol3DLayer","../symbols/ObjectSymbol3DLayer","../symbols/PathSymbol3DLayer","../symbols/TextSymbol3DLayer","../symbols/WaterSymbol3DLayer","../symbols/Symbol3D","./LineCallout3DBorder","../symbols/callouts/LineCallout3D","../symbols/support/Symbol3DVerticalOffset","../symbols/LabelSymbol3D","../symbols/LineSymbol3D","../symbols/MarkerSymbol","../symbols/MeshSymbol3D","../symbols/PictureFillSymbol","../symbols/PictureMarkerSymbol","../symbols/PointSymbol3D","../symbols/PolygonSymbol3D","../symbols/SimpleFillSymbol","../symbols/SimpleMarkerSymbol","../symbols/TextSymbol","../symbols/WebStyleSymbol"],(function(e,s,l,o,r,y,t,m,n,i,b,p,a,c,u,d,f,S,D,w,L,k,x,g,M,h,C,T,P,F,I,O,W,v){"use strict";function R(e,s=!1,l=!1,r=!0){if(!e)return{symbol:null};let y;if(V(e)||e instanceof v)y=e.clone();else if("cim"===e.type)y=P.fromCIMSymbol(e);else if(e instanceof n)y=g.fromSimpleLineSymbol(e);else if(e instanceof O)y=P.fromSimpleMarkerSymbol(e);else if(e instanceof T)y=P.fromPictureMarkerSymbol(e);else if(e instanceof I)y=F.fromSimpleFillSymbol(e);else{if(!(e instanceof W))return{error:new o("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};y=r?x.fromTextSymbol(e):P.fromTextSymbol(e)}if(s&&(y.id=e.id),l&&V(y))for(let e=0;e<y.symbolLayers.length;++e)y.symbolLayers.getItemAt(e)._ignoreDrivers=!0;return{symbol:y}}function V(e){if(!e)return!1;switch(e.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const $={base:r,key:"type",typeMap:{"simple-fill":I,"picture-fill":C,"picture-marker":T,"simple-line":n,"simple-marker":O,text:W,"label-3d":x,"line-3d":g,"mesh-3d":h,"point-3d":P,"polygon-3d":F,"web-style":v,cim:y},errorContext:"symbol"},E=l.createTypeReader({types:$}),U={base:r,key:"type",typeMap:{"simple-fill":I,"picture-fill":C,"picture-marker":T,"simple-line":n,"simple-marker":O,text:W,"line-3d":g,"mesh-3d":h,"point-3d":P,"polygon-3d":F,"web-style":v,cim:y},errorContext:"symbol"},j={base:r,key:"type",typeMap:{text:W,"label-3d":x},errorContext:"symbol"},z={base:r,key:"type",typeMap:{"label-3d":x,"line-3d":g,"mesh-3d":h,"point-3d":P,"polygon-3d":F,"web-style":v},errorContext:"symbol"},A={base:r,key:"type",typeMap:{"line-3d":g,"mesh-3d":h,"point-3d":P,"polygon-3d":F,"web-style":v},errorContext:"symbol"},B={base:r,key:"type",typeMap:{"label-3d":x},errorContext:"symbol"},J=s.ensureOneOfType($);e.ensureType=J,e.fromJSON=function(e,s){return E(e,null,s)},e.isSymbol=function(e){return e instanceof r},e.isSymbol2D=function(e){if(!e)return!1;switch(e.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}},e.isSymbol3D=V,e.readSymbol=E,e.symbolTypes=$,e.symbolTypes3D=z,e.symbolTypesLabel=j,e.symbolTypesLabel3D=B,e.symbolTypesRenderer=U,e.symbolTypesRenderer3D=A,e.to3D=R,e.write=function(e,s,l,r){const y=function(e,s,l){if(!e)return null;if(l&&"web-scene"===l.origin&&!(e instanceof D)&&!(e instanceof v)){const r="cim"!==e.type?R(e):{symbol:null,error:new o("symbol-conversion:unsupported-cim-symbol","CIM symbol is unsupported in web scenes",{symbol:e})};return r.symbol?r.symbol.write(s,l):(l.messages&&l.messages.push(new o("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:l,error:r.error})),null)}if(l&&"web-map"===l.origin&&"web-style"===e.type)return l.messages&&l.messages.push(new o("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in webmaps. Use CIMSymbol instead when working with WebMap in MapView.`,{symbol:e,context:l})),null;return e.write(s,l)}(e,{},r);y&&(s[l]=y)}}));
