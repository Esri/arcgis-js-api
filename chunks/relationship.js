/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../core/lang","../Color","../smartMapping/symbology/support/symbologyUtils","../smartMapping/symbology/support/utils","../smartMapping/symbology/support/colors"],(function(e,o,r,a,l,n){"use strict";const s={light:{color:[153,153,153,.25],width:"1px"},dark:{color:[153,153,153,.25],width:"1px"},darker:{color:[26,26,26,.25],width:"1px"}},t={lightBasemaps:{primary:"relationship-blue-orange-brown",secondary:["relationship-brewer-yellow-blue-black","relationship-brewer-pink-blue-purple","relationship-purple-green-blue","relationship-blue-green-purple","relationship-blue-orange-green","relationship-mustard-blue-wine","relationship-pink-blue-purple","relationship-olive-blue-green","relationship-yellow-cyan-blue","relationship-blue-pink-purple","relationship-purple-green-wine","relationship-blue-peach-purple","relationship-mint-mustard-green","relationship-purple-mustard-darkpurple","relationship-blue-orange-purple","relationship-pink-periwinkle-violet","relationship-blue-tan-green","relationship-blue-red-pink","relationship-blue-green-brightgreen","relationship-blue-orange-lavender","relationship-pink-purple-peach","relationship-purple-mustard-eggshell","relationship-blue-brick-green","relationship-orange-purple-lavender","relationship-brown-purple-lilac","relationship-teal-yellow-lightteal"]},darkBasemaps:{primary:"relationship-blue-green-brightgreen",secondary:["relationship-blue-red-pink","relationship-blue-orange-lavender","relationship-pink-purple-peach","relationship-purple-mustard-eggshell","relationship-blue-brick-green","relationship-orange-purple-lavender","relationship-brown-purple-lilac","relationship-teal-yellow-lightteal","relationship-blue-orange-brown","relationship-brewer-yellow-blue-black","relationship-brewer-pink-blue-purple","relationship-purple-green-blue","relationship-blue-green-purple","relationship-blue-orange-green","relationship-mustard-blue-wine","relationship-pink-blue-purple","relationship-olive-blue-green","relationship-yellow-cyan-blue","relationship-blue-pink-purple","relationship-purple-green-wine","relationship-blue-peach-purple","relationship-mint-mustard-green","relationship-purple-mustard-darkpurple","relationship-blue-orange-purple","relationship-pink-periwinkle-violet","relationship-blue-tan-green"]}},i="#aaaaaa",p="8px",c="2px",u={default:{name:"default",label:"Default",description:"Default theme for visualizing features based on relationship between two attributes.",schemes:{point:{light:{common:{noDataColor:i,outline:s.light,size:p},primary:t.lightBasemaps.primary,secondary:t.lightBasemaps.secondary},dark:{common:{noDataColor:i,outline:s.darker,size:p},primary:t.darkBasemaps.primary,secondary:t.darkBasemaps.secondary}},polyline:{light:{common:{noDataColor:i,width:c},primary:t.lightBasemaps.primary,secondary:t.lightBasemaps.secondary},dark:{common:{noDataColor:i,width:c},primary:t.darkBasemaps.primary,secondary:t.darkBasemaps.secondary}},polygon:{light:{common:{noDataColor:i,outline:s.light,fillOpacity:.8},primary:t.lightBasemaps.primary,secondary:t.lightBasemaps.secondary},dark:{common:{noDataColor:i,outline:s.dark,fillOpacity:.8},primary:t.darkBasemaps.primary,secondary:t.darkBasemaps.secondary}}}}},m=a.createThemes({themeDictionary:u});function h(e){return a.getThemesforBasemap(m,e)}function g(e){const o="default",r=a.getRawSchemes({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme,theme:m.get(o)});if(!r)return;const{schemesInfo:l,basemapId:n,basemapTheme:s}=r,t={...e,basemap:n};return{primaryScheme:T(t,l.primary,l.common),secondarySchemes:l.secondary.map((e=>T(t,e,l.common))).filter(Boolean),basemapId:n,basemapTheme:s}}function d(e){return a.filterSchemesByName(e.name,g(e))}function y(e){return a.filterSchemesByTag(e.includedTags,e.excludedTags,g(e))}function b(e){if(!e)return;const o={...e};return o.colorsForClassBreaks=o.colorsForClassBreaks.map((e=>({numClasses:e.numClasses,colors:e.colors.map((e=>e.map((e=>new r(e)))))}))),o.noDataColor&&(o.noDataColor=new r(o.noDataColor)),"outline"in o&&o.outline&&(o.outline={color:o.outline.color&&new r(o.outline.color),width:o.outline.width}),o}function f(e,r){e=o.clone(e);let a=[];const l=(r||"HH").split(""),n=l[0],s=l[1];"L"===n&&e.reverse();const t="H"===s;return e.forEach((e=>{t&&e.reverse(),a=a.concat(e)})),a}function C(e,o,a){let l;return e.colorsForClassBreaks.some((e=>(e.numClasses===o&&(l=e.colors),!!l))),l=l.map((e=>e.map((e=>new r(e))))),l?f(l,a):null}function w(e,o){const r=o?e:b(e);return r.colorsForClassBreaks.forEach((e=>{const o=e.colors.reverse(),r=[];for(let a=0;a<e.numClasses;a++){const e=[];o.forEach((o=>{e.push(o[a])})),r.push(e)}e.colors=r})),r}function k(e){const o=e.theme||"default",r=e.geometryType,a=e.colors,l=e.numClasses,n=m.get(o);if(!n)return;const s=n.supportedBasemaps,t=[];return s.forEach((e=>{const n=g({theme:o,basemap:e,geometryType:r});if(n){let e=S(n.primaryScheme,a,l);e&&t.push(e),n.secondarySchemes.forEach((o=>{e=S(o,a,l),e&&t.push(e)}))}})),t}function B(e,o,r,a){let n;const s=C(e,r,a);if(s){1===l.hasIdenticalColors(o,s)&&(n=e)}return n}function D(e,o,r,a){let l,n=1;do{l=B(e,o,r,a),l||(e=w(e),n++)}while(!l&&n<=4);return l}function S(e,o,r){return D(e,o,r,"HH")||D(e,o,r,"HL")||D(e,o,r,"LH")||D(e,o,r,"LL")}function T(e,o,r){const a="mesh"!==e.geometryType&&e.worldScale?e.view:null,l=n[o],s=e.theme||"default";if(!l)return;const t=s+"/"+e.basemap+"/"+o,i=[];for(const n in l)if("stops"!==n&&"name"!==n&&"tags"!==n){const e=+n,o=l[n];i.push({numClasses:e,colors:o})}switch(e.geometryType){case"point":case"multipoint":{const e=r;return F({id:t,name:l.name,tags:l.tags,colorsForClassBreaks:i,noDataColor:e.noDataColor,opacity:1,outline:e.outline,size:e.size},a)}case"polyline":{const e=r;return v({id:t,name:l.name,tags:l.tags,colorsForClassBreaks:i,noDataColor:e.noDataColor,opacity:1,width:e.width},a)}case"polygon":{const e=r;return z({id:t,name:l.name,tags:l.tags,colorsForClassBreaks:i,noDataColor:e.noDataColor,opacity:e.fillOpacity,outline:e.outline})}case"mesh":{const e=r;return x({id:t,name:l.name,tags:l.tags,colorsForClassBreaks:i,noDataColor:e.noDataColor,opacity:e.fillOpacity})}}}function F(e,o){return{id:e.id,name:e.name,tags:[...e.tags],colorsForClassBreaks:H(e.colorsForClassBreaks),noDataColor:new r(e.noDataColor),outline:{color:new r(e.outline.color),width:e.outline.width},size:o?l.toWorldScale(e.size,o):e.size,opacity:e.opacity}}function v(e,o){return{id:e.id,name:e.name,tags:[...e.tags],colorsForClassBreaks:H(e.colorsForClassBreaks),noDataColor:new r(e.noDataColor),opacity:e.opacity,width:o?l.toWorldScale(e.width,o):e.width}}function z(e){return{id:e.id,name:e.name,tags:[...e.tags],colorsForClassBreaks:H(e.colorsForClassBreaks),noDataColor:new r(e.noDataColor),outline:{color:new r(e.outline.color),width:e.outline.width},opacity:e.opacity}}function x(e){return{id:e.id,name:e.name,tags:[...e.tags],colorsForClassBreaks:H(e.colorsForClassBreaks),noDataColor:new r(e.noDataColor),opacity:e.opacity}}function H(e){return e.map((e=>({numClasses:e.numClasses,colors:e.colors.map((e=>e.map((e=>new r(e)))))})))}var E=Object.freeze({__proto__:null,getThemes:h,getSchemes:g,getSchemeByName:d,getSchemesByTag:y,cloneScheme:b,flatten2DArray:f,getColors:C,flipColors:w,getMatchingSchemes:k});e.cloneScheme=b,e.flatten2DArray=f,e.flipColors=w,e.getColors=C,e.getMatchingSchemes=k,e.getSchemeByName=d,e.getSchemes=g,e.getSchemesByTag=y,e.getThemes=h,e.relationshipSymbology=E}));
