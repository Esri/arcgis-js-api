/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["require","exports","./_rollupPluginBabelHelpers","../core/has","../core/promiseUtils","../assets"],(function(e,t,_,o,n,r){"use strict";let p;function P(){return!!t._pe}function s(){return!!o("esri-wasm")}function i(){return p||(p=n.create(((t,_)=>{new Promise((function(t,_){e(["./pe-wasm"],t,_)})).then((function(e){return e.peWasm})).then((({default:e})=>{e({locateFile:e=>r.getAssetUrl(`esri/geometry/support/${e}`),onAbort:e=>{_(new Error(e))}}).then((e=>{f(e),t()}))}))})),p)}var E,u,a,c;function f(e){function o(e,t,_){e[t]=_(e[t])}t._pe=e,t.PeDefs.init(),t.PeGTlistExtended.init(),t.PeNotationMgrs.init(),t.PeNotationUtm.init(),t.PePCSInfo.init(),t.PeGCSExtent=function(e){function o(){return e.apply(this,arguments)||this}return _._inheritsLoose(o,e),o.prototype.destroy=function(){t._pe.destroy(this)},o}(t._pe.PeGCSExtent);const n=[t._pe.PeDatum,t._pe.PeGeogcs,t._pe.PeGeogtran,t._pe.PeObject,t._pe.PeParameter,t._pe.PePrimem,t._pe.PeProjcs,t._pe.PeSpheroid,t._pe.PeUnit];for(const e of n)o(e.prototype,"getName",(e=>function(){return e.call(this,new Array(t.PeDefs.PE_NAME_MAX))}));for(const e of[t._pe.PeGeogtran,t._pe.PeProjcs])o(e.prototype,"getParameters",(e=>function(){const _=new Array(t.PeDefs.PE_PARM_MAX);let o=e.call(this);for(let e=0;e<_.length;e++){const n=t._pe.getValue(o,"*");_[e]=n?t._pe.wrapPointer(n,t._pe.PeParameter):null,o+=Int32Array.BYTES_PER_ELEMENT}return _}));o(t._pe.PeHorizon.prototype,"getCoord",(e=>function(){const t=this.getSize();if(!t)return null;const _=[];return l(_,t,e.call(this)),_})),o(t._pe.PeGTlistExtendedEntry.prototype,"getEntries",(e=>{const _=t._pe._pe_getPeGTlistExtendedGTsSize();return function(){let o=null;const n=e.call(this);if(!t._pe.compare(n,t._pe.NULL)){o=[n];const e=this.getSteps();if(e>1){const r=t._pe.getPointer(n);for(let n=1;n<e;n++)o.push(t._pe.wrapPointer(r+_*n,t._pe.PeGTlistExtendedGTs))}}return o}}));const r=t._pe._pe_getPeHorizonSize(),p=e=>function(){let _=this._cache;if(_||(_=new Map,this._cache=_),_.has(e))return _.get(e);let o=null;const n=e.call(this);if(!t._pe.compare(n,t._pe.NULL)){o=[n];const e=n.getNump();if(e>1){const _=t._pe.getPointer(n);for(let n=1;n<e;n++)o.push(t._pe.wrapPointer(_+r*n,t._pe.PeHorizon))}}return _.set(e,o),o};o(t._pe.PeProjcs.prototype,"horizonGcsGenerate",p),o(t._pe.PeProjcs.prototype,"horizonPcsGenerate",p),t._pe.PeObject.prototype.toString=function(e=t.PeDefs.PE_STR_OPTS_NONE){t._pe.ensureCache.prepare();const _=t._pe.getPointer(this),o=t._pe.ensureInt8(new Array(t.PeDefs.PE_BUFFER_MAX));return t._pe.UTF8ToString(t._pe._pe_object_to_string_ext(_,e,o))}}function g(e){if(!e)return;const _=t._pe.getClass(e);if(!_)return;const o=t._pe.getCache(_);if(!o)return;const n=t._pe.getPointer(e);n&&delete o[n]}function T(e,_){const o=[],n=new Array(_);for(let _=0;_<e;_++)o.push(t._pe.ensureInt8(n));return o}function S(e){let t;return Array.isArray(e[0])?(t=[],e.forEach((e=>{t.push(e[0],e[1])}))):t=e,t}function l(e,_,o,n=!1){if(n)for(let n=0;n<2*_;n++)e[n]=t._pe.getValue(o+n*Float64Array.BYTES_PER_ELEMENT,"double");else{const n=0===e.length;for(let r=0;r<_;r++)n&&(e[r]=new Array(2)),e[r][0]=t._pe.getValue(o,"double"),e[r][1]=t._pe.getValue(o+Float64Array.BYTES_PER_ELEMENT,"double"),o+=2*Float64Array.BYTES_PER_ELEMENT}}t._pe=null,function(e){function _(e,_,o){t._pe.ensureCache.prepare();const n=S(o),r=o===n,p=t._pe.ensureFloat64(n),P=t._pe._pe_geog_to_proj(t._pe.getPointer(e),_,p);return P&&l(o,_,p,r),P}function o(e,t,_){return n(e,t,_,0)}function n(e,_,o,n){t._pe.ensureCache.prepare();const r=S(o),p=o===r,P=t._pe.ensureFloat64(r),s=t._pe._pe_proj_to_geog_center(t._pe.getPointer(e),_,P,n);return s&&l(o,_,P,p),s}e.geogToProj=_,e.projGeog=function(e,n,r,p){switch(p){case t.PeDefs.PE_TRANSFORM_P_TO_G:return o(e,n,r);case t.PeDefs.PE_TRANSFORM_G_TO_P:return _(e,n,r)}return 0},e.projToGeog=o,e.projToGeogCenter=n}(t.PeCSTransformations||(t.PeCSTransformations={})),(E=t.PeDefs||(t.PeDefs={})).init=function(){E.PE_BUFFER_MAX=t._pe.PeDefs.prototype.PE_BUFFER_MAX,E.PE_NAME_MAX=t._pe.PeDefs.prototype.PE_NAME_MAX,E.PE_MGRS_MAX=t._pe.PeDefs.prototype.PE_MGRS_MAX,E.PE_USNG_MAX=t._pe.PeDefs.prototype.PE_USNG_MAX,E.PE_DD_MAX=t._pe.PeDefs.prototype.PE_DD_MAX,E.PE_DDM_MAX=t._pe.PeDefs.prototype.PE_DDM_MAX,E.PE_DMS_MAX=t._pe.PeDefs.prototype.PE_DMS_MAX,E.PE_UTM_MAX=t._pe.PeDefs.prototype.PE_UTM_MAX,E.PE_PARM_MAX=t._pe.PeDefs.prototype.PE_PARM_MAX,E.PE_TYPE_NONE=t._pe.PeDefs.prototype.PE_TYPE_NONE,E.PE_TYPE_GEOGCS=t._pe.PeDefs.prototype.PE_TYPE_GEOGCS,E.PE_TYPE_PROJCS=t._pe.PeDefs.prototype.PE_TYPE_PROJCS,E.PE_TYPE_GEOGTRAN=t._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN,E.PE_TYPE_COORDSYS=t._pe.PeDefs.prototype.PE_TYPE_COORDSYS,E.PE_TYPE_UNIT=t._pe.PeDefs.prototype.PE_TYPE_UNIT,E.PE_STR_OPTS_NONE=t._pe.PeDefs.prototype.PE_STR_OPTS_NONE,E.PE_STR_AUTH_NONE=t._pe.PeDefs.prototype.PE_STR_AUTH_NONE,E.PE_STR_AUTH_TOP=t._pe.PeDefs.prototype.PE_STR_AUTH_TOP,E.PE_STR_NAME_CANON=t._pe.PeDefs.prototype.PE_STR_NAME_CANON,E.PE_PARM_X0=t._pe.PeDefs.prototype.PE_PARM_X0,E.PE_PARM_ND=t._pe.PeDefs.prototype.PE_PARM_ND,E.PE_TRANSFORM_1_TO_2=t._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2,E.PE_TRANSFORM_2_TO_1=t._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1,E.PE_TRANSFORM_P_TO_G=t._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G,E.PE_TRANSFORM_G_TO_P=t._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P,E.PE_HORIZON_RECT=t._pe.PeDefs.prototype.PE_HORIZON_RECT,E.PE_HORIZON_POLY=t._pe.PeDefs.prototype.PE_HORIZON_POLY,E.PE_HORIZON_LINE=t._pe.PeDefs.prototype.PE_HORIZON_LINE,E.PE_HORIZON_DELTA=t._pe.PeDefs.prototype.PE_HORIZON_DELTA},function(e){const _={},o={};function n(e,o){let n=null,p=_[e];if(p||(p={},_[e]=p),p.hasOwnProperty(String(o)))n=p[o];else{const _=t._pe.PeFactory.prototype.factoryByType(e,o);t._pe.compare(_,t._pe.NULL)||(n=_,p[o]=n)}return n=r(n),n}function r(e){if(e){const _=e.getType();switch(_){case t.PeDefs.PE_TYPE_GEOGCS:e=t._pe.castObject(e,t._pe.PeGeogcs);break;case t.PeDefs.PE_TYPE_PROJCS:e=t._pe.castObject(e,t._pe.PeProjcs);break;case t.PeDefs.PE_TYPE_GEOGTRAN:e=t._pe.castObject(e,t._pe.PeGeogtran);break;default:_&t.PeDefs.PE_TYPE_UNIT&&(e=t._pe.castObject(e,t._pe.PeUnit))}}return e}e.initialize=function(){t._pe.PeFactory.prototype.initialize(null)},e.coordsys=function(e){return n(t.PeDefs.PE_TYPE_COORDSYS,e)},e.factoryByType=n,e.fromString=function(e,_){let n=null,p=o[e];if(p||(p={},o[e]=p),p.hasOwnProperty(_))n=p[_];else{const o=t._pe.PeFactory.prototype.fromString(e,_);t._pe.compare(o,t._pe.NULL)||(n=o,p[_]=n)}return n=r(n),n},e.geogcs=function(e){return n(t.PeDefs.PE_TYPE_GEOGCS,e)},e.geogtran=function(e){return n(t.PeDefs.PE_TYPE_GEOGTRAN,e)},e.getCode=function(e){return t._pe.PeFactory.prototype.getCode(e)},e.projcs=function(e){return n(t.PeDefs.PE_TYPE_PROJCS,e)},e.unit=function(e){return n(t.PeDefs.PE_TYPE_UNIT,e)}}(t.PeFactory||(t.PeFactory={})),t.PeGCSExtent=null,function(e){let _;e.init=function(){e.PE_GTLIST_OPTS_COMMON=t._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,_=t._pe._pe_getPeGTlistExtendedEntrySize()},e.getGTlist=function(e,o,n,r,p,P){let s=null;const i=new t._pe.PeInteger(P);try{const E=t._pe.PeGTlistExtended.prototype.getGTlist(e,o,n,r,p,i);if((P=i.val)&&(s=[E],P>1)){const e=t._pe.getPointer(E);for(let o=1;o<P;o++)s.push(t._pe.wrapPointer(e+_*o,t._pe.PeGTlistExtendedEntry))}}finally{t._pe.destroy(i)}return s}}(t.PeGTlistExtended||(t.PeGTlistExtended={})),(t.PeGTlistExtendedEntry||(t.PeGTlistExtendedEntry={})).destroy=function(e){if(e&&e.length){for(const t of e)g(t),t.getEntries().forEach((e=>{g(e);const t=e.getGeogtran();g(t),t.getParameters().forEach(g),[t.getGeogcs1(),t.getGeogcs2()].forEach((e=>{g(e);const t=e.getDatum();g(t),g(t.getSpheroid()),g(e.getPrimem()),g(e.getUnit())}))}));t._pe.PeGTlistExtendedEntry.prototype.Delete(e[0])}},(t.PeGTTransformations||(t.PeGTTransformations={})).geogToGeog=function(e,_,o,n,r){t._pe.ensureCache.prepare();const p=S(o),P=o===p,s=t._pe.ensureFloat64(p);let i=0;n&&(i=t._pe.ensureFloat64(n));const E=t._pe._pe_geog_to_geog(t._pe.getPointer(e),_,s,i,r);return E&&l(o,_,s,P),E},function(e){function _(e,_,o,n,r,p){let P,s;switch(t._pe.ensureCache.prepare(),e){case"dd":P=t._pe._pe_geog_to_dd,s=t.PeDefs.PE_DD_MAX;break;case"ddm":P=t._pe._pe_geog_to_ddm,s=t.PeDefs.PE_DDM_MAX;break;case"dms":P=t._pe._pe_geog_to_dms,s=t.PeDefs.PE_DMS_MAX}let i=0;_&&(i=t._pe.getPointer(_));const E=S(n),u=t._pe.ensureFloat64(E),a=T(o,s),c=P(i,o,u,r,t._pe.ensureInt32(a));if(c)for(let e=0;e<o;e++)p[e]=t._pe.UTF8ToString(a[e]);return c}function o(e,_,o,n,r){let p;switch(t._pe.ensureCache.prepare(),e){case"dd":p=t._pe._pe_dd_to_geog;break;case"ddm":p=t._pe._pe_ddm_to_geog;break;case"dms":p=t._pe._pe_dms_to_geog}let P=0;_&&(P=t._pe.getPointer(_));const s=n.map((e=>t._pe.ensureString(e))),i=t._pe.ensureInt32(s),E=t._pe.ensureFloat64(new Array(2*o)),u=p(P,o,i,E);return u&&l(r,o,E),u}e.geog_to_dms=function(e,t,o,n,r){return _("dms",e,t,o,n,r)},e.dms_to_geog=function(e,t,_,n){return o("dms",e,t,_,n)},e.geog_to_ddm=function(e,t,o,n,r){return _("ddm",e,t,o,n,r)},e.ddm_to_geog=function(e,t,_,n){return o("ddm",e,t,_,n)},e.geog_to_dd=function(e,t,o,n,r){return _("dd",e,t,o,n,r)},e.dd_to_geog=function(e,t,_,n){return o("dd",e,t,_,n)}}(t.PeNotationDms||(t.PeNotationDms={})),(u=t.PeNotationMgrs||(t.PeNotationMgrs={})).init=function(){u.PE_MGRS_STYLE_NEW=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,u.PE_MGRS_STYLE_OLD=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,u.PE_MGRS_STYLE_AUTO=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,u.PE_MGRS_180_ZONE_1_PLUS=t._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,u.PE_MGRS_ADD_SPACES=t._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES},u.geog_to_mgrs_extended=function(e,_,o,n,r,p,P){t._pe.ensureCache.prepare();let s=0;e&&(s=t._pe.getPointer(e));const i=S(o),E=t._pe.ensureFloat64(i),u=T(_,t.PeDefs.PE_MGRS_MAX),a=t._pe.ensureInt32(u),c=t._pe._pe_geog_to_mgrs_extended(s,_,E,n,r,p,a);if(c)for(let e=0;e<_;e++)P[e]=t._pe.UTF8ToString(u[e]);return c},u.mgrs_to_geog_extended=function(e,_,o,n,r){t._pe.ensureCache.prepare();let p=0;e&&(p=t._pe.getPointer(e));const P=o.map((e=>t._pe.ensureString(e))),s=t._pe.ensureInt32(P),i=t._pe.ensureFloat64(new Array(2*_)),E=t._pe._pe_mgrs_to_geog_extended(p,_,s,n,i);return E&&l(r,_,i),E},(a=t.PeNotationUsng||(t.PeNotationUsng={})).geog_to_usng=function(e,_,o,n,r,p,P){t._pe.ensureCache.prepare();let s=0;e&&(s=t._pe.getPointer(e));const i=S(o),E=t._pe.ensureFloat64(i),u=T(_,t.PeDefs.PE_MGRS_MAX),a=t._pe.ensureInt32(u),c=t._pe._pe_geog_to_usng(s,_,E,n,r,p,a);if(c)for(let e=0;e<_;e++)P[e]=t._pe.UTF8ToString(u[e]);return c},a.usng_to_geog=function(e,_,o,n){t._pe.ensureCache.prepare();let r=0;e&&(r=t._pe.getPointer(e));const p=o.map((e=>t._pe.ensureString(e))),P=t._pe.ensureInt32(p),s=t._pe.ensureFloat64(new Array(2*_)),i=t._pe._pe_usng_to_geog(r,_,P,s);return i&&l(n,_,s),i},(c=t.PeNotationUtm||(t.PeNotationUtm={})).init=function(){c.PE_UTM_OPTS_NONE=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,c.PE_UTM_OPTS_ADD_SPACES=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,c.PE_UTM_OPTS_NS=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS},c.geog_to_utm=function(e,_,o,n,r){t._pe.ensureCache.prepare();let p=0;e&&(p=t._pe.getPointer(e));const P=S(o),s=t._pe.ensureFloat64(P),i=T(_,t.PeDefs.PE_UTM_MAX),E=t._pe.ensureInt32(i),u=t._pe._pe_geog_to_utm(p,_,s,n,E);if(u)for(let e=0;e<_;e++)r[e]=t._pe.UTF8ToString(i[e]);return u},c.utm_to_geog=function(e,_,o,n,r){t._pe.ensureCache.prepare();let p=0;e&&(p=t._pe.getPointer(e));const P=o.map((e=>t._pe.ensureString(e))),s=t._pe.ensureInt32(P),i=t._pe.ensureFloat64(new Array(2*_)),E=t._pe._pe_utm_to_geog(p,_,s,n,i);return E&&l(r,_,i),E},function(e){const _=new Map;e.init=function(){e.PE_PCSINFO_OPTION_NONE=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=t._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=t._pe.PePCSInfo.prototype.PE_POLE_POINT},e.generate=function(o,n=e.PE_PCSINFO_OPTION_DOMAIN){let r,p;return _.has(o)&&(p=_.get(o),p[n]&&(r=p[n])),r||(r=t._pe.PePCSInfo.prototype.generate(o,n),p||(p=[],_.set(o,p)),p[n]=r),r}}(t.PePCSInfo||(t.PePCSInfo={})),(t.PeVersion||(t.PeVersion={})).version_string=function(){return t._pe.PeVersion.prototype.version_string()};var O=Object.freeze({__proto__:null,get _pe(){return t._pe},isLoaded:P,isSupported:s,load:i,get PeCSTransformations(){return t.PeCSTransformations},get PeDefs(){return t.PeDefs},get PeFactory(){return t.PeFactory},get PeGCSExtent(){return t.PeGCSExtent},get PeGTlistExtended(){return t.PeGTlistExtended},get PeGTlistExtendedEntry(){return t.PeGTlistExtendedEntry},get PeGTTransformations(){return t.PeGTTransformations},get PeNotationDms(){return t.PeNotationDms},get PeNotationMgrs(){return t.PeNotationMgrs},get PeNotationUsng(){return t.PeNotationUsng},get PeNotationUtm(){return t.PeNotationUtm},get PePCSInfo(){return t.PePCSInfo},get PeVersion(){return t.PeVersion},_init:f});t._init=f,t.isLoaded=P,t.isSupported=s,t.load=i,t.pe=O}));
