/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","./componentsUtils","./resources3","./dom","./array2","./debounce","./observers","./interactive","./icon","./input","./progress","./forIn","./loader","./scrim"],(function(t,e,i,a,n,s,l,r,c,o,m,d,u,h){"use strict";
/*!
   * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
   * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
   */const f={parentItem:"parent-item"};
/*!
   * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
   * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
   */function p(){this.setUpItems(),this.setUpFilter(),this.deselectRemovedItems()}const b=["ArrowUp","ArrowDown"];function g(){this.setUpItems(),this.setUpFilter(),this.emitCalciteListChange=s.debounce(F.bind(this),0)}function w(){var t;null===(t=this.mutationObserver)||void 0===t||t.observe(this.el,{childList:!0,subtree:!0})}function y(){var t;null===(t=this.mutationObserver)||void 0===t||t.disconnect()}function v(t){const{selectedValues:e}=this,{item:i,value:n,selected:s,shiftPressed:l}=t.detail;s?(this.multiple&&l&&this.selectSiblings(i),this.multiple||this.deselectSiblingItems(i),e.set(n,i)):(e.delete(n),this.multiple&&l&&this.selectSiblings(i,!0)),this.multiple||(S(i,s),s&&a.focusElement(i)),this.lastSelectedItem=i,this.emitCalciteListChange()}function x(t){t.stopPropagation();const e=t.detail.oldValue,i=this.selectedValues;if(i.has(e)){const a=i.get(e);i.delete(e),i.set(t.detail.newValue,a)}}function k(t){return!!b.find((e=>e===t))}function E(t){const{el:e,items:i,multiple:a,selectedValues:n}=this;if(a)return;e.contains(t.relatedTarget)||C(i).forEach((e=>{S(e,0===n.size?e.contains(t.target)||t.target===e:e.selected)}))}function D(t){const{key:e,target:i}=t;if(!k(e))return;const{items:n,multiple:s,selectionFollowsFocus:l}=this,{length:r}=n,c=n.indexOf(i);if(!r||-1===c)return;t.preventDefault();const o=n[I(this,i,"ArrowUp"===e?"up":"down")];n.forEach((t=>S(t,t===o))),!s&&l&&(o.selected=!0),a.focusElement(o)}function I(t,e,i){const{items:a}=t,{length:s}=a,l=a.indexOf(e),r="up"===i?-1:1;let c=1,o=n.getRoundRobinIndex(l+r*c++,s);const m=o;for(;a[o].disabled&&(o=n.getRoundRobinIndex(l+r*c++,s),o!==m););return o}function C(t){return t.filter((t=>!t.disabled))}function F(){this.calciteListChange.emit(this.selectedValues)}function L(t){if(t.defaultPrevented)return;const e=t.target,i=this.selectedValues;"CALCITE-PICK-LIST-GROUP"===e.parentElement.tagName&&e.slot===f.parentItem?(e.parentElement.remove(),Array.from(e.parentElement.children).forEach((t=>i.delete(t.value)))):(e.remove(),i.delete(e.value)),this.emitCalciteListChange()}function S(t,e){t.disabled||(e?t.removeAttribute("tabindex"):t.setAttribute("tabindex","-1"))}async function H(t){var e;if(this.filterEnabled&&"filter"===t)return void await a.focusElement(this.filterEl);const{items:i,multiple:n,selectionFollowsFocus:s}=this;if(0===i.length)return;if(n)return null===(e=C(i)[0])||void 0===e?void 0:e.setFocus();const l=C(i),r=l.find((t=>t.selected))||l[0];return s&&r&&(r.selected=!0),r.setFocus()}function _(t){this.items=Array.from(this.el.querySelectorAll(t));let e=!1;const{items:i}=this;i.forEach((t=>{t.icon=this.getIconType(),this.multiple||(t.disableDeselect=!0,S(t,!1)),t.selected&&(e=!0,S(t,!0),this.selectedValues.set(t.value,t))}));const[a]=i;e||!a||a.disabled||S(a,!0)}function O(){const t=this.selectedValues,e=this.items.map((({value:t})=>t));t.forEach((t=>{e.includes(t.value)||this.selectedValues.delete(t.value)}))}function V(t){this.items.forEach((e=>{e.value!==t.value&&(e.toggleSelected(!1),this.selectedValues.has(e.value)&&this.selectedValues.delete(e.value))}))}function z(t,e=!1){if(!this.lastSelectedItem)return;const{items:i}=this,a=i.findIndex((t=>t.value===this.lastSelectedItem.value)),n=i.findIndex((e=>e.value===t.value));i.slice(Math.min(a,n),Math.max(a,n)).forEach((t=>{t.toggleSelected(!e),e?this.selectedValues.delete(t.value):this.selectedValues.set(t.value,t)}))}let P;function A(t){const{filteredItems:e}=t.currentTarget,i=e.map((t=>t.value));let n=!1;P||(P=new Set);const s=this.items.filter((t=>{const e=t.parentElement;e.matches("calcite-pick-list-group")&&P.add(e);const a=i.includes(t.value);return t.hidden=!a,n||(n=a&&t.selected),a}));P.forEach((t=>{const e=s.some((e=>t.contains(e)));if(t.hidden=!e,!e)return;const i=a.getSlotted(t,"parent-item");i&&(i.hidden=!1,s.includes(i)&&Array.from(t.children).forEach((t=>t.hidden=!1)))})),P.clear(),s.length>0&&!n&&!this.multiple&&S(s[0],!0)}function R(){return this.items.map((t=>({label:t.label,description:t.description,metadata:t.metadata,value:t.value})))}var U=function(t,e){var i={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(i[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(i[a[n]]=t[a[n]])}return i};const T=t=>{var{props:{disabled:a,loading:n,filterEnabled:s,dataForFilter:l,handleFilter:r,filterPlaceholder:c,setFilterEl:o}}=t,m=U(t,["props"]);const d=e.h("slot",null);return e.h(e.Host,Object.assign({"aria-busy":n.toString(),role:"menu"},m),e.h("section",null,e.h("header",{class:{[i.CSS.sticky]:!0}},s?e.h("calcite-filter",{"aria-label":c,disabled:n||a,items:l,onCalciteFilterChange:r,placeholder:c,ref:o}):null,e.h("slot",{name:i.SLOTS.menuActions})),n?e.h("calcite-scrim",{loading:n}):null,d))},j={container:"container",searchIcon:"search-icon",clearButton:"clear-button"},M={filterLabel:"Filter",clear:"Clear filter"},K={search:"search",close:"x"},N="@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:host{-webkit-box-sizing:border-box;box-sizing:border-box;background-color:var(--calcite-ui-foreground-1);color:var(--calcite-ui-text-2);font-size:var(--calcite-font-size--1)}:host *{-webkit-box-sizing:border-box;box-sizing:border-box}:root{--calcite-popper-transition:var(--calcite-animation-timing)}:host([hidden]){display:none}:host{display:-ms-flexbox;display:flex;width:100%}:host([disabled]){pointer-events:none;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:var(--calcite-ui-opacity-disabled)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.container{display:-ms-flexbox;display:flex;width:100%;padding:0.5rem}label{position:relative;margin-left:0.25rem;margin-right:0.25rem;margin-top:0px;margin-bottom:0px;display:-ms-flexbox;display:flex;width:100%;-ms-flex-align:center;align-items:center;overflow:hidden}input[type=text]{margin-bottom:0.25rem;width:100%;border-style:none;background-color:transparent;padding-top:0.25rem;padding-bottom:0.25rem;padding-right:0.25rem;padding-left:1.5rem;font-family:inherit;font-size:var(--calcite-font-size--2);line-height:1rem;color:var(--calcite-ui-text-1);-webkit-transition:padding var(--calcite-animation-timing), -webkit-box-shadow var(--calcite-animation-timing);transition:padding var(--calcite-animation-timing), -webkit-box-shadow var(--calcite-animation-timing);transition:padding var(--calcite-animation-timing), box-shadow var(--calcite-animation-timing);transition:padding var(--calcite-animation-timing), box-shadow var(--calcite-animation-timing), -webkit-box-shadow var(--calcite-animation-timing)}input[type=text]::-ms-clear{display:none}calcite-input{width:100%}.search-icon{position:absolute;display:-ms-flexbox;display:flex;color:var(--calcite-ui-text-2);inset-inline-start:0;-webkit-transition:left var(--calcite-animation-timing), right var(--calcite-animation-timing), opacity var(--calcite-animation-timing);transition:left var(--calcite-animation-timing), right var(--calcite-animation-timing), opacity var(--calcite-animation-timing)}input[type=text]:focus{border-color:var(--calcite-ui-brand);outline:2px solid transparent;outline-offset:2px;padding-inline:0.25rem}input[type=text]:focus~.search-icon{inset-inline-start:calc(1rem * -1);opacity:0}.clear-button{display:-ms-flexbox;display:flex;cursor:pointer;-ms-flex-align:center;align-items:center;border-width:0px;background-color:transparent;color:var(--calcite-ui-text-2)}.clear-button:hover,.clear-button:focus{color:var(--calcite-ui-text-1)}",q=250,B=e.proxyCustomElement(class extends e.H{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.calciteFilterChange=e.createEvent(this,"calciteFilterChange",7),this.items=[],this.disabled=!1,this.filteredItems=[],this.scale="m",this.value="",this.filter=s.debounce((t=>{const e=new RegExp(t,"i");if(0===this.items.length)return void this.updateFiltered([]);const i=(t,e)=>{let a=!1;return d.forIn(t,(t=>{"function"!=typeof t&&(Array.isArray(t)||"object"==typeof t&&null!==t?i(t,e)&&(a=!0):e.test(t)&&(a=!0))})),a},a=this.items.filter((t=>i(t,e)));this.updateFiltered(a)}),q),this.inputHandler=t=>{const e=t.target;this.value=e.value},this.keyDownHandler=({key:t})=>{"Escape"===t&&this.clear()},this.clear=()=>{this.value="",this.setFocus()}}watchItemsHandler(){this.filter(this.value)}valueHandler(t){this.filter(t)}componentDidRender(){r.updateHostInteraction(this)}componentWillLoad(){this.filter(this.value)}async setFocus(){a.focusElement(this.textInput)}updateFiltered(t){this.filteredItems.length=0,this.filteredItems=this.filteredItems.concat(t),this.calciteFilterChange.emit()}render(){const{disabled:t,scale:i}=this;return e.h(e.Fragment,null,e.h("div",{class:j.container},e.h("label",null,e.h("calcite-input",{"aria-label":this.intlLabel||M.filterLabel,disabled:t,icon:K.search,onCalciteInputInput:this.inputHandler,onKeyDown:this.keyDownHandler,placeholder:this.placeholder,ref:t=>{this.textInput=t},scale:i,type:"text",value:this.value})),this.value?e.h("button",{"aria-label":this.intlClear||M.clear,class:j.clearButton,disabled:t,onClick:this.clear},e.h("calcite-icon",{icon:K.close,scale:i})):null))}get el(){return this}static get watchers(){return{items:["watchItemsHandler"],value:["valueHandler"]}}static get style(){return N}},[1,"calcite-filter",{items:[1040],disabled:[516],filteredItems:[1040],intlClear:[1,"intl-clear"],intlLabel:[1,"intl-label"],placeholder:[1],scale:[513],value:[1025],setFocus:[64]}]);
/*!
   * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
   * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
   */function Y(){if("undefined"==typeof customElements)return;["calcite-filter","calcite-icon","calcite-input","calcite-progress"].forEach((t=>{switch(t){case"calcite-filter":customElements.get(t)||customElements.define(t,B);break;case"calcite-icon":customElements.get(t)||c.defineCustomElement();break;case"calcite-input":customElements.get(t)||o.defineCustomElement();break;case"calcite-progress":customElements.get(t)||m.defineCustomElement()}}))}Y();
/*!
   * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
   * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
   */
const G="@-webkit-keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-down{0%{opacity:0;-webkit-transform:translate3D(0, -5px, 0);transform:translate3D(0, -5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;-webkit-transform:translate3D(0, 5px, 0);transform:translate3D(0, 5px, 0)}100%{opacity:1;-webkit-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0)}}@-webkit-keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}@keyframes in-scale{0%{opacity:0;-webkit-transform:scale3D(0.95, 0.95, 1);transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;-webkit-transform:scale3D(1, 1, 1);transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-duration:var(--calcite-animation-timing);animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{-webkit-animation-name:in;animation-name:in}.calcite-animate__in-down{-webkit-animation-name:in-down;animation-name:in-down}.calcite-animate__in-up{-webkit-animation-name:in-up;animation-name:in-up}.calcite-animate__in-scale{-webkit-animation-name:in-scale;animation-name:in-scale}:root{--calcite-popper-transition:var(--calcite-animation-timing)}:host([hidden]){display:none}:host{position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-negative:0;flex-shrink:0;-ms-flex-positive:1;flex-grow:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:stretch;align-items:stretch;background-color:transparent;font-size:var(--calcite-font-size--1);line-height:1rem;color:var(--calcite-ui-text-2)}:host *{-webkit-box-sizing:border-box;box-sizing:border-box}:host([disabled]){pointer-events:none;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:var(--calcite-ui-opacity-disabled)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}:host([filter-enabled]) header{margin-bottom:0.25rem;display:-ms-flexbox;display:flex;-ms-flex-align:stretch;align-items:stretch;-ms-flex-pack:end;justify-content:flex-end;background-color:var(--calcite-ui-foreground-1);--tw-shadow:0 1px 0 var(--calcite-ui-border-3);--tw-shadow-colored:0 1px 0 var(--tw-shadow-color);-webkit-box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}:host([filter-enabled]) header.sticky-pos{position:-webkit-sticky;position:sticky;top:0px;z-index:1}calcite-filter{margin-bottom:0px}:host([loading][disabled]){min-height:2rem}",W=e.proxyCustomElement(class extends e.H{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.calciteListChange=e.createEvent(this,"calciteListChange",7),this.disabled=!1,this.filterEnabled=!1,this.loading=!1,this.multiple=!1,this.selectionFollowsFocus=!1,this.selectedValues=new Map,this.dataForFilter=[],this.lastSelectedItem=null,this.mutationObserver=l.createObserver("mutation",p.bind(this)),this.setFilterEl=t=>{this.filterEl=t},this.deselectRemovedItems=O.bind(this),this.deselectSiblingItems=V.bind(this),this.selectSiblings=z.bind(this),this.handleFilter=A.bind(this),this.getItemData=R.bind(this),this.keyDownHandler=D.bind(this)}connectedCallback(){g.call(this),w.call(this)}disconnectedCallback(){y.call(this)}componentDidRender(){r.updateHostInteraction(this)}calciteListItemRemoveHandler(t){L.call(this,t)}calciteListItemChangeHandler(t){v.call(this,t)}calciteListItemPropsChangeHandler(t){t.stopPropagation(),this.setUpFilter()}calciteListItemValueChangeHandler(t){x.call(this,t)}calciteListFocusOutHandler(t){E.call(this,t)}setUpItems(){_.call(this,"calcite-pick-list-item")}setUpFilter(){this.filterEnabled&&(this.dataForFilter=this.getItemData())}async getSelectedItems(){return this.selectedValues}async setFocus(t){return H.call(this,t)}getIconType(){return this.multiple?i.ICON_TYPES.square:i.ICON_TYPES.circle}render(){return e.h(T,{onKeyDown:this.keyDownHandler,props:this})}get el(){return this}static get style(){return G}},[1,"calcite-pick-list",{disabled:[516],filterEnabled:[516,"filter-enabled"],filterPlaceholder:[513,"filter-placeholder"],headingLevel:[2,"heading-level"],loading:[516],multiple:[516],selectionFollowsFocus:[4,"selection-follows-focus"],selectedValues:[32],dataForFilter:[32],getSelectedItems:[64],setFocus:[64]},[[0,"calciteListItemRemove","calciteListItemRemoveHandler"],[0,"calciteListItemChange","calciteListItemChangeHandler"],[0,"calciteListItemPropsChange","calciteListItemPropsChangeHandler"],[0,"calciteListItemValueChange","calciteListItemValueChangeHandler"],[0,"focusout","calciteListFocusOutHandler"]]]);function J(){if("undefined"==typeof customElements)return;["calcite-pick-list","calcite-filter","calcite-icon","calcite-input","calcite-loader","calcite-progress","calcite-scrim"].forEach((t=>{switch(t){case"calcite-pick-list":customElements.get(t)||customElements.define(t,W);break;case"calcite-filter":customElements.get(t)||Y();break;case"calcite-icon":customElements.get(t)||c.defineCustomElement();break;case"calcite-input":customElements.get(t)||o.defineCustomElement();break;case"calcite-loader":customElements.get(t)||u.defineCustomElement();break;case"calcite-progress":customElements.get(t)||m.defineCustomElement();break;case"calcite-scrim":customElements.get(t)||h.defineCustomElement()}}))}J();const Q=W,X=J;t.CalcitePickList=Q,t.defineCustomElement=X,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
