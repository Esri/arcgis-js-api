/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","./key","./observers","./componentsUtils"],(function(e,t,n,i){"use strict";
/*!
   * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
   * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
   * v1.0.0-beta.97
   */class r{constructor(e){if(e instanceof r)return e;const[t,n]=String(e).split(".").concat("");this.value=BigInt(t+n.padEnd(r.DECIMALS,"0").slice(0,r.DECIMALS))+BigInt(r.ROUNDED&&n[r.DECIMALS]>="5"),this.isNegative="-"===e.charAt(0)}static _divRound(e,t){return r.fromBigInt(e/t+(r.ROUNDED?e*BigInt(2)/t%BigInt(2):BigInt(0)))}static fromBigInt(e){return Object.assign(Object.create(r.prototype),{value:e})}toString(){const e=this.value.toString().replace(new RegExp("-","g"),"").padStart(r.DECIMALS+1,"0"),t=e.slice(0,-r.DECIMALS),n=e.slice(-r.DECIMALS).replace(/\.?0+$/,""),i=t.concat(n.length?"."+n:"");return`${this.isNegative?"-":""}${i}`}formatToParts(e){const t=this.value.toString().replace(new RegExp("-","g"),"").padStart(r.DECIMALS+1,"0"),n=t.slice(0,-r.DECIMALS),i=t.slice(-r.DECIMALS).replace(/\.?0+$/,""),a=e.formatToParts(BigInt(n));return this.isNegative&&a.unshift({type:"minusSign",value:D.minusSign}),i.length&&(a.push({type:"decimal",value:D.decimal}),i.split("").forEach((e=>a.push({type:"fraction",value:e})))),a}format(e){const t=this.value.toString().replace(new RegExp("-","g"),"").padStart(r.DECIMALS+1,"0"),n=t.slice(0,-r.DECIMALS),i=t.slice(-r.DECIMALS).replace(/\.?0+$/,"");return`${`${this.isNegative?D.minusSign:""}${e.format(BigInt(n))}`}${i.length?`${D.decimal}${e.format(BigInt(i))}`:""}`}add(e){return r.fromBigInt(this.value+new r(e).value)}subtract(e){return r.fromBigInt(this.value-new r(e).value)}multiply(e){return r._divRound(this.value*new r(e).value,r.SHIFT)}divide(e){return r._divRound(this.value*r.SHIFT,new r(e).value)}}function a(e){return!(!e||isNaN(Number(e)))}function s(e){return e&&p(e)?g(e,(e=>{let n=!1;const i=e.split("").filter(((e,i)=>e.match(/\./g)&&!n?(n=!0,!0):!(!e.match(/\-/g)||0!==i)||t.numberKeys.includes(e))).reduce(((e,t)=>e+t));return a(i)?new r(i).toString():""})):""}r.DECIMALS=100,r.ROUNDED=!0,r.SHIFT=BigInt("1"+"0".repeat(r.DECIMALS));const o=/^([-0])0+(?=\d)/,l=/(?!^\.)\.$/,u=/(?!^-)-/g,c=/^-\b0\b\.?0*$/,m=e=>g(e,(e=>{const t=e.replace(u,"").replace(l,"").replace(o,"$1");return a(t)?c.test(t)?t:new r(t).toString():e}));function g(e,t){if(!e)return e;const n=e.toLowerCase().indexOf("e")+1;return n?e.replace(/[eE]*$/g,"").substring(0,n).concat(e.slice(n).replace(/[eE]/g,"")).split(/[eE]/).map(((e,n)=>t(1===n?e.replace(/\./g,""):e))).join("e").replace(/^e/,"1e"):t(e)}function p(e){return t.numberKeys.some((t=>e.includes(t)))}const d="en",h=["ar","bg","bs","ca","cs","da","de","de-CH","el",d,"en-AU","en-CA","en-GB","es","es-MX","et","fi","fr","fr-CH","he","hi","hr","hu","id","it","it-CH","ja","ko","lt","lv","mk","nb","nl","pl","pt","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"],b=["arab","arabext","bali","beng","deva","fullwide","gujr","guru","hanidec","khmr","knda","laoo","latn","limb","mlym","mong","mymr","orya","tamldec","telu","thai","tibt"],f=e=>b.includes(e),S=(new Intl.NumberFormat).resolvedOptions().numberingSystem,v="arab"!==S&&f(S)?S:"latn",E=e=>f(e)?e:v;function _(e){return h.indexOf(e)>-1?e:e?"nb"===(e=e.toLowerCase())?"no":(e.includes("-")&&(e=e.replace(/(\w+)-(\w+)/,((e,t,n)=>`${t}-${n.toUpperCase()}`)),h.includes(e)||(e=e.split("-")[0])),h.includes(e)?e:d):d}const I=new Set;function w(e){y(e),0===I.size&&C.observe(document.documentElement,{attributes:!0,attributeFilter:["lang"],subtree:!0}),I.add(e)}function y(e){e.effectiveLocale=O(e)}function F(e){I.delete(e),0===I.size&&C.disconnect()}const C=n.createObserver("mutation",(e=>{e.forEach((e=>{const t=e.target;I.forEach((e=>{const n=!(!e.locale||e.el.lang),r=!i.containsCrossShadowBoundary(t,e.el);if(n||r)return;const a=i.closestElementCrossShadowBoundary(e.el,"[lang]");if(!a)return void(e.effectiveLocale=d);const s=a.lang;e.effectiveLocale=a.hasAttribute("lang")&&""===s?d:s}))}))}));function O(e){var t;return e.el.lang||e.locale||(null===(t=i.closestElementCrossShadowBoundary(e.el,"[lang]"))||void 0===t?void 0:t.lang)||document.documentElement.lang||d}class ${constructor(){this.delocalize=e=>this._numberFormatOptions?g(e,(e=>e.trim().replace(new RegExp(`[${this._minusSign}]`,"g"),"-").replace(new RegExp(`[${this._group}]`,"g"),"").replace(new RegExp(`[${this._decimal}]`,"g"),".").replace(new RegExp(`[${this._digits.join("")}]`,"g"),this._getDigitIndex))):e,this.localize=e=>this._numberFormatOptions?g(e,(e=>a(e.trim())?new r(e.trim()).format(this._numberFormatter).replace(new RegExp(`[${this._actualGroup}]`,"g"),this._group):e)):e}get group(){return this._group}get decimal(){return this._decimal}get minusSign(){return this._minusSign}get digits(){return this._digits}get numberFormatter(){return this._numberFormatter}get numberFormatOptions(){return this._numberFormatOptions}set numberFormatOptions(e){if(e.locale=_(null==e?void 0:e.locale),e.numberingSystem=E(null==e?void 0:e.numberingSystem),!this._numberFormatOptions&&e.locale===d&&e.numberingSystem===v&&2===Object.keys(e).length||JSON.stringify(this._numberFormatOptions)===JSON.stringify(e))return;this._numberFormatOptions=e,this._numberFormatter=new Intl.NumberFormat(this._numberFormatOptions.locale,this._numberFormatOptions),this._digits=[...new Intl.NumberFormat(this._numberFormatOptions.locale,{useGrouping:!1,numberingSystem:this._numberFormatOptions.numberingSystem}).format(9876543210)].reverse();const t=new Map(this._digits.map(((e,t)=>[e,t]))),n=new Intl.NumberFormat(this._numberFormatOptions.locale).formatToParts(-12345678.9);this._actualGroup=n.find((e=>"group"===e.type)).value,this._group=0===this._actualGroup.trim().length?" ":this._actualGroup,this._decimal=n.find((e=>"decimal"===e.type)).value,this._minusSign=n.find((e=>"minusSign"===e.type)).value,this._getDigitIndex=e=>t.get(e)}}const D=new $,L=(e,t,n)=>Math.max(t,Math.min(e,n)),N=e=>{const t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0};
/*!
   * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
   * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
   * v1.0.0-beta.97
   */e.clamp=L,e.connectLocalized=w,e.decimalPlaces=N,e.defaultNumberingSystem=v,e.disconnectLocalized=F,e.isValidNumber=a,e.numberStringFormatter=D,e.parseNumberString=s,e.sanitizeNumberString=m,e.updateEffectiveLocale=y}));
