/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import e from"../../../core/Error.js";import{createStretchRenderer as t,getDefaultBandCombination as r}from"../../../renderers/support/rasterRendererHelper.js";import{processRasterRendererParameters as n}from"../support/utils.js";async function a(t){t=await n(t);const{rasterInfo:a}=t.layer;if(1===a.bandCount)throw new e("raster-rgb-renderer:not-supported","Only multiband image is supported");const{rgbBandIds:s}=t;if(s&&3!==s.length)throw new e("raster-rgb-renderer:invalid-parameters","rgb band ids must have exactly three 0-based band indices");return s||(t.rgbBandIds=r(a)),t}async function s(e){const r=(e=await a(e)).layer,{rasterInfo:n}=r,{rgbBandIds:s}=e,d={bandIds:s,stretchType:e.stretchType,includeStatisticsInStretch:e.includeStatisticsInStretch};let o=t(n,d);return e.estimateStatistics&&o.dynamicRangeAdjustment&&(await r.updateRasterInfoWithEstimatedStats({renderingRule:e.renderingRule,signal:e.signal}),o=t(n,d)),i(o,e),{renderer:o,rgbBandIds:s}}function i(e,t){const{gamma:r,useGamma:n,dynamicRangeAdjustment:a}=t;3===r?.length&&(e.gamma=r),null!=n&&(e.useGamma=n),null!=a&&(e.dynamicRangeAdjustment=a)}export{s as createRenderer};
