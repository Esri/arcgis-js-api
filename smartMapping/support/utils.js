/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../support/arcadeOnDemand","../../Basemap","../../support/basemapUtils"],(function(e,t,n,r){"use strict";const a={light:["streets","gray","topo","terrain","national-geographic","oceans","osm","gray-vector","streets-vector","topo-vector","streets-relief-vector","streets-navigation-vector"],dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},i={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},o=["integer","small-integer"];let s=null;function l(e){return String(e).padStart(2,"0")}function u(e,t,n){let r;if("date"===t||"number"===t){"number"===t&&(e=new Date(e));r=`TIMESTAMP'${n?e.getFullYear():e.getUTCFullYear()}-${l((n?e.getMonth():e.getUTCMonth())+1)}-${l(n?e.getDate():e.getUTCDate())} ${l(n?e.getHours():e.getUTCHours())}:${l(n?e.getMinutes():e.getUTCMinutes())}:${l(n?e.getSeconds():e.getUTCSeconds())}'`}else r=e;return r}function c(e,t){if(t instanceof Date)return"date";if("number"==typeof t)return"number";if("string"==typeof t){const n=e.getField(t);if("<now>"===t.toLowerCase())return;if(n&&"date"===n.type)return"field"}}e.castIntegerFieldToFloat=function(e){return`cast(${e} as float)`},e.defaultBasemapGroups=a,e.getBasemapGroup=function(e,t=a){for(const n in t)if(t[n].indexOf(e)>-1)return n},e.getBasemapId=function(e,t,a=!0){let i=null;return"string"==typeof e&&t.indexOf(e)>-1?i=e:e instanceof n&&(i=r.getWellKnownBasemapId(e)),a?i||"gray":i},e.getDateDiffSQL=function(e,t,n,r){const{hasQueryEngine:a}=e;let o=`(${u(n,c(e,n),a)} - ${u(t,c(e,t),a)})`;a&&(o=`(${o} * ${i.milliseconds})`);let s=i[r],l="/";return s<1&&(s=1/s,l="*"),{sqlExpression:1===s?o:`(${o} ${l} ${s})`,sqlWhere:null}},e.getDateType=c,e.getFieldsList=async function(e){const n=e.field,r=e.normalizationField,a=e.valueExpression;let i=[];if(a){if(!s){const{arcadeUtils:e}=await t.loadArcade();s=e}i=s.extractFieldNames(a)}return n&&i.push(n),r&&i.push(r),i},e.getNormalizationType=function(e){let t=e.normalizationType;return t||(e.normalizationField?t="field":null!=e.normalizationTotal&&(t="percent-of-total")),t},e.isIntegerField=function(e,t){const n=t&&e.getField(t);return n&&o.indexOf(n.type)>-1},e.unitValueInDays=i,Object.defineProperty(e,"__esModule",{value:!0})}));
