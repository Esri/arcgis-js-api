/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../support/arcadeOnDemand","../../support/basemapUtils"],(function(e,t,n,r){"use strict";const i={light:["streets","gray","topo","terrain","national-geographic","oceans","osm","gray-vector","streets-vector","topo-vector","streets-relief-vector","streets-navigation-vector"],dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},o="percent-of-total",a="field",s={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},l=["integer","small-integer"];let u=null;function c(e){return d.apply(this,arguments)}function d(){return(d=t._asyncToGenerator((function*(e){const t=e.field,r=e.normalizationField,i=e.valueExpression;let o=[];if(i){if(!u){const{arcadeUtils:e}=yield n.loadArcade();u=e}o=u.extractFieldNames(i)}return t&&o.push(t),r&&o.push(r),o}))).apply(this,arguments)}function f(e){let t=e.normalizationType;return t||(e.normalizationField?t=a:null!=e.normalizationTotal&&(t=o)),t}function g(e){return String(e).padStart(2,"0")}function p(e,t,n){let r;if("date"===t||"number"===t){"number"===t&&(e=new Date(e));r=`TIMESTAMP'${n?e.getFullYear():e.getUTCFullYear()}-${g((n?e.getMonth():e.getUTCMonth())+1)}-${g(n?e.getDate():e.getUTCDate())} ${g(n?e.getHours():e.getUTCHours())}:${g(n?e.getMinutes():e.getUTCMinutes())}:${g(n?e.getSeconds():e.getUTCSeconds())}'`}else r=e;return r}function y(e,t,n,r){const{hasQueryEngine:i}=e;let o=`(${p(n,m(e,n),i)} - ${p(t,m(e,t),i)})`;i&&(o=`(${o} * ${s.milliseconds})`);let a=s[r],l="/";a<1&&(a=1/a,l="*");return{sqlExpression:1===a?o:`(${o} ${l} ${a})`,sqlWhere:null}}function m(e,t){if(t instanceof Date)return"date";if("number"==typeof t)return"number";if("string"==typeof t){const n=e.getField(t);if("<now>"===t.toLowerCase())return;if(n&&"date"===n.type)return"field"}}function h(e,t=i){for(const n in t)if(t[n].indexOf(e)>-1)return n}function T(e,t,n=!0){let i=null;return e&&("string"==typeof e?t.includes(e)&&(i=e):i=r.getWellKnownBasemapId(e)),n?i||"gray":i}function $(e,t){const n=t&&e.getField(t);return n&&l.indexOf(n.type)>-1}function F(e){return`cast(${e} as float)`}e.castIntegerFieldToFloat=F,e.defaultBasemapGroups=i,e.getBasemapGroup=h,e.getBasemapId=T,e.getDateDiffSQL=y,e.getDateType=m,e.getFieldsList=c,e.getNormalizationType=f,e.isIntegerField=$,e.unitValueInDays=s,Object.defineProperty(e,"__esModule",{value:!0})}));
