/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../core/Error","../../core/maybe","./summaryStatistics","./support/ageUtils","../support/adapters/support/layerUtils"],(function(e,t,r,a,i,s){"use strict";function n(e){return u.apply(this,arguments)}function u(){return(u=e._asyncToGenerator((function*(e){if(!(e&&e.layer&&e.startTime&&e.endTime&&e.unit))throw new t("summary-statistics-for-age:missing-parameters","'layer', 'startTime', 'endTime' and 'unit' parameters are required");const a=[0,2,1,3,5],{layer:n,...u}=e,o=s.createLayerAdapter(n,a),l={layerAdapter:o,...u};if(!o)throw new t("summary-statistics-for-age:invalid-parameters","'layer' must be one of these types: "+s.getLayerTypeLabels(a).join(", "));const p=l.view,m=r.isSome(l.signal)?{signal:l.signal}:null;yield Promise.all([p&&p.when(),o.load(m)]);const y=i.verifyDates(o,l.startTime,l.endTime,"summary-statistics-for-age:invalid-parameters");if(y)throw y;if(-1===i.supportedAgeUnits.indexOf(l.unit))throw new t("summary-statistics-for-age:invalid-parameters",`Supported units are: ${i.supportedAgeUnits.join(", ")}`);return l}))).apply(this,arguments)}function o(e){return l.apply(this,arguments)}function l(){return(l=e._asyncToGenerator((function*(e){const{layerAdapter:t,...r}=yield n(e),{view:s,startTime:u,endTime:o,unit:l,minValue:p,maxValue:m,signal:y}=r,{valueExpression:c,statisticsQuery:d}=i.getAgeExpressions({layer:t,startTime:u,endTime:o,unit:l}),f={layer:t,valueExpression:c,...d,minValue:p,maxValue:m,view:s,signal:y};return a(f)}))).apply(this,arguments)}return o}));
