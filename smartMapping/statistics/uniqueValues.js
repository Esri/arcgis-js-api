/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../core/maybe","../../core/Error","../support/utils","./support/utils","../support/adapters/support/layerUtils"],(function(e,s,i,r,a){"use strict";return async function(n){const{layerAdapter:t,...u}=await async function(n){if(!n||!n.layer||!n.field&&!n.valueExpression)throw new s("unique-values:missing-parameters","'layer' and 'field' or 'valueExpression' parameters are required");const t=n.valueExpression||n.sqlExpression,u=t&&!n.sqlExpression;if(t)if(u){if(!n.view)throw new s("unique-values:missing-parameters","View is required when 'valueExpression' is specified")}else if(!n.valueExpression)throw new s("unique-values:missing-parameters","'valueExpression' parameters are required");const l=[0,2,1,3,4],{layer:o,...p}=n,d=a.createLayerAdapter(o,l),f={layerAdapter:d,...p};if(!d)throw new s("unique-values:invalid-parameters","'layer' must be one of these types: "+a.getLayerTypeLabels(l).join(", "));const v=e.isSome(f.signal)?{signal:f.signal}:null;await d.load(v);const c=await i.getFieldsList({field:f.field,valueExpression:f.valueExpression}),y=r.verifyBasicFieldValidity(d,c,"unique-values:invalid-parameters");if(y)throw y;return f}(n);return t.uniqueValues(u)}}));
