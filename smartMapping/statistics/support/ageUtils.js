/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../core/Error","../../support/utils","../../support/adapters/support/layerUtils"],(function(e,t,n,r){"use strict";const a=["date","number"];function i(e,t,n){let r;return r="number"===t?e:"date"===t?e.getTime():'$feature["'+e+'"]',"var "+n+" = "+r+";"}function s(e,t,r,a){const s=n.getDateType(e,t),o=n.getDateType(e,r),u=[i(t,s,"startTime"),i(r,o,"endTime"),`var retVal = null;\n\n    if (startTime != null && endTime != null) {\n      startTime = Date(startTime);\n      endTime = Date(endTime);\n      retVal = DateDiff(endTime, startTime, "${a}");\n    }\n\n    return retVal;`],d=[];return"field"===s&&d.push(t),"field"===o&&d.push(r),function(e){const t=e.map((e=>`$feature["${e}"];`));return t.length?t.join("\n")+"\n":""}(d)+u.join("\n")}e.getAgeExpressions=function(e){const{layer:t,startTime:a,endTime:i}=e,o=r.createLayerAdapter(t),u=e.unit||"days",d=n.getDateDiffSQL(o,a,i,u);return{valueExpression:s(o,a,i,u),statisticsQuery:d,histogramQuery:d}},e.supportedAgeUnits=["years","months","days","hours","minutes","seconds"],e.verifyDates=function(e,r,i,s){const o=[];let u=null;return[r,i].every((t=>{const r=n.getDateType(e,t);return r&&o.push(r),!!r}))?o[0]===o[1]?"field"===o[0]?r===i&&(u=new t(s,"'startTime' and 'endTime' parameters cannot be identical")):u=new t(s,"Invalid combination of 'startTime' and 'endTime' parameters"):a.indexOf(o[0])>-1&&a.indexOf(o[1])>-1&&(u=new t(s,"Invalid combination of 'startTime' and 'endTime' parameters")):u=new t(s,"'startTime' and 'endTime' parameters must be one of these values: a date object, unix epoch time, name of a valid date field or <now>"),u},Object.defineProperty(e,"__esModule",{value:!0})}));
