/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../core/maybe","../../../core/Error","../../../layers/support/fieldUtils"],(function(e,n,i,t){"use strict";function r(e,n){return new i(e,n)}function l(e,i){let t=n.isSome(e)?e:"";return n.isSome(i)&&i&&(t=t?"("+t+") AND ("+i+")":i),t}e.createError=r,e.getRangeExpr=function(e,n,i){const t=null!=n?e+" >= "+n:"",r=null!=i?e+" <= "+i:"";let o="";return o=t&&r?l(t,r):t||r,o?"("+o+")":""},e.getSQLFilterForNormalization=function(e){const n=e.field,i=e.normalizationType,t=e.normalizationField;let r;return"log"===i?r="(NOT "+n+" = 0)":"field"===i&&(r="(NOT "+t+" = 0)"),r},e.mergeWhereClauses=l,e.verifyBasicFieldValidity=function(e,n,i){const t=function(e){const n=e.layer;return e.fields.filter((e=>!n.getField(e)))}({layer:e,fields:n});if(t.length)return r(i,"Unknown fields: "+t.join(", ")+". You can only use fields defined in the layer schema");const l=function(e){const n=e.layer;return e.fields.filter((e=>{const i=n.getFieldUsageInfo(e);return!i||!i.supportsStatistics}))}({layer:e,fields:n});return l.length?r(i,"Unsupported fields: "+l.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true"):void 0},e.verifyFieldType=function(e,n,i,t){let l=null;return n?n.name!==e.objectIdField&&-1!==t.indexOf(n.type)||(l=r(i,"'field' should be one of these types: "+t.join(","))):l=r(i,"'field' is not defined in the layer schema"),l},e.verifyNumericField=function(e,n,i){let l;return n?n.name!==e.objectIdField&&t.isNumericField(n)||(l=r(i,"'field' should be one of these numeric types: "+t.numericTypes.join(","))):l=r(i,"'field' is not defined in the layer schema"),l},Object.defineProperty(e,"__esModule",{value:!0})}));
