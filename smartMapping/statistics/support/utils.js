/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../../core/maybe","../../../core/Error","../../../layers/support/fieldUtils"],(function(e,n,t,i){"use strict";function r(e){const n=e.field,t=e.normalizationType,i=e.normalizationField;let r;return"log"===t?r="(NOT "+n+" = 0)":"field"===t?r="(NOT "+i+" = 0)":"natural-log"!==t&&"square-root"!==t||(r=`(${n} > 0)`),r}function l(e,n){return new t(e,n)}function o(e,n,t){const i=null!=n?e+" >= "+n:"",r=null!=t?e+" <= "+t:"";let l="";return l=i&&r?d(i,r):i||r,l?"("+l+")":""}function s(e,n,t,i){let r=null;return n?n.name!==e.objectIdField&&-1!==i.indexOf(n.type)||(r=l(t,"'field' should be one of these types: "+i.join(","))):r=l(t,"'field' is not defined in the layer schema"),r}function u(e,n,t){let r;return n?n.name!==e.objectIdField&&i.isNumericField(n)||(r=l(t,"'field' should be one of these numeric types: "+i.numericTypes.join(","))):r=l(t,"'field' is not defined in the layer schema"),r}function d(e,t){let i=n.isSome(e)?e:"";return n.isSome(t)&&t&&(i=i?"("+i+") AND ("+t+")":t),i}function f(e,n,t){const i=a({layer:e,fields:n});if(i.length)return l(t,"Unknown fields: "+i.join(", ")+". You can only use fields defined in the layer schema");const r=c({layer:e,fields:n});return r.length?l(t,"Unsupported fields: "+r.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true"):void 0}function a(e){const n=e.layer;return e.fields.filter((e=>!n.getField(e)))}function c(e){const n=e.layer;return e.fields.filter((e=>{const t=n.getFieldUsageInfo(e);return!t||!t.supportsStatistics}))}e.createError=l,e.getRangeExpr=o,e.getSQLFilterForNormalization=r,e.mergeWhereClauses=d,e.verifyBasicFieldValidity=f,e.verifyFieldType=s,e.verifyNumericField=u,Object.defineProperty(e,"__esModule",{value:!0})}));
