/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{getDataValues as a,quantizeFeatures as i,calculateHeatmapStats as e}from"./utils.js";import{isNullCountSupported as n,calculateStringStatistics as o,calculateStatistics as t,processSummaryStatisticsResult as l,calculateUniqueValuesCount as s,createUVResult as r,calculateClassBreaks as m,resolveCBResult as u,calculateHistogram as f}from"../../../statistics/utils.js";async function d(i){const{attribute:e,features:s}=i,{normalizationType:r,normalizationField:m,minValue:u,maxValue:f,fieldType:d}=e,p=await a({field:e.field,valueExpression:e.valueExpression,normalizationType:r,normalizationField:m,normalizationTotal:e.normalizationTotal,viewInfoParams:e.viewInfoParams,fieldInfos:e.fieldInfos},s),v=n({normalizationType:r,normalizationField:m,minValue:u,maxValue:f}),c={value:.5,fieldType:d},z="esriFieldTypeString"===d?o({values:p,supportsNullCount:v,percentileParams:c}):t({values:p,minValue:u,maxValue:f,useSampleStdDev:!r,supportsNullCount:v,percentileParams:c});return l(z,"esriFieldTypeDate"===d)}async function p(i){const{attribute:e,features:n}=i,o=await a({field:e.field,valueExpression:e.valueExpression,viewInfoParams:e.viewInfoParams,fieldInfos:e.fieldInfos},n),t=s(o);return r(t,e.domain,e.returnAllCodedValues)}async function v(i){const{attribute:e,features:n}=i,{field:o,normalizationType:t,normalizationField:l,normalizationTotal:s,classificationMethod:r}=e,f=await a({field:o,valueExpression:e.valueExpression,normalizationType:t,normalizationField:l,normalizationTotal:s,viewInfoParams:e.viewInfoParams,fieldInfos:e.fieldInfos},n),d=m(f,{field:o,normalizationType:t,normalizationField:l,normalizationTotal:s,classificationMethod:r,standardDeviationInterval:e.standardDeviationInterval,numClasses:e.numClasses,minValue:e.minValue,maxValue:e.maxValue});return u(d,r)}async function c(i){const{attribute:e,features:n}=i,{field:o,normalizationType:t,normalizationField:l,normalizationTotal:s,classificationMethod:r}=e,m=await a({field:o,valueExpression:e.valueExpression,normalizationType:t,normalizationField:l,normalizationTotal:s,viewInfoParams:e.viewInfoParams,fieldInfos:e.fieldInfos},n);return f(m,{field:o,normalizationType:t,normalizationField:l,normalizationTotal:s,classificationMethod:r,standardDeviationInterval:e.standardDeviationInterval,numBins:e.numBins,minValue:e.minValue,maxValue:e.maxValue})}async function z(a){const{attribute:n,features:o}=a,{field:t,radius:l,fieldOffset:s,transform:r,spatialReference:m,size:u}=n,f=i(o,r,m,u),{count:d,min:p,max:v,mean:c,stdDev:z}=e(f,l,s,t,u[0],u[1]);return{count:d,min:p,max:v,avg:c,stddev:z}}export{v as classBreaks,z as heatmapStatistics,c as histogram,d as summaryStatistics,p as uniqueValues};
