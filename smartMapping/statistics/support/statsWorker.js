/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/mathUtils","../../../geometry/SpatialReference","./utils","../../../support/arcadeOnDemand"],(function(e,t,a,i,n,l){"use strict";let o=null;function r(e){return s.apply(this,arguments)}function s(){return(s=t._asyncToGenerator((function*(e){const{attribute:t,featuresJSON:a}=e,{normalizationType:i,normalizationField:l,minValue:o,maxValue:r,fieldType:s}=t,c=yield u({field:t.field,valueExpression:t.valueExpression,normalizationType:i,normalizationField:l,normalizationTotal:t.normalizationTotal,viewInfoParams:t.viewInfoParams},a),p=n.isNullCountSupported({normalizationType:i,normalizationField:l,minValue:o,maxValue:r}),f="string"===s?n.calculateStringStatistics({values:c,supportsNullCount:p}):n.calculateStatistics({values:c,minValue:o,maxValue:r,useSampleStdDev:!i,supportsNullCount:p});return n.processStatsResult(f,"date"===s)}))).apply(this,arguments)}function u(e,t){return c.apply(this,arguments)}function c(){return(c=t._asyncToGenerator((function*(e,t){if(!t)return[];const r=e.field,s=e.valueExpression,u=e.normalizationType,c=e.normalizationField,p=e.normalizationTotal,f=[],m=e.viewInfoParams;let d=null,y=null;if(s){if(!o){const{arcadeUtils:e}=yield l.loadArcade();o=e}d=o.createFunction(s),y=m&&o.getViewInfo({viewingMode:m.viewingMode,scale:m.scale,spatialReference:new i(m.spatialReference)})}return t.forEach((e=>{const t=e.attributes;let i;if(s){const t=o.createExecContext(e,y);i=o.executeFunction(d,t)}else t&&(i=t[r]);if(u&&a.isFinite(i)){const e=t&&parseFloat(t[c]);i=n.getNormalizedValue(i,u,e,p)}f.push(i)})),f}))).apply(this,arguments)}e.getDataValues=u,e.summaryStatistics=r,Object.defineProperty(e,"__esModule",{value:!0})}));
