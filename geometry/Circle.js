/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/unitUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/accessorSupport/decorators/subclass","./ellipsoidUtils","./Point","./Polygon","./support/geodesicUtils","./support/webMercatorUtils","./support/WKIDUnitConversion"],(function(e,r,t,s,i,o,c,n,a,l,p,u,d){"use strict";var h;let g=h=function(r){function s(...e){var t;return(t=r.call(this,...e)||this).center=null,t.geodesic=!1,t.numberOfPoints=60,t.radius=1e3,t.radiusUnit="meters",t}e._inheritsLoose(s,r);var i=s.prototype;return i.normalizeCtorArgs=function(e,t){let s;if(e&&e.center)s=e;else{if(e&&e.rings)return r.prototype.normalizeCtorArgs.call(this,e,t);s={center:e}}return{...r.prototype.normalizeCtorArgs.call(this),...s,...t}},i.initialize=function(){const e=this.center,r=this.numberOfPoints;if(this.hasZ=e?.hasZ??!1,0!==this.rings.length||!e)return;const s=t.convertUnit(this.radius,this.radiusUnit,"meters"),i=e.spatialReference;let o,c="geographic";if(i.isWebMercator?c="webMercator":(null!=(i.wkid&&d[i.wkid])||i.wkt&&0===i.wkt.indexOf("PROJCS"))&&(c="projected"),this.geodesic){let t;switch(c){case"webMercator":t=u.webMercatorToGeographic(e);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":t=e}o=this._createGeodesicCircle(t,s,r),"webMercator"===c&&(o=u.geographicToWebMercator(o))}else{let i;"webMercator"===c||"projected"===c?i=s/this._convert2Meters(1,e.spatialReference):"geographic"===c&&(i=t.lengthToDegrees(s,"meters",n.getReferenceEllipsoid(e.spatialReference).radius)),o=this._createPlanarCircle(e,i,r)}this.spatialReference=o.spatialReference,this.addRing(o.rings[0])},i.clone=function(){const{center:e,numberOfPoints:r,radius:t,radiusUnit:s,geodesic:i}=this;return new h({center:e?.clone(),numberOfPoints:r,radius:t,radiusUnit:s,geodesic:i})},i._createGeodesicCircle=function(e,r,t){let s=0;const i=[];for(;s<360;){const o=[0,0],c=[e.x,e.y];p.directGeodeticSolver(o,c,s,r),this.hasZ&&o.push(e.z),i.push(o),s+=360/t}return i.push(i[0]),new l(i)},i._createPlanarCircle=function(e,r,t){const s=[],i=2*Math.PI/t;for(let o=0;o<t;++o){const t=i*o,c=[e.x+Math.cos(-t)*r,e.y+Math.sin(-t)*r];this.hasZ&&c.push(e.z),s.push(c)}return s.push(s[0]),new l({spatialReference:e.spatialReference,rings:[s]})},i._convert2Meters=function(e,r){let t;if(r.wkid&&null!=d[r.wkid])t=d.values[d[r.wkid]];else{const e=r.wkt,s=e.lastIndexOf(",")+1,i=e.lastIndexOf("]]");t=parseFloat(e.substring(s,i))}return e*t},s}(l);r.__decorate([s.property({type:a})],g.prototype,"center",void 0),r.__decorate([s.property()],g.prototype,"geodesic",void 0),r.__decorate([s.property()],g.prototype,"numberOfPoints",void 0),r.__decorate([s.property()],g.prototype,"radius",void 0),r.__decorate([s.property()],g.prototype,"radiusUnit",void 0),g=h=r.__decorate([c.subclass("esri.geometry.Circle")],g);return g}));
