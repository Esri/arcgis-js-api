/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/has","../core/Logger","../core/accessorSupport/ensureType","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/subclass","../core/urlUtils","../core/uuid","../portal/support/resourceExtension","./support/WKIDUnitConversion","./support/webMercatorUtils","./Point","./Polygon","./projectionEllipsoid","../core/unitUtils","./support/geodesicUtils"],(function(e,r,t,o,s,i,c,n,a,p,l,u,d,h,g,f,b){"use strict";var y;let _=y=function(r){function t(...e){var t;return(t=r.call(this,...e)||this).center=null,t.geodesic=!1,t.numberOfPoints=60,t.radius=1e3,t.radiusUnit="meters",t}e._inheritsLoose(t,r);var o=t.prototype;return o.normalizeCtorArgs=function(e,t){let o;if(e&&e.center)o=e;else{if(e&&e.rings)return r.prototype.normalizeCtorArgs.call(this,e,t);o={center:e}}return{...r.prototype.normalizeCtorArgs.call(this),...o,...t}},o.initialize=function(){const e=this.center,r=this.numberOfPoints;if(this.hasZ=e&&e.hasZ,0!==this.rings.length||!e)return;const t=f.convertUnit(this.radius,this.radiusUnit,"meters"),o=e.spatialReference;let s,i="geographic";if(o.isWebMercator?i="webMercator":(null!=l[o.wkid]||o.wkt&&0===o.wkt.indexOf("PROJCS"))&&(i="projected"),this.geodesic){let o;switch(i){case"webMercator":o=u.webMercatorToGeographic(e);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":o=e}s=this._createGeodesicCircle(o,t,r),"webMercator"===i&&(s=u.geographicToWebMercator(s))}else{let o;"webMercator"===i||"projected"===i?o=t/this._convert2Meters(1,e.spatialReference):"geographic"===i&&(o=f.lengthToDegrees(t,"meters",g.getReferenceEllipsoid(e.spatialReference).radius)),s=this._createPlanarCircle(e,o,r)}this.spatialReference=s.spatialReference,this.addRing(s.rings[0])},o.clone=function(){const{center:e,numberOfPoints:r,radius:t,radiusUnit:o,geodesic:s}=this;return new y({center:e.clone(),numberOfPoints:r,radius:t,radiusUnit:o,geodesic:s})},o._createGeodesicCircle=function(e,r,t){let o=0;const s=[];for(;o<360;){const i=[0,0],c=[e.x,e.y];b.directGeodeticSolver(i,c,o,r),this.hasZ&&i.push(e.z),s.push(i),o+=360/t}return s.push(s[0]),new h(s)},o._createPlanarCircle=function(e,r,t){let o=0;const s=[];for(;o<2*Math.PI;){const i=[e.x+Math.cos(-o)*r,e.y+Math.sin(-o)*r];this.hasZ&&i.push(e.z),s.push(i),o+=Math.PI/(t/2)}return s.push(s[0]),new h({spatialReference:e.spatialReference,rings:[s]})},o._convert2Meters=function(e,r){let t;if(null!=l[r.wkid])t=l.values[l[r.wkid]];else{const e=r.wkt,o=e.lastIndexOf(",")+1,s=e.lastIndexOf("]]");t=parseFloat(e.substring(o,s))}return e*t},t}(h);return r.__decorate([i.property({type:d})],_.prototype,"center",void 0),r.__decorate([i.property()],_.prototype,"geodesic",void 0),r.__decorate([i.property()],_.prototype,"numberOfPoints",void 0),r.__decorate([i.property()],_.prototype,"radius",void 0),r.__decorate([i.property()],_.prototype,"radiusUnit",void 0),_=y=r.__decorate([c.subclass("esri.geometry.Circle")],_),_}));
