/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../../core/maybe","./jsonUtils"],(function(n,t,e){"use strict";function u(n){return n&&"upperLeft"===n.originPosition}const i=(n,t,e)=>[t,e],r=(n,t,e)=>[t,e,n[2]],o=(n,t,e)=>[t,e,n[2],n[3]];function a(n){if(!n)return null;return{originPosition:"upper-left"===n.originPosition?"upperLeft":"lower-left"===n.originPosition?"lowerLeft":n.originPosition,scale:n.tolerance?[n.tolerance,n.tolerance]:[1,1],translate:t.isSome(n.extent)?[n.extent.xmin,n.extent.ymax]:[0,0]}}function l(n,e){if(n===e||null==n&&null==e)return!0;if(null==n||null==e)return!1;let i,r,o,a,l,s;return u(n)?(i=n.translate[0],r=n.translate[1],o=n.scale[0]):(i=t.isSome(n.extent)?n.extent.xmin:0,r=t.isSome(n.extent)?n.extent.ymax:0,o=n.tolerance),u(e)?(a=e.translate[0],l=e.translate[1],s=e.scale[0]):(a=t.isSome(e.extent)?e.extent.xmin:0,l=t.isSome(e.extent)?e.extent.ymax:0,s=e.tolerance),i===a&&r===l&&o===s}function s({scale:n,translate:t},e){return Math.round((e-t[0])/n[0])}function m({scale:n,translate:t},e){return Math.round((t[1]-e)/n[1])}function c(n,t,e){const u=[];let i,r,o,a;for(let l=0;l<e.length;l++){const c=e[l];l>0?(o=s(n,c[0]),a=m(n,c[1]),o===i&&a===r||(u.push(t(c,o-i,a-r)),i=o,r=a)):(i=s(n,c[0]),r=m(n,c[1]),u.push(t(c,i,r)))}return u.length>0?u:null}function f(n,t,e){return t[0]=s(n,e[0]),t[3]=m(n,e[1]),t[2]=s(n,e[2]),t[1]=m(n,e[3]),t}function x(n,t,e,u){return c(n,e?u?o:r:u?r:i,t)}function z(n,t,e,u){const a=[],l=e?u?o:r:u?r:i;for(let i=0;i<t.length;i++){const e=c(n,l,t[i]);e&&e.length>=3&&a.push(e)}return a.length?a:null}function g(n,t,e,u){const a=[],l=e?u?o:r:u?r:i;for(let i=0;i<t.length;i++){const e=c(n,l,t[i]);e&&e.length>=2&&a.push(e)}return a.length?a:null}function h({scale:n,translate:t},e){return e*n[0]+t[0]}function y({scale:n,translate:t},e){return t[1]-e*n[1]}function I(n,t,e){const u=new Array(e.length);if(!e.length)return u;const[i,r]=n.scale;let o=h(n,e[0][0]),a=y(n,e[0][1]);u[0]=t(e[0],o,a);for(let l=1;l<e.length;l++){const n=e[l];o+=n[0]*i,a-=n[1]*r,u[l]=t(n,o,a)}return u}function q(n,t,e){const u=new Array(e.length);for(let i=0;i<e.length;i++)u[i]=I(n,t,e[i]);return u}function P(n,t,e){return e?(t[0]=h(n,e[0]),t[1]=y(n,e[3]),t[2]=h(n,e[2]),t[3]=y(n,e[1]),t):[h(n,t[0]),y(n,t[3]),h(n,t[2]),y(n,t[1])]}function p(n,t,e,u){return I(n,e?u?o:r:u?r:i,t)}function d(n,t,e,u){return q(n,e?u?o:r:u?r:i,t)}function N(n,t,e,u){return q(n,e?u?o:r:u?r:i,t)}function M(n,t,e){let[u,i]=e[0],r=Math.min(u,t[0]),o=Math.min(i,t[1]),a=Math.max(u,t[2]),l=Math.max(i,t[3]);for(let s=1;s<e.length;s++){const[n,t]=e[s];u+=n,i+=t,n<0&&(r=Math.min(r,u)),n>0&&(a=Math.max(a,u)),t<0?o=Math.min(o,i):t>0&&(l=Math.max(l,i))}return n[0]=r,n[1]=o,n[2]=a,n[3]=l,n}function T(n,t){if(!t.length)return null;n[0]=n[1]=Number.POSITIVE_INFINITY,n[2]=n[3]=Number.NEGATIVE_INFINITY;for(let e=0;e<t.length;e++)M(n,n,t[e]);return n}function S(n){const t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return M(t,t,n)}function E(n){return T([0,0,0,0],n)}function A(n){return T([0,0,0,0],n)}function b(n,t,e,u,i){return t.xmin=s(n,e.xmin),t.ymin=m(n,e.ymin),t.xmax=s(n,e.xmax),t.ymax=m(n,e.ymax),t!==e&&(u&&(t.zmin=e.zmin,t.zmax=e.zmax),i&&(t.mmin=e.mmin,t.mmax=e.mmax)),t}function Y(n,t,e,u,i){return t.points=x(n,e.points,u,i),t}function _(n,t,e,u,i){return t.x=s(n,e.x),t.y=m(n,e.y),t!==e&&(u&&(t.z=e.z),i&&(t.m=e.m)),t}function B(n,t,e,u,i){const r=z(n,e.rings,u,i);return r?(t.rings=r,t):null}function F(n,t,e,u,i){const r=g(n,e.paths,u,i);return r?(t.paths=r,t):null}function Q(n,t){return n&&t?e.isPoint(t)?_(n,{},t,!1,!1):e.isPolyline(t)?F(n,{},t,!1,!1):e.isPolygon(t)?B(n,{},t,!1,!1):e.isMultipoint(t)?Y(n,{},t,!1,!1):e.isExtent(t)?b(n,{},t,!1,!1):null:null}function V(n,t,e,u,i){return t.xmin=h(n,e.xmin),t.ymin=y(n,e.ymin),t.xmax=h(n,e.xmax),t.ymax=y(n,e.ymax),t!==e&&(u&&(t.zmin=e.zmin,t.zmax=e.zmax),i&&(t.mmin=e.mmin,t.mmax=e.mmax)),t}function w(n,e,u,i,r){return t.isSome(u)&&(e.points=p(n,u.points,i,r)),e}function C(n,e,u,i,r){return t.isNone(u)||(e.x=h(n,u.x),e.y=y(n,u.y),e!==u&&(i&&(e.z=u.z),r&&(e.m=u.m))),e}function G(n,e,u,i,r){return t.isSome(u)&&(e.rings=N(n,u.rings,i,r)),e}function O(n,e,u,i,r){return t.isSome(u)&&(e.paths=d(n,u.paths,i,r)),e}n.equals=l,n.getQuantizedBoundsCoordsArray=M,n.getQuantizedBoundsCoordsArrayArray=T,n.getQuantizedBoundsPaths=E,n.getQuantizedBoundsPoints=S,n.getQuantizedBoundsRings=A,n.quantizeBounds=f,n.quantizeExtent=b,n.quantizeGeometry=Q,n.quantizeMultipoint=Y,n.quantizePaths=g,n.quantizePoint=_,n.quantizePoints=x,n.quantizePolygon=B,n.quantizePolyline=F,n.quantizeRings=z,n.quantizeX=s,n.quantizeY=m,n.toQuantizationTransform=a,n.unquantizeBounds=P,n.unquantizeCoordsArray=I,n.unquantizeCoordsArrayArray=q,n.unquantizeExtent=V,n.unquantizeMultipoint=w,n.unquantizePaths=d,n.unquantizePoint=C,n.unquantizePoints=p,n.unquantizePolygon=G,n.unquantizePolyline=O,n.unquantizeRings=N,n.unquantizeX=h,n.unquantizeY=y,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
