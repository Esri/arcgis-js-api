/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","./jsonUtils"],(function(n,t){"use strict";function e(n){return n&&"upperLeft"===n.originPosition}const u=(n,t,e)=>[t,e],i=(n,t,e)=>[t,e,n[2]],r=(n,t,e)=>[t,e,n[2],n[3]];function o({scale:n,translate:t},e){return Math.round((e-t[0])/n[0])}function a({scale:n,translate:t},e){return Math.round((t[1]-e)/n[1])}function l(n,t,e){const u=[];let i,r,l,s;for(let m=0;m<e.length;m++){const c=e[m];m>0?(l=o(n,c[0]),s=a(n,c[1]),l===i&&s===r||(u.push(t(c,l-i,s-r)),i=l,r=s)):(i=o(n,c[0]),r=a(n,c[1]),u.push(t(c,i,r)))}return u.length>0?u:null}function s(n,t,e,o){return l(n,e?o?r:i:o?i:u,t)}function m(n,t,e,o){const a=[],s=e?o?r:i:o?i:u;for(let e=0;e<t.length;e++){const u=l(n,s,t[e]);u&&u.length>=3&&a.push(u)}return a.length?a:null}function c(n,t,e,o){const a=[],s=e?o?r:i:o?i:u;for(let e=0;e<t.length;e++){const u=l(n,s,t[e]);u&&u.length>=2&&a.push(u)}return a.length?a:null}function f({scale:n,translate:t},e){return e*n[0]+t[0]}function x({scale:n,translate:t},e){return t[1]-e*n[1]}function z(n,t,e){const u=new Array(e.length);if(!e.length)return u;const[i,r]=n.scale;let o=f(n,e[0][0]),a=x(n,e[0][1]);u[0]=t(e[0],o,a);for(let n=1;n<e.length;n++){const l=e[n];o+=l[0]*i,a-=l[1]*r,u[n]=t(l,o,a)}return u}function h(n,t,e){const u=new Array(e.length);for(let i=0;i<e.length;i++)u[i]=z(n,t,e[i]);return u}function g(n,t,e,o){return z(n,e?o?r:i:o?i:u,t)}function y(n,t,e,o){return h(n,e?o?r:i:o?i:u,t)}function I(n,t,e,o){return h(n,e?o?r:i:o?i:u,t)}function q(n,t,e){let[u,i]=e[0],r=Math.min(u,t[0]),o=Math.min(i,t[1]),a=Math.max(u,t[2]),l=Math.max(i,t[3]);for(let n=1;n<e.length;n++){const[t,s]=e[n];u+=t,i+=s,t<0&&(r=Math.min(r,u)),t>0&&(a=Math.max(a,u)),s<0?o=Math.min(o,i):s>0&&(l=Math.max(l,i))}return n[0]=r,n[1]=o,n[2]=a,n[3]=l,n}function P(n,t){if(!t.length)return null;n[0]=n[1]=Number.POSITIVE_INFINITY,n[2]=n[3]=Number.NEGATIVE_INFINITY;for(let e=0;e<t.length;e++)q(n,n,t[e]);return n}function p(n,t,e,u,i){return t.xmin=o(n,e.xmin),t.ymin=a(n,e.ymin),t.xmax=o(n,e.xmax),t.ymax=a(n,e.ymax),t!==e&&(u&&(t.zmin=e.zmin,t.zmax=e.zmax),i&&(t.mmin=e.mmin,t.mmax=e.mmax)),t}function d(n,t,e,u,i){return t.points=s(n,e.points,u,i),t}function N(n,t,e,u,i){return t.x=o(n,e.x),t.y=a(n,e.y),t!==e&&(u&&(t.z=e.z),i&&(t.m=e.m)),t}function M(n,t,e,u,i){const r=m(n,e.rings,u,i);return r?(t.rings=r,t):null}function T(n,t,e,u,i){const r=c(n,e.paths,u,i);return r?(t.paths=r,t):null}n.equals=function(n,t){if(n===t||null==n&&null==t)return!0;if(null==n||null==t)return!1;let u,i,r,o,a,l;return e(n)?(u=n.translate[0],i=n.translate[1],r=n.scale[0]):(u=n.extent.xmin,i=n.extent.ymax,r=n.tolerance),e(t)?(o=t.translate[0],a=t.translate[1],l=t.scale[0]):(o=t.extent.xmin,a=t.extent.ymax,l=t.tolerance),u===o&&i===a&&r===l},n.getQuantizedBoundsCoordsArray=q,n.getQuantizedBoundsCoordsArrayArray=P,n.getQuantizedBoundsPaths=function(n){return P([0,0,0,0],n)},n.getQuantizedBoundsPoints=function(n){const t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return q(t,t,n)},n.getQuantizedBoundsRings=function(n){return P([0,0,0,0],n)},n.quantizeBounds=function(n,t,e){return t[0]=o(n,e[0]),t[3]=a(n,e[1]),t[2]=o(n,e[2]),t[1]=a(n,e[3]),t},n.quantizeExtent=p,n.quantizeGeometry=function(n,e){return n&&e?t.isPoint(e)?N(n,{},e,!1,!1):t.isPolyline(e)?T(n,{},e,!1,!1):t.isPolygon(e)?M(n,{},e,!1,!1):t.isMultipoint(e)?d(n,{},e,!1,!1):t.isExtent(e)?p(n,{},e,!1,!1):null:null},n.quantizeMultipoint=d,n.quantizePaths=c,n.quantizePoint=N,n.quantizePoints=s,n.quantizePolygon=M,n.quantizePolyline=T,n.quantizeRings=m,n.quantizeX=o,n.quantizeY=a,n.toQuantizationTransform=function(n){return n?{originPosition:"upper-left"===n.originPosition?"upperLeft":"lower-left"===n.originPosition?"lowerLeft":n.originPosition,scale:[n.tolerance,n.tolerance],translate:[n.extent.xmin,n.extent.ymax]}:null},n.unquantizeBounds=function(n,t,e){return e?(t[0]=f(n,e[0]),t[1]=x(n,e[3]),t[2]=f(n,e[2]),t[3]=x(n,e[1]),t):[f(n,t[0]),x(n,t[3]),f(n,t[2]),x(n,t[1])]},n.unquantizeCoordsArray=z,n.unquantizeCoordsArrayArray=h,n.unquantizeExtent=function(n,t,e,u,i){return t.xmin=f(n,e.xmin),t.ymin=x(n,e.ymin),t.xmax=f(n,e.xmax),t.ymax=x(n,e.ymax),t!==e&&(u&&(t.zmin=e.zmin,t.zmax=e.zmax),i&&(t.mmin=e.mmin,t.mmax=e.mmax)),t},n.unquantizeMultipoint=function(n,t,e,u,i){return t.points=g(n,e.points,u,i),t},n.unquantizePaths=y,n.unquantizePoint=function(n,t,e,u,i){return t.x=f(n,e.x),t.y=x(n,e.y),t!==e&&(u&&(t.z=e.z),i&&(t.m=e.m)),t},n.unquantizePoints=g,n.unquantizePolygon=function(n,t,e,u,i){return t.rings=I(n,e.rings,u,i),t},n.unquantizePolyline=function(n,t,e,u,i){return t.paths=y(n,e.paths,u,i),t},n.unquantizeRings=I,n.unquantizeX=f,n.unquantizeY=x,Object.defineProperty(n,"__esModule",{value:!0})}));
