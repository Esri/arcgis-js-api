/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/JSONSupport","../../core/maybe","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/arrayUtils","../../core/accessorSupport/decorators/subclass","../../chunks/mat4","../../chunks/mat4f64","../../chunks/quat","../../chunks/quatf64","../../chunks/vec3","../../chunks/vec3f64","../Point","../projection","../spatialReferenceEllipsoidUtils","./axisAngleDegrees","./buffer/BufferView","../../chunks/vec32","../../chunks/vec33"],(function(e,t,r,o,n,a,i,c,s,l,p,u,h,f,g,y,d,m,_,v,x){"use strict";var M;let b=M=function(t){function r(e){var r;return(r=t.call(this,e)||this).origin=f.create(),r.translation=f.create(),r.rotation=m.create(),r.scale=f.fromValues(1,1,1),r.geographic=!0,r}e._inheritsLoose(r,t);var n=r.prototype;return n.applyLocal=function(e,t){return h.transformMat4(t,e,this.localMatrix)},n.applyLocalInverse=function(e,t){return h.transformMat4(t,e,this.localMatrixInverse)},n.project=function(e,t){const r=new Float64Array(e.length),o=_.BufferViewVec3f64.fromTypedArray(r),n=_.BufferViewVec3f64.fromTypedArray(e);if(this.geographic){const e=d.getSphericalPCPF(t),a=l.create();return y.computeTranslationToOriginAndRotation(t,this.origin,a,e),s.multiply(a,a,this.localMatrix),v.transformMat4(o,n,a),y.projectBuffer(r,e,0,r,t,0,r.length/3),r}const{localMatrix:a,origin:i}=this;s.equals(a,l.IDENTITY)?x.copy(o,n):v.transformMat4(o,n,a);for(let c=0;c<r.length;c+=3)r[c+0]+=i[0],r[c+1]+=i[1],r[c+2]+=i[2];return r},n.getOriginPoint=function(e){const[t,r,o]=this.origin;return new g({x:t,y:r,z:o,spatialReference:e})},n.equals=function(e){return o.isSome(e)&&this.geographic===e.geographic&&h.exactEquals(this.origin,e.origin)&&s.exactEquals(this.localMatrix,e.localMatrix)},n.clone=function(){const e={origin:f.clone(this.origin),translation:f.clone(this.translation),rotation:m.create(this.rotation),scale:f.clone(this.scale),geographic:this.geographic};return new M(e)},e._createClass(r,[{key:"localMatrix",get:function(){const e=l.create();return p.setAxisAngle(k,m.axis(this.rotation),m.angleRad(this.rotation)),s.fromRotationTranslationScale(e,k,this.translation,this.scale),e}},{key:"localMatrixInverse",get:function(){return s.invert(l.create(),this.localMatrix)}}]),r}(r.JSONSupport);t.__decorate([n.property({type:[Number],nonNullable:!0,json:{write:!0}})],b.prototype,"origin",void 0),t.__decorate([n.property({type:[Number],nonNullable:!0,json:{write:!0}})],b.prototype,"translation",void 0),t.__decorate([n.property({type:[Number],nonNullable:!0,json:{write:!0}})],b.prototype,"rotation",void 0),t.__decorate([n.property({type:[Number],nonNullable:!0,json:{write:!0}})],b.prototype,"scale",void 0),t.__decorate([n.property({type:Boolean,nonNullable:!0,json:{write:!0}})],b.prototype,"geographic",void 0),t.__decorate([n.property()],b.prototype,"localMatrix",null),t.__decorate([n.property()],b.prototype,"localMatrixInverse",null),b=M=t.__decorate([c.subclass("esri.geometry.support.MeshTransform")],b);const k=u.create();return b}));
