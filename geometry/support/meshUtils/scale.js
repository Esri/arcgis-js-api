/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../../core/Logger","../../../chunks/vec3f64","../../../chunks/vec3","../../projectionEllipsoid","../../projection","./projection"],(function(e,t,r,o,n,i,c){"use strict";const s=t.getLogger("esri.geometry.support.meshUtils.scale");function a(e,t,r){if(!e.vertexAttributes||!e.vertexAttributes.position)return;const o=e.spatialReference,n=o.isWGS84||o.isWebMercator&&(!r||!1!==r.geographic),i=r&&r.origin||e.extent.center;n?p(e,t,i):l(e,t,i)}function p(e,t,r){const o=e.spatialReference,s=n.getSphericalPCPF(o),a=u;i.projectPointToVector(r,a,s)||i.projectPointToVector(e.extent.center,a,s);const p=e.vertexAttributes.position,l=e.vertexAttributes.normal,g=e.vertexAttributes.tangent,j=new Float64Array(p.length),x=new Float32Array(l?l.length:0),E=new Float32Array(g?g.length:0);c.projectToECEF(p,o,j),l&&c.projectNormalToECEF(l,p,j,o,x),g&&c.projectTangentToECEF(g,p,j,o,E),f(j,t,a),c.projectFromECEF(j,p,o),l&&c.projectNormalFromECEF(x,p,j,o,l),g&&c.projectTangentFromECEF(E,p,j,o,g),e.vertexAttributesChanged()}function l(e,t,r){const o=u;if(!i.projectPointToVector(r,o,e.spatialReference)){const t=e.extent.center;o[0]=t.x,o[1]=t.y,o[2]=t.z,s.error(`Failed to project specified origin (wkid:${r.spatialReference.wkid}) to mesh spatial reference (wkid:${e.spatialReference.wkid}). Using mesh extent.center instead`)}f(e.vertexAttributes.position,t,o),e.vertexAttributesChanged()}function f(e,t,n=r.ZEROS){if(e)for(let r=0;r<e.length;r+=3){for(let t=0;t<3;t++)g[t]=e[r+t]-n[t];o.scale(g,g,t);for(let t=0;t<3;t++)e[r+t]=g[t]+n[t]}}const g=r.create(),u=r.create();e.scale=a,Object.defineProperty(e,"__esModule",{value:!0})}));
