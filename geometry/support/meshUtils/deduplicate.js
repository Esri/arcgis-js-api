/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../core/mathUtils"],(function(t,e){"use strict";function n(t,n,i){const u=t.byteLength/(4*n),c=new Uint32Array(t,0,u*n);let s=new Uint32Array(u);const a=i&&i.minReduction||0,h=i&&i.originalIndices||null,g=i&&i.componentOffsets||null;let d=0;if(g)for(let t=0;t<g.length-1;t++){const e=g[t+1]-g[t];e>d&&(d=e)}else d=u;const w=Math.floor(1.1*d)+1;(null==o||o.length<2*w)&&(o=new Uint32Array(e.nextHighestPowerOfTwo(2*w)));for(let t=0;t<2*w;t++)o[t]=0;let y=0;const U=!!g&&!!h,A=U?h.length:u,b=U?new Uint32Array(h.length):null,p=1.96;let M=0!==a?Math.ceil(4*p*p/(a*a)*a*(1-a)):A,m=1,O=g?g[1]:A;for(let t=0;t<A;t++){if(t===M){const e=1-y/t;if(e+p*Math.sqrt(e*(1-e)/t)<a)return null;M*=2}if(t===O){for(let t=0;t<2*w;t++)o[t]=0;if(h)for(let t=g[m-1];t<g[m];t++)b[t]=s[h[t]];O=g[++m]}const e=U?h[t]:t,r=e*n,i=f(c,r,n);let u=i%w,d=y;for(;0!==o[2*u+1];){if(o[2*u]===i){const t=o[2*u+1]-1;if(l(c,r,t*n,n)){d=s[t];break}}u++,u>=w&&(u-=w)}d===y&&(o[2*u]=i,o[2*u+1]=e+1,y++),s[e]=d}if(0!==a&&1-y/u<a)return null;if(U){for(let t=g[m-1];t<b.length;t++)b[t]=s[h[t]];s=b}const q=new Uint32Array(n*y);y=0;for(let t=0;t<A;t++)if(s[t]===y){r(c,(U?h[t]:t)*n,q,y*n,n),y++}if(h&&!U){const t=new Uint32Array(h.length);for(let e=0;e<t.length;e++)t[e]=s[h[e]];s=t}return{buffer:q.buffer,indices:s,uniqueCount:y}}function l(t,e,n,l){for(let r=0;r<l;r++)if(t[e+r]!==t[n+r])return!1;return!0}function r(t,e,n,l,r){for(let f=0;f<r;f++)n[l+f]=t[e+f]}function f(t,e,n){let l=0;for(let r=0;r<n;r++)l=t[e+r]+l|0,l=l+(l<<11)+(l>>>2)|0;return l>>>0}let o=null;t.deduplicate=n,t.default=n,Object.defineProperty(t,"__esModule",{value:!0})}));
