/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../core/mathUtils"],(function(t,e){"use strict";function n(t,n,f){const u=t.byteLength/(4*n),c=new Uint32Array(t,0,u*n);let s=new Uint32Array(u);const a=f?.minReduction??0,h=f?.originalIndices||null,g=h?h.length:0,d=f?.componentOffsets||null;let w=0;if(d)for(let e=0;e<d.length-1;e++){const t=d[e+1]-d[e];t>w&&(w=t)}else w=u;const y=Math.floor(1.1*w)+1;(null==i||i.length<2*y)&&(i=new Uint32Array(e.nextHighestPowerOfTwo(2*y)));for(let e=0;e<2*y;e++)i[e]=0;let U=0;const b=!!d&&!!h,A=b?g:u,M=b?new Uint32Array(g):null,m=1.96;let p=0!==a?Math.ceil(4*m*m/(a*a)*a*(1-a)):A,O=1,q=d?d[1]:A;for(let e=0;e<A;e++){if(e===p){const t=1-U/e;if(t+m*Math.sqrt(t*(1-t)/e)<a)return null;p*=2}if(e===q){for(let t=0;t<2*y;t++)i[t]=0;if(h)for(let t=d[O-1];t<d[O];t++)M[t]=s[h[t]];q=d[++O]}const t=b?h[e]:e,l=t*n,f=o(c,l,n);let u=f%y,g=U;for(;0!==i[2*u+1];){if(i[2*u]===f){const t=i[2*u+1]-1;if(r(c,l,t*n,n)){g=s[t];break}}u++,u>=y&&(u-=y)}g===U&&(i[2*u]=f,i[2*u+1]=t+1,U++),s[t]=g}if(0!==a&&1-U/u<a)return null;if(b){for(let t=d[O-1];t<M.length;t++)M[t]=s[h[t]];s=M}const v=new Uint32Array(n*U);U=0;for(let e=0;e<A;e++)if(s[e]===U){l(c,(b?h[e]:e)*n,v,U*n,n),U++}if(h&&!b){const t=new Uint32Array(g);for(let e=0;e<t.length;e++)t[e]=s[h[e]];s=t}return{buffer:v.buffer,indices:s,uniqueCount:U}}function r(t,e,n,r){for(let l=0;l<r;l++)if(t[e+l]!==t[n+l])return!1;return!0}function l(t,e,n,r,l){for(let o=0;o<l;o++)n[r+o]=t[e+o]}function o(t,e,n){let r=0;for(let l=0;l<n;l++)r=t[e+l]+r|0,r=r+(r<<11)+(r>>>2)|0;return r>>>0}let i=null;t.deduplicate=n,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
