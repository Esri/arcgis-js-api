/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../core/mathUtils","../../../views/3d/webgl-engine/lib/Indices"],(function(e,t,n){"use strict";function r(e,r,c){const s=Array.isArray(e),u=s?e.length/r:e.byteLength/(4*r),a=s?e:new Uint32Array(e,0,u*r),y=c?.minReduction??0,d=c?.originalIndices||null,g=d?d.length:0,h=c?.componentOffsets||null;let w=0;if(h)for(let t=0;t<h.length-1;t++){const e=h[t+1]-h[t];e>w&&(w=e)}else w=u;const A=Math.floor(1.1*w)+1;(null==f||f.length<2*A)&&(f=new Uint32Array(t.nextHighestPowerOfTwo(2*A)));for(let t=0;t<2*A;t++)f[t]=0;let b=0;const m=!!h&&!!d,p=m?g:u;let U=n.newIndexArray(u/3);const I=new Uint32Array(g),M=1.96;let x=0!==y?Math.ceil(4*M*M/(y*y)*y*(1-y)):p,O=1,q=h?h[1]:p;for(let t=0;t<p;t++){if(t===x){const e=1-b/t;if(e+M*Math.sqrt(e*(1-e)/t)<y)return null;x*=2}if(t===q){for(let e=0;e<2*A;e++)f[e]=0;if(d)for(let e=h[O-1];e<h[O];e++)I[e]=U[d[e]];q=h[++O]}const e=m?d[t]:t,n=e*r,i=o(a,n,r);let c=i%A,s=b;for(;0!==f[2*c+1];){if(f[2*c]===i){const e=f[2*c+1]-1;if(l(a,n,e*r,r)){s=U[e];break}}c++,c>=A&&(c-=A)}s===b&&(f[2*c]=i,f[2*c+1]=e+1,b++),U[e]=s}if(0!==y&&1-b/u<y)return null;if(m){for(let e=h[O-1];e<I.length;e++)I[e]=U[d[e]];U=n.compactIndices(I)}const v=s?new Array(b):new Uint32Array(b*r);b=0;for(let t=0;t<p;t++)if(U[t]===b){i(a,(m?d[t]:t)*r,v,b*r,r),b++}if(d&&!m){const e=new Uint32Array(g);for(let t=0;t<e.length;t++)e[t]=U[d[t]];U=n.compactIndices(e)}return{buffer:Array.isArray(v)?v:v.buffer,indices:U,uniqueCount:b}}function l(e,t,n,r){for(let l=0;l<r;l++)if(e[t+l]!==e[n+l])return!1;return!0}function i(e,t,n,r,l){for(let i=0;i<l;i++)n[r+i]=e[t+i]}function o(e,t,n){let r=0;for(let l=0;l<n;l++)r=e[t+l]+r|0,r=r+(r<<11)+(r>>>2)|0;return r>>>0}let f=null;e.deduplicate=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
