/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../geometry","../../../Ground","../../../core/maybe","../../../core/promiseUtils","../../../core/unitUtils","../../Mesh","../MeshComponent","../MeshVertexAttributes","../../Point"],(function(e,t,n,o,r,i,a,s,l,u,c){"use strict";function p(e,t,n){return y.apply(this,arguments)}function y(){return(y=t._asyncToGenerator((function*(e,t,n){let r;if(m(e)||e instanceof o){const o=yield d(e);r=yield o.createElevationSampler(t,{demResolution:n&&n.demResolution||"finest-contiguous"})}else r=e;return f(r,t,n)}))).apply(this,arguments)}function f(e,t,n){const o=a.getMetersPerUnitForSR(t.spatialReference),i=e.demResolution.min/o,c=Math.round(t.width/i),p=Math.round(t.height/i),y=c+1,f=p+1,d=new Float64Array(y*f*3),h=new Float32Array(y*f*2);let m=0,g=0;const M=new Uint32Array(c*p*2*3);let R=0,b=0;w.spatialReference=t.spatialReference;for(let a=0;a<f;a++){const n=t.ymin+t.height*(a/p);for(let o=0;o<y;o++){const i=t.xmin+t.width*(o/c);w.x=i,w.y=n,d[m++]=i,d[m++]=n,d[m++]=r.unwrapOr(e.elevationAt(w),0);const s=o/c,l=a/p;h[g++]=s,h[g++]=l,a!==p&&o!==c&&(M[b++]=R+1,M[b++]=R+y+1,M[b++]=R+y,M[b++]=R,M[b++]=R+1,M[b++]=R+y),R++}}return new s({vertexAttributes:new u.MeshVertexAttributes({position:d,uv:h}),components:[new l({faces:M,shading:"smooth",material:n&&n.material||null})],spatialReference:t.spatialReference})}function d(e){return h.apply(this,arguments)}function h(){return(h=t._asyncToGenerator((function*(e){return m(e)?e.load():(yield e.load(),yield i.eachAlways(e.layers.map((e=>e.load()))),e)}))).apply(this,arguments)}function m(e){return"type"in e&&("elevation"===e.type||"base-elevation"===e.type)}const w=new c;e.create=p,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
