/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../core/promiseUtils","../../Point","../../../geometry","../../../Ground","../../../core/unitUtils","../../Mesh"],(function(e,t,n,a,i,o,r){"use strict";function s(e){return"type"in e&&("elevation"===e.type||"base-elevation"===e.type)}const l=new n;e.create=async function(e,n,a){let c;if(s(e)||e instanceof i){const i=await async function(e){if(s(e))return e.load();return await e.load(),await t.eachAlways(e.layers.map((e=>e.load()))),e}(e);c=await i.createElevationSampler(n,{demResolution:a&&a.demResolution||"finest-contiguous"})}else c=e;return function(e,t,n){const a=o.getMetersPerUnitForSR(t.spatialReference),i=e.demResolution.min/a,s=Math.round(t.width/i),c=Math.round(t.height/i),u=s+1,f=c+1,d=new Float64Array(u*f*3),p=new Float32Array(u*f*2);let m=0,y=0;const h=new Uint32Array(s*c*2*3);let w=0,R=0;l.spatialReference=t.spatialReference;for(let n=0;n<f;n++){const a=t.ymin+t.height*(n/c);for(let i=0;i<u;i++){const o=t.xmin+t.width*(i/s);l.x=o,l.y=a,d[m++]=o,d[m++]=a,d[m++]=e.elevationAt(l)||0;const r=i/s,f=n/c;p[y++]=r,p[y++]=f,n!==c&&i!==s&&(h[R++]=w+1,h[R++]=w+u+1,h[R++]=w+u,h[R++]=w,h[R++]=w+1,h[R++]=w+u),w++}}return new r({vertexAttributes:{position:d,uv:p},components:[{faces:h,shading:"smooth",material:n&&n.material||null}],spatialReference:t.spatialReference})}(c,n,a)},Object.defineProperty(e,"__esModule",{value:!0})}));
