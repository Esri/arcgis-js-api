/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../../core/has"],(function(t,e){"use strict";let i=function(){function t(e,i){if(!e)throw new Error("GLB requires a JSON gltf chunk");this.length=t.HEADER_SIZE,this.length+=t.CHUNK_HEADER_SIZE;const n=this.textToArrayBuffer(e);if(this.length+=this.alignTo(n.byteLength,4),i&&(this.length+=t.CHUNK_HEADER_SIZE,this.length+=i.byteLength,i.byteLength%4))throw new Error("Expected BIN chunk length to be divisible by 4 at this point");this.buffer=new ArrayBuffer(this.length),this.outView=new DataView(this.buffer),this.writeHeader();const r=this.writeChunk(n,12,1313821514,32);i&&this.writeChunk(i,r,5130562)}var i=t.prototype;return i.writeHeader=function(){this.outView.setUint32(0,t.MAGIC,!0),this.outView.setUint32(4,t.VERSION,!0),this.outView.setUint32(8,this.length,!0)},i.writeChunk=function(t,e,i,n=0){const r=this.alignTo(t.byteLength,4);for(this.outView.setUint32(e,r,!0),this.outView.setUint32(e+=4,i,!0),this.writeArrayBuffer(this.outView.buffer,t,e+=4,0,t.byteLength),e+=t.byteLength;e%4;)n&&this.outView.setUint8(e,n),e++;return e},i.writeArrayBuffer=function(t,e,i,n,r){new Uint8Array(t,i,r).set(new Uint8Array(e,n,r),0)},i.textToArrayBuffer=function(t){if(e("esri-text-encoder"))return(new TextEncoder).encode(t).buffer;const i=new Uint8Array(t.length);for(let e=0;e<i.length;++e)i[e]=t.charCodeAt(e);return i.buffer},i.alignTo=function(t,e){return e*Math.ceil(t/e)},t}();i.HEADER_SIZE=12,i.CHUNK_HEADER_SIZE=8,i.MAGIC=1179937895,i.VERSION=2,t.GLB=i,Object.defineProperty(t,"__esModule",{value:!0})}));
