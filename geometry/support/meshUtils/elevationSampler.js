/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","../../../core/workers/workers","../../../chunks/vec3f64","../ray","../triangle","./ElevationSamplerWorker","../../../layers/support/ElevationSampler"],(function(e,n,t,r,o,a,l,i,u){"use strict";function c(e,n){return s.apply(this,arguments)}function s(){return(s=n._asyncToGenerator((function*(e,n){const t=yield p(),r=yield h.createIndex(e,t);return f(t),new m(e,r,n)}))).apply(this,arguments)}let m=function(e){function r(n,r,o){var a;return(a=e.call(this)||this)._rindex=r,a.demResolution={min:0,max:0},a.spatialReference=n.spatialReference.clone(),a.extent=n.extent.clone(),a.noDataValue=t.isSome(o)&&o.noDataValue||0,a}return n._inheritsLoose(r,e),r.prototype.elevationAt=function(e,n){let t=Number.NEGATIVE_INFINITY;return a.fromValues([e,n,0],[0,0,-1],E),this._rindex.search({minX:e,maxX:e,minY:n,maxY:n},(e=>{l.intersectRay(e,E,N)&&N[2]>t&&(t=N[2])})),t===Number.NEGATIVE_INFINITY?this.noDataValue:t},r}(u.ElevationSamplerBase);function p(){return++d,y(),x||(x=r.open("ElevationSamplerWorker").catch((()=>null)),x)}function f(e){--d,t.isSome(e)&&0===d&&(I=setTimeout((()=>{e.close(),x=null,I=0}),v))}function y(){I&&(clearTimeout(I),I=0)}const h=new i;let d=0,x=null,I=0;const v=1e4,E=a.fromValues([0,0,0],[0,0,-1]),N=o.create();e.create=c,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
