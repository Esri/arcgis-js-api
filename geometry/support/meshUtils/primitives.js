/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/vec3f64","../../../chunks/vec3","../../../chunks/mat3f64","./georeference"],(function(t,e,n,r,o){"use strict";function a(){const{faceDescriptions:t,faceVertexOffsets:e,uvScales:n}=g,r=4*t.length,o=new Float64Array(3*r),a=new Float32Array(3*r),i=new Float32Array(2*r),s=new Uint32Array(2*t.length*3);let c=0,l=0,f=0,u=0;for(let h=0;h<t.length;h++){const r=t[h],p=c/3;for(const t of e)s[u++]=p+t;const w=r.corners;for(let t=0;t<4;t++){const e=w[t];let s=0;i[f++]=.25*n[t][0]+r.uvOrigin[0],i[f++]=r.uvOrigin[1]-.25*n[t][1];for(let t=0;t<3;t++)0!==r.axis[t]?(o[c++]=.5*r.axis[t],a[l++]=r.axis[t]):(o[c++]=.5*e[s++],a[l++]=0)}}return{position:o,normal:a,uv:i,faces:s}}function i(t=0){const e=Math.round(8*2**t),n=2*e,r=(e-1)*(n+1)+2*n,o=new Float64Array(3*r),a=new Float32Array(3*r),i=new Float32Array(2*r),s=new Uint32Array(3*((e-1)*n*2));let c=0,l=0,f=0,u=0;for(let h=0;h<=e;h++){const t=h/e*Math.PI+.5*Math.PI,r=Math.cos(t),p=Math.sin(t);y[2]=p;const w=0===h||h===e,v=w?n-1:n;for(let g=0;g<=v;g++){const t=g/v*2*Math.PI;y[0]=-Math.sin(t)*r,y[1]=Math.cos(t)*r;for(let e=0;e<3;e++)o[c]=.5*y[e],a[c]=y[e],++c;i[l++]=(g+(w?.5:0))/n,i[l++]=h/e,0!==h&&g!==n&&(h!==e&&(s[f++]=u,s[f++]=u+1,s[f++]=u-n),1!==h&&(s[f++]=u,s[f++]=u-n,s[f++]=u-n-1)),u++}}return{position:o,normal:a,uv:i,faces:s}}function s(t=0){const e=5,n=Math.round(16*2**t),r=(e-1)*(n+1)+2*n,o=new Float64Array(3*r),a=new Float32Array(3*r),i=new Float32Array(2*r),s=new Uint32Array(3*(4*n));let c=0,l=0,f=0,u=0,h=0;for(let p=0;p<=e;p++){const t=0===p||p===e,r=p<=1||p>=e-1,w=2===p||4===p,v=t?n-1:n;for(let g=0;g<=v;g++){const m=g/v*2*Math.PI,A=t?0:.5;y[0]=A*Math.sin(m),y[1]=A*-Math.cos(m),y[2]=p<=2?.5:-.5;for(let t=0;t<3;t++)o[c++]=y[t],a[l++]=r?2===t?p<=1?1:-1:0:2===t?0:y[t]/A;i[f++]=(g+(t?.5:0))/n,i[f++]=p<=1?1*p/3:p<=3?1*(p-2)/3+1/3:1*(p-4)/3+2/3,w||0===p||g===n||(p!==e&&(s[u++]=h,s[u++]=h+1,s[u++]=h-n),1!==p&&(s[u++]=h,s[u++]=h-n,s[u++]=h-n-1)),h++}}return{position:o,normal:a,uv:i,faces:s}}function c(t){const e=h.facingAxisOrderSwap[t],n=h.position,r=h.normal,o=new Float64Array(n.length),a=new Float32Array(r.length);let i=0;for(let s=0;s<4;s++){const t=i;for(let s=0;s<3;s++){const c=e[s],l=Math.abs(c)-1,f=c>=0?1:-1;o[i]=n[t+l]*f,a[i]=r[t+l]*f,i++}}return{position:o,normal:a,uv:new Float32Array(h.uv),faces:new Uint32Array(h.faces)}}const l=1,f=2,u=3,h={position:[-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0],normal:[0,0,1,0,0,1,0,0,1,0,0,1],uv:[0,1,1,1,1,0,0,0],faces:[0,1,2,0,2,3],facingAxisOrderSwap:{east:[u,l,f],west:[-u,-l,f],north:[-l,u,f],south:[l,-u,f],up:[l,f,u],down:[l,-f,-u]}};function p(t,e,n){w(t),v(t,n&&n.size);const r=o.georeference(t,e,n);return{vertexAttributes:{position:r.position,normal:r.normal,uv:t.uv},components:[{faces:t.faces,material:n&&n.material||null}],spatialReference:e.spatialReference}}function w(t){for(let e=0;e<t.position.length;e+=3)t.position[e+2]+=.5}function v(t,e){if(null==e)return;const r="number"==typeof e?[e,e,e]:[null!=e.width?e.width:1,null!=e.depth?e.depth:1,null!=e.height?e.height:1];A[0]=r[0],A[4]=r[1],A[8]=r[2];for(let o=0;o<t.position.length;o+=3){for(let e=0;e<3;e++)y[e]=t.position[o+e];n.transformMat3(y,y,A);for(let e=0;e<3;e++)t.position[o+e]=y[e]}if(r[0]!==r[1]||r[1]!==r[2]){A[0]=1/r[0],A[4]=1/r[1],A[8]=1/r[2];for(let e=0;e<t.normal.length;e+=3){for(let n=0;n<3;n++)y[n]=t.normal[e+n];n.transformMat3(y,y,A),n.normalize(y,y);for(let n=0;n<3;n++)t.normal[e+n]=y[n]}}}const g={faceDescriptions:[{axis:[0,-1,0],uvOrigin:[0,.625],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[1,0,0],uvOrigin:[.25,.625],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[0,1,0],uvOrigin:[.5,.625],corners:[[1,-1],[-1,-1],[-1,1],[1,1]]},{axis:[-1,0,0],uvOrigin:[.75,.625],corners:[[1,-1],[-1,-1],[-1,1],[1,1]]},{axis:[0,0,1],uvOrigin:[0,.375],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[0,0,-1],uvOrigin:[0,.875],corners:[[-1,1],[1,1],[1,-1],[-1,-1]]}],uvScales:[[0,0],[1,0],[1,1],[0,1]],faceVertexOffsets:[0,1,2,0,2,3]},m={south:0,east:1,north:2,west:3,up:4,down:5},y=e.create(),A=r.create();t.boxFaceOrder=m,t.convertUnitGeometry=p,t.createUnitSizeBox=a,t.createUnitSizeCylinder=s,t.createUnitSizePlane=c,t.createUnitSizeSphere=i,Object.defineProperty(t,"__esModule",{value:!0})}));
