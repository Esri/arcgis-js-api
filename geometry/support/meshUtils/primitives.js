/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/vec3f64","../../../chunks/vec3","../../../chunks/mat3f64","./georeference"],(function(t,e,n,r,o){"use strict";const a={position:[-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0],normal:[0,0,1,0,0,1,0,0,1,0,0,1],uv:[0,1,1,1,1,0,0,0],faces:[0,1,2,0,2,3],facingAxisOrderSwap:{east:[3,1,2],west:[-3,-1,2],north:[-1,3,2],south:[1,-3,2],up:[1,2,3],down:[1,-2,-3]}};const i={faceDescriptions:[{axis:[0,-1,0],uvOrigin:[0,.625],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[1,0,0],uvOrigin:[.25,.625],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[0,1,0],uvOrigin:[.5,.625],corners:[[1,-1],[-1,-1],[-1,1],[1,1]]},{axis:[-1,0,0],uvOrigin:[.75,.625],corners:[[1,-1],[-1,-1],[-1,1],[1,1]]},{axis:[0,0,1],uvOrigin:[0,.375],corners:[[-1,-1],[1,-1],[1,1],[-1,1]]},{axis:[0,0,-1],uvOrigin:[0,.875],corners:[[-1,1],[1,1],[1,-1],[-1,-1]]}],uvScales:[[0,0],[1,0],[1,1],[0,1]],faceVertexOffsets:[0,1,2,0,2,3]},s=e.create(),c=r.create();t.boxFaceOrder={south:0,east:1,north:2,west:3,up:4,down:5},t.convertUnitGeometry=function(t,e,r){!function(t){for(let e=0;e<t.position.length;e+=3)t.position[e+2]+=.5}(t),function(t,e){if(null==e)return;const r="number"==typeof e?[e,e,e]:[null!=e.width?e.width:1,null!=e.depth?e.depth:1,null!=e.height?e.height:1];c[0]=r[0],c[4]=r[1],c[8]=r[2];for(let e=0;e<t.position.length;e+=3){for(let n=0;n<3;n++)s[n]=t.position[e+n];n.transformMat3(s,s,c);for(let n=0;n<3;n++)t.position[e+n]=s[n]}if(r[0]!==r[1]||r[1]!==r[2]){c[0]=1/r[0],c[4]=1/r[1],c[8]=1/r[2];for(let e=0;e<t.normal.length;e+=3){for(let n=0;n<3;n++)s[n]=t.normal[e+n];n.transformMat3(s,s,c),n.normalize(s,s);for(let n=0;n<3;n++)t.normal[e+n]=s[n]}}}(t,r&&r.size);const a=o.georeference(t,e,r);return{vertexAttributes:{position:a.position,normal:a.normal,uv:t.uv},components:[{faces:t.faces,material:r&&r.material||null}],spatialReference:e.spatialReference}},t.createUnitSizeBox=function(){const{faceDescriptions:t,faceVertexOffsets:e,uvScales:n}=i,r=4*t.length,o=new Float64Array(3*r),a=new Float32Array(3*r),s=new Float32Array(2*r),c=new Uint32Array(2*t.length*3);let l=0,f=0,u=0,h=0;for(let r=0;r<t.length;r++){const i=t[r],p=l/3;for(const t of e)c[h++]=p+t;const w=i.corners;for(let t=0;t<4;t++){const e=w[t];let r=0;s[u++]=.25*n[t][0]+i.uvOrigin[0],s[u++]=i.uvOrigin[1]-.25*n[t][1];for(let t=0;t<3;t++)0!==i.axis[t]?(o[l++]=.5*i.axis[t],a[f++]=i.axis[t]):(o[l++]=.5*e[r++],a[f++]=0)}}return{position:o,normal:a,uv:s,faces:c}},t.createUnitSizeCylinder=function(t=0){const e=Math.round(16*Math.pow(2,t)),n=4*(e+1)+2*e,r=new Float64Array(3*n),o=new Float32Array(3*n),a=new Float32Array(2*n),i=new Uint32Array(3*(4*e));let c=0,l=0,f=0,u=0,h=0;for(let t=0;t<=5;t++){const n=0===t||5===t,p=t<=1||t>=4,w=2===t||4===t,v=n?e-1:e;for(let g=0;g<=v;g++){const m=g/v*2*Math.PI,y=n?0:.5;s[0]=y*Math.sin(m),s[1]=y*-Math.cos(m),s[2]=t<=2?.5:-.5;for(let e=0;e<3;e++)r[c++]=s[e],o[l++]=p?2===e?t<=1?1:-1:0:2===e?0:s[e]/y;a[f++]=(g+(n?.5:0))/e,a[f++]=t<=1?1*t/3:t<=3?1*(t-2)/3+1/3:1*(t-4)/3+2/3,w||0===t||g===e||(5!==t&&(i[u++]=h,i[u++]=h+1,i[u++]=h-e),1!==t&&(i[u++]=h,i[u++]=h-e,i[u++]=h-e-1)),h++}}return{position:r,normal:o,uv:a,faces:i}},t.createUnitSizePlane=function(t){const e=a.facingAxisOrderSwap[t],n=a.position,r=a.normal,o=new Float64Array(n.length),i=new Float32Array(r.length);let s=0;for(let t=0;t<4;t++){const t=s;for(let a=0;a<3;a++){const c=e[a],l=Math.abs(c)-1,f=c>=0?1:-1;o[s]=n[t+l]*f,i[s]=r[t+l]*f,s++}}return{position:o,normal:i,uv:new Float32Array(a.uv),faces:new Uint32Array(a.faces)}},t.createUnitSizeSphere=function(t=0){const e=Math.round(8*Math.pow(2,t)),n=2*e,r=(e-1)*(n+1)+2*n,o=new Float64Array(3*r),a=new Float32Array(3*r),i=new Float32Array(2*r),c=new Uint32Array(3*((e-1)*n*2));let l=0,f=0,u=0,h=0;for(let t=0;t<=e;t++){const r=t/e*Math.PI+.5*Math.PI,p=Math.cos(r),w=Math.sin(r);s[2]=w;const v=0===t||t===e,g=v?n-1:n;for(let r=0;r<=g;r++){const w=r/g*2*Math.PI;s[0]=-Math.sin(w)*p,s[1]=Math.cos(w)*p;for(let t=0;t<3;t++)o[l]=.5*s[t],a[l]=s[t],++l;i[f++]=(r+(v?.5:0))/n,i[f++]=t/e,0!==t&&r!==n&&(t!==e&&(c[u++]=h,c[u++]=h+1,c[u++]=h-n),1!==t&&(c[u++]=h,c[u++]=h-n,c[u++]=h-n-1)),h++}}return{position:o,normal:a,uv:i,faces:c}},Object.defineProperty(t,"__esModule",{value:!0})}));
