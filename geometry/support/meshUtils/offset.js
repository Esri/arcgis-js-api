/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../../core/Logger","../../../core/maybe","../../../chunks/mat3","../../../chunks/mat3f64","../../../chunks/mat4f64","../../../chunks/vec3","../../../chunks/vec3f64","../../projection","../../projectionEllipsoid","./geographicUtils","./projection"],(function(e,t,r,o,n,i,s,a,c,g,f,p){"use strict";const l=t.getLogger("esri.geometry.support.meshUtils.offset");function m(e,t,o){if(e.vertexAttributes&&e.vertexAttributes.position)if(r.isSome(e.transform))null!=(null==o?void 0:o.geographic)&&o.geographic!==e.transform.geographic&&l.warn(`Specifying the 'geographic' parameter (${o.geographic}) different from the Mesh transform setting (${e.transform.geographic}) is not supported`),u(e.transform,t);else{f.isGeographicMesh(e.spatialReference,o)?h(e,t):P(e,t)}}function u(e,t){const r=e.origin;e.origin=s.add(a.create(),r,t)}function h(e,t){const n=e.spatialReference,i=e.vertexAttributes.position,a=e.vertexAttributes.normal,f=e.vertexAttributes.tangent,l=new Float64Array(i.length),m=r.isSome(a)?new Float32Array(a.length):null,u=r.isSome(f)?new Float32Array(f.length):null,h=e.extent.center,P=v;c.computeLinearTransformation(n,[h.x,h.y,h.z],d,g.getSphericalPCPF(n)),o.fromMat4(x,d),s.transformMat3(P,t,x),p.projectToPCPF(i,n,l),r.isSome(a)&&p.projectNormalToPCPF(a,i,l,n,m),r.isSome(f)&&p.projectTangentToPCPF(f,i,l,n,u),F(l,P),p.projectFromPCPF(l,i,n),r.isSome(a)&&p.projectNormalFromPCPF(m,i,l,n,a),r.isSome(f)&&p.projectTangentFromPCPF(u,i,l,n,f),e.vertexAttributesChanged()}function P(e,t){F(e.vertexAttributes.position,t),e.vertexAttributesChanged()}function F(e,t){if(e)for(let r=0;r<e.length;r+=3)for(let o=0;o<3;o++)e[r+o]+=t[o]}const v=a.create(),d=i.create(),x=n.create();e.offset=m,Object.defineProperty(e,"__esModule",{value:!0})}));
