/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../../core/mathUtils","../../core/maybe","../../chunks/vec3","../../chunks/vec3f64","../../chunks/sphere","./vectorStacks"],(function(t,n,e,r,c,o,i){"use strict";function u(t=w){return[t[0],t[1],t[2],t[3]]}function s(t,n,e,r){return f(t,n,e,r,i.sv4d.get())}function a(t,n){return f(n[0],n[1],n[2],n[3],t)}function f(t,n,e,r,c=u()){return c[0]=t,c[1]=n,c[2]=e,c[3]=r,c}function d(t,n,e){return r.copy(e,t),e[3]=n,e}function I(t,n,e){const r=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],c=Math.abs(r-1)>1e-5&&r>1e-12?1/Math.sqrt(r):1;return e[0]=n[0]*c,e[1]=n[1]*c,e[2]=n[2]*c,e[3]=-(e[0]*t[0]+e[1]*t[1]+e[2]*t[2]),e}function l(t,n,e,r=u()){const c=e[0]-n[0],o=e[1]-n[1],i=e[2]-n[2],s=t[0]-n[0],a=t[1]-n[1],f=t[2]-n[2],d=o*f-i*a,I=i*s-c*f,l=c*a-o*s,N=d*d+I*I+l*l,M=Math.abs(N-1)>1e-5&&N>1e-12?1/Math.sqrt(N):1;r[0]=d*M,r[1]=I*M,r[2]=l*M,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2])}function N(t,n){return M(t,n,0,1,2)}function M(t,n,e,c,o){if(t.count<3)return!1;t.getVec(e,g);let i=c,u=!1;for(;i<t.count-1&&!u;)t.getVec(i,p),i++,u=!r.exactEquals(g,p);if(!u)return!1;for(i=Math.max(i,o),u=!1;i<t.count&&!u;)t.getVec(i,A),i++,r.subtract(E,g,p),r.normalize(E,E),r.subtract(P,p,A),r.normalize(P,P),u=!r.exactEquals(g,A)&&!r.exactEquals(p,A)&&Math.abs(r.dot(E,P))<m;return u?(l(g,p,A,n),!0):(0!==e||1!==c||2!==o)&&M(t,n,0,1,2)}const m=.99619469809,g=c.create(),p=c.create(),A=c.create(),E=c.create(),P=c.create();function h(t,n,e){return n!==t&&a(t,n),t[3]=-r.dot(U(t),e),t}function v(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function y(t,n,e,c){return r.cross(A,n,t),I(e,A,c)}function F(t,n,e,c){return B(t,n,r.subtract(i.sv3d.get(),e,n),R,c)}function b(t,n,r){return!!e.isSome(n)&&B(t,n.origin,n.direction,G,r)}function _(t,n,e){return B(t,n.origin,n.vector,D.NONE,e)}function T(t,n,e){return B(t,n.origin,n.vector,D.CLAMP,e)}function S(t,n){return z(t,o.getCenter(n))-n[3]>=0}function O(t,n){return z(t,o.getCenter(n))+n[3]<0}function C(t,n){return z(t,n)>=0}function L(t,n){return z(t,n)<0}function V(t,n){const e=n[0],r=n[1],c=n[2],o=n[3],i=n[4],u=n[5];return t[0]*(t[0]>0?e:o)+t[1]*(t[1]>0?r:i)+t[2]*(t[2]>0?c:u)+t[3]>=0}function q(t,n){const e=r.dot(U(t),n.ray.direction),c=-z(t,n.ray.origin);if(c<0&&e>=0)return!1;if(e>-1e-6&&e<1e-6)return c>0;if((c<0||e<0)&&!(c<0&&e<0))return!0;const o=c/e;return e>0?o<n.c1&&(n.c1=o):o>n.c0&&(n.c0=o),n.c0<=n.c1}function x(t,n){const e=r.dot(U(t),n.ray.direction),c=-z(t,n.ray.origin);if(e>-1e-6&&e<1e-6)return c>0;const o=c/e;return e>0?o<n.c1&&(n.c1=o):o>n.c0&&(n.c0=o),n.c0<=n.c1}function X(t,n,e){const c=r.scale(i.sv3d.get(),U(t),-t[3]),o=k(t,r.subtract(i.sv3d.get(),n,c),i.sv3d.get());return r.add(e,o,c),e}function k(t,n,e){const c=r.scale(i.sv3d.get(),U(t),r.dot(U(t),n));return r.subtract(e,n,c),e}function j(t,n){return Math.abs(z(t,n))}function z(t,n){return r.dot(U(t),n)+t[3]}function B(t,e,c,o,i){const u=r.dot(U(t),c);if(0===u)return!1;let s=-(r.dot(U(t),e)+t[3])/u;return o&D.CLAMP&&(s=n.clamp(s,0,1)),!(!(o&D.INFINITE_MIN)&&s<0||!(o&D.INFINITE_MAX)&&s>1)&&(r.add(i,e,r.scale(i,c,s)),!0)}function U(t){return t}const w=[0,0,1,0];var D;!function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"}(D||(D={}));const R=D.INFINITE_MIN|D.INFINITE_MAX,G=D.INFINITE_MAX;t.UP=w,t.clip=q,t.clipInfinite=x,t.copy=a,t.create=u,t.distance=j,t.fromManyPoints=N,t.fromManyPointsSampleAt=M,t.fromNormalAndOffset=d,t.fromPoints=l,t.fromPositionAndNormal=I,t.fromValues=f,t.fromVectorsAndPoint=y,t.intersectLine=F,t.intersectLineSegment=_,t.intersectLineSegmentClamp=T,t.intersectRay=b,t.isAABBFullyInside=V,t.isPointInside=C,t.isPointOutside=L,t.isSphereFullyInside=S,t.isSphereFullyOutside=O,t.negate=v,t.normal=U,t.projectPoint=X,t.projectVector=k,t.setOffsetFromPoint=h,t.signedDistance=z,t.wrap=s,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
