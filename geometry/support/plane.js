/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../core/mathUtils","../../core/maybe","../../chunks/vec3","../../chunks/vec3f64","../../chunks/sphere","./vectorStacks"],(function(t,n,e,r,c,o,i){"use strict";function u(t=R){return[t[0],t[1],t[2],t[3]]}function s(t,n,e,r){return f(t,n,e,r,i.sv4d.get())}function a(t,n=u()){return f(t[0],t[1],t[2],t[3],n)}function f(t,n,e,r,c=u()){return c[0]=t,c[1]=n,c[2]=e,c[3]=r,c}function d(t,n,e){return r.copy(e,t),e[3]=n,e}function l(t,n,e){r.copy(e,n);const c=r.dot(n,n);return Math.abs(c-1)>1e-5&&c>1e-12&&r.scale(e,e,1/Math.sqrt(c)),S(e,t,e)}function g(t,n,e,c=u()){return V(r.subtract(i.sv3d.get(),t,n),r.subtract(i.sv3d.get(),e,n),t,c)}function m(t,n){return p(t,n,0,1,2)}function p(t,n,e,c,o){if(t.count<3)return!1;t.getVec(e,v);let i=c,u=!1;for(;i<t.count-1&&!u;)t.getVec(i,b),i++,u=!r.exactEquals(v,b);if(!u)return!1;for(i=Math.max(i,o),u=!1;i<t.count&&!u;)t.getVec(i,h),i++,r.subtract(P,v,b),r.normalize(P,P),r.subtract(M,b,h),r.normalize(M,M),u=!r.exactEquals(v,h)&&!r.exactEquals(b,h)&&Math.abs(r.dot(P,M))<y;return u?(g(v,b,h,n),!0):(0!==e||1!==c||2!==o)&&p(t,n,0,1,2)}const y=.99619469809,v=c.create(),b=c.create(),h=c.create(),P=c.create(),M=c.create();function S(t,n,e){return t!==e&&a(t,e),e[3]=-r.dot(D(e),n),e}function A(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function V(t,n,e,c){return l(e,r.cross(h,n,t),c)}function x(t,n,e,c){return w(t,n,r.subtract(i.sv3d.get(),e,n),G,c)}function O(t,n,r){return!!e.isSome(n)&&w(t,n.origin,n.direction,H,r)}function k(t,n,e){return w(t,n.origin,n.vector,0,e)}function q(t,n,e){return w(t,n.origin,n.vector,1,e)}function F(t,n){return _(t,o.getCenter(n))-n[3]>=0}function I(t,n){return _(t,o.getCenter(n))+n[3]<0}function j(t,n){return _(t,n)>=0}function C(t,n){return _(t,n)<0}function E(t,n){const e=n[0],r=n[1],c=n[2],o=n[3],i=n[4],u=n[5];return t[0]*(t[0]>0?e:o)+t[1]*(t[1]>0?r:i)+t[2]*(t[2]>0?c:u)+t[3]>=0}function L(t,n){const e=r.dot(D(t),n.ray.direction),c=-_(t,n.ray.origin);if(c<0&&e>=0)return!1;if(e>-1e-6&&e<1e-6)return c>0;if((c<0||e<0)&&!(c<0&&e<0))return!0;const o=c/e;return e>0?o<n.c1&&(n.c1=o):o>n.c0&&(n.c0=o),n.c0<=n.c1}function z(t,n){const e=r.dot(D(t),n.ray.direction),c=-_(t,n.ray.origin);if(e>-1e-6&&e<1e-6)return c>0;const o=c/e;return e>0?o<n.c1&&(n.c1=o):o>n.c0&&(n.c0=o),n.c0<=n.c1}function B(t,n,e){const c=r.scale(i.sv3d.get(),D(t),-t[3]),o=N(t,r.subtract(i.sv3d.get(),n,c),i.sv3d.get());return r.add(e,o,c),e}function N(t,n,e){const c=r.scale(i.sv3d.get(),D(t),r.dot(D(t),n));return r.subtract(e,n,c),e}function U(t,n){return Math.abs(_(t,n))}function _(t,n){return r.dot(D(t),n)+t[3]}function w(t,e,c,o,i){const u=r.dot(D(t),c);if(0===u)return!1;let s=-(r.dot(D(t),e)+t[3])/u;return 1&o&&(s=n.clamp(s,0,1)),!(!(4&o)&&s<0||!(8&o)&&s>1)&&(r.add(i,e,r.scale(i,c,s)),!0)}function D(t){return t}const R=[0,0,1,0],G=12,H=8;t.UP=R,t.clip=L,t.clipInfinite=z,t.copy=a,t.create=u,t.distance=U,t.fromManyPoints=m,t.fromManyPointsSampleAt=p,t.fromNormalAndOffset=d,t.fromPoints=g,t.fromPositionAndNormal=l,t.fromValues=f,t.fromVectorsAndPoint=V,t.intersectLine=x,t.intersectLineSegment=k,t.intersectLineSegmentClamp=q,t.intersectRay=O,t.isAABBFullyInside=E,t.isPointInside=j,t.isPointOutside=C,t.isSphereFullyInside=F,t.isSphereFullyOutside=I,t.negate=A,t.normal=D,t.projectPoint=B,t.projectVector=N,t.setOffsetFromPoint=S,t.signedDistance=_,t.wrap=s,Object.defineProperty(t,"__esModule",{value:!0})}));
