// COPYRIGHT Â© 2022 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.43/esri/copyright.txt for details.

define(["require","exports","./polyfill/tsSupport/extends","./executionError","../libs/luxon/luxon"],(function(e,t,n,r,o){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.createDateTimeZone=t.ArcadeDate=t.ArcadeDateError=t.ArcadeDateErrorMessages=t.ArcadeDateErrorCodes=t.UnknownTimeZone=void 0;var a,s=function(){function e(){}return e.instance=new o.IANAZone("Etc/UTC"),e}();t.UnknownTimeZone=s,function(e){e.TimeZoneNotRecognised="TimeZoneNotRecognised"}(a=t.ArcadeDateErrorCodes||(t.ArcadeDateErrorCodes={})),t.ArcadeDateErrorMessages=((i={})[a.TimeZoneNotRecognised]="Timezone identifier has not been recognised.",i);var u=function(e){function o(n,i){var a=e.call(this,r.doSubstitutions(t.ArcadeDateErrorMessages[n],i))||this;return a.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(a,o),a}return n(o,e),o}(Error);t.ArcadeDateError=u;var c=function(){function e(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}return e.fromParts=function(t,n,r,i,a,s,u,c){if(void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),isNaN(t)||isNaN(n)||isNaN(r)||isNaN(i)||isNaN(a)||isNaN(s)||isNaN(u))return null;var f=0,m=o.DateTime.local(t,n).daysInMonth;r<1&&(f=r-1,r=1),r>m&&(f=r-m,r=m);var p=0;n>12?(p=n-12,n=12):n<1&&(p=n-1,n=1);var l=0;a>59?(l=a-59,a=59):a<0&&(l=a,a=0);var y=0;s>59?(y=s-59,s=59):s<0&&(y=s,s=0);var h=0;u>999?(h=u-999,u=999):u<0&&(h=u,u=0);var b=o.DateTime.fromObject({day:r,year:t,month:n,hour:i,minute:a,second:s,millisecond:u},{zone:d(c)});return 0!==p&&(b=b.plus({months:p})),0!==f&&(b=b.plus({days:f})),0!==l&&(b=b.plus({minutes:l})),0!==y&&(b=b.plus({seconds:y})),0!==h&&(b=b.plus({milliseconds:h})),new e(b)},Object.defineProperty(e,"systemTimeZoneCanonicalName",{get:function(){var e;return null!==(e=Intl.DateTimeFormat().resolvedOptions().timeZone)&&void 0!==e?e:"system"},enumerable:!1,configurable:!0}),e.arcadeDateAndZoneToArcadeDate=function(t,n){var r=d(n);return t.isUnknownTimeZone?e.fromParts(t.year,t.monthJS+1,t.day,t.hour,t.minute,t.second,t.millisecond,r):r===s.instance?e.fromParts(t.year,t.monthJS+1,t.day,t.hour,t.minute,t.second,t.millisecond,r):new e(t._date.setZone(n))},e.dateJSToArcadeDate=function(t){return new e(o.DateTime.fromJSDate(t,{zone:"system"}))},e.dateJSAndZoneToArcadeDate=function(t,n){return void 0===n&&(n="system"),new e(o.DateTime.fromJSDate(t,{zone:n}))},e.unknownEpochToArcadeDate=function(t){return new e(o.DateTime.fromMillis(t,{zone:s.instance}))},e.unknownDateJSToArcadeDate=function(t){return e.arcadeDateAndZoneToArcadeDate(e.dateJSToArcadeDate(t),s.instance)},e.epochToArcadeDate=function(t,n){return void 0===n&&(n="system"),new e(o.DateTime.fromMillis(t,{zone:n}))},e.dateTimeToArcadeDate=function(t){return new e(t)},e.prototype.changeTimeZone=function(t){var n=d(t);return e.dateTimeToArcadeDate(this._date.setZone(n))},e.dateTimeAndZoneToArcadeDate=function(t,n){var r=d(n);return t.zone===s.instance?e.fromParts(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond,r):r===s.instance?e.fromParts(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond,r):new e(t.setZone(r))},e.nowToArcadeDate=function(t){return new e(o.DateTime.fromJSDate(new Date,{zone:t}))},e.nowUTCToArcadeDate=function(){return new e(o.DateTime.utc())},Object.defineProperty(e.prototype,"isSystem",{get:function(){return"system"===this.timeZone||this.timeZone===e.systemTimeZoneCanonicalName},enumerable:!1,configurable:!0}),e.prototype.equals=function(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)},Object.defineProperty(e.prototype,"isUnknownTimeZone",{get:function(){return this._date.zone===s.instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._date.isValid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hour",{get:function(){return this._date.hour},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"second",{get:function(){return this._date.second},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"day",{get:function(){return this._date.day},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dayOfWeekISO",{get:function(){return this._date.weekday},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dayOfWeekJS",{get:function(){var e=this._date.weekday;return e>6&&(e=0),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"millisecond",{get:function(){return this._date.millisecond},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"monthISO",{get:function(){return this._date.month},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"weekISO",{get:function(){return this._date.weekNumber},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yearISO",{get:function(){return this._date.weekYear},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"monthJS",{get:function(){return this._date.month-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"year",{get:function(){return this._date.year},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minute",{get:function(){return this._date.minute},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zone",{get:function(){return this._date.zone},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeZoneOffset",{get:function(){return this.isUnknownTimeZone?0:this._date.offset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeZone",{get:function(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";var e=this.zone;return"fixed"===e.type?0===e.fixed?"utc":e.formatOffset(0,"short"):e.name},enumerable:!1,configurable:!0}),e.prototype.stringify=function(){return JSON.stringify(this.toJSDate())},e.prototype.plus=function(t){return new e(this._date.plus(t))},e.prototype.diff=function(e,t){return void 0===t&&(t="milliseconds"),this._date.diff(e._date,t)[t]},e.prototype.toISOString=function(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})},e.prototype.toFormat=function(e,t){return this._date.toFormat(e,t)},e.prototype.toJSDate=function(){return this._date.toJSDate()},e.prototype.toSQLString=function(){return"timestamp '"+this._date.toFormat("yyyy-LL-dd HH:mm:ss")+"'"},e.prototype.toDateTime=function(){return this._date},e.prototype.toNumber=function(){return this._date.toMillis()},e.prototype.getTime=function(){return this._date.toMillis()},e.prototype.toUTC=function(){return new e(this._date.toUTC())},e.prototype.toLocal=function(){return new e(this._date.toLocal())},e.prototype.toString=function(){return this.toISOString(!0)},e}();function d(e){if(e instanceof o.Zone)return e;if("system"===e.toLowerCase())return"system";if("utc"===e.toLowerCase())return"utc";if("unknown"===e.toLowerCase())return s.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(e)){var t=o.FixedOffsetZone.parseSpecifier("UTC"+(e.startsWith("+")||e.startsWith("-")?"":"+")+e);if(t)return t}var n=o.IANAZone.create(e);if(!n.isValid)throw new u(a.TimeZoneNotRecognised);return n}t.ArcadeDate=c,t.createDateTimeZone=d}));