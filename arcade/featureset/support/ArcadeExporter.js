/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../geometry/Geometry","../../FunctionWrapper","../../../chunks/languageUtils"],(function(e,n,t,r){"use strict";function o(e,s){switch(s.type){case"EmptyStatement":return"";case"VariableDeclarator":return function(e,n){const t=null===n.init?null:o(e,n.init),r=l(n.name,e.mangles);return""===t?r:r+" = "+t}(e,s);case"VariableDeclaration":return function(e,n){const t=[];for(let r=0;r<n.declarations.length;r++)t.push(o(e,n.declarations[r]));return"var "+t.join(",")+"; "}(e,s);case"BlockStatement":return function(e,n){let t="{\n";for(let r=0;r<n.body.length;r++)t+=o(e,n.body[r])+" \n";return t+="}\n",t}(e,s);case"FunctionDeclaration":return function(e,n){let t="function "+u(n.id.name,e.globalMangles,{});const r=[];let a={};a={};const s={};for(const e of n.params){const n=l(e.name,s);r.push(n),a[e.name]=1}return t+="("+r.join(",")+") ",t+=o({functions:e.functions,globals:e.globals,symbols:e.symbols,context:e.context,globalMangles:e.globalMangles,localMangles:s,locals:a},n.body),t}(e,s);case"ReturnStatement":return function(e,n){return null===n.argument?"return;":"return "+o(e,n.argument)+";\n"}(e,s);case"IfStatement":return function(e,n){return"if "+o(e,n.test)+" "+o(e,n.consequent)+(null!==n.alternate?"else "+o(e,n.alternate):"")}(e,s);case"ExpressionStatement":return function(e,n){return o(e,n.expression)+";"}(e,s);case"AssignmentExpression":return function(e,n){return o(e,n.left)+" "+n.operator+" "+o(e,n.right)}(e,s);case"UpdateExpression":return function(e,n){return!0===n.prefix?n.operator+o(e,n.argument):o(e,n.argument)+n.operator}(e,s);case"BreakStatement":return"break;";case"ContinueStatement":return"continue;";case"ForStatement":return function(e,n){let t="for(";return null!==n.init&&(t+=o(e,n.init)),t+=";",null!==n.test?t+=o(e,n.test):t+=" ;",null!==n.update?t+=o(e,n.update):t+=" ;",t+=") ",t+=o(e,n.body)+"\n",t}(e,s);case"ForInStatement":return function(e,n){return"for( "+o(e,n.left)+" in "+o(e,n.right)+") "+o(e,n.body)+"\n"}(e,s);case"Identifier":return function(e,o){const s=o.name.toLowerCase();if(void 0!==e.locals[s])return u(o.name,e.globalMangles,e.localMangles);{const l=e.context.globalScope[s];if(void 0===l)return o.name;if(null!==l){if(l.value instanceof t){return i(l.value,e.functions,e.globals,e.symbols)}if(null==l){const n=a(e.symbols);return e.globals.push({name:n,type:"null",params:{value:null}}),n}if(l instanceof n){const n=a(e.symbols);return e.globals.push({name:n,type:"geometry",params:{value:l}}),n}if(r.isNumber(l)){const n=a(e.symbols);return e.globals.push({name:n,type:"number",params:{value:l}}),n}if(r.isDate(l)){const n=a(e.symbols);return e.globals.push({name:n,type:"date",params:{value:r.toDate(l).getTime()}}),n}if(r.isString(l)){const n=a(e.symbols);return e.globals.push({name:n,type:"string",params:{value:l}}),n}if(r.isFeatureSet(l));else if(r.isImmutableArray(l));else if(!r.isArray(l))throw new Error("Unsupported Type")}}return o.name}(e,s);case"MemberExpression":return function(e,n){return"true"===n.computed?o(e,n.object)+"["+o(e,n.property)+"]":o(e,n.object)+"."+n.property.name}(e,s);case"Literal":return null===s.value||void 0===s.value?"null":JSON.stringify(s.value);case"ThisExpression":throw new Error("NOTSUPPORTED");case"CallExpression":return function(e,n){let t=o(e,n.callee)+"(";const r=[];for(const t of n.arguments)r.push(o(e,t));return t+=r.join(",")+")",t}(e,s);case"UnaryExpression":return function(e,n){return!0===n.prefix?n.operator+o(e,n.argument):o(e,n.argument)+n.operator}(e,s);case"BinaryExpression":return function(e,n){return"("+o(e,n.left)+" "+n.operator+" "+o(e,n.right)+")"}(e,s);case"LogicalExpression":return function(e,n){return o(e,n.left)+" "+n.operator+" "+o(e,n.right)}(e,s);case"ConditionalExpression":throw new Error("NOTSUPPORTED");case"ArrayExpression":return function(e,n){const t=[];for(let r=0;r<n.elements.length;r++)t.push(o(e,n.elements[r]));return"["+t.join(",")+"]"}(e,s);case"ObjectExpression":return function(e,n){let t="{";for(let r=0;r<n.properties.length;r++){const a=n.properties[r];t+=("Identifier"===a.key.type?JSON.stringify(a.key.name):o(e,a.key))+":"+o(e,a.value)}return t+="}",t}(e,s);case"Property":return function(){throw new Error("Not Supported")}();case"Array":throw new Error("NOTSUPPORTED");default:throw new Error("UNREOGNISED")}}function a(e){let n=!1,t="";for(;!1===n;)t="$gi_"+s.toString(),s++,void 0===e.syms[t]&&(n=!0);return t}let s=0;function l(e,n){const t="$$fc_"+s.toString();return s++,n[e]=t,t}function u(e,n,t){return void 0===t[e]?void 0===n[e]?e:n[e]:t[e]}function i(e,n,t,r){const a={functions:n,globals:t,symbols:r,context:e.context,locals:{},globalMangles:{},localMangles:{}},s=e.definition.id.name;if(void 0!==n.lkp[s])return n.lkp[s].mangledname;const u=l(s,a.globalMangles),i={name:s,mangledname:u,script:""};return i.script=o(a,e.definition),n.lkp[i.name]=i,n.stack.push(i),u}e.exportFunctionAsArcade=i,Object.defineProperty(e,"__esModule",{value:!0})}));
