/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../chunks/languageUtils","../executionError","../../intl/locale","../../chunks/datetime"],(function(e,t,n,r,o){"use strict";function u(e){const t=new Date(e.getTime()),n=t.getFullYear(),r=new Date(0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const o=s(r),u=new Date(0);u.setFullYear(n,0,4),u.setHours(0,0,0,0);const a=s(u);return t.getTime()>=o.getTime()?n+1:t.getTime()>=a.getTime()?n:n-1}function s(e){const t=1,n=new Date(e.getTime()),r=n.getDay(),o=(r<t?7:0)+r-t;return n.setDate(n.getDate()-o),n.setHours(0,0,0,0),n}function a(e){const t=u(e),n=new Date(0);n.setFullYear(t,0,4),n.setHours(0,0,0,0);return s(n)}function c(e,t,n){return e+(i(n)?m:l)[t]}function i(e){return e%4==0&&(e%100!=0||e%400==0)}const l=[0,31,59,90,120,151,181,212,243,273,304,334],m=[0,31,60,91,121,152,182,213,244,274,305,335];function f(e){return null===e?e:isNaN(e.getTime())?null:e}function d(e,i){e.today=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,0,0,e,n);const s=new Date;return s.setHours(0,0,0,0),s}))},e.now=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,0,0,e,n);return new Date}))},e.timestamp=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,0,0,e,n);let s=new Date;return s=new Date(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),s}))},e.toutc=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,1,1,e,n);const s=t.toDate(u[0]);return null===s?null:new Date(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds())}))},e.tolocal=function(e,n){return i(e,n,((r,u,s)=>{t.pcCheck(s,1,1,e,n);const a=t.toDate(s[0]);return null===a?null:o.DateTime.utc(a.getFullYear(),a.getMonth()+1,a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()).toJSDate()}))},e.day=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,1,1,e,n);const s=t.toDate(u[0]);return null===s?NaN:s.getDate()}))},e.month=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,1,1,e,n);const s=t.toDate(u[0]);return null===s?NaN:s.getMonth()}))},e.year=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,1,1,e,n);const s=t.toDate(u[0]);return null===s?NaN:s.getFullYear()}))},e.hour=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,1,1,e,n);const s=t.toDate(u[0]);return null===s?NaN:s.getHours()}))},e.second=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,1,1,e,n);const s=t.toDate(u[0]);return null===s?NaN:s.getSeconds()}))},e.millisecond=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,1,1,e,n);const s=t.toDate(u[0]);return null===s?NaN:s.getMilliseconds()}))},e.minute=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,1,1,e,n);const s=t.toDate(u[0]);return null===s?NaN:s.getMinutes()}))},e.week=function(e,r){return i(e,r,((o,u,s)=>{t.pcCheck(s,1,2,e,r);const a=t.toDate(s[0]);if(null===a)return NaN;const i=t.toNumber(t.defaultUndefined(s[1],0));if(i<0||i>6)throw new n.ArcadeExecutionError(e,n.ExecutionErrorCodes.InvalidParameter,r);const l=a.getDate(),m=a.getMonth(),f=a.getFullYear(),d=a.getDay(),g=c(l,m,f)-1,h=Math.floor(g/7);return d-i+(d-i<0?7:0)<g-7*h?h+1:h}))},e.weekday=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,1,1,e,n);const s=t.toDate(u[0]);return null===s?NaN:s.getDay()}))},e.isoweekday=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,1,1,e,n);const s=t.toDate(u[0]);if(null===s)return NaN;let a=s.getDay();return 0===a&&(a=7),a}))},e.isomonth=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,1,1,e,n);const s=t.toDate(u[0]);return null===s?NaN:s.getMonth()+1}))},e.isoweek=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,1,1,e,n);const c=t.toDate(u[0]);if(null===c)return NaN;const i=s(c).getTime()-a(c).getTime();return Math.round(i/6048e5)+1}))},e.isoyear=function(e,n){return i(e,n,((r,o,s)=>{t.pcCheck(s,1,1,e,n);const a=t.toDate(s[0]);return null===a?NaN:u(a)}))},e.date=function(e,n){return i(e,n,((u,s,a)=>{if(t.pcCheck(a,0,7,e,n),3===a.length)return f(new Date(t.toNumber(a[0]),t.toNumber(a[1]),t.toNumber(a[2]),0,0,0,0));if(4===a.length)return f(new Date(t.toNumber(a[0]),t.toNumber(a[1]),t.toNumber(a[2]),t.toNumber(a[3]),0,0,0));if(5===a.length)return f(new Date(t.toNumber(a[0]),t.toNumber(a[1]),t.toNumber(a[2]),t.toNumber(a[3]),t.toNumber(a[4]),0,0));if(6===a.length)return f(new Date(t.toNumber(a[0]),t.toNumber(a[1]),t.toNumber(a[2]),t.toNumber(a[3]),t.toNumber(a[4]),t.toNumber(a[5]),0));if(7===a.length)return f(new Date(t.toNumber(a[0]),t.toNumber(a[1]),t.toNumber(a[2]),t.toNumber(a[3]),t.toNumber(a[4]),t.toNumber(a[5]),t.toNumber(a[6])));if(2===a.length){let e,n=t.toString(a[1]);return""===n?null:(n=t.standardiseDateFormat(n),e="X"===n?o.DateTime.fromSeconds(t.toNumber(a[0])):"x"===n?o.DateTime.fromMillis(t.toNumber(a[0])):o.DateTime.fromFormat(t.toString(a[0]),n,{locale:r.getLocale(),numberingSystem:"latn"}),e.isValid?e.toJSDate():null)}if(1===a.length){if(t.isString(a[0])){if(""===a[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;if(!0===/^[0-9][0-9][0-9][0-9]$/.test(a[0]))return t.toDate(a[0]+"-01-01")}const e=t.toNumber(a[0]);if(!1===isNaN(e))return f(new Date(e));return t.toDate(a[0])}return 0===a.length?new Date:void 0}))},e.datediff=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,2,3,e,n);const s=t.toDateTime(u[0]),a=t.toDateTime(u[1]);if(null===s||null===a)return NaN;switch(t.toString(u[2]).toLowerCase()){case"days":case"day":case"d":return s.diff(a,"days").days;case"months":case"month":return s.diff(a,"months").months;case"minutes":case"minute":case"m":return"M"===u[2]?s.diff(a,"months").months:s.diff(a,"minutes").minutes;case"seconds":case"second":case"s":return s.diff(a,"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return s.diff(a).milliseconds;case"hours":case"hour":case"h":return s.diff(a,"hours").hours;case"years":case"year":case"y":return s.diff(a,"years").years}}))},e.dateadd=function(e,n){return i(e,n,((r,o,u)=>{t.pcCheck(u,2,3,e,n);const s=t.toDateTime(u[0]);if(null===s)return null;let a=t.toNumber(u[1]);if(isNaN(a))return s.toJSDate();let c="milliseconds";switch(t.toString(u[2]).toLowerCase()){case"days":case"day":case"d":c="days",a=t.absRound(a);break;case"months":case"month":c="months",a=t.absRound(a);break;case"minutes":case"minute":case"m":c="M"===u[2]?"months":"minutes";break;case"seconds":case"second":case"s":c="seconds";break;case"milliseconds":case"millisecond":case"ms":c="milliseconds";break;case"hours":case"hour":case"h":c="hours";break;case"years":case"year":case"y":c="years"}return s.plus({[c]:a}).toJSDate()}))}}e.registerFunctions=d,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
