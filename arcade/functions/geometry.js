/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../geometry/Geometry","../../geometry/Point","../../geometry/Extent","../../geometry/Multipoint","../../geometry/support/coordsUtils","../../geometry/Polygon","../../geometry/Polyline","../../geometry/support/jsonUtils","../ImmutablePointArray","../../chunks/languageUtils","../Dictionary","../Feature","./centroid"],(function(e,r,n,t,i,a,o,l,f,s,c,u,m,g){"use strict";e.registerFunctions=function(e,p){e.ringisclockwise=function(e,r){return p(e,r,(function(e,r,t){c.pcCheck(t,1,1);let i=[],o=!1,l=!1;if(null===t[0])return!1;if(c.isArray(t[0])){for(const e of t[0]){if(!(e instanceof n))throw new Error("Invalid Argument");i.push(e.hasZ?e.hasM?[e.x,e.y,e.z,e.m]:[e.x,e.y,e.z]:[e.x,e.y])}i.length>0&&(o=t[0][0].hasZ,l=t[0][0].hasM)}else if(t[0]instanceof s)i=t[0]._elements,i.length>0&&(o=t[0]._hasZ,l=t[0]._hasM);else{if(!c.isImmutableArray(t[0]))throw new Error("Invalid Argument");for(const e of t[0].toArray()){if(!(e instanceof n))throw new Error("Invalid Argument");i.push(e.hasZ?e.hasM?[e.x,e.y,e.z,e.m]:[e.x,e.y,e.z]:[e.x,e.y])}i.length>0&&(o=t[0].get(0).hasZ,l=t[0].get(0).hasM)}return!(i.length<3)&&a.isClockwise(i,l,o)}))},e.polygon=function(e,r){return p(e,r,(function(r,n,t){c.pcCheck(t,1,1);let i=null;if(t[0]instanceof u){if(i=c.fixSpatialReference(m.parseGeometryFromDictionary(t[0]),e.spatialReference),i instanceof o==!1)throw new Error("Illegal Parameter")}else i=t[0]instanceof o?f.fromJSON(t[0].toJSON()):c.fixSpatialReference(new o(JSON.parse(t[0])),e.spatialReference);if(null!==i&&!1===i.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return c.fixNullGeometry(i)}))},e.polyline=function(e,r){return p(e,r,(function(r,n,t){c.pcCheck(t,1,1);let i=null;if(t[0]instanceof u){if(i=c.fixSpatialReference(m.parseGeometryFromDictionary(t[0]),e.spatialReference),i instanceof l==!1)throw new Error("Illegal Parameter")}else i=t[0]instanceof l?f.fromJSON(t[0].toJSON()):c.fixSpatialReference(new l(JSON.parse(t[0])),e.spatialReference);if(null!==i&&!1===i.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return c.fixNullGeometry(i)}))},e.point=function(e,r){return p(e,r,(function(r,t,i){c.pcCheck(i,1,1);let a=null;if(i[0]instanceof u){if(a=c.fixSpatialReference(m.parseGeometryFromDictionary(i[0]),e.spatialReference),a instanceof n==!1)throw new Error("Illegal Parameter")}else a=i[0]instanceof n?f.fromJSON(i[0].toJSON()):c.fixSpatialReference(new n(JSON.parse(i[0])),e.spatialReference);if(null!==a&&!1===a.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return c.fixNullGeometry(a)}))},e.multipoint=function(e,r){return p(e,r,(function(r,n,t){c.pcCheck(t,1,1);let a=null;if(t[0]instanceof u){if(a=c.fixSpatialReference(m.parseGeometryFromDictionary(t[0]),e.spatialReference),a instanceof i==!1)throw new Error("Illegal Parameter")}else a=t[0]instanceof i?f.fromJSON(t[0].toJSON()):c.fixSpatialReference(new i(JSON.parse(t[0])),e.spatialReference);if(null!==a&&!1===a.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return c.fixNullGeometry(a)}))},e.extent=function(e,r){return p(e,r,(function(r,a,s){s=c.autoCastFeatureToGeometry(s),c.pcCheck(s,1,1);let g=null;if(s[0]instanceof u)g=c.fixSpatialReference(m.parseGeometryFromDictionary(s[0]),e.spatialReference);else if(s[0]instanceof n){const e={xmin:s[0].x,ymin:s[0].y,xmax:s[0].x,ymax:s[0].y,spatialReference:s[0].spatialReference.toJSON()},r=s[0];r.hasZ?(e.zmin=r.z,e.zmax=r.z):r.hasM&&(e.mmin=r.m,e.mmax=r.m),g=f.fromJSON(e)}else g=s[0]instanceof o||s[0]instanceof l||s[0]instanceof i?f.fromJSON(s[0].extent.toJSON()):s[0]instanceof t?f.fromJSON(s[0].toJSON()):c.fixSpatialReference(new t(JSON.parse(s[0])),e.spatialReference);if(null!==g&&!1===g.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return c.fixNullGeometry(g)}))},e.geometry=function(e,r){return p(e,r,(function(r,n,t){c.pcCheck(t,1,1);let i=null;if(i=t[0]instanceof m?c.fixSpatialReference(t[0].geometry(),e.spatialReference):t[0]instanceof u?c.fixSpatialReference(m.parseGeometryFromDictionary(t[0]),e.spatialReference):c.fixSpatialReference(f.fromJSON(JSON.parse(t[0])),e.spatialReference),null!==i&&!1===i.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return c.fixNullGeometry(i)}))},e.setgeometry=function(e,n){return p(e,n,(function(e,n,t){if(c.pcCheck(t,2,2),!(t[0]instanceof m))throw new Error("Illegal Argument");if(!0===t[0].immutable)throw new Error("Feature is Immutable");if(!(t[1]instanceof r||null===t[1]))throw new Error("Illegal Argument");return t[0]._geometry=t[1],c.voidOperation}))},e.feature=function(e,n){return p(e,n,(function(n,t,i){if(0===i.length)throw new Error("Missing Parameters");let a=null;if(1===i.length)if(c.isString(i[0]))a=m.fromJson(JSON.parse(i[0]));else if(i[0]instanceof m)a=m.createFromArcadeFeature(i[0]);else if(i[0]instanceof r)a=m.createFromGraphicLikeObject(i[0],null,null);else{if(!(i[0]instanceof u))throw new Error("Illegal Argument");{let e=i[0].hasField("geometry")?i[0].field("geometry"):null,r=i[0].hasField("attributes")?i[0].field("attributes"):null;null!==e&&e instanceof u&&(e=m.parseGeometryFromDictionary(e)),null!==r&&(r=m.parseAttributesFromDictionary(r)),a=m.createFromGraphicLikeObject(e,r,null)}}else if(2===i.length){let e=null,n=null;if(null!==i[0])if(i[0]instanceof r)e=i[0];else{if(!(e instanceof u))throw new Error("Illegal Argument");e=m.parseGeometryFromDictionary(i[0])}if(null!==i[1]){if(!(i[1]instanceof u))throw new Error("Illegal Argument");n=m.parseAttributesFromDictionary(i[1])}a=m.createFromGraphicLikeObject(e,n,null)}else{let e=null;const n={};if(null!==i[0])if(i[0]instanceof r)e=i[0];else{if(!(e instanceof u))throw new Error("Illegal Argument");e=m.parseGeometryFromDictionary(i[0])}for(let e=1;e<i.length;e+=2){const r=c.toString(i[e]),t=i[e+1];if(!(null==t||c.isString(t)||isNaN(t)||c.isDate(t)||c.isNumber(t)||c.isBoolean(t)))throw new Error("Illegal Argument");if(c.isFunctionParameter(t)||!1===c.isSimpleType(t))throw new Error("Illegal Argument");t===c.voidOperation?n[r]=null:n[r]=t}a=m.createFromGraphicLikeObject(e,n,null)}return a._geometry=c.fixSpatialReference(a.geometry(),e.spatialReference),a.immutable=!1,a}))},e.dictionary=function(e,r){return p(e,r,(function(e,r,n){if(0===n.length){const e=new u;return e.immutable=!1,e}if(1===n.length&&c.isString(n[0]))try{const e=JSON.parse(n[0]),r=u.convertObjectToArcadeDictionary(e);return r.immutable=!1,r}catch(e){throw new Error("Missing Parameters or Illegal Json")}if(n.length%2!=0)throw new Error("Missing Parameters");const t={};for(let e=0;e<n.length;e+=2){const r=c.toString(n[e]),i=n[e+1];if(!(null==i||c.isString(i)||isNaN(i)||c.isDate(i)||c.isNumber(i)||c.isBoolean(i)||c.isArray(i)||c.isImmutableArray(i)))throw new Error("Illegal Argument");if(c.isFunctionParameter(i))throw new Error("Illegal Argument");i===c.voidOperation?t[r]=null:t[r]=i}const i=new u(t);return i.immutable=!1,i}))},e.haskey=function(e,r){return p(e,r,(function(e,r,n){c.pcCheck(n,2,2);const t=c.toString(n[1]);if(n[0]instanceof m)return n[0].hasField(t);if(n[0]instanceof u)return n[0].hasField(t);throw new Error("Illegal Argument")}))},e.indexof=function(e,r){return p(e,r,(function(e,r,n){c.pcCheck(n,2,2);const t=n[1];if(c.isArray(n[0])){for(let e=0;e<n[0].length;e++)if(c.equalityTest(t,n[0][e]))return e;return-1}if(c.isImmutableArray(n[0])){const e=n[0].length();for(let r=0;r<e;r++)if(c.equalityTest(t,n[0].get(r)))return r;return-1}throw new Error("Illegal Argument")}))},e.angle=function(e,r){return p(e,r,(function(e,r,t){if(t=c.autoCastFeatureToGeometry(t),c.pcCheck(t,2,3),!(t[0]instanceof n))throw new Error("Illegal Argument");if(!(t[1]instanceof n))throw new Error("Illegal Argument");if(t.length>2&&!(t[2]instanceof n))throw new Error("Illegal Argument");return 2===t.length?g.angle2D(t[0],t[1]):g.angleBetween2D(t[0],t[1],t[2])}))},e.bearing=function(e,r){return p(e,r,(function(e,r,t){if(t=c.autoCastFeatureToGeometry(t),c.pcCheck(t,2,3),!(t[0]instanceof n))throw new Error("Illegal Argument");if(!(t[1]instanceof n))throw new Error("Illegal Argument");if(t.length>2&&!(t[2]instanceof n))throw new Error("Illegal Argument");return 2===t.length?g.bearing2D(t[0],t[1]):g.bearingBetween2D(t[0],t[1],t[2])}))},e.isselfintersecting=function(e,r){return p(e,r,(function(r,n,t){t=c.autoCastFeatureToGeometry(t),c.pcCheck(t,1,1);let a=t[0];if(a instanceof o)return a.isSelfIntersecting;if(a instanceof l)return a=a.paths,g.pathsSelfIntersecting(a);if(a instanceof i){const e=a.points;for(let r=0;r<e.length;r++)for(let n=0;n<e.length;n++)if(n!==r){let t=!0;for(let i=0;i<e[r].length;i++)if(e[r][i]!==e[n][i]){t=!1;break}if(!0===t)return!0}}return!(!c.isArray(a)&&!c.isImmutableArray(a))&&(a=c.autoCastArrayOfPointsToPolyline(a,e.spatialReference),null!==a&&(a=a.paths),g.pathsSelfIntersecting(a))}))}},Object.defineProperty(e,"__esModule",{value:!0})}));
