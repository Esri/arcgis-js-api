// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.9/esri/copyright.txt for details.

define(["require","exports","../Dictionary","../Feature","../languageUtils","../../geometry/Extent","../../geometry/Geometry","../../geometry/Multipoint","../../geometry/Point","../../geometry/Polygon","../../geometry/Polyline","../../geometry/support/jsonUtils"],function(e,r,n,t,i,a,o,l,f,s,c,u){function m(e,r){e.polygon=function(e,a){return r(e,a,function(r,a,o){i.pcCheck(o,1,1);var l=null;if(o[0]instanceof n){if((l=i.fixSpatialReference(t.parseGeometryFromDictionary(o[0]),e.spatialReference))instanceof s==!1)throw new Error("Illegal Parameter")}else l=o[0]instanceof s?u.fromJSON(o[0].toJSON()):i.fixSpatialReference(new s(JSON.parse(o[0])),e.spatialReference);if(null!==l&&!1===l.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return i.fixNullGeometry(l)})},e.polyline=function(e,a){return r(e,a,function(r,a,o){i.pcCheck(o,1,1);var l=null;if(o[0]instanceof n){if((l=i.fixSpatialReference(t.parseGeometryFromDictionary(o[0]),e.spatialReference))instanceof c==!1)throw new Error("Illegal Parameter")}else l=o[0]instanceof c?u.fromJSON(o[0].toJSON()):i.fixSpatialReference(new c(JSON.parse(o[0])),e.spatialReference);if(null!==l&&!1===l.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return i.fixNullGeometry(l)})},e.point=function(e,a){return r(e,a,function(r,a,o){i.pcCheck(o,1,1);var l=null;if(o[0]instanceof n){if((l=i.fixSpatialReference(t.parseGeometryFromDictionary(o[0]),e.spatialReference))instanceof f==!1)throw new Error("Illegal Parameter")}else l=o[0]instanceof f?u.fromJSON(o[0].toJSON()):i.fixSpatialReference(new f(JSON.parse(o[0])),e.spatialReference);if(null!==l&&!1===l.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return i.fixNullGeometry(l)})},e.multipoint=function(e,a){return r(e,a,function(r,a,o){i.pcCheck(o,1,1);var f=null;if(o[0]instanceof n){if((f=i.fixSpatialReference(t.parseGeometryFromDictionary(o[0]),e.spatialReference))instanceof l==!1)throw new Error("Illegal Parameter")}else f=o[0]instanceof l?u.fromJSON(o[0].toJSON()):i.fixSpatialReference(new l(JSON.parse(o[0])),e.spatialReference);if(null!==f&&!1===f.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return i.fixNullGeometry(f)})},e.extent=function(e,o){return r(e,o,function(r,o,m){m=i.autoCastFeatureToGeometry(m),i.pcCheck(m,1,1);var p=null;if(m[0]instanceof n)p=i.fixSpatialReference(t.parseGeometryFromDictionary(m[0]),e.spatialReference);else if(m[0]instanceof f){var g={xmin:m[0].x,ymin:m[0].y,xmax:m[0].x,ymax:m[0].y,spatialReference:m[0].spatialReference.toJSON()};m[0].hasZ?(g.zmin=m[0].z,g.zmax=m[0].z):m[0].hasM&&(g.mmin=m[0].m,g.mmax=m[0].m),p=u.fromJSON(g)}else p=m[0]instanceof s?u.fromJSON(m[0].extent.toJSON()):m[0]instanceof c?u.fromJSON(m[0].extent.toJSON()):m[0]instanceof l?u.fromJSON(m[0].extent.toJSON()):m[0]instanceof a?u.fromJSON(m[0].toJSON()):i.fixSpatialReference(new a(JSON.parse(m[0])),e.spatialReference);if(null!==p&&!1===p.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return i.fixNullGeometry(p)})},e.geometry=function(e,a){return r(e,a,function(r,a,o){i.pcCheck(o,1,1);var l=null;if(null!==(l=o[0]instanceof t?i.fixSpatialReference(o[0].geometry(),e.spatialReference):o[0]instanceof n?i.fixSpatialReference(t.parseGeometryFromDictionary(o[0]),e.spatialReference):i.fixSpatialReference(u.fromJSON(JSON.parse(o[0])),e.spatialReference))&&!1===l.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return i.fixNullGeometry(l)})},e.setgeometry=function(e,n){return r(e,n,function(e,r,n){if(i.pcCheck(n,2,2),!(n[0]instanceof t))throw new Error("Illegal Argument");if(!0===n[0].immutable)throw new Error("Feature is Immutable");if(!(n[1]instanceof o||null===n[1]))throw new Error("Illegal Argument");return n[0]._geometry=n[1],i.voidOperation})},e.feature=function(e,a){return r(e,a,function(r,a,l){if(0===l.length)throw new Error("Missing Parameters");var f=null;if(1===l.length)if(i.isString(l[0]))f=t.fromJson(JSON.parse(l[0]));else if(l[0]instanceof t)f=t.createFromArcadeFeature(l[0]);else if(l[0]instanceof o)f=t.createFromGraphicLikeObject(l[0],null,null);else{if(!(l[0]instanceof n))throw new Error("Illegal Argument");var s=l[0].hasField("geometry")?l[0].field("geometry"):null,c=l[0].hasField("attributes")?l[0].field("attributes"):null;null!==s&&s instanceof n&&(s=t.parseGeometryFromDictionary(s)),null!==c&&(c=t.parseAttributesFromDictionary(c)),f=t.createFromGraphicLikeObject(s,c,null)}else if(2===l.length){var s=null,c=null;if(null!==l[0])if(l[0]instanceof o)s=l[0];else{if(!(s instanceof n))throw new Error("Illegal Argument");s=t.parseGeometryFromDictionary(l[0])}if(null!==l[1]){if(!(l[1]instanceof n))throw new Error("Illegal Argument");c=t.parseAttributesFromDictionary(l[1])}f=t.createFromGraphicLikeObject(s,c,null)}else{var s=null,c={};if(null!==l[0])if(l[0]instanceof o)s=l[0];else{if(!(s instanceof n))throw new Error("Illegal Argument");s=t.parseGeometryFromDictionary(l[0])}for(var u=1;u<l.length;u+=2){var m=i.toString(l[u]),p=l[u+1];if(!(null===p||void 0===p||i.isString(p)||isNaN(p)||i.isDate(p)||i.isNumber(p)||i.isBoolean(p)))throw new Error("Illegal Argument");if(i.isFunctionParameter(p)||!1===i.isSimpleType(p))throw new Error("Illegal Argument");p===i.voidOperation?c[m]=null:c[m]=p}f=t.createFromGraphicLikeObject(s,c,null)}return f._geometry=i.fixSpatialReference(f.geometry(),e.spatialReference),f.immutable=!1,f})},e.dictionary=function(e,t){return r(e,t,function(e,r,t){if(0===t.length)throw new Error("Missing Parameters");if(t.length%2!=0)throw new Error("Missing Parameters");for(var a={},o=0;o<t.length;o+=2){var l=i.toString(t[o]),f=t[o+1];if(!(null===f||void 0===f||i.isString(f)||isNaN(f)||i.isDate(f)||i.isNumber(f)||i.isBoolean(f)||i.isArray(f)||i.isImmutableArray(f)))throw new Error("Illegal Argument");if(i.isFunctionParameter(f))throw new Error("Illegal Argument");f===i.voidOperation?a[l]=null:a[l]=f}var s=new n(a);return s.immutable=!1,s})},e.haskey=function(e,a){return r(e,a,function(e,r,a){i.pcCheck(a,2,2);var o=i.toString(a[1]);if(a[0]instanceof t)return a[0].hasField(o);if(a[0]instanceof n)return a[0].hasField(o);throw new Error("Illegal Argument")})},e.indexof=function(e,n){return r(e,n,function(e,r,n){i.pcCheck(n,2,2);var t=n[1];if(i.isArray(n[0])){for(var a=0;a<n[0].length;a++)if(i.equalityTest(t,n[0][a]))return a;return-1}if(i.isImmutableArray(n[0])){for(var o=n[0].length(),a=0;a<o;a++)if(i.equalityTest(t,n[0].get(a)))return a;return-1}throw new Error("Illegal Argument")})}}Object.defineProperty(r,"__esModule",{value:!0}),r.registerFunctions=m});