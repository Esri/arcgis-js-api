// COPYRIGHT Â© 2022 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.41/esri/copyright.txt for details.

define(["require","exports","../polyfill/tsSupport/awaiter","../polyfill/tsSupport/generator","../polyfill/tsSupport/assign","../polyfill/tsSupport/spreadarray","../FunctionWrapper","../ImmutableArray","../languageUtils","../polyfill/promiseUtils"],(function(r,n,e,t,i,a,u,o,c,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.registerFunctions=void 0,n.registerFunctions=function(r){function n(n,e){if(e instanceof u)return r.arcadeCustomFunctionHandler(e);if(e instanceof c.NativeFunction)return function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return e.fn(n,{preparsed:!0,arguments:r})};if(e instanceof c.SizzleFunction)return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(r.length!==e.paramCount)throw new Error("Invalid parameters");return e.fn.apply(e,r)};throw new Error("Invalid Parameter")}function i(r){if(r instanceof o)return r.toArray();if(c.isArray(r))return r;throw new Error("Invalid Parameter")}r.functions.array=function(n,e){return r.standardFunction(n,e,(function(r,n,e){c.pcCheck(e,1,2);var t=c.toNumber(e[0]);if(isNaN(t)||!1===c.isInteger(t))throw new Error("Invalid Parameter");var i=c.defaultUndefined(e[1],null),a=new Array(t);return a.fill(i),a}))},r.functions.front=function(n,e){return r.standardFunction(n,e,(function(r,n,e){if(c.pcCheck(e,1,1),c.isImmutableArray(e[0])){if(e[0].length()<=0)throw new Error("Array is empty");return e[0].get(0)}if(c.isArray(e[0])){if(e[0].length<=0)throw new Error("Array is empty");return e[0][0]}throw new Error("Invalid Parameter")}))},r.functions.back=function(n,e){return r.standardFunction(n,e,(function(r,n,e){if(c.pcCheck(e,1,1),c.isImmutableArray(e[0])){if(e[0].length()<=0)throw new Error("Array is empty");return e[0].get(e[0].length()-1)}if(c.isArray(e[0])){if(e[0].length<=0)throw new Error("Array is empty");return e[0][e[0].length-1]}throw new Error("Invalid Parameter")}))},r.functions.push=function(n,e){return r.standardFunction(n,e,(function(r,n,e){if(c.pcCheck(e,1,2),c.isArray(e[0]))return e[0][e[0].length]=e[1],e[0].length;throw new Error("Invalid Parameter")}))},r.functions.pop=function(n,e){return r.standardFunction(n,e,(function(r,n,e){if(c.pcCheck(e,1,1),c.isArray(e[0])){if(e[0].length<=0)throw new Error("Array is empty");var t=e[0][e[0].length-1];return e[0].length=e[0].length-1,t}throw new Error("Invalid Parameter")}))},r.functions.erase=function(n,e){return r.standardFunction(n,e,(function(r,n,e){if(c.pcCheck(e,2,2),c.isArray(e[0])){var t=c.toNumber(e[1]);if(isNaN(t)||!1===c.isInteger(t))throw new Error("Invalid Parameter");var i=e[0];if(i.length<=0)throw new Error("Array is empty");if(t<0&&(t=i.length+t),t<0)throw new Error("Element not found");if(t>=i.length)throw new Error("Index is greater than array");return i.splice(t,1),c.voidOperation}throw new Error("Invalid Parameter")}))},r.functions.insert=function(n,e){return r.standardFunction(n,e,(function(r,n,e){if(c.pcCheck(e,3,3),c.isArray(e[0])){var t=c.toNumber(e[1]);if(isNaN(t)||!1===c.isInteger(t))throw new Error("Invalid Parameter");var i=e[2],a=e[0];if(t>a.length)throw new Error("Index is greater than array");if(t<0&&t<-1*a.length)throw new Error("Index is greater than array");return t===a.length?(a[t]=i,c.voidOperation):(a.splice(t,0,i),c.voidOperation)}throw new Error("Invalid Parameter")}))},r.functions.resize=function(n,e){return r.standardFunction(n,e,(function(r,n,e){if(c.pcCheck(e,2,3),c.isArray(e[0])){var t=c.toNumber(e[1]);if(isNaN(t)||!1===c.isInteger(t))throw new Error("Invalid Parameter");if(t<0)throw new Error("Size cannot be negative");var i=c.defaultUndefined(e[2],null),a=e[0];if(a.length>=t)return a.length=t,c.voidOperation;var u=a.length;a.length=t;for(var o=u;o<a.length;o++)a[o]=i;return c.voidOperation}throw new Error("Invalid Parameter")}))},r.functions.includes=function(n,e){return r.standardFunction(n,e,(function(r,n,e){if(c.pcCheck(e,2,2),c.isArray(e[0])){var t=e[1];return e[0].findIndex((function(r){return c.equalityTest(r,t)}))>-1}if(c.isImmutableArray(e[0])){var i=e[1];return e[0].toArray().findIndex((function(r){return c.equalityTest(r,i)}))>-1}throw new Error("Invalid Parameter")}))},r.functions.slice=function(n,e){return r.standardFunction(n,e,(function(r,n,e){if(c.pcCheck(e,1,3),c.isArray(e[0])){var t=c.toNumber(c.defaultUndefined(e[1],0)),i=c.toNumber(c.defaultUndefined(e[2],e[0].length));if(isNaN(t)||!1===c.isInteger(t))throw new Error("Invalid Parameter");if(isNaN(i)||!1===c.isInteger(i))throw new Error("Invalid Parameter");return(a=e[0]).slice(t,i)}if(c.isImmutableArray(e[0])){var a=e[0];t=c.toNumber(c.defaultUndefined(e[1],0)),i=c.toNumber(c.defaultUndefined(e[2],a.length()));if(isNaN(t)||!1===c.isInteger(t))throw new Error("Invalid Parameter");if(isNaN(i)||!1===c.isInteger(i))throw new Error("Invalid Parameter");return a.toArray().slice(t,i)}throw new Error("Invalid Parameter")}))},r.functions.splice=function(n,e){return r.standardFunction(n,e,(function(r,n,e){for(var t=[],i=0;i<e.length;i++)c.isArray(e[i])?t.push.apply(t,e[i]):c.isImmutableArray(e[i])?t.push.apply(t,e[i].toArray()):t.push(e[i]);return t}))},"sync"===r.mode&&(r.functions.any=function(e,t){return r.standardFunction(e,t,(function(r,t,a){c.pcCheck(a,2,2);for(var u=n(e,a[1]),o=0,s=i(a[0]);o<s.length;o++){var l=u(s[o]);if(c.isBoolean(l)&&!0===l)return!0}return!1}))},r.functions.all=function(e,t){return r.standardFunction(e,t,(function(r,t,a){c.pcCheck(a,2,2);for(var u=n(e,a[1]),o=0,s=i(a[0]);o<s.length;o++){if(!0!==u(s[o]))return!1}return!0}))},r.functions.none=function(e,t){return r.standardFunction(e,t,(function(r,t,a){c.pcCheck(a,2,2);for(var u=n(e,a[1]),o=0,s=i(a[0]);o<s.length;o++){if(!0===u(s[o]))return!1}return!0}))},r.functions.reduce=function(e,t){return r.standardFunction(e,t,(function(r,t,a){c.pcCheck(a,2,3);var u=n(e,a[1]),o=i(a[0]);return 2===a.length?0===o.length?null:o.reduce((function(r,n){var e=u(r,n);return r=void 0!==e&&e!==c.voidOperation?e:null})):o.reduce((function(r,n){var e=u(r,n);return r=void 0!==e&&e!==c.voidOperation?e:null}),a[2])}))},r.functions.map=function(e,t){return r.standardFunction(e,t,(function(r,t,a){c.pcCheck(a,2,2);for(var u=n(e,a[1]),o=[],s=0,l=i(a[0]);s<l.length;s++){var f=u(l[s]);void 0!==f&&f!==c.voidOperation?o.push(f):o.push(null)}return o}))},r.functions.filter=function(e,t){return r.standardFunction(e,t,(function(r,t,a){c.pcCheck(a,2,2);for(var u=n(e,a[1]),o=[],s=0,l=i(a[0]);s<l.length;s++){var f=l[s];!0===u(f)&&o.push(f)}return o}))}),"async"===r.mode&&(r.functions.any=function(a,u){return r.standardFunctionAsync(a,u,(function(r,u,o){return e(this,void 0,void 0,(function(){var r,e,u,l,f,d,h;return t(this,(function(t){switch(t.label){case 0:c.pcCheck(o,2,2),r=n(a,o[1]),e=i(o[0]),u=0,l=e,t.label=1;case 1:return u<l.length?(f=l[u],[4,r(f)]):[3,7];case 2:return d=t.sent(),h=null,s.isPromiseLike(h)?[4,d]:[3,4];case 3:return h=t.sent(),[3,5];case 4:h=d,t.label=5;case 5:if(c.isBoolean(h)&&!0===h)return[2,!0];t.label=6;case 6:return u++,[3,1];case 7:return[2,!1]}}))}))}))},r.functions.all=function(a,u){return r.standardFunctionAsync(a,u,(function(r,u,o){return e(this,void 0,void 0,(function(){var r,e,u,l,f,d,h;return t(this,(function(t){switch(t.label){case 0:c.pcCheck(o,2,2),r=n(a,o[1]),e=i(o[0]),u=0,l=e,t.label=1;case 1:return u<l.length?(f=l[u],[4,r(f)]):[3,7];case 2:return d=t.sent(),h=null,s.isPromiseLike(h)?[4,d]:[3,4];case 3:return h=t.sent(),[3,5];case 4:h=d,t.label=5;case 5:if(!0!==h)return[2,!1];t.label=6;case 6:return u++,[3,1];case 7:return[2,!0]}}))}))}))},r.functions.none=function(a,u){return r.standardFunctionAsync(a,u,(function(r,u,o){return e(this,void 0,void 0,(function(){var r,e,u,l,f,d,h;return t(this,(function(t){switch(t.label){case 0:c.pcCheck(o,2,2),r=n(a,o[1]),e=i(o[0]),u=0,l=e,t.label=1;case 1:return u<l.length?(f=l[u],[4,r(f)]):[3,7];case 2:return d=t.sent(),h=null,s.isPromiseLike(h)?[4,d]:[3,4];case 3:return h=t.sent(),[3,5];case 4:h=d,t.label=5;case 5:if(!0===h)return[2,!1];t.label=6;case 6:return u++,[3,1];case 7:return[2,!0]}}))}))}))},r.functions.filter=function(a,u){return r.standardFunctionAsync(a,u,(function(r,u,o){return e(this,void 0,void 0,(function(){var r,e,u,l,f,d,h,v;return t(this,(function(t){switch(t.label){case 0:c.pcCheck(o,2,2),r=n(a,o[1]),e=i(o[0]),u=[],l=0,f=e,t.label=1;case 1:return l<f.length?(d=f[l],[4,r(d)]):[3,7];case 2:return h=t.sent(),v=null,s.isPromiseLike(v)?[4,h]:[3,4];case 3:return v=t.sent(),[3,5];case 4:v=h,t.label=5;case 5:!0===v&&u.push(d),t.label=6;case 6:return l++,[3,1];case 7:return[2,u]}}))}))}))},r.functions.reduce=function(a,u){return r.standardFunctionAsync(a,u,(function(r,u,o){var s=this;c.pcCheck(o,2,3);var l=n(a,o[1]),f=i(o[0]),d=null;if(o.length>2){var h=c.defaultUndefined(o[2],null);d=f.reduce((function(r,n){return e(s,void 0,void 0,(function(){var e;return t(this,(function(t){switch(t.label){case 0:return[4,r];case 1:return void 0!==(e=t.sent())&&e!==c.voidOperation||(e=null),[2,l(e,n)]}}))}))}),Promise.resolve(h))}else{if(0===f.length)return null;d=f.reduce((function(r,n,i){return e(s,void 0,void 0,(function(){var e;return t(this,(function(t){switch(t.label){case 0:return i<=1?[2,l(r,n)]:[4,r];case 1:return void 0!==(e=t.sent())&&e!==c.voidOperation||(e=null),[2,l(e,n)]}}))}))}))}return d.then((function(r){return void 0!==r&&r!==c.voidOperation?r:null}))}))},r.functions.map=function(a,u){return r.standardFunctionAsync(a,u,(function(r,u,o){return e(this,void 0,void 0,(function(){var r,e,u,l,f,d,h,v;return t(this,(function(t){switch(t.label){case 0:c.pcCheck(o,2,2),r=n(a,o[1]),e=i(o[0]),u=[],l=0,f=e,t.label=1;case 1:return l<f.length?(d=f[l],[4,r(d)]):[3,7];case 2:return h=t.sent(),v=null,s.isPromiseLike(v)?[4,h]:[3,4];case 3:return v=t.sent(),[3,5];case 4:v=h,t.label=5;case 5:void 0!==v&&v!==c.voidOperation?u.push(v):u.push(null),t.label=6;case 6:return l++,[3,1];case 7:return[2,u]}}))}))}))})}}));