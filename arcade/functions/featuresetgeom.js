/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../kernel","../../chunks/languageUtils","../featureset/actions/SpatialFilter","../featureset/sources/Empty","../../core/promiseUtils","../../geometry/Geometry","../../geometry/geometryEngineAsync"],(function(e,t,n,r,a,s,i,l){"use strict";function o(e){return e instanceof i}function u(e,u,c,f,p){return p(e,u,(function(e,u,p){if(p.length<2)return f(new Error("Missing Parameters"));if(null===(p=n.autoCastFeatureToGeometry(p))[0]&&null===p[1])return s.resolve(!1);if(n.isFeatureSet(p[0]))return p[1]instanceof i?s.resolve(new r({parentfeatureset:p[0],relation:c,relationGeom:p[1]})):null===p[1]?s.resolve(new a({parentfeatureset:p[0]})):f("Spatial Relation cannot accept this parameter type");if(o(p[0])){if(o(p[1])){let e=null;switch(c){case"esriSpatialRelEnvelopeIntersects":e=l.intersects(t.shapeExtent(p[0]),t.shapeExtent(p[1]));break;case"esriSpatialRelIntersects":e=l.intersects(p[0],p[1]);break;case"esriSpatialRelContains":e=l.contains(p[0],p[1]);break;case"esriSpatialRelOverlaps":e=l.overlaps(p[0],p[1]);break;case"esriSpatialRelWithin":e=l.within(p[0],p[1]);break;case"esriSpatialRelTouches":e=l.touches(p[0],p[1]);break;case"esriSpatialRelCrosses":e=l.crosses(p[0],p[1])}return null!==e?e:s.reject(new Error("Unrecognised Relationship"))}return n.isFeatureSet(p[1])?s.resolve(new r({parentfeatureset:p[1],relation:c,relationGeom:p[0]})):null===p[1]?s.resolve(!1):f("Spatial Relation cannot accept this parameter type")}return null!==p[0]?f("Spatial Relation cannot accept this parameter type"):n.isFeatureSet(p[1])?s.resolve(new a({parentfeatureset:p[1]})):p[1]instanceof i||null===p[1]?s.resolve(!1):void 0}))}function c(e){"async"===e.mode&&(e.functions.intersects=function(t,n){return u(t,n,"esriSpatialRelIntersects",e.failDefferred,e.standardFunctionAsync)},e.functions.envelopeintersects=function(t,n){return u(t,n,"esriSpatialRelEnvelopeIntersects",e.failDefferred,e.standardFunctionAsync)},e.signatures.push({name:"envelopeintersects",min:"2",max:"2"}),e.functions.contains=function(t,n){return u(t,n,"esriSpatialRelContains",e.failDefferred,e.standardFunctionAsync)},e.functions.overlaps=function(t,n){return u(t,n,"esriSpatialRelOverlaps",e.failDefferred,e.standardFunctionAsync)},e.functions.within=function(t,n){return u(t,n,"esriSpatialRelWithin",e.failDefferred,e.standardFunctionAsync)},e.functions.touches=function(t,n){return u(t,n,"esriSpatialRelTouches",e.failDefferred,e.standardFunctionAsync)},e.functions.crosses=function(t,n){return u(t,n,"esriSpatialRelCrosses",e.failDefferred,e.standardFunctionAsync)},e.functions.relate=function(t,r){return e.standardFunctionAsync(t,r,(function(e,t,r){if(r=n.autoCastFeatureToGeometry(r),n.pcCheck(r,3,3),o(r[0])&&o(r[1]))return l.relate(r[0],r[1],n.toString(r[2]));if(r[0]instanceof i&&null===r[1])return!1;if(r[1]instanceof i&&null===r[0])return!1;if(n.isFeatureSet(r[0])&&null===r[1])return new a({parentfeatureset:r[0]});if(n.isFeatureSet(r[1])&&null===r[0])return new a({parentfeatureset:r[1]});if(n.isFeatureSet(r[0])&&r[1]instanceof i)return r[0].relate(r[1],n.toString(r[2]));if(n.isFeatureSet(r[1])&&r[0]instanceof i)return r[1].relate(r[0],n.toString(r[2]));if(null===r[0]&&null===r[1])return!1;throw new Error("Illegal Argument")}))})}e.registerFunctions=c,Object.defineProperty(e,"__esModule",{value:!0})}));
