/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../executionError","../../chunks/languageUtils","./fieldStats","../../core/sql/WhereClause"],(function(n,t,e,r,a,i){"use strict";function u(n,t,e,r,a,i){return c.apply(this,arguments)}function c(){return(c=t._asyncToGenerator((function*(n,t,e,u,c,l){if(1===u.length){if(r.isArray(u[0]))return a.calculateStat(n,u[0],r.defaultUndefined(u[1],-1));if(r.isImmutableArray(u[0]))return a.calculateStat(n,u[0].toArray(),r.defaultUndefined(u[1],-1))}else if(2===u.length){if(r.isArray(u[0]))return a.calculateStat(n,u[0],r.defaultUndefined(u[1],-1));if(r.isImmutableArray(u[0]))return a.calculateStat(n,u[0].toArray(),r.defaultUndefined(u[1],-1));if(r.isFeatureSet(u[0])){const e=yield u[0].load(),a=yield s(i.WhereClause.create(u[1],e.getFieldsIndex()),l,c);return u[0].calculateStatistic(n,a,r.defaultUndefined(u[2],1e3),t.abortSignal)}}else if(3===u.length&&r.isFeatureSet(u[0])){const e=yield u[0].load(),a=yield s(i.WhereClause.create(u[1],e.getFieldsIndex()),l,c);return u[0].calculateStatistic(n,a,r.defaultUndefined(u[2],1e3),t.abortSignal)}return a.calculateStat(n,u,-1)}))).apply(this,arguments)}function s(n,t,e){return l.apply(this,arguments)}function l(){return(l=t._asyncToGenerator((function*(n,t,e){const r=n.getVariables();if(r.length>0){const a=[];for(let n=0;n<r.length;n++){const i={name:r[n]};a.push(yield t.evaluateIdentifier(e,i))}const i={};for(let n=0;n<r.length;n++)i[r[n]]=a[n];return n.parameters=i,n}return n}))).apply(this,arguments)}function o(n){"async"===n.mode&&(n.functions.stdev=function(t,e){return n.standardFunctionAsync(t,e,((e,r,a)=>u("stdev",e,r,a,t,n)))},n.functions.variance=function(t,e){return n.standardFunctionAsync(t,e,((e,r,a)=>u("variance",e,r,a,t,n)))},n.functions.average=function(t,e){return n.standardFunctionAsync(t,e,((e,r,a)=>u("mean",e,r,a,t,n)))},n.functions.mean=function(t,e){return n.standardFunctionAsync(t,e,((e,r,a)=>u("mean",e,r,a,t,n)))},n.functions.sum=function(t,e){return n.standardFunctionAsync(t,e,((e,r,a)=>u("sum",e,r,a,t,n)))},n.functions.min=function(t,e){return n.standardFunctionAsync(t,e,((e,r,a)=>u("min",e,r,a,t,n)))},n.functions.max=function(t,e){return n.standardFunctionAsync(t,e,((e,r,a)=>u("max",e,r,a,t,n)))},n.functions.count=function(t,a){return n.standardFunctionAsync(t,a,((n,i,u)=>{if(r.pcCheck(u,1,1,t,a),r.isFeatureSet(u[0]))return u[0].count(n.abortSignal);if(r.isArray(u[0])||r.isString(u[0]))return u[0].length;if(r.isImmutableArray(u[0]))return u[0].length();throw new e.ArcadeExecutionError(t,e.ExecutionErrorCodes.InvalidParameter,a)}))})}n.registerFunctions=o,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
