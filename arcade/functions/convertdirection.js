/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../Dictionary","../../chunks/languageUtils"],(function(e,n,t){"use strict";const r=e=>(n,t,r)=>(r=r||14,+e(n,t).toFixed(r)),s=(e,n)=>e+n,i=(e,n)=>e-n,a=(e,n)=>e*n,o=(e,n)=>e/n,c=(e,n,t)=>r(s)(e,n,t),u=(e,n,t)=>r(i)(e,n,t),d=(e,n,t)=>r(a)(e,n,t),l=(e,n,t)=>r(o)(e,n,t),m=360,h=400,f=2*Math.PI,g=3600,_=3240,w=60,A=60,p=180*g/Math.PI,D=m*w*A,E=90*g,S=180*g,T=270*g,M=String.fromCharCode(7501),R="Â°";function v(e){if(!1===t.isString(e))throw new Error("Invalid Parameter");return e}function U(e,n){const t=10**n;return Math.round(e*t)/t}function F(e,n){return e%n}function I(e){const n=parseFloat(e.toString().replace(Math.trunc(e).toString(),"0"))*Math.sign(e);if(e<0){return{fraction:n,integer:Math.ceil(e)}}return{fraction:n,integer:Math.floor(e)}}var N,b,x,O;function y(e,n){switch(e){case N.north:return"SHORT"===n?"N":"North";case N.east:return"SHORT"===n?"E":"East";case N.south:return"SHORT"===n?"S":"South";case N.west:return"SHORT"===n?"W":"West"}}function z(e,n,t){for(;e.length<t;)e=n+e;return e}function G(e,n){return e-Math.floor(e/n)*n}function H(e){switch(e){case b.truncated_degrees:case b.decimal_degrees:return m;case b.radians:return f;case b.gradians:return h;case b.seconds:return D;case b.fractional_degree_minutes:return w;case b.fractional_minute_seconds:return A;default:throw new Error("Unnexpected evaluations")}}function C(e){switch(e.toUpperCase().trim()){case"NORTH":case"NORTHAZIMUTH":case"NORTH AZIMUTH":return x.north_azimuth;case"POLAR":return x.polar;case"QUADRANT":return x.quadrant;case"SOUTH":case"SOUTHAZIMUTH":case"SOUTH AZIMUTH":return x.south_azimuth}throw new Error("Unsupported direction type")}function P(e){switch(e.toUpperCase().trim()){case"D":case"DD":case"DECIMALDEGREE":case"DECIMAL DEGREE":case"DEGREE":case"DECIMALDEGREES":case"DECIMAL DEGREES":case"DEGREES":return b.decimal_degrees;case"DMS":case"DEGREESMINUTESSECONDS":case"DEGREES MINUTES SECONDS":return b.degrees_minutes_seconds;case"R":case"RAD":case"RADS":case"RADIAN":case"RADIANS":return b.radians;case"G":case"GON":case"GONS":case"GRAD":case"GRADS":case"GRADIAN":case"GRADIANS":return b.gradians}throw new Error("Unsupported units")}!function(e){e[e.north=0]="north",e[e.east=1]="east",e[e.south=2]="south",e[e.west=3]="west"}(N||(N={})),function(e){e[e.decimal_degrees=1]="decimal_degrees",e[e.seconds=2]="seconds",e[e.degrees_minutes_seconds=3]="degrees_minutes_seconds",e[e.radians=4]="radians",e[e.gradians=5]="gradians",e[e.truncated_degrees=6]="truncated_degrees",e[e.fractional_degree_minutes=7]="fractional_degree_minutes",e[e.fractional_minute_seconds=8]="fractional_minute_seconds"}(b||(b={})),function(e){e[e.north_azimuth=1]="north_azimuth",e[e.polar=2]="polar",e[e.quadrant=3]="quadrant",e[e.south_azimuth=4]="south_azimuth"}(x||(x={})),function(e){e[e.meridian=0]="meridian",e[e.direction=1]="direction"}(O||(O={}));let q=function(){function e(e,n,t){this.m_degrees=e,this.m_minutes=n,this.m_seconds=t}var n=e.prototype;return n.getField=function(e){switch(e){case b.decimal_degrees:case b.truncated_degrees:return this.m_degrees;case b.fractional_degree_minutes:return this.m_minutes;case b.seconds:case b.fractional_minute_seconds:return this.m_seconds;default:throw new Error("Unnexpected evaluation")}},e.secondsToDMS=function(n){const t=I(n).fraction;let r=I(n).integer;const s=Math.floor(r/g);r-=s*g;const i=Math.floor(r/A);return r-=i*A,new e(s,i,r+t)},e.numberToDms=function(n){const t=I(n).fraction,r=I(n).integer,s=d(I(100*t).fraction,100);return new e(r,I(100*t).integer,s)},n.format=function(n,t){let r=U(this.m_seconds,t),s=this.m_minutes,i=this.m_degrees;if(n===b.seconds||n===b.fractional_minute_seconds)A<=r&&(r-=A,++s),w<=s&&(s=0,++i),m<=i&&(i=0);else if(n===b.fractional_degree_minutes)r=0,s=30<=this.m_seconds?this.m_minutes+1:this.m_minutes,i=this.m_degrees,w<=s&&(s=0,++i),m<=i&&(i=0);else if(n===b.decimal_degrees||n===b.truncated_degrees){const e=l(this.m_seconds,g),n=l(this.m_minutes,w);i=Math.round(this.m_degrees+n+e),s=0,r=0}return new e(i,s,r)},e.dmsToSeconds=function(e,n,t){return e*g+n*A+t},e}(),k=function(){function e(e,n,t){this.meridian=e,this.angle=n,this.direction=t}return e.prototype.fetchAzimuth=function(e){return e===O.meridian?this.meridian:this.direction},e}(),L=function(){function e(e){this.m_angle=e}e.createFromAngleAndDirection=function(n,t){return new e(new W(e._convertDirectionFormat(n.extractAngularUnits(b.seconds),t,x.north_azimuth)))};var n=e.prototype;return n.getAngle=function(n){const t=this.m_angle.extractAngularUnits(b.seconds);switch(n){case x.north_azimuth:case x.south_azimuth:case x.polar:return new W(e._convertDirectionFormat(t,x.north_azimuth,n));case x.quadrant:{const n=e.secondsNorthAzimuthToQuadrant(t);return new W(n.angle)}}},n.getMeridian=function(n){const t=this.m_angle.extractAngularUnits(b.seconds);switch(n){case x.north_azimuth:return N.north;case x.south_azimuth:return N.south;case x.polar:return N.east;case x.quadrant:return e.secondsNorthAzimuthToQuadrant(t).meridian}},n.getDirection=function(n){const t=this.m_angle.extractAngularUnits(b.seconds);switch(n){case x.north_azimuth:return N.east;case x.south_azimuth:return N.west;case x.polar:return N.north;case x.quadrant:return e.secondsNorthAzimuthToQuadrant(t).direction}},e.secondsNorthAzimuthToQuadrant=function(e){const n=e<=E||e>=T?N.north:N.south,t=n===N.north?Math.min(D-e,e):Math.abs(e-S),r=e>S?N.west:N.east;return new k(n,t,r)},e.createFromAngleMeridianAndDirection=function(n,t,r){return new e(new W(e.secondsQuadrantToNorthAzimuth(n.extractAngularUnits(b.seconds),t,r)))},e.secondsQuadrantToNorthAzimuth=function(e,n,t){return n===N.north?t===N.east?e:D-e:t===N.east?S-e:S+e},e._convertDirectionFormat=function(e,n,t){let r=0;switch(n){case x.north_azimuth:r=e;break;case x.polar:r=E-e;break;case x.quadrant:throw new Error("Unnexpected evaluation");case x.south_azimuth:r=e+S}let s=0;switch(t){case x.north_azimuth:s=r;break;case x.polar:s=E-r;break;case x.quadrant:throw new Error("Unnexpected evaluation");case x.south_azimuth:s=r-S}return s=F(s,D),s<0?D+s:s},e}();function Q(e,n,t){let r=null;switch(n){case b.decimal_degrees:r=d(e,g);break;case b.seconds:r=e;break;case b.gradians:r=d(e,_);break;case b.radians:r=d(e,p);break;default:throw new Error("Unnexpected evaluation")}switch(t){case b.decimal_degrees:return l(r,g);case b.seconds:return r;case b.gradians:return l(r,_);case b.radians:return r/p;default:throw new Error("Unnexpected evaluation")}}let W=function(){function e(e){this.m_seconds=e}return e.createFromAngleAndUnits=function(n,t){return new e(Q(n,t,b.seconds))},e.prototype.extractAngularUnits=function(e){return Q(this.m_seconds,b.seconds,Z(e))},e.createFromDegreesMinutesSeconds=function(n,t,r){return new e(c(c(d(n,g),d(t,A)),r))},e}();function Z(e){switch(e){case b.decimal_degrees:case b.truncated_degrees:case b.degrees_minutes_seconds:return b.decimal_degrees;case b.gradians:return b.gradians;case b.fractional_degree_minutes:return b.fractional_degree_minutes;case b.radians:return b.radians;case b.seconds:case b.fractional_minute_seconds:return b.seconds}}let B=function(){function e(e,n,t,r){this.m_view=e,this.m_angle=n,this.m_merdian=t,this.m_direction=r,this.m_dms=null,this.m_formatted_dms=null}e.createFromStringAndBearing=function(n,t,r){return new e(n,t.getAngle(r),t.getMeridian(r),t.getDirection(r))};var n=e.prototype;return n.fetchAngle=function(){return this.m_angle},n.fetchMeridian=function(){return this.m_merdian},n.fetchDirection=function(){return this.m_direction},n.fetchView=function(){return this.m_view},n.fetchDms=function(){return null===this.m_dms&&this._calculateDms(),this.m_dms},n.fetchFormattedDms=function(){return null===this.m_formatted_dms&&this._calculateDms(),this.m_formatted_dms},n._calculateDms=function(){let e=null,n=b.truncated_degrees,t=0;for(let r=0;r<this.m_view.length;r++){const s=this.m_view[r];switch(s){case"m":e=se(this.m_view,r,s),n=n===b.truncated_degrees?b.fractional_degree_minutes:n,r=e.newpos;continue;case"s":e=se(this.m_view,r,s),n=b.fractional_minute_seconds,t=t<e.rounding?e.rounding:t,r=e.newpos;continue;default:continue}}this.m_dms=q.secondsToDMS(this.m_angle.extractAngularUnits(b.seconds)),this.m_formatted_dms=q.secondsToDMS(this.m_angle.extractAngularUnits(b.seconds)).format(n,t)},e}();function V(e,n,t,r,s){let i=null;switch(n){case b.decimal_degrees:case b.radians:case b.gradians:return i=G(U(e.extractAngularUnits(n),r),H(n)),z(i.toFixed(r),"0",t+r+(r>0?1:0));case b.truncated_degrees:case b.fractional_degree_minutes:return i=G(s.fetchFormattedDms().getField(n),H(n)),z(i.toFixed(r),"0",t+r+(r>0?1:0));case b.fractional_minute_seconds:return i=G(U(s.fetchDms().getField(n),r),H(n)),z(i.toFixed(r),"0",t+r+(r>0?1:0));default:throw new Error("Unnexepected evaluation")}}function X(e,n,t){if(t===x.quadrant)throw new Error("Conversion error");if(n===b.degrees_minutes_seconds){const n=q.numberToDms(e);return L.createFromAngleAndDirection(W.createFromDegreesMinutesSeconds(n.m_degrees,n.m_minutes,n.m_seconds),t)}return L.createFromAngleAndDirection(W.createFromAngleAndUnits(e,Z(n)),t)}function j(e){switch(t.toNumber(e)){case 1:return{first:N.north,second:N.east};case 2:return{first:N.south,second:N.east};case 3:return{first:N.south,second:N.west};case 4:return{first:N.north,second:N.west}}return null}function J(e){switch(e.toUpperCase().trim()){case"N":case"NORTH":return N.north;case"E":case"EAST":return N.east;case"S":case"SOUTH":return N.south;case"W":case"WEST":return N.west}return null}function K(e){const n=parseFloat(e);if(t.isNumber(n)){if(isNaN(n))throw new Error("Invalid conversion");return n}throw new Error("Invalid conversion")}function Y(e,n,r){const s=r===x.quadrant;let i=null,a=null,o=0,c=0,u=0;if(s){if(e.length<2)throw new Error("Conversion Error");u=1;const n=j(t.toString(e[e.length-1]));if(n?(i=n.first,a=n.second):(o=1,i=J(t.toString(e[0])),a=J(t.toString(e[e.length-1]))),null===i||null===a)throw new Error("Invalid Conversion")}switch(n){case b.decimal_degrees:case b.radians:case b.gradians:if(0===e.length)throw new Error("Invalid Conversion");return s?L.createFromAngleMeridianAndDirection(W.createFromAngleAndUnits(K(e[o]),Z(n)),i,a):L.createFromAngleAndDirection(W.createFromAngleAndUnits(K(e[o]),Z(n)),r);case b.degrees_minutes_seconds:if(c=e.length-u-o,3===c){const n=W.createFromDegreesMinutesSeconds(K(e[o]),K(e[o+1]),K(e[o+2]));return s?L.createFromAngleMeridianAndDirection(n,i,a):L.createFromAngleAndDirection(n,r)}if(1===c){const n=K(e[o]),t=q.numberToDms(n),c=W.createFromDegreesMinutesSeconds(t.m_degrees,t.m_minutes,t.m_seconds);return s?L.createFromAngleMeridianAndDirection(c,i,a):L.createFromAngleAndDirection(c,r)}}throw new Error("Conversion Error")}function $(e){const n=[" ","-","/","'",'"',"\\","^",R,M,"\t","\r","\n","*"];let t="";for(let r=0;r<e.length;r++){const s=e.charAt(r);-1!==n.indexOf(s)?t+="RRSPLITRRSPLITRR":t+=s}return t.split("RRSPLITRRSPLITRR").filter((e=>""!==e))}function ee(e,n,r){if(t.isNumber(e))return X(t.toNumber(e),n,r);if(t.isString(e))return Y($(e),n,r);if(t.isArray(e))return Y(e,n,r);if(t.isImmutableArray(e))return Y(e.toArray(),n,r);throw new Error("Conversion Error")}function ne(e,n,t){const r=Z(t);if(r&&t!==b.degrees_minutes_seconds){return e.getAngle(n).extractAngularUnits(r)}throw new Error("Conversion Error")}function te(e,n,t){const r=e.getAngle(n);if(n===x.quadrant&&t===b.degrees_minutes_seconds){const t=q.secondsToDMS(r.extractAngularUnits(b.seconds));return[y(e.getMeridian(n),"SHORT"),t.m_degrees,t.m_minutes,t.m_seconds,y(e.getDirection(n),"SHORT")]}if(t===b.degrees_minutes_seconds){const e=q.secondsToDMS(r.extractAngularUnits(b.seconds));return[e.m_degrees,e.m_minutes,e.m_seconds]}return n===x.quadrant?[y(e.getMeridian(n),"SHORT"),r.extractAngularUnits(t),y(e.getDirection(n),"SHORT")]:[r.extractAngularUnits(t)]}function re(e,n){let t="";switch(e){case b.decimal_degrees:t=n===x.quadrant?"DD.DD"+R:"DDD.DD"+R;break;case b.degrees_minutes_seconds:t=n===x.quadrant?"dd"+R+" mm' ss\"":"ddd"+R+" mm' ss.ss\"";break;case b.radians:t="R.RR";break;case b.gradians:t="GGG.GG"+M;break;default:throw new Error("Conversion error")}return n===x.quadrant&&(t="p "+t+" b"),t}function se(e,n,t){const r={padding:0,rounding:0,newpos:n};let s=!1;for(;n<e.length;){const i=e[n];if(i===t)s?r.rounding++:r.padding++,n++;else{if("."!==i)break;s=!0,n++}}return r.newpos=n-1,r}function ie(e,n,t){const r={escaped:"",newpos:n};for(n++;n<e.length;){const t=e[n];if(n++,"]"===t)break;r.escaped+=t}return r.newpos=n-1,r}function ae(e,n,t){let r="",s=null,i=null;const a=B.createFromStringAndBearing(n,e,t),o={D:b.decimal_degrees,d:b.truncated_degrees,m:b.fractional_degree_minutes,s:b.fractional_minute_seconds,R:b.radians,G:b.gradians};for(let c=0;c<n.length;c++){const u=n[c];switch(u){case"[":s=ie(n,c),r+=s.escaped,c=s.newpos;continue;case"D":case"d":case"m":case"s":case"R":case"G":s=se(n,c,u),i=e.getAngle(t),r+=V(i,o[u],s.padding,s.rounding,a),c=s.newpos;continue;case"P":case"p":r+=y(a.fetchMeridian(),"p"===u?"SHORT":"LONG");continue;case"B":case"b":r+=y(a.fetchDirection(),"b"===u?"SHORT":"LONG");continue;default:r+=u}}return r}function oe(e,r,s){if(!(r instanceof n))throw new Error("Invalid Parameter");if(!1===r.hasField("directionType"))throw new Error("Invalid Parameter - Missing directionType");if(!1===r.hasField("angleType"))throw new Error("Invalid Parameter - Missing directionType");const i=C(v(r.field("directiontype"))),a=ee(e,P(v(r.field("angletype"))),i);if(!(s instanceof n))throw new Error("Invalid Parameter");if(!1===s.hasField("directionType"))throw new Error("Invalid Parameter - Missing directionType");if(!1===s.hasField("outputType"))throw new Error("Invalid Parameter - Missing directionType");const o=C(v(s.field("directiontype"))),c=s.hasField("angleType")?P(v(s.field("angletype"))):null,u=v(s.field("outputType")).toUpperCase().trim();if(!o||!u)throw new Error("Conversion error");if(!(c||"TEXT"===u&&s.hasField("format")))throw new Error("Invalid unit");switch(u){case"VALUE":return o===x.quadrant||c===b.degrees_minutes_seconds?te(a,o,c):ne(a,o,c);case"TEXT":{let e="";return s.hasField("format")&&(e=t.toString(s.field("format"))),null!==e&&""!==e||(e=re(c,o)),ae(a,e,o)}default:throw new Error("Invalid Parameter")}}e.convertDirection=oe,e.preciseAdd=c,e.preciseDivide=l,e.preciseMinus=u,e.preciseMultiply=d,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
