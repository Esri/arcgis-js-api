// COPYRIGHT Â© 2022 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.43/esri/copyright.txt for details.

define(["require","exports","../polyfill/tsSupport/awaiter","../polyfill/tsSupport/generator","../../kernel","../kernel","../languageUtils","./centroid","../../geometry/Extent","../../geometry/Geometry","../../geometry/geometryEngineAsync","../../geometry/Multipoint","../../geometry/Point","../../geometry/Polygon","../../geometry/Polyline","../../geometry/jsonUtils","../executionError","../Dictionary","../ArcadePortal","../portalUtils"],(function(e,n,r,t,o,i,a,u,c,s,l,f,d,E,m,y,C,h,v,A){"use strict";function x(e){return 0===o.version.indexOf("4.")?E.fromExtent(e):new E({spatialReference:e.spatialReference,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]})}function w(e,n,r){if(a.pcCheck(e,2,2,n,r),e[0]instanceof s&&e[1]instanceof s);else if(e[0]instanceof s&&null===e[1]);else if(e[1]instanceof s&&null===e[0]);else if(null!==e[0]||null!==e[1])throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r)}Object.defineProperty(n,"__esModule",{value:!0}),n.registerFunctions=void 0,n.registerFunctions=function(e){"async"===e.mode&&(e.functions.disjoint=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){return w(o=a.autoCastFeatureToGeometry(o),n,r),null===o[0]||null===o[1]||l.disjoint(o[0],o[1])}))},e.functions.intersects=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){return w(o=a.autoCastFeatureToGeometry(o),n,r),null!==o[0]&&null!==o[1]&&l.intersects(o[0],o[1])}))},e.functions.touches=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){return w(o=a.autoCastFeatureToGeometry(o),n,r),null!==o[0]&&null!==o[1]&&l.touches(o[0],o[1])}))},e.functions.crosses=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){return w(o=a.autoCastFeatureToGeometry(o),n,r),null!==o[0]&&null!==o[1]&&l.crosses(o[0],o[1])}))},e.functions.within=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){return w(o=a.autoCastFeatureToGeometry(o),n,r),null!==o[0]&&null!==o[1]&&l.within(o[0],o[1])}))},e.functions.contains=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){return w(o=a.autoCastFeatureToGeometry(o),n,r),null!==o[0]&&null!==o[1]&&l.contains(o[0],o[1])}))},e.functions.overlaps=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){return w(o=a.autoCastFeatureToGeometry(o),n,r),null!==o[0]&&null!==o[1]&&l.overlaps(o[0],o[1])}))},e.functions.equals=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){return a.pcCheck(o,2,2,n,r),o[0]===o[1]||(o[0]instanceof s&&o[1]instanceof s?l.equals(o[0],o[1]):!(!a.isDate(o[0])||!a.isDate(o[1]))&&o[0].equals(o[1]))}))},e.functions.relate=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,3,3,n,r),o[0]instanceof s&&o[1]instanceof s)return l.relate(o[0],o[1],a.toString(o[2]));if(o[0]instanceof s&&null===o[1])return!1;if(o[1]instanceof s&&null===o[0])return!1;if(null===o[0]&&null===o[1])return!1;throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r)}))},e.functions.intersection=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){return w(o=a.autoCastFeatureToGeometry(o),n,r),null===o[0]||null===o[1]?null:l.intersect(o[0],o[1])}))},e.functions.union=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){var u=[];if(0===(o=a.autoCastFeatureToGeometry(o)).length)throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.WrongNumberOfParameters,r);if(1===o.length)if(a.isArray(o[0])){for(var c=a.autoCastFeatureToGeometry(o[0]),f=0;f<c.length;f++)if(null!==c[f]){if(!(c[f]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);u.push(c[f])}}else{if(!a.isImmutableArray(o[0])){if(o[0]instanceof s)return a.fixSpatialReference(i.cloneGeometry(o[0]),n.spatialReference);if(null===o[0])return null;throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r)}var d=a.autoCastFeatureToGeometry(o[0].toArray());for(f=0;f<d.length;f++)if(null!==d[f]){if(!(d[f]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);u.push(d[f])}}else for(f=0;f<o.length;f++)if(null!==o[f]){if(!(o[f]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);u.push(o[f])}return 0===u.length?null:l.union(u)}))},e.functions.difference=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){return w(o=a.autoCastFeatureToGeometry(o),n,r),null!==o[0]&&null===o[1]?i.cloneGeometry(o[0]):null===o[0]?null:l.difference(o[0],o[1])}))},e.functions.symmetricdifference=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){return w(o=a.autoCastFeatureToGeometry(o),n,r),null===o[0]&&null===o[1]?null:null===o[0]?i.cloneGeometry(o[1]):null===o[1]?i.cloneGeometry(o[0]):l.symmetricDifference(o[0],o[1])}))},e.functions.clip=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,2,2,n,r),!(o[1]instanceof c)&&null!==o[1])throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);if(null===o[0])return null;if(!(o[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return null===o[1]?null:l.clip(o[0],o[1])}))},e.functions.cut=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,2,2,n,r),!(o[1]instanceof m)&&null!==o[1])throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);if(null===o[0])return[];if(!(o[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return null===o[1]?[i.cloneGeometry(o[0])]:l.cut(o[0],o[1])}))},e.functions.area=function(n,o){var u=this;return e.standardFunctionAsync(n,o,(function(e,c,f){return r(u,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:return a.pcCheck(f,1,2,n,o),null===(f=a.autoCastFeatureToGeometry(f))[0]?[2,0]:a.isFeatureSet(f[0])?[4,f[0].sumArea(i.convertSquareUnitsToCode(a.defaultUndefined(f[1],-1)),!1,n.abortSignal)]:[3,2];case 1:if(e=t.sent(),n.abortSignal.aborted)throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.Cancelled,o);return[2,e];case 2:if(a.isArray(f[0])||a.isImmutableArray(f[0]))return null===(r=a.autoCastArrayOfPointsToPolygon(f[0],n.spatialReference))?[2,0]:[2,l.planarArea(r,i.convertSquareUnitsToCode(a.defaultUndefined(f[1],-1)))];if(!(f[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,o);return[2,l.planarArea(f[0],i.convertSquareUnitsToCode(a.defaultUndefined(f[1],-1)))]}}))}))}))},e.functions.areageodetic=function(n,o){var u=this;return e.standardFunctionAsync(n,o,(function(e,c,f){return r(u,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:return a.pcCheck(f,1,2,n,o),null===(f=a.autoCastFeatureToGeometry(f))[0]?[2,0]:a.isFeatureSet(f[0])?[4,f[0].sumArea(i.convertSquareUnitsToCode(a.defaultUndefined(f[1],-1)),!0,n.abortSignal)]:[3,2];case 1:if(e=t.sent(),n.abortSignal.aborted)throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.Cancelled,o);return[2,e];case 2:if(a.isArray(f[0])||a.isImmutableArray(f[0]))return null===(r=a.autoCastArrayOfPointsToPolygon(f[0],n.spatialReference))?[2,0]:[2,l.geodesicArea(r,i.convertSquareUnitsToCode(a.defaultUndefined(f[1],-1)))];if(!(f[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,o);return[2,l.geodesicArea(f[0],i.convertSquareUnitsToCode(a.defaultUndefined(f[1],-1)))]}}))}))}))},e.functions.length=function(n,o){var u=this;return e.standardFunctionAsync(n,o,(function(e,c,f){return r(u,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:return a.pcCheck(f,1,2,n,o),null===(f=a.autoCastFeatureToGeometry(f))[0]?[2,0]:a.isFeatureSet(f[0])?[4,f[0].sumLength(i.convertLinearUnitsToCode(a.defaultUndefined(f[1],-1)),!1,n.abortSignal)]:[3,2];case 1:if(e=t.sent(),n.abortSignal.aborted)throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.Cancelled,o);return[2,e];case 2:if(a.isArray(f[0])||a.isImmutableArray(f[0]))return null===(r=a.autoCastArrayOfPointsToPolyline(f[0],n.spatialReference))?[2,0]:[2,l.planarLength(r,i.convertLinearUnitsToCode(a.defaultUndefined(f[1],-1)))];if(!(f[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,o);return[2,l.planarLength(f[0],i.convertLinearUnitsToCode(a.defaultUndefined(f[1],-1)))]}}))}))}))},e.functions.length3d=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(a.pcCheck(o,1,2,n,r),null===(o=a.autoCastFeatureToGeometry(o))[0])return 0;if(a.isArray(o[0])||a.isImmutableArray(o[0])){var u=a.autoCastArrayOfPointsToPolyline(o[0],n.spatialReference);return null===u?0:l.planarLength(u,i.convertLinearUnitsToCode(a.defaultUndefined(o[1],-1)))}if(!(o[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return l.planarLength(o[0],i.convertLinearUnitsToCode(a.defaultUndefined(o[1],-1)))}))},e.functions.lengthgeodetic=function(n,o){var u=this;return e.standardFunctionAsync(n,o,(function(e,c,f){return r(u,void 0,void 0,(function(){var e,r;return t(this,(function(t){switch(t.label){case 0:return a.pcCheck(f,1,2,n,o),null===(f=a.autoCastFeatureToGeometry(f))[0]?[2,0]:a.isFeatureSet(f[0])?[4,f[0].sumLength(i.convertLinearUnitsToCode(a.defaultUndefined(f[1],-1)),!0,n.abortSignal)]:[3,2];case 1:if(e=t.sent(),n.abortSignal.aborted)throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.Cancelled,o);return[2,e];case 2:if(a.isArray(f[0])||a.isImmutableArray(f[0]))return null===(r=a.autoCastArrayOfPointsToPolyline(f[0],n.spatialReference))?[2,0]:[2,l.geodesicLength(r,i.convertLinearUnitsToCode(a.defaultUndefined(f[1],-1)))];if(!(f[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,o);return[2,l.geodesicLength(f[0],i.convertLinearUnitsToCode(a.defaultUndefined(f[1],-1)))]}}))}))}))},e.functions.distance=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,2,3,n,r);var u=o[0];(a.isArray(o[0])||a.isImmutableArray(o[0]))&&(u=a.autoCastArrayOfPointsToMultiPoint(o[0],n.spatialReference));var c=o[1];if((a.isArray(o[1])||a.isImmutableArray(o[1]))&&(c=a.autoCastArrayOfPointsToMultiPoint(o[1],n.spatialReference)),!(u instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);if(!(c instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return l.distance(u,c,i.convertLinearUnitsToCode(a.defaultUndefined(o[2],-1)))}))},e.functions.distancegeodetic=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,2,3,n,r);var u=o[0],c=o[1];if(!(u instanceof d))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);if(!(c instanceof d))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);var s=new m({paths:[],spatialReference:u.spatialReference});return s.addPath([u,c]),l.geodesicLength(s,i.convertLinearUnitsToCode(a.defaultUndefined(o[2],-1)))}))},e.functions.densify=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,2,3,n,r),null===o[0])return null;if(!(o[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);var u=a.toNumber(o[1]);if(isNaN(u))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);if(u<=0)throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return o[0]instanceof E||o[0]instanceof m?l.densify(o[0],u,i.convertLinearUnitsToCode(a.defaultUndefined(o[2],-1))):o[0]instanceof c?l.densify(x(o[0]),u,i.convertLinearUnitsToCode(a.defaultUndefined(o[2],-1))):o[0]}))},e.functions.densifygeodetic=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,2,3,n,r),null===o[0])return null;if(!(o[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);var u=a.toNumber(o[1]);if(isNaN(u))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);if(u<=0)throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return o[0]instanceof E||o[0]instanceof m?l.geodesicDensify(o[0],u,i.convertLinearUnitsToCode(a.defaultUndefined(o[2],-1))):o[0]instanceof c?l.geodesicDensify(x(o[0]),u,i.convertLinearUnitsToCode(a.defaultUndefined(o[2],-1))):o[0]}))},e.functions.generalize=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,2,4,n,r),null===o[0])return null;if(!(o[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);var u=a.toNumber(o[1]);if(isNaN(u))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return l.generalize(o[0],u,a.toBoolean(a.defaultUndefined(o[2],!0)),i.convertLinearUnitsToCode(a.defaultUndefined(o[3],-1)))}))},e.functions.buffer=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,2,3,n,r),null===o[0])return null;if(!(o[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);var u=a.toNumber(o[1]);if(isNaN(u))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return 0===u?i.cloneGeometry(o[0]):l.buffer(o[0],u,i.convertLinearUnitsToCode(a.defaultUndefined(o[2],-1)))}))},e.functions.buffergeodetic=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,2,3,n,r),null===o[0])return null;if(!(o[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);var u=a.toNumber(o[1]);if(isNaN(u))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return 0===u?i.cloneGeometry(o[0]):l.geodesicBuffer(o[0],u,i.convertLinearUnitsToCode(a.defaultUndefined(o[2],-1)))}))},e.functions.offset=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,2,6,n,r),null===o[0])return null;if(!(o[0]instanceof E||o[0]instanceof m))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);var u=a.toNumber(o[1]);if(isNaN(u))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);var c=a.toNumber(a.defaultUndefined(o[4],10));if(isNaN(c))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);var s=a.toNumber(a.defaultUndefined(o[5],0));if(isNaN(s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return l.offset(o[0],u,i.convertLinearUnitsToCode(a.defaultUndefined(o[2],-1)),a.toString(a.defaultUndefined(o[3],"round")).toLowerCase(),c,s)}))},e.functions.rotate=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,2,3,n,r);var i=o[0];if(null===i)return null;if(!(i instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);i instanceof c&&(i=E.fromExtent(i));var u=a.toNumber(o[1]);if(isNaN(u))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);var f=a.defaultUndefined(o[2],null);if(null===f)return l.rotate(i,u);if(f instanceof d)return l.rotate(i,u,f);throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r)}))},e.functions.centroid=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,1,1,n,r),null===o[0])return null;var l=o[0];if((a.isArray(o[0])||a.isImmutableArray(o[0]))&&(l=a.autoCastArrayOfPointsToMultiPoint(o[0],n.spatialReference)),null===l)return null;if(!(l instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return l instanceof d?a.fixSpatialReference(i.cloneGeometry(o[0]),n.spatialReference):l instanceof E?l.getCentroid():l instanceof m?u.centroidPolyline(l):l instanceof f?u.centroidMultiPoint(l):l instanceof c?l.getCenter():null}))},e.functions.multiparttosinglepart=function(n,o){var u=this;return e.standardFunctionAsync(n,o,(function(e,h,v){return r(u,void 0,void 0,(function(){var e,r,u,h,A,x,w,p,g,F,P;return t(this,(function(t){switch(t.label){case 0:if(v=a.autoCastFeatureToGeometry(v),a.pcCheck(v,1,1,n,o),e=[],null===v[0])return[2,null];if(!(v[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,o);return v[0]instanceof d?[2,[a.fixSpatialReference(i.cloneGeometry(v[0]),n.spatialReference)]]:v[0]instanceof c?[2,[a.fixSpatialReference(i.cloneGeometry(v[0]),n.spatialReference)]]:[4,l.simplify(v[0])];case 1:if((r=t.sent())instanceof E){for(u=[],h=[],P=0;P<r.rings.length;P++)r.isClockwise(r.rings[P])?(A=y.fromJson({rings:[r.rings[P]],hasZ:!0===r.hasZ,hazM:!0===r.hasM,spatialReference:r.spatialReference.toJson()}),u.push(A)):h.push({ring:r.rings[P],pt:r.getPoint(P,0)});for(x=0;x<h.length;x++)for(w=0;w<u.length;w++)if(u[w].contains(h[x].pt)){u[w].addRing(h[x].ring);break}return[2,u]}if(r instanceof m){for(p=[],P=0;P<r.paths.length;P++)g=y.fromJson({paths:[r.paths[P]],hasZ:!0===r.hasZ,hazM:!0===r.hasM,spatialReference:r.spatialReference.toJson()}),p.push(g);return[2,p]}if(v[0]instanceof f){for(F=a.fixSpatialReference(i.cloneGeometry(v[0]),n.spatialReference),P=0;P<F.points.length;P++)e.push(F.getPoint(P));return[2,e]}return[2,null]}}))}))}))},e.functions.issimple=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,1,1,n,r),null===o[0])return!0;if(!(o[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return l.isSimple(o[0])}))},e.functions.simplify=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,1,1,n,r),null===o[0])return null;if(!(o[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return l.simplify(o[0])}))},e.functions.convexhull=function(n,r){return e.standardFunctionAsync(n,r,(function(e,t,o){if(o=a.autoCastFeatureToGeometry(o),a.pcCheck(o,1,1,n,r),null===o[0])return null;if(!(o[0]instanceof s))throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,r);return l.convexHull(o[0])}))},e.functions.getuser=function(n,o){var i=this;return e.standardFunctionAsync(n,o,(function(e,u,c){return r(i,void 0,void 0,(function(){var e,r,i,u,s,l,f,d,E,m,y,x,w;return t(this,(function(t){switch(t.label){case 0:return a.pcCheck(c,0,2,n,o),e=a.defaultUndefined(c[1],""),r=!0===e,e=!0===e||!1===e?"":a.toString(e),0===c.length||c[0]instanceof v?(d=null,n.services&&n.services.portal&&(d=n.services.portal),c.length>0&&(d=A.getPortal(c[0],d)),[4,A.lookupUser(d,e,r)]):[3,2];case 1:if(E=t.sent()){for(m=JSON.parse(JSON.stringify(E)),i=0,u=["lastLogin","created","modified"];i<u.length;i++)void 0!==m[w=u[i]]&&null!==m[w]&&(m[w]=new Date(m[w]));return[2,h.convertObjectToArcadeDictionary(m,a.defaultTimeZone(n))]}return[2,null];case 2:return s=null,a.isFeatureSet(c[0])&&(s=c[0]),s?(r=!1,e?[2,null]:[4,s.load()]):[3,9];case 3:return t.sent(),[4,s.getOwningSystemUrl()];case 4:return(l=t.sent())?[3,7]:e?[3,6]:[4,s.getIdentityUser()];case 5:return(f=t.sent())?[2,h.convertObjectToArcadeDictionary({username:f},a.defaultTimeZone(n))]:[2,null];case 6:return[2,null];case 7:return d=null,n.services&&n.services.portal&&(d=n.services.portal),d=A.getPortal(new v(l),d),[4,A.lookupUser(d,e,r)];case 8:if(E=t.sent()){for(m=JSON.parse(JSON.stringify(E)),y=0,x=["lastLogin","created","modified"];y<x.length;y++)void 0!==m[w=x[y]]&&null!==m[w]&&(m[w]=new Date(m[w]));return[2,h.convertObjectToArcadeDictionary(m,a.defaultTimeZone(n))]}return[2,null];case 9:throw new C.ArcadeExecutionError(n,C.ExecutionErrorCodes.InvalidParameter,o)}}))}))}))})}}));