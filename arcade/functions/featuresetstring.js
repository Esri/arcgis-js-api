/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../Dictionary","../executionError","../../chunks/languageUtils","../featureset/support/shared"],(function(e,n,t,r,o,i){"use strict";function a(e){return e&&e.domain?"coded-value"===e.domain.type||"codedValue"===e.domain.type?t.convertObjectToArcadeDictionary({type:"codedValue",name:e.domain.name,dataType:i.layerFieldEsriConstants[e.field.type],codedValues:e.domain.codedValues.map((e=>({name:e.name,code:e.code})))}):t.convertObjectToArcadeDictionary({type:"range",name:e.domain.name,dataType:i.layerFieldEsriConstants[e.field.type],min:e.domain.min,max:e.domain.max}):null}function u(e){"async"===e.mode&&(e.functions.domain=function(t,i){return e.standardFunctionAsync(t,i,function(){var e=n._asyncToGenerator((function*(e,n,u){if(o.pcCheck(u,2,3,t,i),o.isFeature(u[0])){return a(o.featureFullDomain(u[0],o.toString(u[1]),void 0===u[2]?void 0:o.toNumber(u[2])))}if(o.isFeatureSet(u[0])){yield u[0]._ensureLoaded();return a(o.getDomain(o.toString(u[1]),u[0],null,void 0===u[2]?void 0:o.toNumber(u[2])))}throw new r.ArcadeExecutionError(t,r.ExecutionErrorCodes.InvalidParameter,i)}));return function(n,t,r){return e.apply(this,arguments)}}())},e.functions.subtypes=function(i,a){return e.standardFunctionAsync(i,a,function(){var e=n._asyncToGenerator((function*(e,n,u){if(o.pcCheck(u,1,1,i,a),o.isFeature(u[0])){const e=o.featureSubtypes(u[0]);return e?t.convertObjectToArcadeDictionary(e):null}if(o.isFeatureSet(u[0])){yield u[0]._ensureLoaded();const e=u[0].subtypes();return e?t.convertObjectToArcadeDictionary(e):null}throw new r.ArcadeExecutionError(i,r.ExecutionErrorCodes.InvalidParameter,a)}));return function(n,t,r){return e.apply(this,arguments)}}())},e.functions.domainname=function(t,i){return e.standardFunctionAsync(t,i,function(){var e=n._asyncToGenerator((function*(e,n,a){if(o.pcCheck(a,2,4,t,i),o.isFeature(a[0]))return o.featureDomainValueLookup(a[0],o.toString(a[1]),a[2],void 0===a[3]?void 0:o.toNumber(a[3]));if(o.isFeatureSet(a[0])){yield a[0]._ensureLoaded();const e=o.getDomain(o.toString(a[1]),a[0],null,void 0===a[3]?void 0:o.toNumber(a[3]));return o.getDomainValue(e,a[2])}throw new r.ArcadeExecutionError(t,r.ExecutionErrorCodes.InvalidParameter,i)}));return function(n,t,r){return e.apply(this,arguments)}}())},e.signatures.push({name:"domainname",min:2,max:4}),e.functions.domaincode=function(t,i){return e.standardFunctionAsync(t,i,function(){var e=n._asyncToGenerator((function*(e,n,a){if(o.pcCheck(a,2,4,t,i),o.isFeature(a[0]))return o.featureDomainCodeLookup(a[0],o.toString(a[1]),a[2],void 0===a[3]?void 0:o.toNumber(a[3]));if(o.isFeatureSet(a[0])){yield a[0]._ensureLoaded();const e=o.getDomain(o.toString(a[1]),a[0],null,void 0===a[3]?void 0:o.toNumber(a[3]));return o.getDomainCode(e,a[2])}throw new r.ArcadeExecutionError(t,r.ExecutionErrorCodes.InvalidParameter,i)}));return function(n,t,r){return e.apply(this,arguments)}}())},e.signatures.push({name:"domaincode",min:2,max:4})),e.functions.text=function(n,t){return e.standardFunctionAsync(n,t,((e,r,i)=>{if(o.pcCheck(i,1,2,n,t),!o.isFeatureSet(i[0]))return o.toStringExplicit(i[0],i[1]);{const n=o.defaultUndefined(i[1],"");if(""===n)return i[0].castToText();if("schema"===n.toLowerCase())return i[0].convertToText("schema",e.abortSignal);if("featureset"===n.toLowerCase())return i[0].convertToText("featureset",e.abortSignal)}}))},e.functions.gdbversion=function(t,i){return e.standardFunctionAsync(t,i,function(){var e=n._asyncToGenerator((function*(e,n,a){if(o.pcCheck(a,1,1,t,i),o.isFeature(a[0]))return a[0].gdbVersion();if(o.isFeatureSet(a[0])){return(yield a[0].load()).gdbVersion}throw new r.ArcadeExecutionError(t,r.ExecutionErrorCodes.InvalidParameter,i)}));return function(n,t,r){return e.apply(this,arguments)}}())},e.functions.schema=function(i,a){return e.standardFunctionAsync(i,a,function(){var e=n._asyncToGenerator((function*(e,n,u){if(o.pcCheck(u,1,1,i,a),o.isFeatureSet(u[0]))return yield u[0].load(),t.convertObjectToArcadeDictionary(u[0].schema());if(o.isFeature(u[0])){const e=o.featureSchema(u[0]);return e?t.convertObjectToArcadeDictionary(e):null}throw new r.ArcadeExecutionError(i,r.ExecutionErrorCodes.InvalidParameter,a)}));return function(n,t,r){return e.apply(this,arguments)}}())}}e.registerFunctions=u,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
