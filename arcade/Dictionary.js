/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","./ArcadeDate","./executionError","./ImmutableArray","../chunks/languageUtils","../geometry/Geometry"],(function(t,n,i,e,r,s){"use strict";function o(t,n,i=!1){if(null==t)return null;if(r.isNumber(t))return r.toNumber(t);if(r.isBoolean(t))return r.toBoolean(t);if(r.isString(t))return r.toString(t);if(r.isDate(t))return r.toDate(t,n);if(r.isArray(t)){const e=[];for(const r of t)e.push(o(r,n,i));return e}const e=new a;e.immutable=!1;for(const r of Object.keys(t)){const s=t[r];void 0!==s&&e.setField(r,o(s,n,i))}return e.immutable=i,e}let a=function(){function a(t){this.declaredClass="esri.arcade.Dictionary",this.attributes=null,this.plain=!1,this.immutable=!0,this.attributes=t instanceof a?t.attributes:t??{}}var u=a.prototype;return u.field=function(t){const n=t.toLowerCase(),e=this.attributes[t];if(void 0!==e)return e;for(const i in this.attributes)if(i.toLowerCase()===n)return this.attributes[i];throw new i.ArcadeExecutionError(null,i.ExecutionErrorCodes.FieldNotFound,null,{key:t})},u.setField=function(t,e){if(this.immutable)throw new i.ArcadeExecutionError(null,i.ExecutionErrorCodes.Immutable,null);if(r.isFunctionParameter(e))throw new i.ArcadeExecutionError(null,i.ExecutionErrorCodes.NoFunctionInDictionary,null);const s=t.toLowerCase();e instanceof Date&&(e=n.ArcadeDate.dateJSToArcadeDate(e));if(void 0===this.attributes[t]){for(const t in this.attributes)if(t.toLowerCase()===s)return void(this.attributes[t]=e);this.attributes[t]=e}else this.attributes[t]=e},u.hasField=function(t){const n=t.toLowerCase();if(void 0!==this.attributes[t])return!0;for(const i in this.attributes)if(i.toLowerCase()===n)return!0;return!1},u.keys=function(){let t=[];for(const n in this.attributes)t.push(n);return t=t.sort(),t},u.castToText=function(t=!1){let i="";for(const o in this.attributes){""!==i&&(i+=",");const a=this.attributes[o];null==a?i+=JSON.stringify(o)+":null":r.isBoolean(a)||r.isNumber(a)||r.isString(a)?i+=JSON.stringify(o)+":"+JSON.stringify(a):a instanceof s?i+=JSON.stringify(o)+":"+r.toStringExplicit(a):a instanceof e||a instanceof Array?i+=JSON.stringify(o)+":"+r.toStringExplicit(a,null,t):a instanceof n.ArcadeDate?i+=t?JSON.stringify(o)+":"+JSON.stringify(a.getTime()):JSON.stringify(o)+":"+a.stringify():null!==a&&"object"==typeof a&&void 0!==a.castToText&&(i+=JSON.stringify(o)+":"+a.castToText(t))}return"{"+i+"}"},a.convertObjectToArcadeDictionary=function(t,n,i=!0){const e=new a;e.immutable=!1;for(const r in t){const i=t[r];void 0!==i&&e.setField(r.toString(),o(i,n))}return e.immutable=i,e},a.convertJsonToArcade=function(t,n,i=!1){return o(t,n,i)},u.castAsJson=function(t=null){const n={};for(let i in this.attributes){const e=this.attributes[i];void 0!==e&&(t?.keyTranslate&&(i=t.keyTranslate(i)),n[i]=r.castAsJson(e,t))}return n},u.castDictionaryValueAsJsonAsync=function(){var n=t._asyncToGenerator((function*(t,n,i,e=null,s){const o=yield r.castAsJsonAsync(i,e,s);return t[n]=o,o}));function i(t,i,e){return n.apply(this,arguments)}return i}(),u.castAsJsonAsync=function(){var i=t._asyncToGenerator((function*(t=null,i=null){const e={},o=[];for(let a in this.attributes){const u=this.attributes[a];i?.keyTranslate&&(a=i.keyTranslate(a)),void 0!==u&&(r.isSimpleType(u)||u instanceof s||u instanceof n.ArcadeDate?e[a]=r.castAsJson(u,i):o.push(this.castDictionaryValueAsJsonAsync(e,a,u,t,i)))}return o.length>0&&(yield Promise.all(o)),e}));function e(){return i.apply(this,arguments)}return e}(),a}();return a}));
