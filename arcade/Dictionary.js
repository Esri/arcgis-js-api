/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","./executionError","./ImmutableArray","../chunks/languageUtils","../geometry/Geometry"],(function(t,n,i,r,e){"use strict";function s(t,n=!1){if(null==t)return null;if(r.isNumber(t))return r.toNumber(t);if(r.isBoolean(t))return r.toBoolean(t);if(r.isString(t))return r.toString(t);if(r.isDate(t))return r.toDate(t);if(r.isArray(t)){const i=[];for(const r of t)i.push(s(r,n));return i}const i=new o;i.immutable=!1;for(const r of Object.keys(t)){const e=t[r];void 0!==e&&i.setField(r,s(e,n))}return i.immutable=n,i}let o=function(){function o(t){this.declaredClass="esri.arcade.Dictionary",this.attributes=null,this.plain=!1,this.immutable=!0,this.attributes=t instanceof o?t.attributes:t??{}}var u=o.prototype;return u.field=function(t){const i=t.toLowerCase(),r=this.attributes[t];if(void 0!==r)return r;for(const n in this.attributes)if(n.toLowerCase()===i)return this.attributes[n];throw new n.ArcadeExecutionError(null,n.ExecutionErrorCodes.FieldNotFound,null,{key:t})},u.setField=function(t,i){if(this.immutable)throw new n.ArcadeExecutionError(null,n.ExecutionErrorCodes.Immutable,null);if(r.isFunctionParameter(i))throw new n.ArcadeExecutionError(null,n.ExecutionErrorCodes.NoFunctionInDictionary,null);const e=t.toLowerCase();if(void 0===this.attributes[t]){for(const t in this.attributes)if(t.toLowerCase()===e)return void(this.attributes[t]=i);this.attributes[t]=i}else this.attributes[t]=i},u.hasField=function(t){const n=t.toLowerCase();if(void 0!==this.attributes[t])return!0;for(const i in this.attributes)if(i.toLowerCase()===n)return!0;return!1},u.keys=function(){let t=[];for(const n in this.attributes)t.push(n);return t=t.sort(),t},u.castToText=function(t=!1){let n="";for(const s in this.attributes){""!==n&&(n+=",");const o=this.attributes[s];null==o?n+=JSON.stringify(s)+":null":r.isBoolean(o)||r.isNumber(o)||r.isString(o)?n+=JSON.stringify(s)+":"+JSON.stringify(o):o instanceof e?n+=JSON.stringify(s)+":"+r.toStringExplicit(o):o instanceof i||o instanceof Array?n+=JSON.stringify(s)+":"+r.toStringExplicit(o,null,t):o instanceof Date?n+=t?JSON.stringify(s)+":"+JSON.stringify(o.getTime()):JSON.stringify(s)+":"+JSON.stringify(o):null!==o&&"object"==typeof o&&void 0!==o.castToText&&(n+=JSON.stringify(s)+":"+o.castToText(t))}return"{"+n+"}"},o.convertObjectToArcadeDictionary=function(t,n=!0){const i=new o;i.immutable=!1;for(const r in t){const n=t[r];void 0!==n&&i.setField(r.toString(),s(n))}return i.immutable=n,i},o.convertJsonToArcade=function(t,n=!1){return s(t,n)},u.castAsJson=function(t=null){const n={};for(let i in this.attributes){const e=this.attributes[i];void 0!==e&&(t?.keyTranslate&&(i=t.keyTranslate(i)),n[i]=r.castAsJson(e,t))}return n},u.castDictionaryValueAsJsonAsync=function(){var n=t._asyncToGenerator((function*(t,n,i,e=null,s){const o=yield r.castAsJsonAsync(i,e,s);return t[n]=o,o}));function i(t,i,r){return n.apply(this,arguments)}return i}(),u.castAsJsonAsync=function(){var n=t._asyncToGenerator((function*(t=null,n=null){const i={},s=[];for(let o in this.attributes){const u=this.attributes[o];n?.keyTranslate&&(o=n.keyTranslate(o)),void 0!==u&&(r.isSimpleType(u)||u instanceof e||u instanceof Date?i[o]=r.castAsJson(u,n):s.push(this.castDictionaryValueAsJsonAsync(i,o,u,t,n)))}return s.length>0&&(yield Promise.all(s)),i}));function i(){return n.apply(this,arguments)}return i}(),o}();return o}));
