/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["./ImmutableArray","../chunks/languageUtils","../geometry/Geometry"],(function(t,i,e){"use strict";function r(t,e=!1){if(null==t)return null;if(i.isNumber(t))return i.toNumber(t);if(i.isBoolean(t))return i.toBoolean(t);if(i.isString(t))return i.toString(t);if(i.isDate(t))return i.toDate(t);if(i.isArray(t)){const i=[];for(const n of t)i.push(r(n,e));return i}const s=new n;s.immutable=!1;for(const i of Object.keys(t)){const n=t[i];void 0!==n&&s.setField(i,r(n,e))}return s.immutable=e,s}let n=function(){function n(t){this.declaredClass="esri.arcade.Dictionary",this.attributes=null,this.plain=!1,this.immutable=!0,this.attributes=t instanceof n?t.attributes:null==t?{}:t}var s=n.prototype;return s.field=function(t){const i=t.toLowerCase(),e=this.attributes[t];if(void 0!==e)return e;for(const r in this.attributes)if(r.toLowerCase()===i)return this.attributes[r];throw new Error("Field not Found : "+t)},s.setField=function(t,i){if(this.immutable)throw new Error("Dictionary is Immutable");const e=t.toLowerCase();if(void 0===this.attributes[t]){for(const t in this.attributes)if(t.toLowerCase()===e)return void(this.attributes[t]=i);this.attributes[t]=i}else this.attributes[t]=i},s.hasField=function(t){const i=t.toLowerCase();if(void 0!==this.attributes[t])return!0;for(const e in this.attributes)if(e.toLowerCase()===i)return!0;return!1},s.keys=function(){let t=[];for(const i in this.attributes)t.push(i);return t=t.sort(),t},s.castToText=function(){let r="";for(const n in this.attributes){""!==r&&(r+=",");const s=this.attributes[n];null==s?r+=JSON.stringify(n)+":null":i.isBoolean(s)||i.isNumber(s)||i.isString(s)?r+=JSON.stringify(n)+":"+JSON.stringify(s):s instanceof e||s instanceof t||s instanceof Array?r+=JSON.stringify(n)+":"+i.toStringExplicit(s):s instanceof Date?r+=JSON.stringify(n)+":"+JSON.stringify(s):null!==s&&"object"==typeof s&&void 0!==s.castToText&&(r+=JSON.stringify(n)+":"+s.castToText())}return"{"+r+"}"},n.convertObjectToArcadeDictionary=function(t,i=!0){const e=new n;e.immutable=!1;for(const n in t){const i=t[n];void 0!==i&&e.setField(n.toString(),r(i))}return e.immutable=i,e},n.convertJsonToArcade=function(t,i=!1){return r(t,i)},n}();return n}));
