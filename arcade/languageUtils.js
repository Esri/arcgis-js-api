// COPYRIGHT © 2022 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.43/esri/copyright.txt for details.

define(["require","exports","./polyfill/tsSupport/awaiter","./polyfill/tsSupport/generator","./polyfill/tsSupport/assign","./polyfill/tsSupport/spreadarray","./FunctionWrapper","./ImmutableArray","./ImmutablePathArray","./ImmutablePointArray","./ArcadeDate","../geometry/Extent","../geometry/Geometry","../geometry/Multipoint","../geometry/Point","../geometry/Polygon","../geometry/Polyline","../libs/luxon/luxon","dojo/number","dojo/_base/kernel","./featureset/support/shared","./ArcadeModule","./executionError"],(function(e,n,t,r,i,a,o,u,l,s,f,c,d,m,y,p,g,h,v,b,x,S,A){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.featureSchema=n.defaultTimeZone=n.featureDomainCodeLookup=n.featureDomainValueLookup=n.featureSubtypes=n.featureFullDomain=n.castAsJsonAsync=n.castAsJson=n.binaryOperator=n.tick=n.toStringArray=n.autoCastArrayOfPointsToMultiPoint=n.autoCastArrayOfPointsToPolyline=n.autoCastArrayOfPointsToPolygon=n.autoCastFeatureToGeometry=n.stableStringify=n.getDomain=n.getDomainCode=n.getDomainValue=n.fixNullGeometry=n.fixSpatialReference=n.toBoolean=n.toDate=n.toNumber=n.toStringExplicit=n.toNumberArray=n.toString=n.equalityTest=n.greaterThanLessThan=n.standardiseDateFormat=n.formatDate=n.formatNumber=n.generateUUID=n.absRound=n.pcCheck=n.isJsDate=n.isObject=n.isDate=n.isImmutableArray=n.isFeatureSetCollection=n.isFeatureSet=n.isFeature=n.isArray=n.isInteger=n.isNumber=n.isBoolean=n.isString=n.getType=n.defaultUndefined=n.isSimpleType=n.isModule=n.isFunctionParameter=n.multiReplace=n.continueResult=n.breakResult=n.voidOperation=n.ReturnResult=n.ImplicitResult=n.ImplicitResultE=n.ReturnResultE=void 0;var N=function(e){this.value=e};n.ReturnResultE=N;var D=function(e){this.value=e};function T(e,n,t){return""===n?e:null===n?e:void 0===n?e:n===t?e:n===t?e:e=e.split(n).join(t)}function R(e){return e instanceof o.ArcadeFunction}function k(e){return e instanceof S.ArcadeModule}function C(e){return!!M(e)||(!!O(e)||(!!L(e)||(!!F(e)||(null===e||(e===n.voidOperation||"number"==typeof e)))))}function M(e){return"string"==typeof e||e instanceof String}function F(e){return"boolean"==typeof e}function O(e){return"number"==typeof e}function I(e){return e instanceof Array}function w(e){return"esri.arcade.Feature"===(null==e?void 0:e.arcadeDeclaredClass)}function E(e){return"esri.arcade.featureset.support.FeatureSet"===(null==e?void 0:e.declaredRootClass)}function P(e){return"esri.arcade.featureSetCollection"===(null==e?void 0:e.declaredRootClass)}function Z(e){return e instanceof u}function L(e){return e instanceof f.ArcadeDate}function J(e){return null!=e&&"object"==typeof e}function _(e){return e instanceof Date}function j(e,n){return isNaN(e)?e.toString():null==n||""===n?e.toString():(n=T(n,"‰",""),n=T(n,"¤",""),v.format(e,{pattern:n}))}function Y(e,n){return null==n||""===n?e.toISOString(!0):e.toFormat(G(n),{locale:b.locale,numberingSystem:"latn"})}function G(e){for(var n="",t=0,r=(e=e.replace(/LTS|LT|LL?L?L?|l{1,4}/g,"[$&]")).match(/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g)||[];t<r.length;t++){var i=r[t];switch(i){case"D":n+="d";break;case"DD":n+="dd";break;case"DDD":n+="o";break;case"d":n+="c";break;case"ddd":n+="ccc";break;case"dddd":n+="cccc";break;case"M":n+="L";break;case"MM":n+="LL";break;case"MMM":n+="LLL";break;case"MMMM":n+="LLLL";break;case"YY":n+="yy";break;case"Y":case"YYYY":n+="yyyy";break;case"Q":n+="q";break;case"Z":n+="ZZ";break;case"ZZ":n+="ZZZ";break;case"S":n+="'S'";break;case"SS":n+="'SS'";break;case"SSS":n+="u";break;case"A":case"a":n+="a";break;case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":case"X":case"x":n+=i;break;default:i.length>=2&&"["===i.slice(0,1)&&"]"===i.slice(-1)?n+="'"+i.slice(1,-1)+"'":n+="'"+i+"'"}}return n}function V(e,n,t){switch(t){case">":return e>n;case"<":return e<n;case">=":return e>=n;case"<=":return e<=n}return!1}function z(e,t){if(e===t)return!0;if(null===e&&t===n.voidOperation||null===t&&e===n.voidOperation)return!0;if(L(e)&&L(t))return e.equals(t);if(e instanceof l)return e.equalityTest(t);if(e instanceof s)return e.equalityTest(t);if(e instanceof y&&t instanceof y){var r=e.getCacheValue("_arcadeCacheId"),i=t.getCacheValue("_arcadeCacheId");if(null!=r)return r===i}if(J(e)&&J(t)){if(e._arcadeCacheId===t._arcadeCacheId&&void 0!==e._arcadeCacheId&&null!==e._arcadeCacheId)return!0;if(e._underlyingGraphic===t._underlyingGraphic&&void 0!==e._underlyingGraphic&&null!==e._underlyingGraphic)return!0}return!1}function U(e,t){if(M(e))return e;if(null===e)return"";if(O(e))return j(e,t);if(F(e))return e.toString();if(L(e))return Y(e,t);if(e instanceof d)return JSON.stringify(e.toJson());if(I(e)){for(var r=[],i=0;i<e.length;i++)r[i]=B(e[i]);return"["+r.join(",")+"]"}if(e instanceof u){for(r=[],i=0;i<e.length();i++)r[i]=B(e.get(i));return"["+r.join(",")+"]"}return null!==e&&"object"==typeof e&&void 0!==e.castToText?e.castToText():R(e)?"object, Function":e===n.voidOperation?"":k(e)?"object, Module":""}function q(e,t,r){if(void 0===r&&(r=!1),M(e))return e;if(null===e)return"";if(O(e))return j(e,t);if(F(e))return e.toString();if(L(e))return Y(e,t);if(e instanceof d)return e instanceof c?'{"xmin":'+e.xmin.toString()+',"ymin":'+e.ymin.toString()+","+(e.hasZ?'"zmin":'+e.zmin.toString()+",":"")+(e.hasM?'"mmin":'+e.mmin.toString()+",":"")+'"xmax":'+e.xmax.toString()+',"ymax":'+e.ymax.toString()+","+(e.hasZ?'"zmax":'+e.zmax.toString()+",":"")+(e.hasM?'"mmax":'+e.mmax.toString()+",":"")+'"spatialReference":'+K(e.spatialReference)+"}":K(e.toJson(),(function(e,n){return e.key===n.key?0:"spatialReference"===e.key?1:"spatialReference"===n.key?-1:e.key<n.key?-1:e.key>n.key?1:0}));if(I(e)){for(var i=[],a=0;a<e.length;a++)i[a]=B(e[a],r);return"["+i.join(",")+"]"}if(e instanceof u){for(i=[],a=0;a<e.length();a++)i[a]=B(e.get(a),r);return"["+i.join(",")+"]"}return null!==e&&"object"==typeof e&&void 0!==e.castToText?e.castToText(r):R(e)?"object, Function":e===n.voidOperation?"":k(e)?"object, Module":""}function B(e,t){if(void 0===t&&(t=!1),null===e)return"null";if(F(e)||O(e)||M(e))return JSON.stringify(e);if(e instanceof d)return q(e,null,t);if(e instanceof u)return q(e,null,t);if(e instanceof Array)return q(e,null,t);if(L(e))return t?JSON.stringify(e.getTime()):JSON.stringify(Y(e,""));if(null!==e&&"object"==typeof e){if(void 0!==e.castToText)return e.castToText(t)}else if(e===n.voidOperation)return"null";return"null"}function H(e,t){return O(e)?e:null===e?0:""===e?0:L(e)?NaN:F(e)?e?1:0:I(e)?NaN:""===e?NaN:void 0===e?NaN:void 0!==t&&M(e)?(t=T(t,"‰",""),t=T(t,"¤",""),v.parse(e,{pattern:t})):e===n.voidOperation?0:Number(e)}function W(e,n){if(!e)return n;if(!e.domain)return n;var t=null;if("string"===e.field.type||"esriFieldTypeString"===e.field.type)n=U(n);else{if(null==n)return null;if(""===n)return n;n=H(n)}for(var r=0;r<e.domain.codedValues.length;r++){var i=e.domain.codedValues[r];i.code===n&&(t=i)}return null===t?n:t.name}function Q(e,n){if(!e)return n;if(!e.domain)return n;var t=null;n=U(n);for(var r=0;r<e.domain.codedValues.length;r++){var i=e.domain.codedValues[r];i.name===n&&(t=i)}return null===t?n:t.code}function X(e,n,t,r){if(void 0===t&&(t=null),void 0===r&&(r=null),!n)return null;if(!n.fields)return null;for(var i,a,o=null,u=0;u<n.fields.length;u++){var l=n.fields[u];l.name.toLowerCase()===e.toString().toLowerCase()&&(o=l)}if(null===o)throw new A.ArcadeExecutionError(null,A.ExecutionErrorCodes.FieldNotFound,null,{key:e});return null===r&&t&&n.typeIdField&&(r=t.hasField(n.typeIdField)?t.field(n.typeIdField):null),null!=r&&n.types.some((function(e){return e.id===r&&((i=e.domains&&e.domains[o.name])&&"inherited"===i.type&&(i=$(o.name,n),a=!0),!0)})),a||i||(i=$(e,n)),{field:o,domain:i}}function $(e,n){var t;return n.fields.some((function(n){return n.name.toLowerCase()===e.toLowerCase()&&(t=n.domain),!!t})),t}function K(e,n){n||(n={}),"function"==typeof n&&(n={cmp:n});var t,r="boolean"==typeof n.cycles&&n.cycles,i=n.cmp&&(t=n.cmp,function(e){return function(n,r){var i={key:n,value:e[n]},a={key:r,value:e[r]};return t(i,a)}}),a=[];return function e(n){if(n&&n.toJson&&"function"==typeof n.toJson&&(n=n.toJson()),void 0!==n){if("number"==typeof n)return isFinite(n)?""+n:"null";if("object"!=typeof n)return JSON.stringify(n);var t,o;if(Array.isArray(n)){for(o="[",t=0;t<n.length;t++)t&&(o+=","),o+=e(n[t])||"null";return o+"]"}if(null===n)return"null";if(a.includes(n)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=a.push(n)-1,l=Object.keys(n).sort(i&&i(n));for(o="",t=0;t<l.length;t++){var s=l[t],f=e(n[s]);f&&(o&&(o+=","),o+=JSON.stringify(s)+":"+f)}return a.splice(u,1),"{"+o+"}"}}(e)}function ee(e,n){if(!(n instanceof y))throw new A.ArcadeExecutionError(null,A.ExecutionErrorCodes.InvalidParameter,null);e.push([n.x,n.y])}n.ImplicitResultE=D,n.ImplicitResult=D,n.ReturnResult=N,n.voidOperation={type:"VOID"},n.breakResult={type:"BREAK"},n.continueResult={type:"CONTINUE"},n.multiReplace=T,n.isFunctionParameter=R,n.isModule=k,n.isSimpleType=C,n.defaultUndefined=function(e,n){return void 0===e?n:e},n.getType=function(e){return null==e?"":I(e)?"Array":Z(e)?"Array":L(e)?"Date":M(e)?"String":F(e)?"Boolean":O(e)?"Number":"esri.arcade.Attachment"===(null==e?void 0:e.declaredClass)?"Attachment":"esri.arcade.Portal"===(null==e?void 0:e.declaredClass)?"Portal":"esri.arcade.Dictionary"===(null==e?void 0:e.declaredClass)?"Dictionary":e instanceof S.ArcadeModule?"Module":w(e)?"Feature":e instanceof y?"Point":e instanceof p?"Polygon":e instanceof g?"Polyline":e instanceof m?"Multipoint":e instanceof c?"Extent":R(e)?"Function":E(e)?"FeatureSet":P(e)?"FeatureSetCollection":e===n.voidOperation?"":"number"==typeof e&&isNaN(e)?"Number":"Unrecognised Type"},n.isString=M,n.isBoolean=F,n.isNumber=O,n.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isArray=I,n.isFeature=w,n.isFeatureSet=E,n.isFeatureSetCollection=P,n.isImmutableArray=Z,n.isDate=L,n.isObject=J,n.isJsDate=_,n.pcCheck=function(e,n,t,r,i){if(e.length<n||e.length>t)throw new A.ArcadeExecutionError(r,A.ExecutionErrorCodes.WrongNumberOfParameters,i)},n.absRound=function(e){return e<0?-Math.round(-e):Math.round(e)},n.generateUUID=function(){var e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===n?t:3&t|8).toString(16)}))},n.formatNumber=j,n.formatDate=Y,n.standardiseDateFormat=G,n.greaterThanLessThan=function(e,t,r){if(null===e){if(null===t||t===n.voidOperation)return V(null,null,r);if(O(t))return V(0,t,r);if(M(t))return V(0,H(t),r);if(F(t))return V(0,H(t),r);if(L(t))return V(0,t.toNumber(),r)}if(e===n.voidOperation){if(null===t||t===n.voidOperation)return V(null,null,r);if(O(t))return V(0,t,r);if(M(t))return V(0,H(t),r);if(F(t))return V(0,H(t),r);if(L(t))return V(0,t.toNumber(),r)}else if(O(e)){if(O(t))return V(e,t,r);if(F(t))return V(e,H(t),r);if(null===t||t===n.voidOperation)return V(e,0,r);if(M(t))return V(e,H(t),r);if(L(t))return V(e,t.toNumber(),r)}else if(M(e)){if(M(t))return V(U(e),U(t),r);if(L(t))return V(H(e),t.toNumber(),r);if(O(t))return V(H(e),t,r);if(null===t||t===n.voidOperation)return V(H(e),0,r);if(F(t))return V(H(e),H(t),r)}else if(L(e)){if(L(t))return V(e.toNumber(),t.toNumber(),r);if(null===t||t===n.voidOperation)return V(e.toNumber(),0,r);if(O(t))return V(e.toNumber(),t,r);if(F(t))return V(e.toNumber(),H(t),r);if(M(t))return V(e.toNumber(),H(t),r)}else if(F(e)){if(F(t))return V(e,t,r);if(O(t))return V(H(e),H(t),r);if(L(t))return V(H(e),t.toNumber(),r);if(null===t||t===n.voidOperation)return V(H(e),0,r);if(M(t))return V(H(e),H(t),r)}return!!z(e,t)&&("<="===r||">="===r)},n.equalityTest=z,n.toString=U,n.toNumberArray=function(e){var n=[];if(!I(e))return null;if(e instanceof u){for(var t=0;t<e.length();t++)n[t]=H(e.get(t));return n}for(t=0;t<e.length;t++)n[t]=H(e[t]);return n},n.toStringExplicit=q,n.toNumber=H,n.toDate=function(e,n){if(L(e))return e;if(M(e)){var t=function(e,n){var t=/ (\d\d)/,r=f.createDateTimeZone(n),i=h.DateTime.fromISO(e,{zone:r});if(i.isValid)return i;if(t.test(e)&&(e=e.replace(t,"T$1"),(i=h.DateTime.fromISO(e,{zone:n})).isValid))return i;return null}(e,n);if(t)return f.ArcadeDate.dateTimeToArcadeDate(t)}return null},n.toBoolean=function(e){return F(e)?e:M(e)?"true"===(e=e.toLowerCase()):!!O(e)&&(0!==e&&!isNaN(e))},n.fixSpatialReference=function(e,n){return null==e?null:(null!==e.spatialReference&&void 0!==e.spatialReference||(e.spatialReference=n),e)},n.fixNullGeometry=function(e){if(null===e)return null;if(e instanceof y)return"NaN"===e.x||null===e.x||isNaN(e.x)?null:e;if(e instanceof p){if(0===e.rings.length)return null;for(var n=0,t=e.rings;n<t.length;n++){if(t[n].length>0)return e}return null}if(e instanceof g){if(0===e.paths.length)return null;for(var r=0,i=e.paths;r<i.length;r++){if(i[r].length>0)return e}return null}return e instanceof m?0===e.points.length?null:e:e instanceof c?"NaN"===e.xmin||null===e.xmin||isNaN(e.xmin)?null:e:null},n.getDomainValue=W,n.getDomainCode=Q,n.getDomain=X,n.stableStringify=K,n.autoCastFeatureToGeometry=function(e){if(null===e)return null;for(var n=[],t=0,r=e;t<r.length;t++){var i=r[t];i&&i.arcadeDeclaredClass&&"esri.arcade.Feature"===i.arcadeDeclaredClass?n.push(i.geometry()):n.push(i)}return n},n.autoCastArrayOfPointsToPolygon=function(e,n){if(I(e)||Z(e)){var t=!1,r=!1,i=[],a=n;if(I(e)){for(var o=0,u=e;o<u.length;o++){ee(i,u[o])}i.length>0&&(a=e[0].spatialReference,t=e[0].hasZ,r=e[0].hasM)}else if(e instanceof s)(i=e._elements).length>0&&(t=e._hasZ,r=e._hasM,a=e.get(0).spatialReference);else{if(!Z(e))throw new A.ArcadeExecutionError(null,A.ExecutionErrorCodes.InvalidParameter,null);for(var l=0,f=e.toArray();l<f.length;l++){ee(i,f[l])}i.length>0&&(a=e.get(0).spatialReference,t=!0===e.get(0).hasZ,r=!0===e.get(0).hasM)}return 0===i.length?null:(new p({rings:[],spatialReference:{wkid:4326}}).isClockwise(i)||(i=i.slice(0).reverse()),new p({rings:[i],spatialReference:a,hasZ:t,hasM:r}))}return e},n.autoCastArrayOfPointsToPolyline=function(e,n){if(I(e)||Z(e)){var t=!1,r=!1,i=[],a=n;if(I(e)){for(var o=0,u=e;o<u.length;o++){ee(i,u[o])}i.length>0&&(a=e[0].spatialReference,t=!0===e[0].hasZ,r=!0===e[0].hasM)}else if(e instanceof s)(i=e._elements).length>0&&(t=e._hasZ,r=e._hasM,a=e.get(0).spatialReference);else if(Z(e)){for(var l=0,f=e.toArray();l<f.length;l++){ee(i,f[l])}i.length>0&&(a=e.get(0).spatialReference,t=!0===e.get(0).hasZ,r=!0===e.get(0).hasM)}return 0===i.length?null:new g({paths:[i],spatialReference:a,hasZ:t,hasM:r})}return e},n.autoCastArrayOfPointsToMultiPoint=function(e,n){if(I(e)||Z(e)){var t=!1,r=!1,i=[],a=n;if(I(e)){for(var o=0,u=e;o<u.length;o++){ee(i,u[o])}i.length>0&&(a=e[0].spatialReference,t=!0===e[0].hasZ,r=!0===e[0].hasM)}else if(e instanceof s)(i=e._elements).length>0&&(t=e._hasZ,r=e._hasM,a=e.get(0).spatialReference);else if(Z(e)){for(var l=0,f=e.toArray();l<f.length;l++){ee(i,f[l])}i.length>0&&(a=e.get(0).spatialReference,t=!0===e.get(0).hasZ,r=!0===e.get(0).hasM)}return 0===i.length?null:new m({points:i,spatialReference:a,hasZ:t,hasM:r})}return e},n.toStringArray=function(e,n){void 0===n&&(n=!1);var t=[];if(null===e)return t;if(!0===I(e)){for(var r=0;r<e.length;r++){""===(i=U(e[r]))&&!0!==n||t.push(i)}return t}if(e instanceof u){for(r=0;r<e.length();r++){var i;""===(i=U(e.get(r)))&&!0!==n||t.push(i)}return t}return C(e)?(""===(i=U(e))&&!0!==n||t.push(i),t):[]};var ne=0;function te(e,n){return void 0===n&&(n=null),null==e?null:F(e)||O(e)||M(e)?e:e instanceof d?!0===(null==n?void 0:n.keepGeometryType)?e:e.toJson():e instanceof u?e.toArray().map((function(e){return te(e,n)})):e instanceof Array?e.map((function(e){return te(e,n)})):_(e)?e:L(e)?e.toJSDate():null!==e&&"object"==typeof e&&void 0!==e.castAsJson?e.castAsJson(n):null}function re(e,n,i,a,o){return t(this,void 0,void 0,(function(){var t;return r(this,(function(r){switch(r.label){case 0:return[4,ie(e,n,i)];case 1:return t=r.sent(),o[a]=t,[2]}}))}))}function ie(e,n,i){return void 0===n&&(n=null),void 0===i&&(i=null),t(this,void 0,void 0,(function(){var t,a,o,l,s;return r(this,(function(r){switch(r.label){case 0:return e instanceof u&&(e=e.toArray()),null!=e?[3,1]:[2,null];case 1:return C(e)||e instanceof d||_(e)||L(e)?[2,te(e,i)]:[3,2];case 2:if(!(e instanceof Array))return[3,5];for(t=[],a=[],o=0,l=e;o<l.length;o++)null===(s=l[o])||C(s)||s instanceof d||_(s)||L(s)?a.push(te(s,i)):(a.push(null),t.push(re(s,n,i,a.length-1,a)));return t.length>0?[4,Promise.all(t)]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2,a];case 5:if(null!==e&&"object"==typeof e&&void 0!==e.castAsJsonAsync)return[2,e.castAsJsonAsync(n,i)];r.label=6;case 6:return[2,null]}}))}))}n.tick=function(e){return++ne%100==0?(ne=0,new Promise((function(n){setTimeout((function(){n(e)}),0)}))):e},n.binaryOperator=function(e,n,t){switch(t){case"&":return e&n;case"|":return e|n;case"^":return e^n;case"<<":return e<<n;case">>":return e>>n;case">>>":return e>>>n}},n.castAsJson=te,n.castAsJsonAsync=ie,n.featureFullDomain=function(e,n,t){var r=e.fullSchema();return null===r?null:r.fields?X(n,r,e,t):null},n.featureSubtypes=function(e){var n=e.fullSchema();return null===n?null:n.fields&&n.typeIdField?{subtypeField:n.typeIdField,subtypes:n.types?n.types.map((function(e){return{name:e.name,code:e.id}})):[]}:null},n.featureDomainValueLookup=function(e,n,t,r){var i=e.fullSchema();if(null===i)return null;if(!i.fields)return null;var a=X(n,i,e,r);if(void 0===t)try{t=e.field(n)}catch(e){return null}return W(a,t)},n.featureDomainCodeLookup=function(e,n,t,r){var i=e.fullSchema();if(null===i)return null;if(!i.fields)return null;if(void 0===t){try{t=e.field(n)}catch(e){return null}return t}return Q(X(n,i,e,r),t)},n.defaultTimeZone=function(e){var n,t;return(null===(n=null==e?void 0:e.timeReference)||void 0===n?void 0:n.timeZone)?null===(t=null==e?void 0:e.timeReference)||void 0===t?void 0:t.timeZone:"system"},n.featureSchema=function(e){var n=e.fullSchema();if(null===n)return null;if(!n.fields)return null;for(var t=[],r=0,i=n.fields;r<i.length;r++){var a=i[r];t.push(x.esriFieldToJson(a))}return{objectIdField:n.objectIdField,globalIdField:n.globalIdField,geometryType:void 0===x.layerGeometryEsriRestConstants[n.geometryType]?"":x.layerGeometryEsriRestConstants[n.geometryType],fields:t}}}));