/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","./has","./jsonMap","./maybe","../geometry/ellipsoidUtils","../geometry/support/Ellipsoid","../geometry/support/spatialReferenceUtils","../geometry/support/WKIDUnitConversion"],(function(e,s,t,r,i,n,a,u){"use strict";const c=39.37,l=n.earth.radius*Math.PI/200,o=/UNIT\[([^\]]+)\]\]$/i,m=u,f=/UNIT\[([^\]]+)\]/i,U=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),d=t.strict()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),h=e=>e*e,q=e=>e*e*e,p={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:h(.001)},"square-centimeters":{inBaseUnits:h(.01)},"square-decimeters":{inBaseUnits:h(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:h(1e3)},"square-inches":{inBaseUnits:h(.0254)},"square-feet":{inBaseUnits:h(.3048)},"square-yards":{inBaseUnits:h(.9144)},"square-miles":{inBaseUnits:h(1609.344)},"square-us-feet":{inBaseUnits:h(1200/3937)},acres:{inBaseUnits:.0015625*h(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*q(.001)},"cubic-centimeters":{inBaseUnits:1e3*q(.01)},"cubic-decimeters":{inBaseUnits:1e3*q(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*q(1e3)},"cubic-inches":{inBaseUnits:1e3*q(.0254)},"cubic-feet":{inBaseUnits:1e3*q(.3048)},"cubic-yards":{inBaseUnits:1e3*q(.9144)},"cubic-miles":{inBaseUnits:1e3*q(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},g=(()=>{const e={};for(const s in p)for(const t in p[s].units)e[t]=s;return e})();function S(e,s,t){return e*p[t].units[s].inBaseUnits}function B(e,s,t){return e/p[t].units[s].inBaseUnits}const b=["metric","imperial","square-inches","square-feet","square-yards","square-miles","square-us-feet","square-meters","square-kilometers","acres","ares","hectares"],k=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],M=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function y(e){return"imperial"===e||"metric"===e}function _(e){const s=g[e];if(!s)throw new Error("unknown type");return s}function w(e){return p[e].baseUnit}function D(e){return w(_(e))}function F(e,s=null){return s=s||_(e),p[s].baseUnit===e}function N(e,s,t){if(s===t)return e;const r=_(s);if(r!==_(t))throw new Error("incompatible units");const i=F(s,r)?e:S(e,s,r);return F(t,r)?i:B(i,t,r)}function I(e,s,t){switch(t){case"metric":return O(e,s);case"imperial":return T(e,s);default:return t}}function P(e,s,t){switch(t){case"metric":return L(e,s);case"imperial":return E(e,s);default:return t}}function R(e,s,t){switch(t){case"metric":return J(e,s);case"imperial":return v(e,s);default:return t}}function O(e,s){const t=N(e,s,"meters");return Math.abs(t)<3e3?"meters":"kilometers"}function L(e,s){const t=N(e,s,"meters");return Math.abs(t)<1e5?"meters":"kilometers"}function T(e,s){const t=N(e,s,"feet");return Math.abs(t)<1e3?"feet":"miles"}function E(e,s){const t=N(e,s,"feet");return Math.abs(t)<1e5?"feet":"miles"}function J(e,s){const t=N(e,s,"square-meters");return Math.abs(t)<3e6?"square-meters":"square-kilometers"}function v(e,s){const t=N(e,s,"square-feet");return Math.abs(t)<1e6?"square-feet":"square-miles"}function C(e,s,t){return N(e,s,"meters")/(t*Math.PI/180)}function A(e){return d.fromJSON(e.toLowerCase())||null}function x(e){return d.toJSON(e)||null}function K(e){if(r.isSome(e)&&!a.isEarth(e))return 1;const s=W(e);return s>1e5?1:s}function V(e){return W(e)>=i.getReferenceEllipsoid(e).metersPerDegree?"meters":H(e)}function W(e,s=n.earth.metersPerDegree){return r.unwrapOr(j(e,!0),s)}function j(e,s=!1){const t=r.isSome(e)?e.wkid:null,i=r.isSome(e)?e.wkt:null;let u=null;if(t){if(a.isWKIDFromMars(t))return n.mars.metersPerDegree;if(a.isWKIDFromMoon(t))return n.moon.metersPerDegree;u=m.values[m[t]],!u&&s&&U.has(t)&&(u=l)}else i&&(Z(i)?u=Y(o.exec(i),u):X(i)&&(u=Y(f.exec(i),u)));return u}function Y(e,s){return e&&e[1]?G(e[1]):s}function G(e){return parseFloat(e.split(",")[1])}function H(e){const s=r.isSome(e)?e.wkid:null,t=r.isSome(e)?e.wkt:null;let i=null;if(s)i=m.units[m[s]];else if(t){const e=Z(t)?o:X(t)?f:null;if(e){const s=e.exec(t);s&&s[1]&&(i=se(s[1]))}}return r.isSome(i)?A(i):null}function $(e){const s=H(e);return r.isNone(s)||!k.includes(s)?null:s}function z(e){const s=V(e);return r.isNone(s)||!k.includes(s)?null:s}function Q(e){const s=H(e);return r.isNone(s)?null:M.get(s)}function X(e){return/^GEOCCS/i.test(e)}function Z(e){return/^PROJCS/i.test(e)}const ee=1e-7;function se(e){const s=/[\\"\\']{1}([^\\"\\']+)/.exec(e);let t=s&&s[1];if(!t||!m.units.includes(t)){const s=G(e);t=null;const r=m.values;for(let e=0;e<r.length;++e)if(Math.abs(s-r[e])<ee){t=m.units[e];break}}return t}function te(e){const s=H(e);if(r.isNone(s))return null;switch(s){case"feet":case"us-feet":case"clarke-feet":case"clarke-yards":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"benoit-1895-b-chains":case"indian-yards":case"indian-1937-yards":case"gold-coast-feet":case"sears-1922-truncated-chains":return"imperial";case"50-kilometers":case"150-kilometers":case"meters":return"metric"}return null}const re={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},ie={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},ne={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},ae=t.strict()(re),ue=t.strict()(ie),ce=t.strict()(ne);e.angleUnitsJSONMap=ce,e.areaUnitFromSpatialReference=Q,e.areaUnitsJSONMap=ae,e.baseUnitForUnit=D,e.baseUnitForUnitType=w,e.convertUnit=N,e.getDefaultUnitSystem=te,e.getMetersPerUnit=j,e.getMetersPerUnitForSR=W,e.getMetersPerVerticalUnitForSR=K,e.getUnitString=H,e.getVerticalUnitStringForSR=V,e.inchesPerMeter=c,e.isBaseUnit=F,e.isMeasurementSystem=y,e.lengthToDegrees=C,e.lengthUnitFromSpatialReference=$,e.lengthUnitsJSONMap=ue,e.measurementAreaUnits=b,e.measurementLengthUnits=k,e.preferredAreaUnit=R,e.preferredImperialAreaUnit=v,e.preferredImperialLengthUnit=T,e.preferredImperialVerticalLengthUnit=E,e.preferredLengthUnit=I,e.preferredMetricAreaUnit=J,e.preferredMetricLengthUnit=O,e.preferredMetricVerticalLengthUnit=L,e.preferredVerticalLengthUnit=P,e.unitFromRESTJSON=A,e.unitToRESTJSON=x,e.unitType=_,e.verticalLengthUnitFromSpatialReference=z,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
