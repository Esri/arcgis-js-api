/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports"],(function(e){"use strict";function n(e,n,x){const i=n&&n.length,u=i?n[0]*x:e.length;let o=t(e,0,u,x,!0);const f=new Array;if(!o||o.next===o.prev)return f;let l,p,c,v,s;if(i&&(o=y(e,n,o,x)),e.length>80*x){l=c=e[0],p=v=e[1];for(let n=x;n<u;n+=x){const t=e[n],x=e[n+1];l=Math.min(l,t),p=Math.min(p,x),c=Math.max(c,t),v=Math.max(v,x)}s=Math.max(c-l,v-p),s=0!==s?1/s:0}return r(o,f,x,l,p,s),f}function t(e,n,t,x,r){let i;if(r===w(e,n,t,x)>0)for(let u=n;u<t;u+=x)i=o(u,e[u],e[u+1],i);else for(let u=t-x;u>=n;u-=x)i=o(u,e[u],e[u+1],i);return i&&b(i,i.next)&&(f(i),i=i.next),i}function x(e,n=e){if(!e)return e;let t,x=e;do{if(t=!1,x.steiner||!b(x,x.next)&&0!==d(x.prev,x,x.next))x=x.next;else{if(f(x),x=n=x.prev,x===x.next)break;t=!0}}while(t||x!==n);return n}function r(e,n,t,o,l,y,p=0){if(!e)return;!p&&y&&(e=v(e,o,l,y));let c=e;for(;e.prev!==e.next;){const v=e.prev,s=e.next;if(y?u(e,o,l,y):i(e))n.push(v.index/t),n.push(e.index/t),n.push(s.index/t),f(e),e=s.next,c=s.next;else if((e=s)===c){p?1===p?r(e=k(e,n,t),n,t,o,l,y,2):2===p&&A(e,n,t,o,l,y):r(x(e),n,t,o,l,y,1);break}}}function i(e){const n=e.prev,t=e,x=e.next;if(d(n,t,x)>=0)return!1;let r=e.next.next;const i=r;let u=0;for(;r!==e.prev&&(0===u||r!==i);){if(u++,M(n.x,n.y,t.x,t.y,x.x,x.y,r.x,r.y)&&d(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function u(e,n,t,x){const r=e.prev,i=e,u=e.next;if(d(r,i,u)>=0)return!1;const o=r.x<i.x?r.x<u.x?r.x:u.x:i.x<u.x?i.x:u.x,f=r.y<i.y?r.y<u.y?r.y:u.y:i.y<u.y?i.y:u.y,l=r.x>i.x?r.x>u.x?r.x:u.x:i.x>u.x?i.x:u.x,y=r.y>i.y?r.y>u.y?r.y:u.y:i.y>u.y?i.y:u.y,p=z(o,f,n,t,x),c=z(l,y,n,t,x);let v=e.prevZ,s=e.nextZ;for(;v&&v.z>=p&&s&&s.z<=c;){if(v!==e.prev&&v!==e.next&&M(r.x,r.y,i.x,i.y,u.x,u.y,v.x,v.y)&&d(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,s!==e.prev&&s!==e.next&&M(r.x,r.y,i.x,i.y,u.x,u.y,s.x,s.y)&&d(s.prev,s,s.next)>=0)return!1;s=s.nextZ}for(;v&&v.z>=p;){if(v!==e.prev&&v!==e.next&&M(r.x,r.y,i.x,i.y,u.x,u.y,v.x,v.y)&&d(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;s&&s.z<=c;){if(s!==e.prev&&s!==e.next&&M(r.x,r.y,i.x,i.y,u.x,u.y,s.x,s.y)&&d(s.prev,s,s.next)>=0)return!1;s=s.nextZ}return!0}function o(e,n,t,x){const r=new P(e,n,t);return x?(r.next=x.next,r.prev=x,x.next.prev=r,x.next=r):(r.prev=r,r.next=r),r}function f(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function l(e){let n=e,t=e;do{(n.x<t.x||n.x===t.x&&n.y<t.y)&&(t=n),n=n.next}while(n!==e);return t}function y(e,n,r,i){const u=new Array;for(let x=0,o=n.length;x<o;x++){const r=t(e,n[x]*i,x<o-1?n[x+1]*i:e.length,i,!1);r===r.next&&(r.steiner=!0),u.push(l(r))}u.sort(m);for(const t of u)p(t,r),r=x(r,r.next);return r}function p(e,n){if(n=c(e,n)){const t=O(n,e);x(t,t.next)}}function c(e,n){let t=n;const x=e.x,r=e.y;let i,u=-1/0;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const e=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(e<=x&&e>u){if(u=e,e===x){if(r===t.y)return t;if(r===t.next.y)return t.next}i=t.x<t.next.x?t:t.next}}t=t.next}while(t!==n);if(!i)return null;if(x===u)return i.prev;const o=i,f=i.x,l=i.y;let y,p=1/0;for(t=i.next;t!==o;)x>=t.x&&t.x>=f&&x!==t.x&&M(r<l?x:u,r,f,l,r<l?u:x,r,t.x,t.y)&&(y=Math.abs(r-t.y)/(x-t.x),(y<p||y===p&&t.x>i.x)&&g(t,e)&&(i=t,p=y)),t=t.next;return i}function v(e,n,t,x){for(let r;r!==e;r=r.next){if(r=r||e,null===r.z&&(r.z=z(r.x,r.y,n,t,x)),r.prev.next!==r||r.next.prev!==r)return r.prev.next=r,r.next.prev=r,v(e,n,t,x);r.prevZ=r.prev,r.nextZ=r.next}return e.prevZ.nextZ=null,e.prevZ=null,s(e)}function s(e){let n,t=1;for(;;){let x,r=e;e=null,n=null;let i=0;for(;r;){i++,x=r;let u=0;for(;u<t&&x;u++)x=x.nextZ;let o=t;for(;u>0||o>0&&x;){let t;0===u?(t=x,x=x.nextZ,o--):0!==o&&x?r.z<=x.z?(t=r,r=r.nextZ,u--):(t=x,x=x.nextZ,o--):(t=r,r=r.nextZ,u--),n?n.nextZ=t:e=t,t.prevZ=n,n=t}r=x}if(n.nextZ=null,t*=2,i<2)return e}}function h(e,n,t,x){const r=n&&n.length,i=r?n[0]*t:e.length;let u=Math.abs(w(e,0,i,t));if(r)for(let f=0,l=n.length;f<l;f++){const x=n[f]*t,r=f<l-1?n[f+1]*t:e.length;u-=Math.abs(w(e,x,r,t))}let o=0;for(let f=0;f<x.length;f+=3){const n=x[f]*t,r=x[f+1]*t,i=x[f+2]*t;o+=Math.abs((e[n]-e[i])*(e[r+1]-e[n+1])-(e[n]-e[r])*(e[i+1]-e[n+1]))}return 0===u&&0===o?0:Math.abs((o-u)/u)}function d(e,n,t){return(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)}function Z(e,n,t,x){return!!(b(e,n)&&b(t,x)||b(e,x)&&b(t,n))||d(e,n,t)>0!=d(e,n,x)>0&&d(t,x,e)>0!=d(t,x,n)>0}function a(e,n){let t=e;do{if(t.index!==e.index&&t.next.index!==e.index&&t.index!==n.index&&t.next.index!==n.index&&Z(t,t.next,e,n))return!0;t=t.next}while(t!==e);return!1}function w(e,n,t,x){let r=0;for(let i=n,u=t-x;i<t;i+=x)r+=(e[u]-e[i])*(e[i+1]+e[u+1]),u=i;return r}function M(e,n,t,x,r,i,u,o){return(r-u)*(n-o)-(e-u)*(i-o)>=0&&(e-u)*(x-o)-(t-u)*(n-o)>=0&&(t-u)*(i-o)-(r-u)*(x-o)>=0}function g(e,n){return d(e.prev,e,e.next)<0?d(e,n,e.next)>=0&&d(e,e.prev,n)>=0:d(e,n,e.prev)<0||d(e,e.next,n)<0}function z(e,n,t,x,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-t)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-x)*r)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function b(e,n){return e.x===n.x&&e.y===n.y}function m(e,n){return e.x-n.x}function k(e,n,t){let x=e;do{const r=x.prev,i=x.next.next;!b(r,i)&&Z(r,x,x.next,i)&&g(r,i)&&g(i,r)&&(n.push(r.index/t),n.push(x.index/t),n.push(i.index/t),f(x),f(x.next),x=e=i),x=x.next}while(x!==e);return x}function A(e,n,t,i,u,o){let f=e;do{let e=f.next.next;for(;e!==f.prev;){if(f.index!==e.index&&_(f,e)){let l=O(f,e);return f=x(f,f.next),l=x(l,l.next),r(f,n,t,i,u,o),void r(l,n,t,i,u,o)}e=e.next}f=f.next}while(f!==e)}function _(e,n){return e.next.index!==n.index&&e.prev.index!==n.index&&!a(e,n)&&g(e,n)&&g(n,e)&&j(e,n)}function j(e,n){let t=e,x=!1;const r=(e.x+n.x)/2,i=(e.y+n.y)/2;do{t.y>i!=t.next.y>i&&t.next.y!==t.y&&r<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(x=!x),t=t.next}while(t!==e);return x}function O(e,n){const t=new P(e.index,e.x,e.y),x=new P(n.index,n.x,n.y),r=e.next,i=n.prev;return e.next=n,n.prev=e,t.next=r,r.prev=t,x.next=t,t.prev=x,i.next=x,x.prev=i,x}let P=function(e,n,t){this.index=e,this.x=n,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1};e.deviation=h,e.earcut=n,Object.defineProperty(e,"__esModule",{value:!0})}));
