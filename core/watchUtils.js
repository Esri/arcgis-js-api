/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{deprecatedModule as n}from"./deprecate.js";import{isEventTarget as t,on as r}from"./events.js";import{equals as e}from"./lang.js";import o from"./Logger.js";import{createDeferred as c,onAbort as u,createAbortError as i}from"./promiseUtils.js";n(o.getLogger("esri.core.watchUtils"),"esri/core/watchUtils",{replacement:"esri/core/reactiveUtils",warnOnce:!0,version:"4.24"});const f=/\?(\.|$)/g;function s(n,t,r,e){const o=Array.isArray(t)?t:t.includes(",")?t.split(","):[t],c=l(n,t,r,e);for(const u of o){const t=u.trim().replace(f,"$1"),e=n.get(t);r.call(n,e,e,t,n)}return c}function l(n,t,r,e){return n.watch(t,r,e)}function a(n,t,r,e){return N(n,t,null,r,e)}function m(n,t,r,e){return z(n,t,V,r,e)}function p(n,t,r,e){return N(n,t,V,r,e)}function v(n,t,r,e){return z(n,t,k,r,e)}function g(n,t,r,e){return N(n,t,k,r,e)}function h(n,t,r,e){return z(n,t,q,r,e)}function d(n,t,r,e){return N(n,t,q,r,e)}function j(n,t,r,e){return z(n,t,B,r,e)}function y(n,t,r,e){return N(n,t,B,r,e)}function w(n,t,r,e){return z(n,t,C,r,e)}function b(n,t,r,e){return N(n,t,C,r,e)}function A(n,t,r,e){return z(n,t,D,r,e)}function U(n,t,r,e){return N(n,t,D,r,e)}function L(n,t,r,o,c){return z(n,t,(n=>e(r,n)),o,c)}function O(n,t,r,o,c){return N(n,t,(n=>e(r,n)),o,c)}function $(n,t,r,e){let o=!1;const c=n.watch(t,((t,e,c,u)=>{o||r.call(n,t,e,c,u)}),e);return{remove(){c.remove()},pause(){o=!0},resume(){o=!1}}}function x(n,e,o,c,u,i,f){const l={};function a(t){const r=l[t];r&&(i&&i(r.target,t,n,o),r.handle.remove(),delete l[t])}const m=s(n,e,((e,i,f)=>{a(f),t(e)&&(l[f]={handle:r(e,o,c),target:e},u&&u(e,f,n,o))}),f);return{remove(){m.remove();for(const n in l)a(n)}}}function z(n,t,r,e,o){const c=n.watch(t,((t,o,c,u)=>{r&&!r(t)||e?.call(n,t,o,c,u)}),o);if(Array.isArray(t))for(const u of t){const o=n.get(u);r&&r(o)&&e?.call(n,o,o,t,n)}else{const o=n.get(t);r&&r(o)&&e?.call(n,o,o,t,n)}return c}function N(n,t,r,e,o){const f="function"==typeof e?e:null,s="object"==typeof e?e:null;"boolean"==typeof e&&(o=e);let l,a=!1;function m(){l&&(l.remove(),l=null)}const p=c();u(s,(()=>{m(),p.reject(i())}));const v={then:p.promise.then.bind(p.promise),catch:p.promise.catch.bind(p.promise),remove:m};return Object.freeze(v),l=z(n,t,r,((t,r,e,o)=>{a=!0,m(),f&&f.call(n,t,r,e,o),p.resolve({value:t,oldValue:r,propertyName:e,target:o})}),o),a&&m(),v}function V(n){return!!n}function k(n){return!n}function q(n){return!0===n}function B(n){return!1===n}function C(n){return void 0!==n}function D(n){return void 0===n}export{s as init,x as on,a as once,$ as pausable,l as watch,m as when,w as whenDefined,b as whenDefinedOnce,L as whenEqual,O as whenEqualOnce,j as whenFalse,y as whenFalseOnce,v as whenNot,g as whenNotOnce,p as whenOnce,h as whenTrue,d as whenTrueOnce,A as whenUndefined,U as whenUndefinedOnce,N as whenValidOnce};
