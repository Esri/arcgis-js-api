/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","./events","./lang","./promiseUtils"],(function(n,e,t,r){"use strict";const o=/\?(\.|$)/g;function u(n,e,t,r){const u=Array.isArray(e)?e:e.indexOf(",")>-1?e.split(","):[e],i=c(n,e,t,r);for(const c of u){const e=c.trim().replace(o,"$1"),r=n.get(e);t.call(n,r,r,e,n)}return i}function c(n,e,t,r){return n.watch(e,t,r)}function i(n,e,t,r){return E(n,e,null,t,r)}function l(n,e,t,r){return q(n,e,T,t,r)}function f(n,e,t,r){return E(n,e,T,t,r)}function a(n,e,t,r){return q(n,e,D,t,r)}function s(n,e,t,r){return E(n,e,D,t,r)}function h(n,e,t,r){return q(n,e,N,t,r)}function d(n,e,t,r){return E(n,e,N,t,r)}function w(n,e,t,r){return q(n,e,U,t,r)}function m(n,e,t,r){return E(n,e,U,t,r)}function p(n,e,t,r){return q(n,e,x,t,r)}function v(n,e,t,r){return E(n,e,x,t,r)}function g(n,e,t,r){return q(n,e,F,t,r)}function O(n,e,t,r){return E(n,e,F,t,r)}function b(n,e,r,o,u){return q(n,e,(n=>t.equals(r,n)),o,u)}function y(n,e,r,o,u){return E(n,e,(n=>t.equals(r,n)),o,u)}function A(n,e,t,r){let o=!1;const u=n.watch(e,((e,r,u,c)=>{o||t.call(n,e,r,u,c)}),r);return{remove(){u.remove()},pause(){o=!0},resume(){o=!1}}}function j(n,t,r,o,c,i,l){const f={};function a(e){const t=f[e];t&&(i&&i(t.target,e,n,r),t.handle.remove(),delete f[e])}const s=u(n,t,((t,u,i)=>{a(i),e.isEventTarget(t)&&(f[i]={handle:e.on(t,r,o),target:t},c&&c(t,i,n,r))}),l);return{remove(){s.remove();for(const n in f)a(n)}}}function q(n,e,t,r,o){const u=n.watch(e,((e,o,u,c)=>{t&&!t(e)||null==r||r.call(n,e,o,u,c)}),o);if(Array.isArray(e))for(const c of e){const o=n.get(c);t&&t(o)&&(null==r||r.call(n,o,o,e,n))}else{const o=n.get(e);t&&t(o)&&(null==r||r.call(n,o,o,e,n))}return u}function E(n,e,t,o,u){const c="function"==typeof o?o:null,i="object"==typeof o?o:null;"boolean"==typeof o&&(u=o);let l,f=!1;function a(){l&&(l.remove(),l=null)}const s=r.createDeferred();r.onAbort(i,(()=>{a(),s.reject(r.createAbortError())}));const h={then:s.promise.then.bind(s.promise),catch:s.promise.catch.bind(s.promise),remove:a};return Object.freeze(h),l=q(n,e,t,((e,t,r,o)=>{f=!0,a(),c&&c.call(n,e,t,r,o),s.resolve({value:e,oldValue:t,propertyName:r,target:o})}),u),f&&a(),h}function T(n){return!!n}function D(n){return!n}function N(n){return!0===n}function U(n){return!1===n}function x(n){return void 0!==n}function F(n){return void 0===n}n.init=u,n.on=j,n.once=i,n.pausable=A,n.watch=c,n.when=l,n.whenDefined=p,n.whenDefinedOnce=v,n.whenEqual=b,n.whenEqualOnce=y,n.whenFalse=w,n.whenFalseOnce=m,n.whenNot=a,n.whenNotOnce=s,n.whenOnce=f,n.whenTrue=h,n.whenTrueOnce=d,n.whenUndefined=g,n.whenUndefinedOnce=O,n.whenValidOnce=E,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
