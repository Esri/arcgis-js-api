/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","./lang","./events","./promiseUtils"],(function(n,e,t,r){"use strict";function o(n,e,t,r,o){const u=n.watch(e,((e,o,u,c)=>{t&&!t(e)||null==r||r.call(n,e,o,u,c)}),o);if(Array.isArray(e))for(const o of e){const u=n.get(o);t&&t(u)&&(null==r||r.call(n,u,u,e,n))}else{const o=n.get(e);t&&t(o)&&(null==r||r.call(n,o,o,e,n))}return u}function u(n,e,t,u,c){const i="function"==typeof u?u:null,l="object"==typeof u?u:null;"boolean"==typeof u&&(c=u);let f,a=!1;function s(){f&&(f.remove(),f=null)}const h=r.createDeferred();r.onAbort(l,(()=>{s(),h.reject(r.createAbortError())}));const d={then:h.promise.then.bind(h.promise),catch:h.promise.catch.bind(h.promise),remove:s};return Object.freeze(d),f=o(n,e,t,((e,t,r,o)=>{a=!0,s(),i&&i.call(n,e,t,r,o),h.resolve({value:e,oldValue:t,propertyName:r,target:o})}),c),a&&s(),d}function c(n){return!!n}function i(n){return!n}function l(n){return!0===n}function f(n){return!1===n}function a(n){return void 0!==n}function s(n){return void 0===n}const h=/\?(\.|$)/g;function d(n,e,t,r){const o=Array.isArray(e)?e:e.indexOf(",")>-1?e.split(","):[e],u=w(n,e,t,r);for(const e of o){const r=e.trim().replace(h,"$1"),o=n.get(r);t.call(n,o,o,r,n)}return u}function w(n,e,t,r){return n.watch(e,t,r)}n.init=d,n.on=function(n,e,r,o,u,c,i){const l={};function f(e){const t=l[e];t&&(c&&c(t.target,e,n,r),t.handle.remove(),delete l[e])}const a=d(n,e,((e,c,i)=>{f(i),t.isEventTarget(e)&&(l[i]={handle:t.on(e,r,o),target:e},u&&u(e,i,n,r))}),i);return{remove(){a.remove();for(const n in l)f(n)}}},n.once=function(n,e,t,r){return u(n,e,null,t,r)},n.pausable=function(n,e,t,r){let o=!1;const u=n.watch(e,((e,r,u,c)=>{o||t.call(n,e,r,u,c)}),r);return{remove(){u.remove()},pause(){o=!0},resume(){o=!1}}},n.watch=w,n.when=function(n,e,t,r){return o(n,e,c,t,r)},n.whenDefined=function(n,e,t,r){return o(n,e,a,t,r)},n.whenDefinedOnce=function(n,e,t,r){return u(n,e,a,t,r)},n.whenEqual=function(n,t,r,u,c){return o(n,t,(n=>e.equals(r,n)),u,c)},n.whenEqualOnce=function(n,t,r,o,c){return u(n,t,(n=>e.equals(r,n)),o,c)},n.whenFalse=function(n,e,t,r){return o(n,e,f,t,r)},n.whenFalseOnce=function(n,e,t,r){return u(n,e,f,t,r)},n.whenNot=function(n,e,t,r){return o(n,e,i,t,r)},n.whenNotOnce=function(n,e,t,r){return u(n,e,i,t,r)},n.whenOnce=function(n,e,t,r){return u(n,e,c,t,r)},n.whenTrue=function(n,e,t,r){return o(n,e,l,t,r)},n.whenTrueOnce=function(n,e,t,r){return u(n,e,l,t,r)},n.whenUndefined=function(n,e,t,r){return o(n,e,s,t,r)},n.whenUndefinedOnce=function(n,e,t,r){return u(n,e,s,t,r)},n.whenValidOnce=u,Object.defineProperty(n,"__esModule",{value:!0})}));
