/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","./Accessor","./Logger","./accessorSupport/tracking","./accessorSupport/decorators/property","./accessorSupport/decorators/subclass","./accessorSupport/tracking/SimpleTrackingTarget"],(function(t,e,n,s,r,a,c,o,i){"use strict";const p=t=>{let s=function(t){function n(){var e;return(e=t.apply(this,arguments)||this)._numUpdating=0,e.asyncUpdateState=new Map,e}e._inheritsLoose(n,t);var s=n.prototype;return s.autoUpdateAsync=function(t,e){return u((e=>this.updateAsync(t,e)),e)},s.updateAsync=function(){var t=e._asyncToGenerator((function*(t,e){if(!this.startAsyncUpdate(t)){try{const n=yield e();this._set(t,n)}catch(n){r.getLogger(this.declaredClass).warn(`Async update of "${t}" failed. Async update functions should not throw exceptions.`)}this.endAsyncUpdate(t)&&this.updateAsync(t,e)}}));function n(e,n){return t.apply(this,arguments)}return n}(),s.startAsyncUpdate=function(t){var e;const n=null!=(e=this.asyncUpdateState.get(t))?e:0;return 1&n?(this.asyncUpdateState.set(t,2|n),!0):(++this._numUpdating,this.asyncUpdateState.set(t,1|n),!1)},s.endAsyncUpdate=function(t){var e;--this._numUpdating;const n=-2&(null!=(e=this.asyncUpdateState.get(t))?e:0);return 2&n?(this.asyncUpdateState.set(t,-3&n),!0):(this.asyncUpdateState.set(t,n),!1)},e._createClass(n,[{key:"updating",get:function(){return this._numUpdating>0}}]),n}(t);return n.__decorate([c.property({readOnly:!0})],s.prototype,"updating",null),n.__decorate([c.property()],s.prototype,"_numUpdating",void 0),s=n.__decorate([o.subclass("esri.core.AsyncUpdate")],s),s};function u(t,e){const n=()=>{c&&!o&&t(s)},s=()=>{if(!c||o)return e();c.clear(),o=!0;const t=a.runTracked(c,e);return o=!1,t},r=()=>{c&&(c.destroy(),c=null)};let c=new i.SimpleTrackingTarget(n),o=!1;return t(s),{remove:r}}t.AsyncUpdate=function(t){function n(){return t.apply(this,arguments)||this}return e._inheritsLoose(n,t),n}(p(s)),t.AsyncUpdate=n.__decorate([o.subclass("esri.core.AsyncUpdate")],t.AsyncUpdate),t.AsyncUpdateMixin=p,Object.defineProperty(t,"__esModule",{value:!0})}));
