// COPYRIGHT Â© 2020 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.17/esri/copyright.txt for details.

define(["require","exports","@dojo/framework/shim/array","./RandomLCG"],(function(r,n,e,t){"use strict";function i(r){return r}function f(r,n){if(void 0===n&&(n=i),r&&0!==r.length){for(var e=r[0],t=n(e),f=1;f<r.length;++f){var u=r[f],o=Number(n(u));o>t&&(t=o,e=u)}return e}}Object.defineProperty(n,"__esModule",{value:!0}),n.remove=n.fromMapValues=n.keysOfSet=n.keysOfMap=n.shuffle=n.pickRandom=n.removeUnorderedMany=n.removeUnordered=n.indexOf=n.PositionHint=n.flatten=n.binaryFindClosest=n.binaryIndexOf=n.range=n.constant=n.splitIntoChunks=n.intersect=n.difference=n.equals=n.unique=n.min=n.max=n.last=n.first=n.includes=n.from=n.findIndex=n.find=void 0,Object.defineProperty(n,"find",{enumerable:!0,get:function(){return e.find}}),Object.defineProperty(n,"findIndex",{enumerable:!0,get:function(){return e.findIndex}}),Object.defineProperty(n,"from",{enumerable:!0,get:function(){return e.from}}),Object.defineProperty(n,"includes",{enumerable:!0,get:function(){return e.includes}}),n.first=function(r){if(r)return r.length>0?r[0]:void 0},n.last=function(r){if(r){var n=r.length;return n>0?r[n-1]:void 0}},n.max=f,n.min=function(r,n){return void 0===n&&(n=i),f(r,(function(r){return-n(r)}))},n.unique=function(r,n){return n?r.filter((function(r,t,i){return e.findIndex(i,n.bind(null,r))===t})):r.filter((function(r,n,e){return e.indexOf(r)===n}))},n.equals=function(r,n,e){if(!r&&!n)return!0;if(!r||!n||r.length!==n.length)return!1;if(e){for(var t=0;t<r.length;t++)if(!e(r[t],n[t]))return!1}else for(t=0;t<r.length;t++)if(r[t]!==n[t])return!1;return!0},n.difference=function(r,n,e){var t,i;return e?(t=n.filter(h.bind(null,r,e)),i=r.filter(h.bind(null,n,e))):(t=n.filter(v.bind(null,r)),i=r.filter(v.bind(null,n))),{added:t,removed:i}},n.intersect=function(r,n,t){return r&&n?t?r.filter((function(r){return e.findIndex(n,(function(n){return t(r,n)}))>-1})):r.filter((function(r){return n.indexOf(r)>-1})):[]},n.splitIntoChunks=function(r,n){var e=r.length;if(0===e)return[];for(var t=[],i=0;i<e;i+=n)t.push(r.slice(i,i+n));return t};var u=!!Array.prototype.fill;n.constant=function(r,n){if(u)return new Array(r).fill(n);for(var e=new Array(r),t=0;t<r;t++)e[t]=n;return e},n.range=function(r,n){void 0===n&&(n=r,r=0);for(var e=new Array(n-r),t=r;t<n;t++)e[t-r]=t;return e},n.binaryIndexOf=function(r,n,e){for(var t=r.length,i=0,f=t-1;i<f;){var u=i+Math.floor((f-i)/2);n>r[u]?i=u+1:f=u}var o=r[i];return e?n>=r[t-1]?-1:o===n?i:i-1:o===n?i:-1},n.binaryFindClosest=function(r,n,e){if(r&&0!==r.length){var t=r.length-1,i=r[0];if(n<=e(i))return i;var f=r[t];if(n>=e(f))return f;for(var u=0,o=0,a=t;u<a;){var l=r[o=u+Math.floor((a-u)/2)],c=e(l);if(c===n)return l;if(n<c){if(o>0){var d=r[o-1],s=e(d);if(n>s)return n-s>=c-n?l:d}a=o}else{if(o<t){var v=r[o+1],h=e(v);if(n<h)return n-c>=h-n?v:l}u=o+1}}return r[o]}},n.flatten=function(r){return r.reduce((function(r,n){return r.concat(n||[])}),[])};var o=function(){this.last=0};n.PositionHint=o;var a=new o;function l(r,n,e,t){t=t||a;for(var i=Math.max(0,t.last-10),f=i;f<e;++f)if(r[f]===n)return t.last=f,f;var u=Math.min(i,e);for(f=0;f<u;++f)if(r[f]===n)return t.last=f,f;return-1}n.indexOf=l,n.removeUnordered=function(r,n,e,t){var i=null==e?r.length:e,f=l(r,n,i,t);if(-1!==f)return r[f]=r[i-1],null==e&&r.pop(),n};var c=new Set;function d(r){return r?(s.seed=r,function(){return s.getFloat()}):Math.random}n.removeUnorderedMany=function(r,n,e,t,i,f){if(void 0===e&&(e=r.length),void 0===t&&(t=n.length),0===t||0===e)return e;c.clear();for(var u=0;u<t;++u)c.add(n[u]);i=i||a;var o=Math.max(0,i.last-10);for(u=o;u<e;++u)if(c.has(r[u])&&(f&&f.push(r[u]),c.delete(r[u]),r[u]=r[e-1],--e,--u,0===c.size||0===e))return c.clear(),e;for(u=0;u<o;++u)if(c.has(r[u])&&(f&&f.push(r[u]),c.delete(r[u]),r[u]=r[e-1],--e,--u,0===c.size||0===e))return c.clear(),e;return c.clear(),e},n.pickRandom=function(r,n,e){var t=r.length;if(n>=t)return r.slice(0);for(var i=d(e),f=new Set,u=[];u.length<n;){var o=Math.floor(i()*t);f.has(o)||(f.add(o),u.push(r[o]))}return u},n.shuffle=function(r,n){for(var e=d(n),t=r.length-1;t>0;t--){var i=Math.floor(e()*(t+1)),f=r[t];r[t]=r[i],r[i]=f}return r};var s=new t;function v(r,n){return-1===r.indexOf(n)}function h(r,n,e){return!r.some(n.bind(null,e))}function m(r){return r}n.keysOfMap=function(r){var n=new Array(r.size),e=0;return r.forEach((function(r,t){return n[e++]=t})),n},n.keysOfSet=function(r,n){void 0===n&&(n=m);var e=new Array(r.size),t=0;return r.forEach((function(r){return e[t++]=n(r)})),e},n.fromMapValues=function(r){if(Array.from)return Array.from(r.values());var n=new Array(r.size),e=0;return r.forEach((function(r){return n[e++]=r})),n},n.remove=function(r,n){var e=r.indexOf(n);return-1!==e?(r.splice(e,1),n):null}}));