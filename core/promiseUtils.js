/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../chunks/_rollupPluginBabelHelpers","./clock","./deprecate","./Error","./events","./Logger","./maybe"],(function(e,r,t,n,o,i,u,s){"use strict";function c(e,r){return l.apply(this,arguments)}function l(){return(l=r._asyncToGenerator((function*(e,r){const t=e.slice(),n=yield Promise.all(e.map(((e,t)=>r(e,t))));return t.filter(((e,r)=>n[r]))}))).apply(this,arguments)}function a(e){return n.deprecatedFunction(u.getLogger("esri.core.promiseUtils"),"create",{moduleName:"esri.core.promiseUtils",replacement:"new Promise()",version:"4.24"}),new Promise(((r,t)=>{try{e(r,t)}catch(n){Promise.resolve().then((()=>t(n)))}}))}function f(e="Aborted"){return new o("AbortError",e)}function m(e,r="Aborted"){if(p(e))throw f(r)}function h(e){return s.isSome(e)?"aborted"in e?e:e.signal:e}function p(e){const r=h(e);return s.isSome(r)&&r.aborted}function y(e){if(T(e))throw e}function b(e){if(!T(e))throw e}function w(e,r){const t=h(e);if(!s.isNone(t)){if(!t.aborted)return i.once(t,"abort",(()=>r()));r()}}function d(e,r){const t=h(e);if(!s.isNone(t))return m(t),i.once(t,"abort",(()=>r(f())))}function v(e,r){const t=h(r);return s.isNone(t)?e:new Promise(((t,n)=>{let o=w(r,(()=>n(f())));const i=()=>o=s.removeMaybe(o);e.then(i,i),e.then(t,n)}))}function A(e,r,t){return Promise.race([e,L(r).then((()=>{throw new o("timeout",`Did not resolve within ${r} milliseconds (${t??"timeout"})`)}))])}function T(e){return"AbortError"===e?.name}function g(e){return P.apply(this,arguments)}function P(){return(P=r._asyncToGenerator((function*(e){try{return yield e}catch(r){if(!T(r))throw r;return}}))).apply(this,arguments)}function E(e){return N.apply(this,arguments)}function N(){return(N=r._asyncToGenerator((function*(e,r=u.getLogger("esri")){try{return yield e}catch(t){T(t)||r.error(t)}}))).apply(this,arguments)}function _(){let e=null;const r=new Promise(((r,t)=>{e={promise:void 0,resolve:r,reject:t}}));return e.promise=r,e}function j(e){return k.apply(this,arguments)}function k(){return(k=r._asyncToGenerator((function*(e){if(!e)return;if("function"!=typeof e.forEach){const r=Object.keys(e),t=r.map((r=>e[r])),n=yield j(t),o={};return r.map(((e,r)=>o[e]=n[r])),o}const r=e;return new Promise((e=>{const t=[];let n=r.length;0===n&&e(t),r.forEach((r=>{const o={promise:r||Promise.resolve(r)};t.push(o),o.promise.then((e=>{o.value=e})).catch((e=>{o.error=e})).then((()=>{--n,0===n&&e(t)}))}))}))}))).apply(this,arguments)}function G(e){return O.apply(this,arguments)}function O(){return(O=r._asyncToGenerator((function*(e){return(yield j(e)).filter((e=>!!e.value)).map((e=>e.value))}))).apply(this,arguments)}function L(e,r,t){const n=new AbortController;return w(t,(()=>n.abort())),new Promise(((t,o)=>{let i=setTimeout((()=>{i=0,t(r)}),e);w(n,(()=>{i&&(clearTimeout(i),o(f()))}))}))}function S(e,r,t,n){const i=t&&"abort"in t?t:null;null!=n||i||(n=t);let u=setTimeout((()=>{u=0,i&&i.abort()}),r);const s=()=>n||new o("promiseUtils:timeout","The wrapped promise did not resolve within "+r+" ms");return e.then((e=>{if(0===u)throw s();return clearTimeout(u),e}),(e=>{throw clearTimeout(u),0===u?s():e}))}function I(e){return e&&"function"==typeof e.then}function M(e){return I(e)?e:Promise.resolve(e)}function U(e,r=-1){let t,n,o,i,u=null;const c=(...l)=>{if(t){n=l,i&&i.reject(f()),i=_();const e=s.assumeNonNull(i.promise);if(u){const e=u;u=null,e.abort()}return e}if(o=i||_(),i=null,r>0){const n=new AbortController;t=M(e(...l,n.signal));const o=t;L(r).then((()=>{t===o&&(i?n.abort():u=n)}))}else t=1,t=M(e(...l));const a=()=>{const e=n;n=o=t=u=null,null!=e&&c(...e)},m=t,h=o;return m.then(a,a),m.then(h.resolve,h.reject),s.assumeNonNull(h.promise)};return c}function C(){let e,r;const n=new Promise(((t,n)=>{e=t,r=n})),o=r=>{e(r)};return o.resolve=r=>e(r),o.reject=e=>r(e),o.timeout=(e,r)=>t.clock.setTimeout((()=>o.reject(r)),e),o.promise=n,o}function D(e,r){return e.then(r,r)}function $(e){return x.apply(this,arguments)}function x(){return(x=r._asyncToGenerator((function*(e){yield Promise.resolve(),m(e)}))).apply(this,arguments)}e.after=L,e.always=D,e.create=a,e.createAbortError=f,e.createDeferred=_,e.createResolver=C,e.debounce=U,e.eachAlways=j,e.eachAlwaysValues=G,e.filter=c,e.ignoreAbortErrors=g,e.isAbortError=T,e.isAborted=p,e.isPromiseLike=I,e.logOnError=E,e.onAbort=w,e.onAbortOrThrow=d,e.throwIfAbortError=y,e.throwIfAborted=m,e.throwIfNotAbortError=b,e.timeout=S,e.waitTick=$,e.when=M,e.whenOrAbort=v,e.whenOrTimeout=A,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
