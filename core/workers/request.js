/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../Error","../global","../maybe"],(function(e,t,r,s,a){"use strict";let n;function o(e,o={}){let l=o.responseType;l?"array-buffer"!==l&&"blob"!==l&&"json"!==l&&"native"!==l&&"native-request-init"!==l&&"text"!==l&&(l="text"):l="json";const i=a.unwrap(o.signal);return delete o.signal,s.invokeStaticMessage("request",{url:e,options:o},{signal:i}).then(function(){var s=t._asyncToGenerator((function*(t){let s,a,u,c,f;if(t.data)if(t.data instanceof ArrayBuffer){if(!("json"!==l&&"text"!==l&&"blob"!==l||(s=new Blob([t.data]),"json"!==l&&"text"!==l||(n||(n=new FileReaderSync),c=n.readAsText(s),"json"!==l)))){try{a=JSON.parse(c||null)}catch(b){const t={...b,url:e,requestOptions:o};throw new r("request:server",b.message,t)}if(a.error){const t={...a.error,url:e,requestOptions:o};throw new r("request:server",a.error.message,t)}}}else"native"===l&&(t.data.signal=i,u=yield fetch(t.data.url,t.data));switch(l){case"blob":f=s;break;case"json":f=a;break;case"native":f=u;break;case"text":f=c;break;default:f=t.data}return{data:f,requestOptions:o,ssl:t.ssl,url:e}}));return function(e){return s.apply(this,arguments)}}())}e.execute=o,Object.defineProperty(e,"__esModule",{value:!0})}));
