/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","./Error","./Promise","./promiseUtils","./Warning","./accessorSupport/decorators/property","./accessorSupport/decorators/subclass"],(function(o,e,r,t,n,l,a,s){"use strict";const d="not-loaded",i="loading",c="failed",u="loaded",p=t=>{let p=function(e){function t(...t){var l;return(l=e.call(this,...t)||this)._loadController=null,l.loadError=null,l.loadStatus="not-loaded",l._set("loadWarnings",[]),l.addResolvingPromise(new Promise((e=>{const t=l.load.bind(o._assertThisInitialized(l));l.load=a=>{const s=new Promise(((e,t)=>{const s=n.onAbortOrThrow(a,t);l.destroyed&&t(new r("load:instance-destroyed",`Instance of '${l.declaredClass||l.constructor.name}' is already destroyed`,{instance:o._assertThisInitialized(l)})),l._promiseProps.when(e,t).finally((()=>{s&&s.remove()}))}));if(l.loadStatus===d){l._set("loadStatus",i);const o=l._loadController=new AbortController;t({signal:o.signal}),n.onAbort(o.signal,(()=>{l._promiseProps.abort()}))}return e(),s}}))),l.when((()=>{l._set("loadStatus",u),l._loadController=null}),(o=>{l._set("loadStatus",c),l._set("loadError",o),l._loadController=null})),l}o._inheritsLoose(t,e);var l=t.prototype;return l.load=function(){return null},l.cancelLoad=function(){return this.isFulfilled()||(this._set("loadError",new r("load:cancelled","Cancelled")),this._loadController?.abort()),this},o._createClass(t,[{key:"loaded",get:function(){return this.loadStatus===u}},{key:"loadWarnings",get:function(){return this._get("loadWarnings")}}]),t}(t);return e.__decorate([a.property({readOnly:!0})],p.prototype,"loaded",null),e.__decorate([a.property({readOnly:!0})],p.prototype,"loadError",void 0),e.__decorate([a.property({clonable:!1})],p.prototype,"loadStatus",void 0),e.__decorate([a.property({type:[l],readOnly:!0})],p.prototype,"loadWarnings",null),p=e.__decorate([s.subclass("esri.core.Loadable")],p),p};let _=function(e){function r(){return e.apply(this,arguments)||this}return o._inheritsLoose(r,e),r}(p(t.EsriPromise));_=e.__decorate([s.subclass("esri.core.Loadable")],_),function(o){function e(o){return!(!o||!o.load)}o.LoadableMixin=p,o.isLoadable=e}(_||(_={}));return _}));
