/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","./events","./handleUtils","./maybe","./promiseUtils","./accessorSupport/watch","./accessorSupport/trackingUtils"],(function(n,e,t,r,o,i,c){"use strict";function u(n,e,t={}){return l(n,e,t,v)}function s(n,e,t={}){return l(n,e,t,b)}function l(n,e,t={},o){let c=null;const u=t.once?(n,t)=>{o(n)&&(r.removeMaybe(c),e(n,t))}:(n,t)=>{o(n)&&e(n,t)};if(c=i.watchTracked(n,u,t.sync,t.equals),t.initial){const e=n();u(e,e)}return c}function a(n,o,i,c={}){let s=null,l=null,a=null;function f(){s&&l&&(l.remove(),c.onListenerRemove?.(s),s=null,l=null)}function m(n){c.once&&c.once&&r.removeMaybe(a),i(n)}const y=u(n,((n,t)=>{f(),e.isEventTarget(n)&&(s=n,l=e.on(n,o,m),c.onListenerAdd?.(n))}),{sync:c.sync,initial:!0});return a=t.makeHandle((()=>{y.remove(),f()})),a}function f(n,e){return y(n,null,e)}function m(n,e){return y(n,b,e)}function y(n,e,i){if(o.isAborted(i))return Promise.reject(o.createAbortError());const c=n();if(e?.(c))return Promise.resolve(c);let u=null;function s(){u=r.removeMaybe(u)}return new Promise(((r,c)=>{u=t.handlesGroup([o.onAbort(i,(()=>{s(),c(o.createAbortError())})),l(n,(n=>{s(),r(n)}),{sync:!1,once:!0},e??v)])}))}function v(n){return!0}function b(n){return!!n}function d(n,e,t={}){let r=!1;const o=u(n,((n,t)=>{r||e(n,t)}),t);return{remove(){o.remove()},pause(){r=!0},resume(){r=!1}}}const p={sync:!0},h={initial:!0},w={sync:!0,initial:!0};n.autorun=c.autorun,n.initial=h,n.on=a,n.once=f,n.pausable=d,n.sync=p,n.syncAndInitial=w,n.watch=u,n.when=s,n.whenOnce=m,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})}));
