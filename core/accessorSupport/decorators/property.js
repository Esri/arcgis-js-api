/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../Logger","../ensureType","../get","../metadata","../set"],(function(e,r,t,n,o,s){"use strict";const i=r.getLogger("esri.core.accessorSupport.decorators.property");function a(e,r){return t=>{let n=+e(t);return null!=r.step&&(n=Math.round(n/r.step)*r.step),null!=r.min&&(n=Math.max(r.min,n)),null!=r.max&&(n=Math.min(r.max,n)),n}}e.ensureRange=a,e.property=function(e={}){return(r,u,p)=>{if(r===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${r.name}.${u}. Accessor does not support static properties.`);const c=o.getOwnPropertyMetadata(r,u);p&&(p.get||p.set?(c.get=p.get||c.get,c.set=p.set||c.set):"value"in p&&("value"in e&&i.warn(`@property() will redefine the value of "${u}" on "${r.constructor.name}" already defined in the metadata`,e),c.value=e.value=p.value)),null!=e.readOnly&&(c.readOnly=e.readOnly);const{aliasOf:f}=e;if(f){const e="string"==typeof f?f:f.source,r="string"==typeof f?null:!0===f.overridable;let t;c.dependsOn=[e],c.get=function(){let r=n.get(this,e);if("function"==typeof r){t||(t=e.split(".").slice(0,-1).join("."));const o=n.get(this,t);o&&(r=r.bind(o))}return r},c.readOnly||(c.set=r?function(e){void 0!==e?this._override(u,e):this._clearOverride(u)}:function(r){s.set(this,e,r)})}const y=e.type,l=e.types;c.cast||(y?c.cast=function(e){let r=0,n=e;if(t.isLongFormType(e))return t.ensureLongFormType(e);for(;Array.isArray(n)&&1===n.length&&"string"!=typeof n[0]&&"number"!=typeof n[0];)n=n[0],r++;const o=n;if(t.isOneOf(o))return 0===r?t.ensureOneOf(o):t.ensureNArrayTyped(t.ensureOneOf(o),r);if(1===r)return t.ensureArray(o);if(r>1)return t.ensureNArray(o,r);const s=e;if(s.from)return s.from;return t.ensureType(s)}(y):l&&(Array.isArray(l)?c.cast=t.ensureArrayTyped(t.ensureOneOfType(l[0])):c.cast=t.ensureOneOfType(l))),e.range&&(c.cast=a(c.cast,e.range)),o.mergeProperty(c,e)}},e.propertyJSONMeta=function(e,r,t){const n=o.getOwnPropertyMetadata(e,t);n.json||(n.json={});let s=n.json;return void 0!==r&&(s.origins||(s.origins={}),s.origins[r]||(s.origins[r]={}),s=s.origins[r]),s},Object.defineProperty(e,"__esModule",{value:!0})}));
