/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../has","../Logger","./utils"],(function(e,t,n,r){"use strict";let o,c=[];const i=n.getLogger("esri.core.Accessor");function s(){c=[]}function l(e){void 0!==o&&o.onObservableAccessed(e)}let a=!1,u=!1;function f(e,t,n){if(a)return d(e,t,n);p(e);const r=t.call(n);return h(),r}function g(e,t){return f(void 0,e,t)}function d(e,t,n){const r=a;a=!0,p(e);let o=null;try{o=t.call(n)}catch(c){u&&i.error(c)}return h(),a=r,o}function p(e){o=e,c.push(e)}function h(){const e=c.pop();o=c.length>0?c[c.length-1]:void 0,void 0!==e&&e.onTrackingEnd()}function y(e,t){if(32&t.flags)return;const n=u;u=!1,64&t.flags?d(t,t.metadata.get,e):v(e,t),u=n}const A=[];function v(e,t){128&t.flags||(t.flags|=128,d(t,(()=>{const n=t.metadata.dependsOn||A;for(const t of n)if("string"==typeof t&&-1===t.indexOf("."))k(e,t,!1);else{const n=r.pathToArray(t);for(let t=0,r=e;t<n.length&&null!=r&&"object"==typeof r;++t)r=k(r,n[t],t!==n.length-1)}})),t.flags&=-129)}function k(e,t,n){const o="?"===t[t.length-1]?t.slice(0,-1):t;if(null!=e.getItemAt||Array.isArray(e)){const t=parseInt(o,10);if(!isNaN(t))return Array.isArray(e)?e[t]:e.getItemAt(t)}const c=r.getProperties(e),i=null==c?void 0:c.properties.get(o);return i&&(l(i),y(e,i)),n?e[o]:void 0}e.initializeDependencyTracking=y,e.resetGlobalTarget=s,e.runTracked=f,e.runTrackedNoThrow=d,e.runUntracked=g,e.trackAccess=l,e.trackExplicitDependencies=v,Object.defineProperty(e,"__esModule",{value:!0})}));
