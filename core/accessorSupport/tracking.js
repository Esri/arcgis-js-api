/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../has","../Logger","./utils"],(function(t,e,n,r){"use strict";let o,c=[];const s=n.getLogger("esri.core.Accessor");function i(t){void 0!==o&&o.onPropertyAccessed(t)}let l=!1,a=!1;function f(t,e,n){const r=l;l=!0,u(t);let o=null;try{o=e.call(n)}catch(t){a&&s.error(t)}return g(),l=r,o}function u(t){o=t,c.push(t)}function g(){const t=c.pop();o=c.length>0?c[c.length-1]:void 0,void 0!==t&&t.onTrackingEnd()}function d(t,e){if(32&e.flags)return;const n=a;a=!1,64&e.flags?f(e,e.metadata.get,t):y(t,e),a=n}const p=[];function y(t,e){128&e.flags||(e.flags|=128,f(e,(()=>{const n=e.metadata.dependsOn||p;for(const e of n)if("string"==typeof e&&-1===e.indexOf("."))h(t,e,!1);else{const n=r.pathToArray(e);for(let e=0,r=t;e<n.length&&null!=r&&"object"==typeof r;++e)r=h(r,n[e],e!==n.length-1)}})),e.flags&=-129)}function h(t,e,n){const o="?"===e[e.length-1]?e.slice(0,-1):e;if(null!=t.getItemAt||Array.isArray(t)){const e=parseInt(o,10);if(!isNaN(e))return Array.isArray(t)?t[e]:t.getItemAt(e)}const c=r.getProperties(t),s=null==c?void 0:c.properties.get(o);return s&&(i(s),d(t,s)),n?t[o]:void 0}t.initializeDependencyTracking=d,t.resetGlobalTarget=function(){c=[]},t.runTracked=function(t,e,n){if(l)return f(t,e,n);u(t);const r=e.call(n);return g(),r},t.runTrackedNoThrow=f,t.trackExplicitDependencies=y,t.trackPropertyAccess=i,Object.defineProperty(t,"__esModule",{value:!0})}));
