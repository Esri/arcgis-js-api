/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports"],(function(e){"use strict";let s=!1;function t(e){return void 0!==e.flags}let r=function(){function e(e,s){this._observers=e,this._observer=s}return e.prototype.remove=function(){this._observers.delete(this._observer)},e}(),n=function(){function e(e,s){this.propertyName=e,this.metadata=s,this.flags=1,this._observers=null,this._accessedProperties=null,this._observationHandles=[],this.flags=1|(s.nonNullable?8:0)|(s.hasOwnProperty("value")?16:0)|(void 0===s.get?32:0)|(void 0===s.dependsOn?64:0)}var n=e.prototype;return n.destroy=function(){this._accessedProperties&&(this._accessedProperties.clear(),this._accessedProperties=null),this._observers&&(this._observers.clear(),this._observers=null),this._clearObservationHandles()},n.onPropertyAccessed=function(e){e!==this&&(null===this._accessedProperties&&(this._accessedProperties=new Set),this._accessedProperties.add(e))},n.onTrackingEnd=function(){this._clearObservationHandles(),this.flags|=32;const e=this._accessedProperties;if(null===e)return;const s=this._observationHandles;for(const t of e)s.push(t.observe(this));e.clear()},n.observe=function(e){return null===this._observers&&(this._observers=new Set),new r(this._observers.add(e),e)},n.notify=function(){2&~this.flags&&(this.flags|=1),this._notifyObservers()},n.invalidate=function(){this.notify()},n.commit=function(){this.flags&=-2,this._notifyObservers()},n._notifyObservers=function(){if(null===this._observers)return;const e=this._observers.size,r=new Array(e);let n=e-1;for(const e of this._observers)r[n--]=e;const i=!s;for(;r.length;){const e=r.pop();if(t(e)){if(2&~e.flags&&(e.flags|=1),null===e._observers)continue;for(const s of e._observers)r.push(s)}else i&&e.notify()}},n._clearObservationHandles=function(){for(const e of this._observationHandles)e.remove();this._observationHandles.length=0},e}();e.Property=n,e.isInvalidating=function(){return s},e.startInvalidating=function(){s=!0},e.stopInvalidating=function(){s=!1},Object.defineProperty(e,"__esModule",{value:!0})}));
