/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../maybe","./utils","../Accessor","../Collection"],(function(e,t,n,o,r){"use strict";const f=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function i(e){return e instanceof o}function c(e){return e instanceof r?Object.keys(e.items):i(e)?n.getProperties(e).keys():e?Object.keys(e):[]}function s(e,t){return e instanceof r?e.items[t]:e[t]}function u(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}function l(e){return e?e.declaredClass:null}function p(e,n){const o=e.diff;if(o&&"function"==typeof o)return o(e,n);const r=c(e),a=c(n);if(0===r.length&&0===a.length)return;if(!r.length||!a.length||u(e,n))return{type:"complete",oldValue:e,newValue:n};const y=a.filter((e=>-1===r.indexOf(e))),d=r.filter((e=>-1===a.indexOf(e))),m=r.filter((t=>a.indexOf(t)>-1&&s(e,t)!==s(n,t))).concat(y,d).sort(),h=l(e);if(h&&f.indexOf(h)>-1&&m.length)return{type:"complete",oldValue:e,newValue:n};let b;const g=i(e)&&i(n);for(const f of m){const r=s(e,f),i=s(n,f);let c;(g||"function"!=typeof r&&"function"!=typeof i)&&(r!==i&&(null==r&&null==i||(c=o&&o[f]&&"function"==typeof o[f]?o[f](r,i):"object"==typeof r&&"object"==typeof i&&l(r)===l(i)?p(r,i):{type:"complete",oldValue:r,newValue:i},t.isSome(c)&&(t.isSome(b)?b.diff[f]=c:b={type:"partial",diff:{[f]:c}}))))}return b}function a(e,n){if(t.isNone(e))return!1;const o=n.split(".");let r=e;for(const t of o){if("complete"===r.type)return!0;if("partial"!==r.type)return!1;{const e=r.diff[t];if(!e)return!1;r=e}}return!0}function y(e,t){for(const n of t)if(a(e,n))return!0;return!1}function d(e,t){if("function"!=typeof e&&"function"!=typeof t&&(e||t))return!e||!t||"object"==typeof e&&"object"==typeof t&&l(e)!==l(t)?{type:"complete",oldValue:e,newValue:t}:p(e,t)}function m(e){if(t.isNone(e))return!0;switch(e.type){case"complete":return!1;case"collection":{const t=e;for(const e of t.added)if(!m(e))return!1;for(const e of t.removed)if(!m(e))return!1;for(const e of t.changed)if(!m(e))return!1;return!0}case"partial":for(const t in e.diff){if(!m(e.diff[t]))return!1}return!0}}e.diff=d,e.hasDiff=a,e.hasDiffAny=y,e.isEmpty=m,Object.defineProperty(e,"__esModule",{value:!0})}));
