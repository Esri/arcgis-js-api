/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../Accessor","../Collection","../maybe","./utils"],(function(e,t,n,o,r){"use strict";const i=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function f(e){return e instanceof t}function s(e){return e instanceof n?Object.keys(e.items):f(e)?r.getProperties(e).keys():e?Object.keys(e):[]}function c(e,t){return e instanceof n?e.items[t]:e[t]}function u(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}function l(e){return e?e.declaredClass:null}function a(e,t){const n=e.diff;if(n&&"function"==typeof n)return n(e,t);const r=s(e),p=s(t);if(0===r.length&&0===p.length)return;if(!r.length||!p.length||u(e,t))return{type:"complete",oldValue:e,newValue:t};const y=p.filter((e=>-1===r.indexOf(e))),d=r.filter((e=>-1===p.indexOf(e))),m=r.filter((n=>p.indexOf(n)>-1&&c(e,n)!==c(t,n))).concat(y,d).sort(),b=l(e);if(b&&i.indexOf(b)>-1&&m.length)return{type:"complete",oldValue:e,newValue:t};let h;const g=f(e)&&f(t);for(const i of m){const r=c(e,i),f=c(t,i);let s;(g||"function"!=typeof r&&"function"!=typeof f)&&(r!==f&&(null==r&&null==f||(s=n&&n[i]&&"function"==typeof n[i]?n[i](r,f):"object"==typeof r&&"object"==typeof f&&l(r)===l(f)?a(r,f):{type:"complete",oldValue:r,newValue:f},o.isSome(s)&&(o.isSome(h)?h.diff[i]=s:h={type:"partial",diff:{[i]:s}}))))}return h}function p(e,t){if(o.isNone(e))return!1;const n=t.split(".");let r=e;for(const o of n){if("complete"===r.type)return!0;if("partial"!==r.type)return!1;{const e=r.diff[o];if(!e)return!1;r=e}}return!0}function y(e,t){for(const n of t)if(p(e,n))return!0;return!1}function d(e,t){if(!("function"==typeof e||"function"==typeof t||o.isNone(e)&&o.isNone(t)))return o.isNone(e)||o.isNone(t)||"object"==typeof e&&"object"==typeof t&&l(e)!==l(t)?{type:"complete",oldValue:e,newValue:t}:a(e,t)}function m(e){if(o.isNone(e))return!0;switch(e.type){case"complete":return!1;case"collection":{const t=e;for(const e of t.added)if(!m(e))return!1;for(const e of t.removed)if(!m(e))return!1;for(const e of t.changed)if(!m(e))return!1;return!0}case"partial":for(const t in e.diff){if(!m(e.diff[t]))return!1}return!0}}e.diff=d,e.hasDiff=p,e.hasDiffAny=y,e.isEmpty=m,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
