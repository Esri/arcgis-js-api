/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../handleUtils","../lang","../maybe"],(function(r,n,t,e){"use strict";function a(r){return r?r.__accessor__?r.__accessor__:r.propertyInvalidated?r:null:null}function i(r,n){return null!=r&&r.metadatas&&null!=r.metadatas[n]}function o(r,n){const t=a(r);return t?t.getDependsInfo(r,n,""):""}function u(r,n,t){if(t){return l(r,n,{policy:t,path:""})}return l(r,n,null)}function l(r,n,a){return n?Object.keys(n).reduce(((r,i)=>{let o=null,u="merge";if(a&&(o=a.path?`${a.path}.${i}`:i,u=a.policy(o)),"replace"===u)return r[i]=n[i],r;if("replace-arrays"===u&&Array.isArray(r[i]))return r[i]=n[i],r;if(void 0===r[i])return r[i]=t.clone(n[i]),r;let s=r[i],c=n[i];if(s===c)return r;if(Array.isArray(c)||Array.isArray(r))s=s?Array.isArray(s)?r[i]=s.concat():r[i]=[s]:r[i]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach((r=>{s.includes(r)||s.push(r)})));else if(c&&"object"==typeof c)if(a){const n=a.path;a.path=e.assumeNonNull(o),r[i]=l(s,c,a),a.path=n}else r[i]=l(s,c,null);else r.hasOwnProperty(i)&&!n.hasOwnProperty(i)||(r[i]=c);return r}),r||{}):r}function s(r){return r&&("string"!=typeof r||r.includes("."))?c(r):r}function c(r){return Array.isArray(r)?r:r.split(".")}function f(r){return r.includes(",")?r.split(",").map((r=>r.trim())):[r.trim()]}function p(r){if(Array.isArray(r)){const n=[];for(const t of r)n.push(...f(t));return n}return f(r)}function y(r){if(!r.includes("?"))return null;const n=c(r),t=new Array(n.length);for(let e=0;e<n.length;e++){const r=n[e];t[e]="?"===r[r.length-1],t[e]&&(n[e]=r.slice(0,-1))}return{fullPath:n.join("."),conditional:t}}function h(r,t,e,a){const i=p(t);if(1!==i.length){const t=i.map((n=>a(r,n,e)));return n.handlesGroup(t)}return a(r,i[0],e)}function d(r){let n=!1;return()=>{n||(n=!0,r())}}r.getDependsInfo=o,r.getProperties=a,r.isPropertyDeclared=i,r.merge=u,r.once=d,r.parse=h,r.parseConditionalPath=y,r.pathToArray=c,r.pathToStringOrArray=s,r.splitPath=p,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})}));
