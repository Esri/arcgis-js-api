// COPYRIGHT Â© 2020 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.17/esri/copyright.txt for details.

define(["require","exports","tslib","../config","./global","../views/webgl/context-util"],(function(e,r,a,t,o,n){"use strict";var i,d,s;function l(e){return"function"==typeof s[e]?s[e]=s[e](o):s[e]}t.has||(null===(i=o.dojoConfig)||void 0===i?void 0:i.has)?(s=a.__assign(a.__assign({},null===(d=o.dojoConfig)||void 0===d?void 0:d.has),t.has),delete t.has):s={},l.add=function(e,r,a,t){return(t||void 0===s[e])&&(s[e]=r),a&&l(e)},l.cache=s,function(){l.add("host-webworker",void 0!==o.WorkerGlobalScope&&self instanceof o.WorkerGlobalScope);var e="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document;if(l.add("host-browser",e),l.add("host-node","object"==typeof o.process&&o.process.versions&&o.process.versions.node&&o.process.versions.v8),l.add("dom",e),l("host-browser")){var r=navigator,a=r.userAgent,t=r.appVersion,n=parseFloat(t);if(l.add("wp",parseFloat(a.split("Windows Phone")[1])||void 0),l.add("msapp",parseFloat(a.split("MSAppHost/")[1])||void 0),l.add("khtml",t.indexOf("Konqueror")>=0?n:void 0),l.add("edge",parseFloat(a.split("Edge/")[1])||void 0),l.add("opr",parseFloat(a.split("OPR/")[1])||void 0),l.add("webkit",!l("wp")&&!l("edge")&&parseFloat(a.split("WebKit/")[1])||void 0),l.add("chrome",!l("edge")&&!l("opr")&&parseFloat(a.split("Chrome/")[1])||void 0),l.add("android",!l("wp")&&parseFloat(a.split("Android ")[1])||void 0),l.add("safari",!(t.indexOf("Safari")>=0)||l("wp")||l("chrome")||l("android")||l("edge")||l("opr")?void 0:parseFloat(t.split("Version/")[1])),l.add("mac",t.indexOf("Macintosh")>=0),l.add("quirks","BackCompat"===document.compatMode),!l("wp")&&a.match(/(iPhone|iPod|iPad)/)){var i=RegExp.$1.replace(/P/,"p"),d=a.match(/OS ([\d_]+)/)?RegExp.$1:"1",s=parseFloat(d.replace(/_/,".").replace(/_/g,""));l.add(i,s),l.add("ios",s)}l.add("trident",parseFloat(t.split("Trident/")[1])||void 0),l.add("svg","undefined"!=typeof SVGAngle),l("webkit")||(a.indexOf("Opera")>=0&&l.add("opera",n>=9.8&&parseFloat(a.split("Version/")[1])||n),!(a.indexOf("Gecko")>=0)||l("wp")||l("khtml")||l("trident")||l("edge")||l.add("mozilla",n),l("mozilla")&&l.add("ff",parseFloat(a.split("Firefox/")[1]||a.split("Minefield/")[1])||void 0))}}(),l.add("esri-debug-messages",!1),l.add("esri-deprecation-warnings",!0),function(){if(o.navigator){var e=navigator.userAgent,r=e.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i),a=e.match(/iPhone/i);r&&l.add("esri-mobile",r),a&&l.add("esri-iPhone",a),l.add("esri-geolocation",!!navigator.geolocation)}l.add("esri-canvas-svg-support",!l("trident")),l.add("esri-secure-context",(function(){return"isSecureContext"in o?o.isSecureContext:o.location&&o.location.origin?0===o.location.origin.indexOf("https:"):void 0})),l.add("esri-wasm","WebAssembly"in o),l.add("esri-shared-array-buffer",(function(){var e="SharedArrayBuffer"in o,r=!1===o.crossOriginIsolated;return e&&!r})),l.add("esri-atomics","Atomics"in o),l.add("esri-workers","Worker"in o),l.add("esri-text-decoder","TextDecoder"in o),l.add("esri-text-encoder","TextEncoder"in o),l.add("featurelayer-advanced-symbols",!1),l.add("featurelayer-pbf",!1),l.add("feature-layers-workers",!0),l.add("mapview-transitions-duration",200),l("host-webworker")||(l.add("esri-abortable-fetch","fetch"in o&&"signal"in new Request("https://www.arcgis.com")),l("host-node")||(l.add("csp-restrictions",(function(){try{new Function}catch(e){return!0}return!1})),l.add("esri-image-decode",(function(){if("decode"in new Image){var e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void e.decode().then((function(){l.add("esri-image-decode",!0,!0,!0)})).catch((function(){l.add("esri-image-decode",!1,!0,!0)}))}return!1})),l.add("esri-url-encodes-apostrophe",(function(){var e=o.document.createElement("a");return e.href="?'",e.href.indexOf("?%27")>-1})),l.add("esri-webgl",(function(){return c().available})),l.add("esri-webgl-high-precision-fragment",(function(){return c().supportsHighPrecisionFragment})),l.add("esri-webgl-vertex-shader-samplers",(function(){return c().supportsVertexShaderSamplers})),l.add("esri-webgl-element-index-uint",(function(){return c().supportsElementIndexUint})),l.add("esri-webgl-standard-derivatives",(function(){return c().supportsStandardDerivatives})),l.add("esri-webgl-texture-float",(function(){return c().supportsTextureFloat})),l.add("esri-webgl-color-buffer-float",(function(){return c().supportsColorBufferFloat})),l.add("esri-webgl-instanced-arrays",(function(){return c().supportsInstancedArrays})),l.add("esri-webgl-major-performance-caveat",(function(){return c().majorPerformanceCaveat})),l.add("esri-featurelayer-webgl",!0),l.add("esri-featurelayer-webgl-labeling",!0),l.add("esri-webgl2",(function(){return function(){if(p)return p;if(p={available:!1,version:0},void 0===typeof WebGL2RenderingContext)return p;var e=document.createElement("canvas");if(!e)return p;var r=n.createContext(e,{},"webgl2");if(!r)return p;p.available=!0;var a=r.getParameter(r.VERSION);if(!a)return p;var t=a.match(/^WebGL\s+([\d.]*)/);t&&(p.version=parseFloat(t[1]));return p}().available})),l.add("esri-webgl-max-texture-size",(function(){return c().maxTextureSize}))))}();var u=null;function c(){if(u)return u;if(u={available:!1,majorPerformanceCaveat:!1,maxTextureSize:0,supportsHighPrecisionFragment:!1,supportsVertexShaderSamplers:!1,supportsElementIndexUint:!1,supportsStandardDerivatives:!1,supportsInstancedArrays:!1,supportsTextureFloat:!1,supportsColorBufferFloat:!1,version:0},void 0===typeof WebGLRenderingContext)return u;var e=document.createElement("canvas");if(!e)return u;var r=n.createContext(e,{failIfMajorPerformanceCaveat:!0},"webgl");if(r||(r=n.createContext(e,{},"webgl"))&&(u.majorPerformanceCaveat=!0),!r)return u;var a=r.getParameter(r.VERSION);if(!a)return u;var t=a.match(/^WebGL\s+([\d.]*)/);if(t){u.version=parseFloat(t[1]),u.available=u.version>=.94;var o=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);o&&(u.supportsHighPrecisionFragment=o.precision>0),u.supportsVertexShaderSamplers=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0,u.supportsElementIndexUint=null!==r.getExtension("OES_element_index_uint"),u.supportsStandardDerivatives=null!==r.getExtension("OES_standard_derivatives"),u.supportsInstancedArrays=null!==r.getExtension("ANGLE_instanced_arrays"),u.supportsTextureFloat=null!==r.getExtension("OES_texture_float"),u.supportsColorBufferFloat=null!==r.getExtension("WEBGL_color_buffer_float")}return u.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),u}var p=null;return l}));