/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/Accessor","../../core/accessorSupport/decorators/property","../../core/has","../../core/accessorSupport/ensureType","../../core/Logger","../../core/accessorSupport/decorators/subclass","../../libs/maquette/projection","../../libs/maquette/h","../../libs/maquette/projector"],(function(t,e,o,i,r,s,n,l,a,h,c){"use strict";const x={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};let p=function(e){function o(t){var o;return(o=e.call(this,t)||this).x=0,o.y=0,o.text="-",o.fontSize=14,o.anchor="center",o.visible=!0,o.backgroundColor="rgba(0, 0, 0, 0.6)",o.textColor="white",o.textShadowColor=[0,0,0],o.textShadowSize=1,o}t._inheritsLoose(o,e);var i=o.prototype;return i.render=function(){return h.h("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",backgroundColor:this.backgroundColor,color:this.textColor,padding:this.padding+"px",borderRadius:this.padding+"px",textShadow:`0 0 ${this.textShadowSize}px rgb(${this.textShadowColor[0]}, ${this.textShadowColor[1]}, ${this.textShadowColor[2]})`}},[this.text])},i.renderCanvas=function(t){if(!this.visible)return;const e=t.font.replace(/^(.*?)px/,"");t.font=`${this.fontSize}px ${e}`;const o=this.padding,i=this.padding,r=t.measureText(this.text).width,s=this.fontSize,n=d[this.anchor];t.textAlign="center",t.textBaseline="middle";const l=r+2*o,a=s+2*o,h=this.x+n.x*l,c=this.y+n.y*a;this.roundedRect(t,h,c,l,a,i),t.fillStyle=this.backgroundColor,t.fill();const x=this.x+(n.x+.5)*l,p=this.y+(n.y+.5)*a;this._renderTextShadow(t,this.text,x,p),t.fillStyle=this.textColor,t.fillText(this.text,x,p)},i._renderTextShadow=function(t,e,o,i){t.lineJoin="miter",t.fillStyle=`rgba(${this.textShadowColor[0]}, ${this.textShadowColor[1]}, ${this.textShadowColor[2]}, ${1/y.length})`;const r=this.textShadowSize;for(const[s,n]of y)t.fillText(e,o+r*s,i+r*n)},i.roundedRect=function(t,e,o,i,r,s){t.beginPath(),t.moveTo(e,o+s),t.arcTo(e,o,e+s,o,s),t.lineTo(e+i-s,o),t.arcTo(e+i,o,e+i,o+s,s),t.lineTo(e+i,o+r-s),t.arcTo(e+i,o+r,e+i-s,o+r,s),t.lineTo(e+s,o+r),t.arcTo(e,o+r,e,o+r-s,s),t.closePath()},i._cssClasses=function(){const t={"esri-text-overlay-item":!0};for(const e in x)t[x[e]]=this.anchor===e;return t},t._createClass(o,[{key:"position",get:function(){return[this.x,this.y]},set:function(t){this._set("x",t[0]),this._set("y",t[1])}},{key:"padding",get:function(){return.5*this.fontSize}}]),o}(o);e.__decorate([i.property()],p.prototype,"x",void 0),e.__decorate([i.property()],p.prototype,"y",void 0),e.__decorate([i.property()],p.prototype,"position",null),e.__decorate([i.property()],p.prototype,"text",void 0),e.__decorate([i.property()],p.prototype,"fontSize",void 0),e.__decorate([i.property()],p.prototype,"anchor",void 0),e.__decorate([i.property()],p.prototype,"visible",void 0),e.__decorate([i.property()],p.prototype,"padding",null),p=e.__decorate([l.subclass("esri.views.overlay.TextOverlayItem")],p);const d={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},y=[];{const t=16;for(let e=0;e<360;e+=360/t)y.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)])}return p}));
