// COPYRIGHT Â© 2020 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.17/esri/copyright.txt for details.

define(["require","exports","tslib","../../core/Accessor","../../core/accessorSupport/decorators","../../libs/maquette/index"],(function(t,e,o,i,r,n){"use strict";for(var s={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"},l=function(t){function e(e){var o=t.call(this,e)||this;return o.x=0,o.y=0,o.text="-",o.fontSize=14,o.anchor="center",o.visible=!0,o.backgroundColor="rgba(0, 0, 0, 0.6)",o.textColor="white",o.textShadowColor=[0,0,0],o.textShadowSize=1,o}return o.__extends(e,t),Object.defineProperty(e.prototype,"position",{get:function(){return[this.x,this.y]},set:function(t){this._set("x",t[0]),this._set("y",t[1])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return.5*this.fontSize},enumerable:!1,configurable:!0}),e.prototype.render=function(){return n.h("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",backgroundColor:this.backgroundColor,color:this.textColor,padding:this.padding+"px",borderRadius:this.padding+"px",textShadow:"0 0 "+this.textShadowSize+"px rgb("+this.textShadowColor[0]+", "+this.textShadowColor[1]+", "+this.textShadowColor[2]+")"}},[this.text])},e.prototype.renderCanvas=function(t){if(this.visible){var e=t.font.replace(/^(.*?)px/,"");t.font=this.fontSize+"px "+e;var o=this.padding,i=this.padding,r=t.measureText(this.text).width,n=this.fontSize,s=a[this.anchor];t.textAlign="center",t.textBaseline="middle";var l=r+2*o,h=n+2*o,x=this.x+s.x*l,p=this.y+s.y*h;this.roundedRect(t,x,p,l,h,i),t.fillStyle=this.backgroundColor,t.fill();var d=this.x+(s.x+.5)*l,c=this.y+(s.y+.5)*h;this._renderTextShadow(t,this.text,d,c),t.fillStyle=this.textColor,t.fillText(this.text,d,c)}},e.prototype._renderTextShadow=function(t,e,o,i){t.lineJoin="miter",t.fillStyle="rgba("+this.textShadowColor[0]+", "+this.textShadowColor[1]+", "+this.textShadowColor[2]+", "+1/h.length+")";for(var r=this.textShadowSize,n=0,s=h;n<s.length;n++){var l=s[n],a=l[0],x=l[1];t.fillText(e,o+r*a,i+r*x)}},e.prototype.roundedRect=function(t,e,o,i,r,n){t.beginPath(),t.moveTo(e,o+n),t.arcTo(e,o,e+n,o,n),t.lineTo(e+i-n,o),t.arcTo(e+i,o,e+i,o+n,n),t.lineTo(e+i,o+r-n),t.arcTo(e+i,o+r,e+i-n,o+r,n),t.lineTo(e+n,o+r),t.arcTo(e,o+r,e,o+r-n,n),t.closePath()},e.prototype._cssClasses=function(){var t={"esri-text-overlay-item":!0};for(var e in s)t[s[e]]=this.anchor===e;return t},o.__decorate([r.property()],e.prototype,"x",void 0),o.__decorate([r.property()],e.prototype,"y",void 0),o.__decorate([r.property({dependsOn:["x","y"]})],e.prototype,"position",null),o.__decorate([r.property()],e.prototype,"text",void 0),o.__decorate([r.property()],e.prototype,"fontSize",void 0),o.__decorate([r.property()],e.prototype,"anchor",void 0),o.__decorate([r.property()],e.prototype,"visible",void 0),o.__decorate([r.property({dependsOn:["fontSize"]})],e.prototype,"padding",null),e=o.__decorate([r.subclass("esri.views.overlay.TextOverlayItem")],e)}(i),a={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},h=[],x=0;x<360;x+=22.5)h.push([Math.cos(Math.PI*x/180),Math.sin(Math.PI*x/180)]);return l}));