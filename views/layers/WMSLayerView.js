/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/Logger","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/subclass","../../core/Error","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../layers/support/commonProperties","../../layers/support/ExportWMSImageParameters"],(function(e,r,t,o,s,a,p,i,n,u,c,l,y,m){"use strict";const h=e=>{let o=function(e){function t(){return e.apply(this,arguments)||this}r._inheritsLoose(t,e);var o=t.prototype;return o.initialize=function(){this.exportImageParameters=new m.ExportWMSImageParameters({layer:this.layer})},o.destroy=function(){this.exportImageParameters.destroy(),this.exportImageParameters=null},o.fetchPopupFeatures=function(e){const{layer:r}=this;if(!e)return Promise.reject(new n("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:r}));const{popupEnabled:t}=r;if(!t)return Promise.reject(new n("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:t}));const o=this.createFetchPopupFeaturesQuery(e);if(!o)return Promise.resolve([]);const{extent:s,width:a,height:p,x:i,y:u}=o;if(!(s&&a&&p))throw new n("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:s,width:a,height:p});const c=r.fetchFeatureInfo(s,a,p,i,u);return Promise.resolve(c?[c]:[])},r._createClass(t,[{key:"exportImageVersion",get:function(){var e;return null==(e=this.exportImageParameters)||e.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}}]),t}(e);return t.__decorate([p.property()],o.prototype,"exportImageParameters",void 0),t.__decorate([p.property({readOnly:!0})],o.prototype,"exportImageVersion",null),t.__decorate([p.property()],o.prototype,"layer",void 0),t.__decorate([p.property(y.combinedViewLayerTimeExtentProperty)],o.prototype,"timeExtent",void 0),o=t.__decorate([i.subclass("esri.layers.mixins.WMSLayerView")],o),o};e.WMSLayerView=h,e.default=h,Object.defineProperty(e,"__esModule",{value:!0})}));
