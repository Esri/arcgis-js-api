/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../core/maybe","../../../layers/support/fieldUtils"],(function(e,i,t){"use strict";e.getFetchPopupTemplate=function(e,t){return e.popupTemplate?e.popupTemplate:i.isSome(t)&&t.defaultPopupTemplateEnabled&&i.isSome(e.defaultPopupTemplate)?e.defaultPopupTemplate:null},e.getRequiredFields=async function(e,l=e.popupTemplate){if(!i.isSome(l))return[];const d=await l.getRequiredFields(e.fields),{lastEditInfoEnabled:p}=l,{objectIdField:s,typeIdField:u,globalIdField:a,relationships:o}=e;if(d.includes("*"))return["*"];const n=p?await t.getFeatureEditFields(e):[],f=t.fixFields(e.fields,[...d,...n]);return u&&f.push(u),f&&s&&t.hasField(e.fields,s)&&-1===f.indexOf(s)&&f.push(s),f&&a&&t.hasField(e.fields,a)&&-1===f.indexOf(a)&&f.push(a),o&&o.forEach((i=>{const{keyField:l}=i;f&&l&&t.hasField(e.fields,l)&&-1===f.indexOf(l)&&f.push(l)})),f},Object.defineProperty(e,"__esModule",{value:!0})}));
