/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/maybe","../../core/Logger","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/subclass","../../core/Error","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../geometry/Point","../../layers/support/commonProperties","../../tasks/support/Query","./support/popupUtils"],(function(e,r,t,o,s,p,a,i,n,u,c,l,y,d,h,m,w){"use strict";const f=e=>{let o=function(e){function t(){var r;return(r=e.apply(this,arguments)||this).view=null,r}r._inheritsLoose(t,e);var o=t.prototype;return o.fetchPopupFeatures=async function(e,r){const{layer:t}=this;if(!e)throw new u("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:t});const{popupEnabled:o}=t,p=w.getFetchPopupTemplate(t,r);if(!o||!s.isSome(p))throw new u("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:o,popupTemplate:p});const a=await p.getRequiredFields(),i=new m;i.geometry=e,i.outFields=a,i.outSpatialReference=e.spatialReference;const n=this.view.resolution,c="2d"===this.view.type?new d(n,n,this.view.spatialReference):new d(.5*n,.5*n,this.view.spatialReference),{returnTopmostRaster:l,showNoDataRecords:y}=p.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},h={returnDomainValues:!0,returnTopmostRaster:l,pixelSize:c,showNoDataRecords:y};return t.queryVisibleRasters(i,h).then((e=>e))},o.canResume=function(){var r;return!!e.prototype.canResume.call(this)&&(null==(r=this.timeExtent)||!r.isEmpty)},t}(e);return t.__decorate([i.property()],o.prototype,"layer",void 0),t.__decorate([i.property()],o.prototype,"suspended",void 0),t.__decorate([i.property(h.combinedViewLayerTimeExtentProperty)],o.prototype,"timeExtent",void 0),t.__decorate([i.property()],o.prototype,"view",void 0),o=t.__decorate([n.subclass("esri.views.layers.ImageryLayerView")],o),o};e.ImageryLayerView=f,e.default=f,Object.defineProperty(e,"__esModule",{value:!0})}));
