/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","../../../chunks/vec2","../../../chunks/vec2f64","../../../chunks/vec3","../../../chunks/vec3f64","./SnappingPoint","../../support/geometry3dUtils","../../support/geometry2dUtils"],(function(t,n,e,i,r,s,o,a,c,l){"use strict";let u=function(){function t(){}return t.prototype.intersect=function(t){return C(this,t)},t}(),f=function(t){function e(n){var e;return(e=t.call(this)||this).point=n,e}n._inheritsLoose(e,t);var i=e.prototype;return i.equals=function(t){return q(t)&&s.exactEquals(this.point,t.point)},i.closestTo=function(){return a.cloneSnappingPoint(this.point)},e}(u),p=function(t){function e(n,e,i){var r;return(r=t.call(this)||this).start=n,r.end=e,r.type=i,r.lineLike={start:r.start,end:r.end,type:r.type},r}n._inheritsLoose(e,t);var i=e.prototype;return i.equals=function(t){return S(t)&&this.type===t.type&&s.exactEquals(this.start,t.start)&&s.exactEquals(this.end,t.end)},i.closestTo=function(t){const n=c.projectPointToLineLike(t,this.lineLike);return a.asSnappingPoint(n)},e}(u),h=function(t){function e(n,e){return t.call(this,n,e,l.LineType.LINE)||this}return n._inheritsLoose(e,t),e}(p),d=function(t){function e(n,e,i){var r;return(r=t.call(this)||this).intersection=n,r.first=e,r.second=i,r}n._inheritsLoose(e,t);var i=e.prototype;return i.equals=function(t){return t instanceof e&&this.first.equals(t.first)&&this.second.equals(t.second)},i.closestTo=function(){return a.cloneSnappingPoint(this.intersection)},e}(u),L=function(t){function e(n,e,i){var r;return(r=t.call(this)||this).basePoint=n,r.first=e,r.second=i,r}n._inheritsLoose(e,t);var i=e.prototype;return i.equals=function(t){return t instanceof e&&this.first.equals(t.first)&&this.second.equals(t.second)},i.closestTo=function(t){const n=this.basePoint;return a.asSnappingPoint(o.fromValues(n[0],n[1],t[2]))},e}(u),P=function(t){function e(n,e){var i;return(i=t.call(this)||this).center=n,i.radius=e,i}n._inheritsLoose(e,t);var i=e.prototype;return i.equals=function(t){return _(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius},i.closestTo=function(t){const n=c.projectPointToVerticalCylinder(t,this.center,this.radius);return a.asSnappingPoint(n)},e}(u),y=function(t){function e(n,e,i){var r;return(r=t.call(this)||this).start=n,r.end=e,r.type=i,r.planeLike={start:n,end:e,type:i},r}n._inheritsLoose(e,t);var r=e.prototype;return r.equals=function(t){return m(t)&&this.type===t.type&&s.exactEquals(this.start,t.start)&&s.exactEquals(this.end,t.end)},r.closestTo=function(t){return a.asSnappingPoint(c.projectPointToVerticalPlane(t,this.planeLike))},r.closestEndTo=function(t){const{start:n,end:e}=this;return Math.sign(i.dot(i.subtract(b,e,n),i.subtract(x,t,n)))>0?e:n},e}(u),k=function(t){function e(n,e){return t.call(this,n,e,c.VerticalPlaneType.HALF_PLANE)||this}return n._inheritsLoose(e,t),e}(y),V=function(t){function e(n,e){return t.call(this,n,e,c.VerticalPlaneType.PLANE)||this}return n._inheritsLoose(e,t),e}(y),g=function(t){function i(n,e,i){var r;return(r=t.call(this)||this).start=n,r.end=e,r.getZ=i,r.planeLike={start:n,end:e,type:c.VerticalPlaneType.HALF_PLANE},r}n._inheritsLoose(i,t);var r=i.prototype;return r.equals=function(t){return E(t)&&s.exactEquals(this.start,t.start)&&s.exactEquals(this.end,t.end)&&this.getZ===t.getZ},r.closestTo=function(t){return A(this,t)},r.addIfOnTheGround=function(t,n){for(const i of n){const n=e.unwrapOr(this.getZ(i[0],i[1],i[2]),0);Math.abs(i[2]-n)<c.epsilon&&(i[2]=n,t.push(i))}},i}(u);function A(t,n){const i=c.projectPointToVerticalPlane(n,t.planeLike);return i[2]=e.toNullable(t.getZ(n[0],n[1],n[2]))??I,a.asSnappingPoint(i)}function C(t,n){let e=[];if(q(t)){const{point:i}=t;S(n)?e=c.intersectLineAndPoint(n.lineLike,i):_(n)?e=c.intersectVerticalCylinderAndPoint(n.center,n.radius,i):m(n)?e=c.intersectVerticalPlaneAndPoint(n.planeLike,i):E(n)&&(e=T(n,t))}else if(S(t)){const{lineLike:i}=t;q(n)?e=c.intersectLineAndPoint(i,n.point):S(n)?e=c.intersectLineLike(i,n.lineLike):_(n)?e=c.intersectLineLikeAndVerticalCylinder(i,n.center,n.radius):m(n)?e=c.intersectVerticalPlaneAndLineLike(n.planeLike,i):E(n)&&(e=T(n,t))}else if(_(t)){const{center:i,radius:r}=t;if(S(n))e=c.intersectLineLikeAndVerticalCylinder(n.lineLike,i,r);else if(q(n))e=c.intersectVerticalCylinderAndPoint(i,r,n.point);else{if(m(n))return c.intersectVerticalPlaneAndVerticalCylinder(n.planeLike,i,r).map((e=>new L(e,t,n)));E(n)&&(e=T(n,t))}}else if(m(t)){const{planeLike:i}=t;if(m(n))return c.intersectVerticalPlane(i,n.planeLike).map((e=>new L(e,t,n)));if(q(n))e=c.intersectVerticalPlaneAndPoint(i,n.point);else if(S(n))e=c.intersectVerticalPlaneAndLineLike(i,n.lineLike);else{if(_(n))return c.intersectVerticalPlaneAndVerticalCylinder(i,n.center,n.radius).map((e=>new L(e,t,n)));E(n)&&(e=T(n,t))}}else E(t)&&(e=T(t,n));return v(e,t,n)}function T(t,n){const{planeLike:i,getZ:r}=t,s=[];if(q(n))t.addIfOnTheGround(s,c.intersectVerticalPlaneAndPoint(i,n.point));else if(S(n))t.addIfOnTheGround(s,c.intersectVerticalPlaneAndLineLike(i,n.lineLike));else if(_(n))for(const[a,l]of c.intersectVerticalPlaneAndVerticalCylinder(i,n.center,n.radius)){const t=r(a,l,0);e.isSome(t)&&s.push(o.fromValues(a,l,t))}else if(m(n)||E(n))for(const[a,l]of c.intersectVerticalPlane(i,n.planeLike)){const t=e.toNullable(r(a,l,0))??I;s.push(o.fromValues(a,l,t))}return s}function v(t,n,e){return t.map((t=>new d(a.asSnappingPoint(t),n,e)))}function q(t){return t instanceof f}function S(t){return t instanceof p}function _(t){return t instanceof P}function m(t){return t instanceof y}function E(t){return t instanceof g}const b=r.create(),x=r.create(),I=0;t.DrapedLineConstraint=g,t.IntersectionConstraint=d,t.LineConstraint=h,t.LineLikeConstraint=p,t.PointConstraint=f,t.SnappingConstraint=u,t.VerticalCylinderConstraint=P,t.VerticalHalfPlaneConstraint=k,t.VerticalLineIntersectionConstraint=L,t.VerticalPlaneConstraint=V,t.VerticalPlaneLikeConstraint=y,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
