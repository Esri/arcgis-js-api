/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6","../../../../core/has","../../../../core/Logger","../../../../core/accessorSupport/ensureType","../../../../core/handleUtils","../../../../core/accessorSupport/decorators/property","../../../../core/accessorSupport/decorators/subclass","../../../../core/urlUtils","../../../../core/uuid","../../../../portal/support/resourceExtension","../../../../geometry/Polygon","../../../../core/Handles","../../../../geometry/support/aaBoundingRect","../../../support/TileTreeDebugger"],(function(e,t,r,o,s,n,a,i,u,l,c,d,g,p,f,h){"use strict";e.WorkerTileTreeDebugger=function(e){function r(t){var r;return(r=e.call(this,t)||this).handles=new p,r}t._inheritsLoose(r,e);var o=r.prototype;return o.initialize=function(){const e=setInterval((()=>this.fetchDebugInfo()),2e3);this.handles.add(a.makeHandle((()=>clearInterval(e))))},o.destroy=function(){this.handles.destroy()},o.getTiles=function(){if(!this.debugInfo)return[];const e=new Map,t=new Map;this.debugInfo.storedTiles.forEach((t=>{e.set(t.data.id,t.featureCount)})),this.debugInfo.pendingTiles.forEach((r=>{e.set(r.data.id,r.featureCount),t.set(r.data.id,r.state)}));const r=r=>{var o;const s=t.get(r),n=null!=(o=e.get(r))?o:"?";return s?`${s}:${n}\n${r}`:`store:${n}\n${r}`},o=new Map;return this.debugInfo.storedTiles.forEach((e=>{o.set(e.data.id,e.data)})),this.debugInfo.pendingTiles.forEach((e=>{o.set(e.data.id,e.data)})),Array.from(o.values()).map((e=>({lij:[e.level,e.row,e.col],geometry:g.fromExtent(f.toExtent(e.extent,this.view.spatialReference)),label:r(e.id)})))},o.fetchDebugInfo=function(){this.handle.getDebugInfo(null).then((e=>{this.debugInfo=e,this.update()}))},r}(h.TileTreeDebugger),r.__decorate([i.property({constructOnly:!0})],e.WorkerTileTreeDebugger.prototype,"handle",void 0),e.WorkerTileTreeDebugger=r.__decorate([u.subclass("esri.views.interactive.snapping.featureSources.WorkerTileTreeDebugger")],e.WorkerTileTreeDebugger),Object.defineProperty(e,"__esModule",{value:!0})}));
