/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","../../../chunks/vec2","../../../chunks/vec2f64","../../../chunks/vec3f64","../../../support/elevationInfoUtils","./SnappingAlgorithm","./SnappingPoint","./snappingUtils","./candidates/RightAngleTriangleSnappingCandidate","../support/viewUtils","../../support/geometry2dUtils"],(function(e,t,n,i,o,r,s,a,p,c,l,g,d){"use strict";let h=function(e){function o(){return e.apply(this,arguments)||this}t._inheritsLoose(o,e);var a=o.prototype;return a.snapNewVertex=function(e,t){const n=t.editGeometryOperations.data.components[0],i=[],o=n.vertices.length;if("polygon"!==t.editGeometryOperations.data.type||o<2)return i;const{view:r}=this,s=n.vertices[0],a=n.vertices[o-1],c=p.anyMapPointToSnappingPoint(s.pos,r,t),l=p.anyMapPointToSnappingPoint(a.pos,r,t);return this._processCandidateProposal(c,l,e,t,i),i},a.snapExistingVertex=function(e,t){const i=[],o=n.unwrap(t.vertexHandle),r=o.component;if(r.edges.length<2)return i;if("polyline"===t.editGeometryOperations.data.type&&(0===o.index||o.index===r.vertices.length-1))return i;const{view:s}=this,a=p.anyMapPointToSnappingPoint(o.leftEdge.leftVertex.pos,s,t),c=p.anyMapPointToSnappingPoint(o.rightEdge.rightVertex.pos,s,t);return this._processCandidateProposal(a,c,e,t,i),i},a._processCandidateProposal=function(e,t,n,o,a){if(!this.exceedsShortLineThreshold(e,t,o))return;const h=i.lerp(u,e,t,.5),f=.5*i.distance(e,t),v=r.create();d.projectPointToCircle(v,n,h,f),v[2]=n[2];const P=p.asSnappingPoint(v),{spatialReference:y,pointer:S}=o,T=g.vectorToScreenPoint(n,y,s.absoluteHeightElevationInfo,this.view);if(c.squaredScreenDistance(T,g.vectorToScreenPoint(P,y,s.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(S)){if(this.isVertical(e,P)||this.isVertical(P,t))return;a.push(new l.RightAngleTriangleSnappingCandidate({targetPoint:P,point1:e,point2:t,isDraped:"on-the-ground"===o.elevationInfo?.mode}))}},o}(a.SnappingAlgorithm);const u=o.create();e.RightAngleTriangleSnapper=h,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
