/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","../../../chunks/vec2f64","../../../chunks/vec2","./Settings","./snappingUtils","./SnappingAlgorithm","../../3d/support/geometryUtils/vector2d","./RightAngleTriangleSnappingCandidate"],(function(e,t,n,o,i,r,s,a,l,p){"use strict";let h=function(e){function a({enabled:t=r.defaults.lineSnapper.enabled,proximityThreshold:n=r.defaults.lineProximityThreshold,shortLineThreshold:o=r.defaults.shortLineThreshold}={}){return e.call(this,{enabled:t,proximityThreshold:n,shortLineThreshold:o})||this}t._inheritsLoose(a,e);var h=a.prototype;return h.snapNewVertex=function(e,t){const n=t.geometry.data.components[0],o=[],i=n.vertices.length;if("polygon"!==t.geometry.type||i<2)return o;const r=n.vertices[0],s=n.vertices[i-1];return this._processCandidateProposal(r.pos,s.pos,e,t,o),o},h.snapExistingVertex=function(e,t){const o=[],i=n.unwrap(t.vertexHandle),r=i.component;return r.edges.length<2?o:"polyline"!==t.geometry.type||0!==i.index&&i.index!==r.vertices.length-1?(this._processCandidateProposal(i.left.left.pos,i.right.right.pos,e,t,o),o):o},h._processCandidateProposal=function(e,t,n,r,a){if(!this.exceedsShortLineThreshold(e,t,r))return;const h=i.lerp(o.create(),e,t,.5),c=.5*i.distance(e,t),d=l.projectPointToCircle(o.create(),[n.x,n.y],h,c),g=r.geometry.data.coordinateHelper,u=g.fromXYZ(d,n.hasZ?n.z:0),f=g.fromPoint(n),y=s.anyMapPointToScreenPoint(f,g,r.elevationInfo,r.view);s.squareDistance(y,s.anyMapPointToScreenPoint(u,g,r.elevationInfo,r.view))<this.squaredProximityTreshold(r.pointer)&&a.push(new p.RightAngleTriangleSnappingCandidate({coordinateHelper:g,targetPoint:u,point1:e,point2:t}))},a}(a.SnappingAlgorithm);e.RightAngleTriangleSnapper=h,Object.defineProperty(e,"__esModule",{value:!0})}));
