/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","../../../chunks/vec2","../../../chunks/vec2f64","../../../support/elevationInfoUtils","./SnappingAlgorithm","./snappingUtils","./candidates/RightAngleTriangleSnappingCandidate","../support/viewUtils","../../support/geometry2dUtils"],(function(e,t,n,i,o,r,s,a,p,l,c){"use strict";let d=function(e){function o(){return e.apply(this,arguments)||this}t._inheritsLoose(o,e);var s=o.prototype;return s.snapNewVertex=function(e,t){const n=t.editGeometryOperations.data.components[0],i=[],o=n.vertices.length;if("polygon"!==t.editGeometryOperations.data.type||o<2)return i;const{view:r}=this,s=n.vertices[0],p=n.vertices[o-1],l=a.convertPointElevation(s.pos,r,t),c=a.convertPointElevation(p.pos,r,t);return this._processCandidateProposal(l,c,e,t,i),i},s.snapExistingVertex=function(e,t){const i=[],o=n.unwrap(t.vertexHandle),r=o.component;if(r.edges.length<2)return i;if("polyline"===t.editGeometryOperations.data.type&&(0===o.index||o.index===r.vertices.length-1))return i;const{view:s}=this,p=a.convertPointElevation(o.leftEdge.leftVertex.pos,s,t),l=a.convertPointElevation(o.rightEdge.rightVertex.pos,s,t);return this._processCandidateProposal(p,l,e,t,i),i},s._processCandidateProposal=function(e,t,n,o,s){if(!this.exceedsShortLineThreshold(e,t,o))return;const d=i.lerp(g,e,t,.5),h=.5*i.distance(e,t),v=c.projectPointToCircle(u,n,d,h),{coordinateHelper:f,pointer:P}=o,y=f.fromXYZ(v,f.getZ(n,0)),m=l.anyMapPointToScreenPoint(n,f,r.absoluteHeightElevationInfo,this.view);a.squaredScreenDistance(m,l.anyMapPointToScreenPoint(y,f,r.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(P)&&s.push(new p.RightAngleTriangleSnappingCandidate({coordinateHelper:f,targetPoint:y,point1:e,point2:t,elevationInfo:f.hasZ()?r.absoluteHeightElevationInfo:null}))},o}(s.SnappingAlgorithm);const g=o.create(),u=o.create();e.RightAngleTriangleSnapper=d,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
