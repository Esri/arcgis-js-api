/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../core/maybe","../../../core/reactiveUtils","../../../chunks/vec3","../../../layers/graphics/dehydratedFeatures","../../input/InputManager","../keybindings","./SnappingPoint"],(function(e,n,t,i,o,a,r,s){"use strict";function p(e,n){const t=e.length===n.length&&e[0]===n[0]&&e[1]===n[1];switch(e.length){case 2:return t;case 3:return t&&e[2]===n[2];case 4:return t&&e[2]===n[2]&&e[3]===n[3]}return!1}function c(e,n){const t=e.x-n.x,i=e.y-n.y;return t*t+i*i}function g(e,n){return Math.sqrt(c(e,n))}function d(e,n){n.sort(((n,t)=>i.squaredDistance(n.targetPoint,e)-i.squaredDistance(t.targetPoint,e)))}var u;function l({point:e,distance:t,types:i,coordinateHelper:{spatialReference:a}},r,s){return{point:o.makeDehydratedPoint(e[0],e[1],e[2],a.toJSON()),mode:r,distance:t,types:i,query:n.isSome(s)?s.toJSON():{where:"1=1"}}}function E(e,n,t){return{left:s.anyMapPointToSnappingPoint(e.leftVertex.pos,n,t),right:s.anyMapPointToSnappingPoint(e.rightVertex.pos,n,t)}}function y(e){return e.createQuery()}function S(e,i=(()=>{})){const o=t.watch((()=>({view:e.view,snappingOptions:e.snappingOptions})),(({view:t,snappingOptions:o})=>{const s="snapping-toggle",p=a.ViewEventPriorities.TOOL;if(e.removeHandles(s),t&&n.isSome(o)){const n=[t.on("key-down",(e=>{e.key!==r.SNAPPING_KEYS.toggle||e.repeat||(o.enabledToggled=!0,i())}),p),t.on("key-up",(e=>{e.key===r.SNAPPING_KEYS.toggle&&(o.enabledToggled=!1,i())}),p),t.on("pointer-move",(e=>{const n=e.native.ctrlKey;o.enabledToggled!==n&&(o.enabledToggled=n,i())}),p)];e.addHandles(n,s)}}),t.syncAndInitial);e.addHandles(o)}e.LineSegmentHintType=void 0,(u=e.LineSegmentHintType||(e.LineSegmentHintType={}))[u.TARGET=0]="TARGET",u[u.REFERENCE=1]="REFERENCE",u[u.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION",e.editEdgeToSnappingEdge=E,e.makeFilter=y,e.makeSnappingQuery=l,e.objectEqual=p,e.screenDistance=g,e.setupSnappingToggleHandles=S,e.sortCandidatesInPlace=d,e.squaredScreenDistance=c,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
