/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/Evented","../../../core/maybe","./EditGeometry","./operations/AppendVertex","./operations/UpdateVertices","./operations/RemoveVertices","./operations/SplitEdge","./operations/SetVertexPosition","./operations/CloseComponent","./operations/MoveVertex","./operations/OffsetEdgeVertex","./operations/RotateVertex","./operations/ScaleVertex","./operations/UndoGroup"],(function(e,t,n,r,o,i,s,a,c,p,u,d,l,h,V,f){"use strict";let m=function(e){function n(t){var n;return(n=e.call(this)||this).data=t,n.undoStack=[],n.redoStack=[],n.listener=n.data.on("change",(e=>{e.addedVertices&&n.emit("vertex-add",{type:"vertex-add",vertices:e.addedVertices,operation:e.operation}),e.removedVertices&&n.emit("vertex-remove",{type:"vertex-remove",vertices:e.removedVertices,operation:e.operation}),e.updatedVertices&&n.emit("vertex-update",{type:"vertex-update",vertices:e.updatedVertices,operation:e.operation})})),n}t._inheritsLoose(n,e);var m=n.prototype;return m.destroy=function(){this.listener.remove()},m.splitEdge=function(e,t){return this.apply(new c.SplitEdge(this.data,e,t))},m.updateVertices=function(e,t,n=1){return this.apply(new s.UpdateVertices(this.data,e,t),n)},m.moveVertices=function(e,t,n,r,o=1){return this.updateVertices(e,new d.MoveVertex(this.data.coordinateHelper,t,n,r),o)},m.scaleVertices=function(e,t,n,r,o,i=1,s=0){return this.updateVertices(e,new V.ScaleVertex(t,n,r,o,s),i)},m.rotateVertices=function(e,t,n,r=1,o=0){return this.updateVertices(e,new h.RotateVertex(t,n,o),r)},m.removeVertices=function(e){return this.apply(new a.RemoveVertices(this.data,e,this._minNumVerticesPerType))},m.appendVertex=function(e){return 0===this.data.components.length?null:this.apply(new i.AppendVertex(this.data,this.data.components[0],e))},m.setVertexPosition=function(e,t){return this.apply(new p.SetVertexPosition(this.data,e,t))},m.offsetEdge=function(e,t,n,r=1){return this.updateVertices([t.leftVertex,t.rightVertex],new l.OffsetEdgeVertex(this.data.coordinateHelper,e,t,n),r)},m.closeComponent=function(e){return this.data.components.includes(e)?this.apply(new u.CloseComponent(this.data,e)):null},m.canRemoveVertex=function(){return this.data.components[0].vertices.length>this._minNumVerticesPerType},m.createUndoGroup=function(){const e=new f.UndoGroup;return this.apply(e),{remove:()=>e.close()}},m.undo=function(){if(this.undoStack.length>0){const e=this.undoStack.pop();return e.undo(),this.redoStack.push(e),e}return null},m.redo=function(){if(this.redoStack.length>0){const e=this.redoStack.pop();return e.apply(),this.undoStack.push(e),e}return null},m.apply=function(e,t=1){return 0!==t&&!r.isNone(this.lastOperation)&&this.lastOperation.accumulate(e)||(e.apply(),this.undoStack.push(e),this.redoStack=[]),e},n.fromGeometry=function(e,t){return new n(o.EditGeometry.fromGeometry(e,t))},t._createClass(n,[{key:"canUndo",get:function(){return this.undoStack.length>0}},{key:"canRedo",get:function(){return this.redoStack.length>0}},{key:"lastOperation",get:function(){return this.undoStack.length>0?this.undoStack[this.undoStack.length-1]:null}},{key:"_minNumVerticesPerType",get:function(){switch(this.data.type){case"point":return 1;case"polyline":return 2;case"polygon":return 3;default:return 0}}}]),n}(n);e.EditGeometryOperations=m,Object.defineProperty(e,"__esModule",{value:!0})}));
