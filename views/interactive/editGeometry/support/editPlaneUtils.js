/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/vec3f64","../../../../chunks/vec3","../../../../chunks/vec2","../../../3d/support/stack","../../../3d/support/geometryUtils","../operations/UpdateVertices","../operations/MoveVertex","../operations/RotateVertex","../operations/ScaleVertex"],(function(s,e,t,o,n,i,a,r,c,d){"use strict";function b(s,e){return g(s,e,!1)}function u(s,e){return g(s,e,!0)}function g(s,e,t){if(s instanceof a.UpdateVertices){if(s.operation instanceof r.MoveVertex)return l(s.operation,e,t),!0;if(s.operation instanceof c.RotateVertex)return p(s.operation,e,t),!0;if(s.operation instanceof d.ScaleVertex)return f(s.operation,e,t),!0}return!1}function l(s,o,n=!1){const i=n?-1:1,a=e.fromValues(i*s.dx,i*s.dy,i*s.dz);t.add(o.origin,o.origin,a)}function p(s,o,n=!1){const i=n?-s.angle:s.angle;t.rotateZ(o.basis1,o.basis1,e.ZEROS,i),t.rotateZ(o.basis2,o.basis2,e.ZEROS,i)}function f(s,e,o=!1){const n=o?1/s.factor1:s.factor1,i=o?1/s.factor2:s.factor2;t.scale(e.basis1,e.basis1,n),t.scale(e.basis2,e.basis2,i),v(e.origin,s.origin,s.axis1,n),v(e.origin,s.origin,s.axis2,i)}function v(s,e,t,i){const a=n.sv2d.get(),r=o.subtract(a,s,e),c=o.scale(a,t,o.dot(t,r));o.scaleAndAdd(s,s,c,i-1)}function I(s,e,t,a){a||(a=i.boundedPlane.create());const r=o.set(n.sv2d.get(),s[1],-s[0]),c=o.set(n.sv2d.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),d=o.set(n.sv2d.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),b=n.sv2d.get();e.components.forEach((e=>e.vertices.forEach((e=>{const t=e.pos;o.set(b,o.dot(s,t),o.dot(r,t)),o.min(c,c,b),o.max(d,d,b)}))));const u=1e-6,g=o.set(n.sv2d.get(),d[0]-c[0]<u?t/2:0,d[1]-c[1]<u?t/2:0);return o.subtract(c,c,g),o.add(d,d,g),o.scale(a.basis1,s,(d[0]-c[0])/2),o.scale(a.basis2,r,(d[1]-c[1])/2),o.set(a.origin,c[0]*s[0]+c[1]*r[0],c[0]*s[1]+c[1]*r[1]),o.add(a.origin,a.origin,a.basis1),o.add(a.origin,a.origin,a.basis2),a}function N(s,e,o,a=0,r){r||(r=i.boundedPlane.create()),e.toRenderCoords(s.origin,o,r.origin);const c=n.sv3d.get();t.add(c,s.origin,s.basis1),t.add(c,c,s.basis2),e.toRenderCoords(c,o,c);const d=n.sv3d.get();t.add(d,s.origin,s.basis1),t.subtract(d,d,s.basis2),e.toRenderCoords(d,o,d);const b=n.sv3d.get();t.subtract(b,s.origin,s.basis1),t.subtract(b,b,s.basis2),e.toRenderCoords(b,o,b);const u=n.sv3d.get();t.subtract(u,s.origin,s.basis1),t.add(u,u,s.basis2),e.toRenderCoords(u,o,u);const g=t.lerp(n.sv3d.get(),c,d,.5);t.subtract(g,g,r.origin);const l=t.lerp(n.sv3d.get(),b,u,.5);t.subtract(l,r.origin,l),t.lerp(r.basis1,g,l,.5);const p=t.lerp(n.sv3d.get(),u,c,.5);t.subtract(p,p,r.origin);const f=t.lerp(n.sv3d.get(),d,b,.5);t.subtract(f,r.origin,f),t.lerp(r.basis2,p,f,.5);const v=t.cross(n.sv3d.get(),r.basis1,r.basis2),I=t.cross(v,v,r.basis1);return t.normalize(I,I),t.scale(r.basis2,I,t.dot(r.basis2,I)),t.scale(r.basis1,r.basis1,1+a/t.length(r.basis1)),t.scale(r.basis2,r.basis2,1+a/t.length(r.basis2)),i.boundedPlane.updateUnboundedPlane(r),r}s.apply=b,s.calculateOrientedBounds=I,s.mapPlaneToRenderPlane=N,s.unapply=u,Object.defineProperty(s,"__esModule",{value:!0})}));
