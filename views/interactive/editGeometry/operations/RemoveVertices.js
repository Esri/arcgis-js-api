/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../../../core/maybe","../EditGeometry"],(function(e,t,r){"use strict";let i=function(){function e(e,t,r=0){this.editGeometry=e,this.vertices=t,this.minNumberOfVertices=r,this.removedVertices=null}var i=e.prototype;return i.apply=function(){let e="redo";null==this.removedVertices?(this.removedVertices=[],this.vertices.forEach((e=>{const r=this._removeVertex(e);t.isSome(r)&&this.removedVertices.push(r)})),e="apply"):this.removedVertices.forEach((e=>{this._removeVertex(e.removedVertex)}));const r={removedVertices:this.vertices,operation:e};this.editGeometry.emit("change",r)},i.undo=function(){this.removedVertices.forEach((e=>{this._undoRemoveVertex(e)}));const e={addedVertices:this.vertices,operation:"undo"};this.editGeometry.emit("change",e)},i.accumulate=function(){return!1},i._removeVertex=function(e){const t=e.component;if(t.vertices.length<=this.minNumberOfVertices)return null;const i={removedVertex:e,createdEdge:null},s=e.left,n=e.right;return t.vertices.splice(t.vertices.indexOf(e),1),s&&(t.edges.splice(t.edges.indexOf(s),1),s.left.right=null),n&&(t.edges.splice(t.edges.indexOf(n),1),n.right.left=null),0===e.index&&n&&this.vertices.length>0&&t.swapVertices(t.vertices.indexOf(n.right),0),s&&n&&(i.createdEdge=new r.Edge(t,s.left,n.right),t.edges.push(i.createdEdge)),n&&t.updateVertexIndex(n.right,n.right.index-1),i},i._undoRemoveVertex=function(e){const t=e.removedVertex,r=e.removedVertex.component,i=t.left,s=t.right;e.createdEdge&&r.edges.splice(r.edges.indexOf(e.createdEdge),1),r.vertices.push(t),i&&(r.edges.push(i),i.left.right=i),s&&(r.edges.push(s),s.right.left=s),r.updateVertexIndex(t,t.index)},e}();e.RemoveVertices=i,Object.defineProperty(e,"__esModule",{value:!0})}));
