/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/Logger","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/subclass","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../core/promiseUtils","../../core/Accessor","./interactiveToolUtils","./ManipulatorCollection"],(function(t,e,o,i,a,n,r,s,c,l,h,u,p,d,v){"use strict";t.InteractiveToolBase=function(t){function o(e){var o;return(o=t.call(this,e)||this).attached=!1,o.created=!1,o.completed=!1,o.manipulators=new v.ManipulatorCollection,o.deferCreation=!1,o._editableFlags=new Array,o._creationResolver=u.createResolver(),o}e._inheritsLoose(o,t);var i=o.prototype;return i.attach=function(){!this.attached&&this.isSupported&&(this.manipulators.attach(),this.onAttach(),this.visible&&this.onShow(),this._set("attached",!0))},i.detach=function(){this.attached&&(this.onHide(),this.onDetach(),this.manipulators.detach(),this._set("attached",!1))},i.handleInputEvent=function(t){this.attached&&this.onInputEvent(t)},i.handleInputEventAfter=function(t){this.attached&&this.onInputEventAfter(t)},i.destroy=function(){this.manipulators.destroy(),this._set("view",null)},i.setEditableFlag=function(t,e){this._editableFlags[t]=e,this.manipulators.isToolEditable=this._editableFlags.every((t=>null==t||t)),this._updateManipulatorAttachment(),0===t&&this.notifyChange("editable"),this.onEditableChange()},i.hasEditableFlag=function(t){const e=this._editableFlags[t];return null==e||e},i.when=function(){return this._creationResolver.promise},i.rejectCreation=function(t){this._creationResolver.reject(t)},i.initialize=function(){this.deferCreation||this.complete()},i.onAttach=function(){},i.onDetach=function(){},i.onShow=function(){},i.onHide=function(){},i.onEditableChange=function(){},i.onInputEvent=function(t){},i.onInputEventAfter=function(t){},i.create=function(){this.created||(this._set("created",!0),this._creationResolver(this))},i.complete=function(){this.create(),this._set("completed",!0)},i._show=function(){this._updateManipulatorAttachment(),this.onShow()},i._hide=function(){this._updateManipulatorAttachment(),this.onHide()},i._updateManipulatorAttachment=function(){this.attached&&this.visible?this.manipulators.attach():this.manipulators.detach()},e._createClass(o,[{key:"active",get:function(){return null!=this.view&&this.view.activeTool===this}},{key:"isSupported",get:function(){return!0}},{key:"visible",set:function(t){this._set("visible",t),t||d.setActive(this,!1),this.attached&&(t?this._show():this._hide())}},{key:"editable",get:function(){return this.hasEditableFlag(0)},set:function(t){this.setEditableFlag(0,t)}},{key:"internallyEditable",get:function(){return this.hasEditableFlag(0)&&this.hasEditableFlag(1)}}]),o}(p),o.__decorate([r.property({constructOnly:!0})],t.InteractiveToolBase.prototype,"view",void 0),o.__decorate([r.property({dependsOn:["view.activeTool"],readOnly:!0})],t.InteractiveToolBase.prototype,"active",null),o.__decorate([r.property({value:!0})],t.InteractiveToolBase.prototype,"visible",null),o.__decorate([r.property({value:!0})],t.InteractiveToolBase.prototype,"editable",null),o.__decorate([r.property({readOnly:!0})],t.InteractiveToolBase.prototype,"attached",void 0),o.__decorate([r.property({readOnly:!0})],t.InteractiveToolBase.prototype,"created",void 0),o.__decorate([r.property({readOnly:!0})],t.InteractiveToolBase.prototype,"completed",void 0),o.__decorate([r.property({readOnly:!0})],t.InteractiveToolBase.prototype,"manipulators",void 0),o.__decorate([r.property({constructOnly:!0})],t.InteractiveToolBase.prototype,"deferCreation",void 0),t.InteractiveToolBase=o.__decorate([s.subclass("esri.views.interactive.InteractiveToolBase")],t.InteractiveToolBase),Object.defineProperty(t,"__esModule",{value:!0})}));
