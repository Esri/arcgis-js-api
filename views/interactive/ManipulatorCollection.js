/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/Collection","../../core/maybe"],(function(t,i,a,e){"use strict";var o;t.ManipulatorVisibilityPredicate=void 0,(o=t.ManipulatorVisibilityPredicate||(t.ManipulatorVisibilityPredicate={}))[o.WhenToolEditable=0]="WhenToolEditable",o[o.WhenToolNotEditable=1]="WhenToolNotEditable",o[o.Always=2]="Always";let n=function(){function o(){this._isToolEditable=!0,this._manipulators=new a,this._resourceContexts={manipulator3D:{}},this._attached=!1}var n=o.prototype;return n.add=function(i,a=t.ManipulatorVisibilityPredicate.WhenToolEditable){this.addMany([i],a)},n.addMany=function(i,a=t.ManipulatorVisibilityPredicate.WhenToolEditable){for(const t of i){const i={manipulator:t,visibilityPredicate:a,attached:!1};this._manipulators.add(i),this._attached&&this._updateManipulatorAttachment(i)}},n.remove=function(t){for(let i=0;i<this._manipulators.length;i++)if(this._manipulators.getItemAt(i).manipulator===t){const t=this._manipulators.splice(i,1)[0];this._detachManipulator(t);break}},n.removeAll=function(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._manipulators.removeAll()},n.attach=function(){this._manipulators.forEach((t=>{this._updateManipulatorAttachment(t)})),this._attached=!0},n.detach=function(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._attached=!1},n.destroy=function(){this.detach(),this._manipulators.forEach((({manipulator:t})=>{t.destroy&&t.destroy()})),this._manipulators.destroy(),this._resourceContexts=null},n.on=function(t,i){return this._manipulators.on(t,(t=>{i(t)}))},n.forEach=function(t){for(const i of this._manipulators.items)t(i)},n.some=function(t){return this._manipulators.items.some(t)},n.toArray=function(){const t=[];return this.forEach((i=>t.push(i.manipulator))),t},n.intersect=function(t,i){let a=null,o=Number.MAX_VALUE;return this._manipulators.forEach((({manipulator:n,attached:r})=>{if(!r||!n.interactive)return;const l=n.intersectionDistance(t,i);e.isSome(l)&&l<o&&(o=l,a=n)})),a},n._updateManipulatorAttachment=function(t){this._isManipulatorItemVisible(t)?this._attachManipulator(t):this._detachManipulator(t)},n._attachManipulator=function(t){t.attached||(t.manipulator.attach&&t.manipulator.attach(this._resourceContexts),t.attached=!0)},n._detachManipulator=function(t){if(!t.attached)return;const i=t.manipulator;i.grabbing=!1,i.dragging=!1,i.hovering=!1,i.selected=!1,i.detach&&i.detach(this._resourceContexts),t.attached=!1},n._isManipulatorItemVisible=function(i){return i.visibilityPredicate===t.ManipulatorVisibilityPredicate.Always||(this._isToolEditable?i.visibilityPredicate===t.ManipulatorVisibilityPredicate.WhenToolEditable:i.visibilityPredicate===t.ManipulatorVisibilityPredicate.WhenToolNotEditable)},i._createClass(o,[{key:"isToolEditable",set:function(t){this._isToolEditable=t}},{key:"length",get:function(){return this._manipulators.length}}]),o}();t.ManipulatorCollection=n,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
