/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/Collection","../../core/maybe"],(function(t,i,a,n){"use strict";let e=function(){function t(){this._isToolEditable=!0,this._manipulators=new a,this._nextManipulatorId=0,this._resourceContexts={manipulator3D:{}},this._attached=!1}var e=t.prototype;return e.add=function(t,i=0){return this.addMany([t],i)[0]},e.addMany=function(t,i=0){return t.map((t=>{const a=this._nextManipulatorId++,n={id:a,manipulator:t,visibilityPredicate:i,attached:!1};return this._manipulators.add(n),this._attached&&this._updateManipulatorAttachment(n),a}))},e.remove=function(t){if("number"==typeof t){const i=t;for(let t=0;t<this._manipulators.length;t++)if(this._manipulators.getItemAt(t).id===i){const i=this._manipulators.splice(t,1)[0];return this._detachManipulator(i),i.id}return null}const i=t;for(let a=0;a<this._manipulators.length;a++)if(this._manipulators.getItemAt(a).manipulator===i){const t=this._manipulators.splice(a,1)[0];return this._detachManipulator(t),t.id}return null},e.removeAll=function(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._manipulators.removeAll()},e.attach=function(){this._manipulators.forEach((t=>{this._updateManipulatorAttachment(t)})),this._attached=!0},e.detach=function(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._attached=!1},e.destroy=function(){this._manipulators.forEach((({manipulator:t})=>{t.destroy&&t.destroy()})),this._manipulators.destroy(),this._resourceContexts=null},e.on=function(t,i){return this._manipulators.on(t,(t=>{i(t)}))},e.forEach=function(t){for(const i of this._manipulators.items)t(i)},e.some=function(t){return this._manipulators.items.some(t)},e.toArray=function(){const t=[];return this.forEach((i=>t.push(i.manipulator))),t},e.intersect=function(t,i){let a=null,e=Number.MAX_VALUE;return this._manipulators.forEach((({id:o,manipulator:r,attached:s})=>{if(!s||!r.interactive)return;const u=r.intersectionDistance(t,i);n.isSome(u)&&u<e&&(e=u,a={id:o,manipulator:r})})),a},e.findById=function(t){if(n.isNone(t))return null;for(const i of this._manipulators.items)if(t===i.id)return i.manipulator;return null},e._updateManipulatorAttachment=function(t){this._isManipulatorItemVisible(t)?this._attachManipulator(t):this._detachManipulator(t)},e._attachManipulator=function(t){t.attached||(t.manipulator.attach&&t.manipulator.attach(this._resourceContexts),t.attached=!0)},e._detachManipulator=function(t){if(!t.attached)return;const i=t.manipulator;i.grabbing=!1,i.dragging=!1,i.hovering=!1,i.selected=!1,i.detach&&i.detach(this._resourceContexts),t.attached=!1},e._isManipulatorItemVisible=function(t){return 2===t.visibilityPredicate||(this._isToolEditable?0===t.visibilityPredicate:1===t.visibilityPredicate)},i._createClass(t,[{key:"isToolEditable",set:function(t){this._isToolEditable=t}},{key:"length",get:function(){return this._manipulators.length}}]),t}();t.ManipulatorCollection=e,Object.defineProperty(t,"__esModule",{value:!0})}));
