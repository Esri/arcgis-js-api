// COPYRIGHT Â© 2020 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.17/esri/copyright.txt for details.

define(["require","exports","tslib"],(function(t,e,i){"use strict";function n(t){return d.intern(t)}function s(t){return _.intern(t)}function l(t){return v.intern(t)}function r(t){return S.intern(t)}function o(t){return y.intern(t)}function a(t){return T.intern(t)}function u(t){return k.intern(t)}function p(t){return C.intern(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.StateTracker=e.makePipelineState=e.makeStencilWrite=e.makeColorWrite=e.makeDepthWrite=e.makeStencilTest=e.makeDepthTest=e.makePolygonOffset=e.makeCulling=e.makeBlending=e.defaultColorWriteParams=e.defaultDepthWriteParams=e.backFaceCullingParams=e.separateBlendingParams=e.simpleBlendingParams=void 0,e.simpleBlendingParams=function(t,e,i,n){return void 0===i&&(i=32774),void 0===n&&(n=[0,0,0,0]),{srcRgb:t,srcAlpha:t,dstRgb:e,dstAlpha:e,opRgb:i,opAlpha:i,color:{r:n[0],g:n[1],b:n[2],a:n[3]}}},e.separateBlendingParams=function(t,e,i,n,s,l,r){return void 0===s&&(s=32774),void 0===l&&(l=32774),void 0===r&&(r=[0,0,0,0]),{srcRgb:t,srcAlpha:e,dstRgb:i,dstAlpha:n,opRgb:s,opAlpha:l,color:{r:r[0],g:r[1],b:r[2],a:r[3]}}},e.backFaceCullingParams={face:1029,mode:2305},e.defaultDepthWriteParams={zNear:0,zFar:1},e.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0},e.makeBlending=n,e.makeCulling=s,e.makePolygonOffset=l,e.makeDepthTest=r,e.makeStencilTest=o,e.makeDepthWrite=a,e.makeColorWrite=u,e.makeStencilWrite=p,e.makePipelineState=function(t){return D.intern(t)};var h=function(){function t(t,e){this.makeKey=t,this.makeRef=e,this.interns=new Map}return t.prototype.intern=function(t){if(!t)return null;var e=this.makeKey(t),i=this.interns;return i.has(e)||i.set(e,this.makeRef(t)),i.get(e)},t}();function c(t){return"["+t.join(",")+"]"}var d=new h(f,(function(t){return i.__assign({__tag:"Blending"},t)}));function f(t){return t?c([t.srcRgb,t.srcAlpha,t.dstRgb,t.dstAlpha,t.opRgb,t.opAlpha,t.color.r,t.color.g,t.color.b,t.color.a]):null}var _=new h(g,(function(t){return i.__assign({__tag:"Culling"},t)}));function g(t){return t?c([t.face,t.mode]):null}var v=new h(W,(function(t){return i.__assign({__tag:"PolygonOffset"},t)}));function W(t){return t?c([t.factor,t.units]):null}var S=new h(I,(function(t){return i.__assign({__tag:"DepthTest"},t)}));function I(t){return t?c([t.func]):null}var y=new h(m,(function(t){return i.__assign({__tag:"StencilTest"},t)}));function m(t){return t?c([t.function.func,t.function.ref,t.function.mask,t.operation.fail,t.operation.zFail,t.operation.zPass]):null}var T=new h(b,(function(t){return i.__assign({__tag:"DepthWrite"},t)}));function b(t){return t?c([t.zNear,t.zFar]):null}var k=new h(P,(function(t){return i.__assign({__tag:"ColorWrite"},t)}));function P(t){return t?c([t.r,t.g,t.b,t.a]):null}var C=new h(O,(function(t){return i.__assign({__tag:"StencilWrite"},t)}));function O(t){return t?c([t.mask]):null}var D=new h((function(t){return t?c([f(t.blending),g(t.culling),W(t.polygonOffset),I(t.depthTest),m(t.stencilTest),b(t.depthWrite),P(t.colorWrite),O(t.stencilWrite)]):null}),(function(t){return{blending:n(t.blending),culling:s(t.culling),polygonOffset:l(t.polygonOffset),depthTest:r(t.depthTest),stencilTest:o(t.stencilTest),depthWrite:a(t.depthWrite),colorWrite:u(t.colorWrite),stencilWrite:p(t.stencilWrite)}}));var B=function(){function t(t){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._stateSetters=t}return t.prototype.setPipeline=function(t){(this._pipelineInvalid||t!==this._pipeline)&&(this.setBlending(t.blending),this.setCulling(t.culling),this.setPolygonOffset(t.polygonOffset),this.setDepthTest(t.depthTest),this.setStencilTest(t.stencilTest),this.setDepthWrite(t.depthWrite),this.setColorWrite(t.colorWrite),this.setStencilWrite(t.stencilWrite),this._pipeline=t),this._pipelineInvalid=!1},t.prototype.invalidateBlending=function(){this._blendingInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidateCulling=function(){this._cullingInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidatePolygonOffset=function(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidateDepthTest=function(){this._depthTestInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidateStencilTest=function(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidateDepthWrite=function(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidateColorWrite=function(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0},t.prototype.invalidateStencilWrite=function(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0},t.prototype.setBlending=function(t){this._blending=this.setSubState(t,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1},t.prototype.setCulling=function(t){this._culling=this.setSubState(t,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1},t.prototype.setPolygonOffset=function(t){this._polygonOffset=this.setSubState(t,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1},t.prototype.setDepthTest=function(t){this._depthTest=this.setSubState(t,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1},t.prototype.setStencilTest=function(t){this._stencilTest=this.setSubState(t,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1},t.prototype.setDepthWrite=function(t){this._depthWrite=this.setSubState(t,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1},t.prototype.setColorWrite=function(t){this._colorWrite=this.setSubState(t,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1},t.prototype.setStencilWrite=function(t){this._stencilWrite=this.setSubState(t,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1},t.prototype.setSubState=function(t,e,i,n){return(i||t!==e)&&(n(t),this._pipelineInvalid=!0),t},t}();e.StateTracker=B}));