/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../core/typedArrayUtil","./checkWebGLError"],(function(e,t,i){"use strict";return function(){function n(e,t,n,s,r){this._context=e,this.bufferType=t,this.usage=n,this._glName=null,this._size=-1,this._indexType=void 0,e.instanceCounter.increment(1,this),this._glName=this._context.gl.createBuffer(),i.checkWebGLError(this._context.gl),s&&this.setData(s,r)}n.createIndex=function(e,t,i,s){return new n(e,34963,t,i,s)},n.createVertex=function(e,t,i){return new n(e,34962,t,i)};var s=n.prototype;return s.dispose=function(){if(this._context){if(this._glName){this._context.gl.deleteBuffer(this._glName),this._glName=null}this._context.instanceCounter.decrement(1,this),this._context=null}},s.setData=function(e,i){if(!e)return;if("number"==typeof e){if(e<0&&console.error("Buffer size cannot be negative!"),34963===this.bufferType&&i)switch(this._indexType=i,this._size=e,i){case 5123:e*=2;break;case 5125:e*=4}}else{let i=e.byteLength;t.isUint16Array(e)&&(i/=2,this._indexType=5123),t.isUint32Array(e)&&(i/=4,this._indexType=5125),this._size=i}const n=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);this._context.gl.bufferData(this.bufferType,e,this.usage),this._context.bindVAO(n)},s.setSubData=function(e,i=0,n=0,s=e.byteLength){if(!e)return;(i<0||i>=this._size)&&console.error("offset is out of range!");let r=i,o=n,h=s,u=e.byteLength;t.isUint16Array(e)&&(u/=2,r*=2,o*=2,h*=2),t.isUint32Array(e)&&(u/=4,r*=4,o*=4,h*=4),void 0===s&&(s=u-1),n>=s&&console.error("end must be bigger than start!"),i+n-s>this._size&&console.error("An attempt to write beyond the end of the buffer!");const c=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);const f=this._context.gl,a=ArrayBuffer.isView(e)?e.buffer:e,_=0===o&&h===e.byteLength?a:a.slice(o,h);f.bufferSubData(this.bufferType,r,_),this._context.bindVAO(c)},e._createClass(n,[{key:"glName",get:function(){return this._glName}},{key:"size",get:function(){return this._size}},{key:"indexType",get:function(){return this._indexType}},{key:"byteSize",get:function(){return 34962===this.bufferType?this._size:5125===this._indexType?4*this._size:2*this._size}}]),n}()}));
