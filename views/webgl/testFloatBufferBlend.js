/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../3d/webgl-engine/lib/OrderIndependentTransparency","../../chunks/webgl-debug","./BufferObject","./context-util","./enums","./FramebufferObject","./renderState","./VertexArrayObject","./VertexElementDescriptor","./WebGLDriverTestModule"],(function(e,t,r,i,a,n,o,l,s,p,u,c){"use strict";let d=function(e){function c(r){var i;if((i=e.call(this)||this)._rctx=r,!r.gl)return t._assertThisInitialized(i);if(r.type===n.ContextType.WEBGL1)return i._result=!(!r.capabilities.textureFloat?.textureFloat||!r.capabilities.colorBufferFloat?.textureFloat),t._assertThisInitialized(i);if(!(r.capabilities.textureFloat?.textureFloat&&r.capabilities.colorBufferFloat?.textureFloat&&r.capabilities.colorBufferFloat?.floatBlend))return t._assertThisInitialized(i);const a="\n    precision highp float;\n    attribute vec2 a_pos;\n\n    void main() {\n      gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ",o="\n     precision highp float;\n\n     void main() {\n      gl_FragColor = vec4(0.5, 0.5, 0.5, 0.5);\n     }\n    ";return i._program=r.programCache.acquire(a,o,new Map([["a_pos",0]])),i}return t._inheritsLoose(c,e),c.prototype._test=function(e){const t=this._rctx,n=new l.FramebufferObject(t,{colorTarget:o.TargetType.TEXTURE,depthStencilTarget:o.DepthStencilTargetType.NONE},{target:o.TextureType.TEXTURE_2D,wrapMode:o.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:o.PixelFormat.RGBA,dataType:o.PixelType.FLOAT,internalFormat:o.SizedPixelFormat.RGBA32F,samplingMode:o.TextureSamplingMode.NEAREST,width:1,height:1}),c=a.BufferObject.createVertex(t,o.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),d=new p.VertexArrayObject(t,new Map([["a_pos",0]]),{geometry:[new u.VertexElementDescriptor("a_pos",2,o.DataType.UNSIGNED_SHORT,0,4)]},{geometry:c});t.useProgram(e);const b=t.getBoundFramebufferObject(),{x:T,y:f,width:g,height:m}=t.getViewport();t.bindFramebuffer(n),t.setViewport(0,0,1,1),t.bindVAO(d),t.drawArrays(o.PrimitiveType.TRIANGLE_STRIP,0,4);const x=s.makePipelineState({blending:r.blendingAlpha});t.setPipelineState(x),t.drawArrays(o.PrimitiveType.TRIANGLE_STRIP,0,4),i.webglDebugExports.init(t);const _=t.gl.getError();return t.setViewport(T,f,g,m),t.bindFramebuffer(b),d.dispose(!1),c.dispose(),n.dispose(),1282!==_||(console.warn("Device claims support for WebGL extension EXT_float_blend but does not support it. Using fall back."),!1)},c}(c.WebGLDriverTestModule);e.FloatBufferBlend=d,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
