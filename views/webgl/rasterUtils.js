/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","./context-util","./enums","./FramebufferObject","./Texture"],(function(e,t,r,i,n){"use strict";function a(e,i,a="nearest",o=!1){var u;const m=!(o&&"u8"===i.pixelType),s=m?r.PixelType.FLOAT:r.PixelType.UNSIGNED_BYTE,l=null==i.pixels||0===i.pixels.length?null:m?i.getAsRGBAFloat():i.getAsRGBA(),f=null==(u=e.capabilities.textureFloat)?void 0:u.textureFloatLinear,T={width:i.width,height:i.height,target:r.TextureType.TEXTURE_2D,pixelFormat:r.PixelFormat.RGBA,internalFormat:e.type===t.ContextType.WEBGL2&&m?r.SizedPixelFormat.RGBA32F:r.PixelFormat.RGBA,samplingMode:!f||"bilinear"!==a&&"cubic"!==a?r.TextureSamplingMode.NEAREST:r.TextureSamplingMode.LINEAR,dataType:s,wrapMode:r.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1};return new n.Texture(e,T,l)}function o(e,t,a,o){const u=o?r.PixelType.UNSIGNED_BYTE:r.PixelType.FLOAT,m={width:t,height:a,target:r.TextureType.TEXTURE_2D,pixelFormat:r.PixelFormat.RGBA,internalFormat:r.PixelFormat.RGBA,samplingMode:r.TextureSamplingMode.NEAREST,dataType:u,wrapMode:r.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},s=new n.Texture(e,m);return new i.FramebufferObject(e,{colorTarget:r.TargetType.TEXTURE,depthStencilTarget:r.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER,width:t,height:a},s)}function u(e,i){const{spacing:a,offsets:o,coefficients:u,size:[m,s]}=i,l=a[0]>1,f={width:l?4*m:m,height:s,target:r.TextureType.TEXTURE_2D,pixelFormat:r.PixelFormat.RGBA,internalFormat:e.type===t.ContextType.WEBGL2?r.SizedPixelFormat.RGBA32F:r.PixelFormat.RGBA,dataType:r.PixelType.FLOAT,samplingMode:r.TextureSamplingMode.NEAREST,wrapMode:r.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},T=new Float32Array(l?m*s*16:2*o.length);if(l)for(let t=0,r=0;t<u.length;t++)T[r++]=u[t],t%3==2&&(T[r++]=1);else for(let t=0;t<s;t++)for(let e=0;e<m;e++){const r=4*(t*m+e),i=2*(e*s+t);T[r]=o[i],T[r+1]=o[i+1],T[r+3]=-1===o[i]?0:1}return new n.Texture(e,f,T)}function m(e,t){const i={width:t.length/4,height:1,target:r.TextureType.TEXTURE_2D,pixelFormat:r.PixelFormat.RGBA,internalFormat:r.PixelFormat.RGBA,dataType:r.PixelType.UNSIGNED_BYTE,samplingMode:r.TextureSamplingMode.NEAREST,wrapMode:r.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1};return new n.Texture(e,i,t)}function s(e,t,r,i=1,n=!0,a=!1){return{u_flipY:n,u_isFloatTexture:a,u_applyTransform:!!e,u_opacity:i,u_transformSpacing:e?e.spacing:null,u_transformGridSize:e?e.size:null,u_targetImageSize:t,u_srcImageSize:r}}function l(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:null}}function f(e,t){return{u_scale:e,u_offset:t}}function T(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function p(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function c(e,t){const r=e.gl,i=t.glName,n=r.getProgramParameter(i,r.ACTIVE_UNIFORMS),a=new Map;let o;for(let u=0;u<n;u++)o=r.getActiveUniform(i,u),o&&a.set(o.name,{location:r.getUniformLocation(i,o.name),info:o});return a}function x(e,t,r){Object.keys(r).forEach((i=>{const n=t.get(i)||t.get(i+"[0]");n&&g(e,i,r[i],n)}))}function _(e,t,r,i){r.length===i.length&&(i.some((e=>null==e))||r.some((e=>null==e))||r.forEach(((r,n)=>{t.setUniform1i(r,n),e.bindTexture(i[n],n)})))}function g(e,t,i,n){if(null===n||null==i)return!1;const{info:a}=n;switch(a.type){case r.UniformType.FLOAT:a.size>1?e.setUniform1fv(t,i):e.setUniform1f(t,i);break;case r.UniformType.FLOAT_VEC2:e.setUniform2fv(t,i);break;case r.UniformType.FLOAT_VEC3:e.setUniform3fv(t,i);break;case r.UniformType.FLOAT_VEC4:e.setUniform4fv(t,i);break;case r.UniformType.FLOAT_MAT3:e.setUniformMatrix3fv(t,i);break;case r.UniformType.FLOAT_MAT4:e.setUniformMatrix4fv(t,i);break;case r.UniformType.INT:a.size>1?e.setUniform1iv(t,i):e.setUniform1i(t,i);break;case r.UniformType.BOOL:e.setUniform1i(t,i?1:0);break;case r.UniformType.INT_VEC2:case r.UniformType.BOOL_VEC2:e.setUniform2iv(t,i);break;case r.UniformType.INT_VEC3:case r.UniformType.BOOL_VEC3:e.setUniform3iv(t,i);break;case r.UniformType.INT_VEC4:case r.UniformType.BOOL_VEC4:e.setUniform4iv(t,i);break;default:return!1}return!0}e.createColormapTexture=m,e.createFrameBuffer=o,e.createRasterTexture=a,e.createTransformTexture=u,e.getBasicGridUniforms=f,e.getColormapUniforms=l,e.getCommonUniforms=s,e.getShadedReliefUniforms=p,e.getStretchUniforms=T,e.getUniformLocationInfos=c,e.setTextures=_,e.setUniforms=x,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
