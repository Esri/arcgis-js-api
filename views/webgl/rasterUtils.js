/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../core/maybe","../../chunks/vec2f64","./context-util","./enums","./Texture"],(function(e,t,r,n,i,o){"use strict";function a(e,t,r="nearest",a=!1){const u=!(a&&"u8"===t.pixelType),s=u?i.PixelType.FLOAT:i.PixelType.UNSIGNED_BYTE,f=null==t.pixels||0===t.pixels.length?null:u?t.getAsRGBAFloat():t.getAsRGBA(),m=e.capabilities.textureFloat?.textureFloatLinear,l={width:t.width,height:t.height,target:i.TextureType.TEXTURE_2D,pixelFormat:i.PixelFormat.RGBA,internalFormat:e.type===n.ContextType.WEBGL2&&u?i.SizedPixelFormat.RGBA32F:i.PixelFormat.RGBA,samplingMode:!m||"bilinear"!==r&&"cubic"!==r?i.TextureSamplingMode.NEAREST:i.TextureSamplingMode.LINEAR,dataType:s,wrapMode:i.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1};return new o.Texture(e,l,f)}function u(e,t){const{spacing:r,offsets:a,coefficients:u,size:[s,f]}=t,m=r[0]>1,l={width:m?4*s:s,height:f,target:i.TextureType.TEXTURE_2D,pixelFormat:i.PixelFormat.RGBA,internalFormat:e.type===n.ContextType.WEBGL2?i.SizedPixelFormat.RGBA32F:i.PixelFormat.RGBA,dataType:i.PixelType.FLOAT,samplingMode:i.TextureSamplingMode.NEAREST,wrapMode:i.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},T=new Float32Array(m?s*f*16:2*a.length);if(m&&null!=u)for(let n=0,i=0;n<u.length;n++)T[i++]=u[n],n%3==2&&(T[i++]=1);else for(let n=0;n<f;n++)for(let e=0;e<s;e++){const t=4*(n*s+e),r=2*(e*f+n);T[t]=a[r],T[t+1]=a[r+1],T[t+3]=-1===a[r]?0:1}return new o.Texture(e,l,T)}function s(e,t){const r={width:t.length/4,height:1,target:i.TextureType.TEXTURE_2D,pixelFormat:i.PixelFormat.RGBA,internalFormat:i.PixelFormat.RGBA,dataType:i.PixelType.UNSIGNED_BYTE,samplingMode:i.TextureSamplingMode.NEAREST,wrapMode:i.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1};return new o.Texture(e,r,t)}function f(e,t,n,i=1,o=!0){return{u_flipY:o,u_applyTransform:!!e,u_opacity:i,u_transformSpacing:e?e.spacing:r.ZEROS,u_transformGridSize:e?e.size:r.ZEROS,u_targetImageSize:t,u_srcImageSize:n}}function m(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:0}}function l(e,t){return{u_scale:e,u_offset:t}}function T(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function c(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function p(e,r){const n=e.gl,i=r.glName,o=new Map;if(t.isNone(i))return o;const a=n.getProgramParameter(i,n.ACTIVE_UNIFORMS);let u;for(let t=0;t<a;t++)u=n.getActiveUniform(i,t),u&&o.set(u.name,{location:n.getUniformLocation(i,u.name),info:u});return o}function x(e,t,r){Object.keys(r).forEach((n=>{const i=t.get(n)||t.get(n+"[0]");i&&_(e,n,r[n],i)}))}function g(e,t,r,n){r.length===n.length&&(n.some((e=>null==e))||r.some((e=>null==e))||r.forEach(((r,i)=>{t.setUniform1i(r,i),e.bindTexture(n[i],i)})))}function _(e,t,r,n){if(null===n||null==r)return!1;const{info:o}=n;switch(o.type){case i.UniformType.FLOAT:o.size>1?e.setUniform1fv(t,r):e.setUniform1f(t,r);break;case i.UniformType.FLOAT_VEC2:e.setUniform2fv(t,r);break;case i.UniformType.FLOAT_VEC3:e.setUniform3fv(t,r);break;case i.UniformType.FLOAT_VEC4:e.setUniform4fv(t,r);break;case i.UniformType.FLOAT_MAT3:e.setUniformMatrix3fv(t,r);break;case i.UniformType.FLOAT_MAT4:e.setUniformMatrix4fv(t,r);break;case i.UniformType.INT:o.size>1?e.setUniform1iv(t,r):e.setUniform1i(t,r);break;case i.UniformType.BOOL:e.setUniform1i(t,r?1:0);break;case i.UniformType.INT_VEC2:case i.UniformType.BOOL_VEC2:e.setUniform2iv(t,r);break;case i.UniformType.INT_VEC3:case i.UniformType.BOOL_VEC3:e.setUniform3iv(t,r);break;case i.UniformType.INT_VEC4:case i.UniformType.BOOL_VEC4:e.setUniform4iv(t,r);break;default:return!1}return!0}e.createColormapTexture=s,e.createRasterTexture=a,e.createTransformTexture=u,e.getBasicGridUniforms=l,e.getColormapUniforms=m,e.getCommonUniforms=f,e.getShadedReliefUniforms=c,e.getStretchUniforms=T,e.getUniformLocationInfos=p,e.setTextures=g,e.setUniforms=x,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
