/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../chunks/vec2f64","./context-util","./enums","./Texture"],(function(e,t,r,n,i){"use strict";function o(e,t,o="nearest",a=!1){const u=!(a&&"u8"===t.pixelType),s=u?n.PixelType.FLOAT:n.PixelType.UNSIGNED_BYTE,f=null==t.pixels||0===t.pixels.length?null:u?t.getAsRGBAFloat():t.getAsRGBA(),m=e.capabilities.textureFloat?.textureFloatLinear,l={width:t.width,height:t.height,target:n.TextureType.TEXTURE_2D,pixelFormat:n.PixelFormat.RGBA,internalFormat:e.type===r.ContextType.WEBGL2&&u?n.SizedPixelFormat.RGBA32F:n.PixelFormat.RGBA,samplingMode:!m||"bilinear"!==o&&"cubic"!==o?n.TextureSamplingMode.NEAREST:n.TextureSamplingMode.LINEAR,dataType:s,wrapMode:n.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1};return new i.Texture(e,l,f)}function a(e,t){const{spacing:o,offsets:a,coefficients:u,size:[s,f]}=t,m=o[0]>1,l={width:m?4*s:s,height:f,target:n.TextureType.TEXTURE_2D,pixelFormat:n.PixelFormat.RGBA,internalFormat:e.type===r.ContextType.WEBGL2?n.SizedPixelFormat.RGBA32F:n.PixelFormat.RGBA,dataType:n.PixelType.FLOAT,samplingMode:n.TextureSamplingMode.NEAREST,wrapMode:n.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},T=new Float32Array(m?s*f*16:2*a.length);if(m)for(let r=0,n=0;r<u.length;r++)T[n++]=u[r],r%3==2&&(T[n++]=1);else for(let r=0;r<f;r++)for(let e=0;e<s;e++){const t=4*(r*s+e),n=2*(e*f+r);T[t]=a[n],T[t+1]=a[n+1],T[t+3]=-1===a[n]?0:1}return new i.Texture(e,l,T)}function u(e,t){const r={width:t.length/4,height:1,target:n.TextureType.TEXTURE_2D,pixelFormat:n.PixelFormat.RGBA,internalFormat:n.PixelFormat.RGBA,dataType:n.PixelType.UNSIGNED_BYTE,samplingMode:n.TextureSamplingMode.NEAREST,wrapMode:n.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1};return new i.Texture(e,r,t)}function s(e,r,n,i=1,o=!0){return{u_flipY:o,u_applyTransform:!!e,u_opacity:i,u_transformSpacing:e?e.spacing:t.ZEROS,u_transformGridSize:e?e.size:t.ZEROS,u_targetImageSize:r,u_srcImageSize:n}}function f(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:0}}function m(e,t){return{u_scale:e,u_offset:t}}function l(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function T(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function c(e,t){const r=e.gl,n=t.glName,i=r.getProgramParameter(n,r.ACTIVE_UNIFORMS),o=new Map;let a;for(let u=0;u<i;u++)a=r.getActiveUniform(n,u),a&&o.set(a.name,{location:r.getUniformLocation(n,a.name),info:a});return o}function p(e,t,r){Object.keys(r).forEach((n=>{const i=t.get(n)||t.get(n+"[0]");i&&_(e,n,r[n],i)}))}function x(e,t,r,n){r.length===n.length&&(n.some((e=>null==e))||r.some((e=>null==e))||r.forEach(((r,i)=>{t.setUniform1i(r,i),e.bindTexture(n[i],i)})))}function _(e,t,r,i){if(null===i||null==r)return!1;const{info:o}=i;switch(o.type){case n.UniformType.FLOAT:o.size>1?e.setUniform1fv(t,r):e.setUniform1f(t,r);break;case n.UniformType.FLOAT_VEC2:e.setUniform2fv(t,r);break;case n.UniformType.FLOAT_VEC3:e.setUniform3fv(t,r);break;case n.UniformType.FLOAT_VEC4:e.setUniform4fv(t,r);break;case n.UniformType.FLOAT_MAT3:e.setUniformMatrix3fv(t,r);break;case n.UniformType.FLOAT_MAT4:e.setUniformMatrix4fv(t,r);break;case n.UniformType.INT:o.size>1?e.setUniform1iv(t,r):e.setUniform1i(t,r);break;case n.UniformType.BOOL:e.setUniform1i(t,r?1:0);break;case n.UniformType.INT_VEC2:case n.UniformType.BOOL_VEC2:e.setUniform2iv(t,r);break;case n.UniformType.INT_VEC3:case n.UniformType.BOOL_VEC3:e.setUniform3iv(t,r);break;case n.UniformType.INT_VEC4:case n.UniformType.BOOL_VEC4:e.setUniform4iv(t,r);break;default:return!1}return!0}e.createColormapTexture=u,e.createRasterTexture=o,e.createTransformTexture=a,e.getBasicGridUniforms=m,e.getColormapUniforms=f,e.getCommonUniforms=s,e.getShadedReliefUniforms=T,e.getStretchUniforms=l,e.getUniformLocationInfos=c,e.setTextures=x,e.setUniforms=p,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
