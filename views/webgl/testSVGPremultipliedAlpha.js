/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../2d/engine/webgl/DefaultVertexAttributeLayouts","./BufferObject","./enums","./FramebufferObject","./Texture","./VertexArrayObject","./WebGLDriverTestModule"],(function(e,t,r,i,a,n,o,s,p){"use strict";let l=function(e){function p(t){var r;(r=e.call(this)||this)._rctx=t,r._image=new Image,r._image.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",r._image.width=5,r._image.height=5,r._image.decode();const i="\n    precision highp float;\n\n    attribute vec2 a_pos;\n    varying vec2 v_uv;\n\n    void main() {\n      v_uv = a_pos;\n      gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ",a="\n    precision highp float;\n\n    varying vec2 v_uv;\n    uniform sampler2D u_texture;\n\n    void main() {\n      gl_FragColor = texture2D(u_texture, v_uv);\n    }\n    ";return r._program=t.programCache.acquire(i,a,new Map([["a_pos",0]])),r}t._inheritsLoose(p,e);var l=p.prototype;return l.dispose=function(){e.prototype.dispose.call(this),this._image.src=""},l._test=function(e){const t=this._rctx;if(!t.gl)return e.dispose(),!0;const p=new n.FramebufferObject(t,{colorTarget:a.TargetType.TEXTURE,depthStencilTarget:a.DepthStencilTargetType.NONE},{target:a.TextureType.TEXTURE_2D,wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:a.PixelFormat.RGBA,dataType:a.PixelType.UNSIGNED_BYTE,samplingMode:a.TextureSamplingMode.NEAREST,width:1,height:1}),l=i.BufferObject.createVertex(t,a.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),u=new s.VertexArrayObject(t,new Map([["a_pos",0]]),r.Pos2us,{geometry:l}),g=new o.Texture(t,{dataType:a.PixelType.UNSIGNED_BYTE,pixelFormat:a.PixelFormat.RGBA,preMultiplyAlpha:!1,wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:a.TextureSamplingMode.LINEAR},this._image);t.useProgram(e),t.bindTexture(g,0),e.setUniform1i("u_texture",0);const d=t.getBoundFramebufferObject(),{x:c,y:T,width:m,height:_}=t.getViewport();t.bindFramebuffer(p),t.setViewport(0,0,1,1),t.setClearColor(0,0,0,0),t.setBlendingEnabled(!1),t.clearSafe(a.ClearBufferBit.COLOR_BUFFER_BIT),t.bindVAO(u),t.drawArrays(a.PrimitiveType.TRIANGLE_STRIP,0,4);const f=new Uint8Array(4);return p.readPixels(0,0,1,1,a.PixelFormat.RGBA,a.PixelType.UNSIGNED_BYTE,f),u.dispose(!1),l.dispose(),p.dispose(),g.dispose(),t.setViewport(c,T,m,_),t.bindFramebuffer(d),255!==f[0]},p}(p.WebGLDriverTestModule);e.SVGPremultipliedAlpha=l,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
