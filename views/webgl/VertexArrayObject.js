/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","./Util"],(function(t,i){"use strict";let e=function(){function e(t,i,e,s,r){this._context=t,this._locations=i,this._layout=e,this._buffers=s,this._indexBuffer=r,this._glName=null,this.id=n++,this._initialized=!1,t.instanceCounter.increment(2,this)}var s=e.prototype;return s.dispose=function(t=!0){if(!this._context)return;const i=this._context.capabilities.vao;i&&this._glName&&(i.deleteVertexArray(this._glName),this._glName=null);if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),t){for(const t in this._buffers)this._buffers[t].dispose(),delete this._buffers[t];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}this._context.instanceCounter.decrement(2,this),this._context=null},s.initialize=function(){if(this._initialized)return;const t=this._context.capabilities.vao;if(t){const i=t.createVertexArray();t.bindVertexArray(i),this._bindLayout(),t.bindVertexArray(null),this._glName=i}this._initialized=!0},s.bind=function(){this.initialize();const t=this._context.capabilities.vao;t?t.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())},s._bindLayout=function(){const t=this._buffers,e=!!this._context.capabilities.vao,n=this._layout,s=this._indexBuffer;t||console.error("Vertex buffer dictionary is empty!");const r=this._context.gl;for(const e in t){const s=t[e];s||console.error("Vertex buffer is uninitialized!");const r=n[e];r||console.error("Vertex element descriptor is empty!"),i.bindVertexBufferLayout(this._context,this._locations,s,r)}s&&(e?r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,s.glName):this._context.bindBuffer(s))},s.unbind=function(){this.initialize();const t=this._context.capabilities.vao;t?t.bindVertexArray(null):this._unbindLayout()},s._unbindLayout=function(){const t=this._buffers,e=this._layout;t||console.error("Vertex buffer dictionary is empty!");for(const n in t){const s=t[n];s||console.error("Vertex buffer is uninitialized!");const r=e[n];i.unbindVertexBufferLayout(this._context,this._locations,s,r)}const n=this._indexBuffer;n&&this._context.unbindBuffer(n.bufferType)},t._createClass(e,[{key:"glName",get:function(){return this._glName}},{key:"vertexBuffers",get:function(){return this._buffers}},{key:"indexBuffer",get:function(){return this._indexBuffer}},{key:"size",get:function(){return Object.keys(this._buffers).reduce(((t,i)=>t+this._buffers[i].size),this._indexBuffer?this._indexBuffer.size:0)}},{key:"layout",get:function(){return this._layout}},{key:"locations",get:function(){return this._locations}}]),e}(),n=0;return e}));
