/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../core/maybe","./capabilities/DisjointTimerQuery"],(function(e,t,r){"use strict";function i(e,r){const i=e.capabilities.disjointTimerQuery;return t.isNone(i)?null:new s(i,r)}let s=function(){function e(e,t){this._timer=e,this._queryPool=new Array,this._queryResults=new Map,this._currentQuery=null,t.forEach((e=>{const t=this._timer.createQuery(),r=this._timer.createQuery();this._queryPool.push(t,r),this._queryResults.set(e,null)}))}var i=e.prototype;return i.start=function(){r.hasRunningElapsedTimer||(this._currentQuery=this._queryPool.pop(),t.isNone(this._currentQuery)||(this._timer.disjoint(),this._timer.beginTimeElapsed(this._currentQuery)))},i.stop=function(e){if(this._timer.disjoint()||t.isNone(this._currentQuery)||!this._queryResults.has(e))return this.abort(),null;this._timer.endTimeElapsed();const r=this._queryResults.get(e);if(t.isNone(r))return this._queryResults.set(e,this._currentQuery),this._currentQuery=null,null;if(!this._timer.resultAvailable(r))return this._queryPool.unshift(this._currentQuery),this._currentQuery=null,null;const i=this._timer.getResult(r)/1e6;return this._queryPool.unshift(r),this._queryResults.set(e,this._currentQuery),this._currentQuery=null,i},i.abort=function(){t.isSome(this._currentQuery)&&(this._timer.deleteQuery(this._currentQuery),this._queryPool.unshift(this._timer.createQuery()),this._currentQuery=null)},i.dispose=function(){t.isSome(this._currentQuery)&&this._timer.deleteQuery(this._currentQuery),this._queryPool.forEach((e=>{this._timer.deleteQuery(e)})),this._queryResults.forEach((e=>{t.isNone(e)||this._timer.deleteQuery(e)}))},e}();e.createElapsedTimerPool=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
