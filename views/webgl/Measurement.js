/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../core/maybe","./capabilities/DisjointTimerQuery"],(function(e,t,i){"use strict";function r(e){const r=e.capabilities.disjointTimerQuery;return t.isNone(r)?null:r.timestampBits()>0?new u(r):i.hasRunningElapsedTimer?null:new s(r)}let s=function(){function e(e){this._timer=e,this._timer.disjoint(),this._query=this._timer.createQuery(),this._timer.beginTimeElapsed(this._query)}var i=e.prototype;return i.stop=function(e,t=50){this._timer.endTimeElapsed(),this._checkQueryResult(e,t)},i.abort=function(){this._deleteQuery()},i._deleteQuery=function(){this._query&&(this._timer.deleteQuery(this._query),this._query=null)},i._checkQueryResult=function(e,i){if(this._timer.disjoint())return this._deleteQuery(),void e(null);const r=t.unwrapOrThrow(this._query);if(!this._timer.resultAvailable(r))return void setTimeout((()=>this._checkQueryResult(e,i)),i);const s=this._timer.getResult(r);this._deleteQuery(),e(s/1e6)},e}(),u=function(){function e(e){this._timer=e,this._timer.disjoint(),this._start=this._timer.createQuery(),this._end=this._timer.createQuery(),this._timer.createTimestamp(this._start)}var i=e.prototype;return i.abort=function(){this._deleteQueries()},i.stop=function(e,i=50){this._timer.createTimestamp(t.unwrapOrThrow(this._end)),this._checkQueryResult(e,i)},i._deleteQueries=function(){this._start&&(this._timer.deleteQuery(this._start),this._start=null),this._end&&(this._timer.deleteQuery(this._end),this._end=null)},i._checkQueryResult=function(e,i){if(this._timer.disjoint())return this._deleteQueries(),void e(null);if(!(this._end&&this._timer.resultAvailable(this._end)))return void setTimeout((()=>this._checkQueryResult(e,i)),i);const r=this._timer.getResult(t.unwrapOrThrow(this._start)),s=this._timer.getResult(t.unwrapOrThrow(this._end));this._deleteQueries(),e((s-r)/1e6)},e}();e.startMeasurement=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
