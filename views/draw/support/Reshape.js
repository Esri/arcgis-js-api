/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../geometry","../../../Graphic","../../../core/asyncUtils","../../../core/Collection","../../../core/Error","../../../core/Evented","../../../core/Handles","../../../core/Logger","../../../core/maybe","../../../core/quantityUtils","../../../core/reactiveUtils","../../../core/screenUtils","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/ensureType","../../../core/arrayUtils","../../../core/accessorSupport/decorators/subclass","../../../geometry/support/coordsUtils","../../../layers/GraphicsLayer","../../../symbols/SimpleMarkerSymbol","../../ViewingMode","../../2d/interactive/SnappingVisualizer2D","./drawUtils","./GraphicMover","./HighlightHelper","./layerUtils","./settings","../../input/InputManager","../../interactive/keybindings","../../interactive/editGeometry/EditGeometryOperations","../../interactive/sketch/SketchTooltipOptions","../../interactive/snapping/SnappingContext","../../interactive/tooltip/Tooltip","../../interactive/tooltip/TranslateTooltipInfos","../../support/automaticAreaMeasurementUtils","../../support/automaticLengthMeasurementUtils","../../../geometry/Polyline","../../../geometry/Point"],(function(e,t,i,o,s,n,r,a,c,p,h,l,d,y,v,_,u,m,g,f,x,G,b,M,V,w,S,k,E,I,T,C,O,R,H,U,A,D,L){"use strict";let F=function(e,t,i){this.graphic=e,this.mover=t,this.selected=i,this.type="reshape-start"},z=function(e,t,i){this.graphic=e,this.mover=t,this.selected=i,this.type="reshape"},P=function(e,t,i){this.graphic=e,this.mover=t,this.selected=i,this.type="reshape-stop"},N=function(e,t,i){this.mover=e,this.dx=t,this.dy=i,this.type="move-start"},B=function(e,t,i){this.mover=e,this.dx=t,this.dy=i,this.type="move"},K=function(e,t,i){this.mover=e,this.dx=t,this.dy=i,this.type="move-stop"},q=function(e){this.added=e,this.type="vertex-select"},W=function(e){this.removed=e,this.type="vertex-deselect"},Y=function(e,t,i,o){this.added=e,this.graphic=t,this.oldGraphic=i,this.vertices=o,this.type="vertex-add"},j=function(e,t,i,o){this.removed=e,this.graphic=t,this.oldGraphic=i,this.vertices=o,this.type="vertex-remove"};const J=k.settings.reshapeGraphics,Q={vertices:{default:new x({style:"circle",size:J.vertex.size,color:J.vertex.color,outline:{color:J.vertex.outlineColor,width:1}}),hover:new x({style:"circle",size:J.vertex.hoverSize,color:J.vertex.hoverColor,outline:{color:J.vertex.hoverOutlineColor,width:1}}),selected:new x({style:"circle",size:J.selected.size,color:J.selected.color,outline:{color:J.selected.outlineColor,width:1}})},midpoints:{default:new x({style:"circle",size:J.midpoint.size,color:J.midpoint.color,outline:{color:J.midpoint.outlineColor,width:1}}),hover:new x({style:"circle",size:J.midpoint.size,color:J.midpoint.color,outline:{color:J.midpoint.outlineColor,width:1}})}};let X=function(t){function i(e){var i;return(i=t.call(this,e)||this)._activeOperationInfo=null,i._editGeometryOperations=null,i._handles=new c,i._graphicAttributes={esriSketchTool:"box"},i._mover=null,i._snappingContext=null,i._snappingTask=null,i._stagedVertex=null,i._tooltip=null,i._viewHandles=new c,i.callbacks={onReshapeStart(){},onReshape(){},onReshapeStop(){},onMoveStart(){},onMove(){},onMoveStop(){},onGraphicClick(){}},i.enableMidpoints=!0,i.enableMovement=!0,i.enableVertices=!0,i.graphic=null,i.layer=null,i.midpointGraphics=new n,i.midpointSymbol=new x({style:"circle",size:6,color:[200,200,200],outline:{color:[100,100,100],width:1}}),i.selectedVertices=[],i.snappingManager=null,i.tooltipOptions=new C,i.type="reshape",i.vertexGraphics=new n,i.view=null,i}e._inheritsLoose(i,t);var a=i.prototype;return a.initialize=function(){const e=this.view;this._highlightHelper=new w({view:e}),this._setup(),this._handles.add([d.when((()=>e?.ready),(()=>{const{layer:e,view:t}=this;S.addUniqueLayer(t,e),this._viewHandles.add(t.on("key-down",(e=>this._keyDownHandler(e)),E.ViewEventPriorities.TOOL))}),{once:!0,initial:!0}),d.pausable((()=>this.graphic),(()=>this.refresh())),d.pausable((()=>this.layer),((e,t)=>{t&&(this._clearSelection(),this._resetGraphics(t)),this.refresh()})),d.pausable((()=>this.enableMidpoints),(()=>this.refresh())),d.watch((()=>this.tooltipOptions.enabled),(e=>{this._tooltip=e?new R.Tooltip({view:this.view}):h.destroyMaybe(this._tooltip)}),d.syncAndInitial)])},a.destroy=function(){this._reset(),this._mover?.destroy(),this._mover=null,this._tooltip=h.destroyMaybe(this._tooltip),this._handles=h.destroyMaybe(this._handles),this._viewHandles=h.destroyMaybe(this._viewHandles)},a.isUIGraphic=function(e){const t=[];return this.graphic&&t.push(this.graphic),t.concat(this.vertexGraphics.items,this.midpointGraphics.items),t.length>0&&t.includes(e)},a.refresh=function(){this._reset(),this._setup()},a.reset=function(){this.graphic=null},a.clearSelection=function(){this._clearSelection()},a.removeSelectedVertices=function(){this.selectedVertices.length&&this._removeVertices(this.selectedVertices)},a._setup=function(){const{graphic:e,layer:t}=this;if(!t||!e||h.isNone(e.geometry))return;const i=e.geometry;"mesh"!==i.type&&"extent"!==i.type?("polygon"===i.type&&g.closeRingsAndFixWinding(i),this._setUpHighlights(),this._setupGraphics(),this._setupMover()):this._logGeometryTypeError()},a._setUpHighlights=function(){this.highlightsEnabled&&this.graphic&&this._highlightHelper.add(this.graphic)},a._setUpGeometryHelper=function(){const e=this.graphic.geometry;if(h.isNone(e)||"mesh"===e.type||"extent"===e.type)return void this._logGeometryTypeError();const t="multipoint"===e.type?new D({paths:e.points,spatialReference:e.spatialReference}):e;this._editGeometryOperations=T.EditGeometryOperations.fromGeometry(t,G.ViewingMode.Local)},a._saveSnappingContextForHandle=function(e,t){this._snappingGraphicsLayer=new f({listMode:"hide",internal:!0,title:"Reshape snapping layer"}),this.view.map.layers.add(this._snappingGraphicsLayer),this._snappingContext=new O.SnappingContext({editGeometryOperations:this._editGeometryOperations,elevationInfo:{mode:"on-the-ground",offset:0},pointer:t.viewEvent?.pointerType||"mouse",excludeFeature:this.graphic,visualizer:new b.SnappingVisualizer2D(this._snappingGraphicsLayer),vertexHandle:this._getVertexFromEditGeometry(e)})},a._reset=function(){this._clearSelection(),this._highlightHelper.removeAll(),this._updateTooltip(),this._resetGraphics(),this._resetSnappingStateVars(),this._activeOperationInfo=null,this._mover&&this._mover.destroy(),this._mover=null,this.view.cursor="default"},a._resetSnappingStateVars=function(){h.isSome(this.snappingManager)&&this.snappingManager.doneSnapping(),h.isSome(this._snappingGraphicsLayer)&&(this.view?.map&&this.view.map.layers.remove(this._snappingGraphicsLayer),this._snappingGraphicsLayer.destroy()),this._editGeometryOperations=h.destroyMaybe(this._editGeometryOperations),this._snappingTask=h.abortMaybe(this._snappingTask),this._snappingTask=null,this._snappingContext=null,this._stagedVertex=null},a._resetGraphics=function(e){this._removeMidpointGraphics(e),this._removeVertexGraphics(e),this._set("selectedVertices",[])},a._removeMidpointGraphics=function(e){const t=e||this.layer;t&&t.removeMany(this.midpointGraphics.items),this.midpointGraphics.items.forEach((e=>e.destroy())),this.midpointGraphics.removeAll()},a._removeVertexGraphics=function(e){const t=e||this.layer;t&&t.removeMany(this.vertexGraphics.items),this.vertexGraphics.items.forEach((e=>e.destroy())),this.vertexGraphics.removeAll()},a._getCoordinatesForUI=function(e){const t=g.geometryToCoordinates(e.clone());if("polygon"===e.type)for(const i of t){const e=i[i.length-1];i[0][0]===e[0]&&i[0][1]===e[1]&&i.length>2&&i.pop()}return t},a._setupGraphics=function(){const e=this.graphic.geometry;if(h.isSome(e)&&("polyline"===e.type||"polygon"===e.type)){const t=this._getCoordinatesForUI(e);this.enableMidpoints&&this._setUpMidpointGraphics(t),this.enableVertices&&this._setUpVertexGraphics(t)}},a._setUpMidpointGraphics=function(e){this._removeMidpointGraphics();const t=this._createMidpointGraphics(e);this.midpointGraphics.addMany(t),this.layer.addMany(t)},a._setUpVertexGraphics=function(e){this._removeVertexGraphics();const t=this._createVertexGraphics(e);this.vertexGraphics.addMany(t),this._storeRelatedVertexIndices(),this.layer.addMany(t)},a._createVertexGraphics=function(e){const{_graphicAttributes:t,symbols:i,view:{spatialReference:s}}=this,n=[];return e?.forEach(((e,r)=>{e.forEach(((e,a)=>{const[c,p]=e;n.push(new o({geometry:new L({x:c,y:p,spatialReference:s}),symbol:i?.vertices?.default,attributes:{...t,pathIndex:r,pointIndex:a}}))}))})),n},a._createMidpointGraphics=function(e){const{_graphicAttributes:t,symbols:i,view:{spatialReference:s}}=this,n=[];return e?.forEach(((e,r)=>{e.forEach(((a,c)=>{const[p,l]=a,d=e[c+1]?c+1:0;if("polygon"===h.get(this.graphic.geometry,"type")||0!==d){const[a,h]=e[d],[y,v]=g.getMidpoint([p,l],[a,h]);n.push(new o({geometry:new L({x:y,y:v,spatialReference:s}),symbol:i.midpoints.default,attributes:{...t,pathIndex:r,pointIndexStart:c,pointIndexEnd:d}}))}}))})),n},a._storeRelatedVertexIndices=function(){const e=this.vertexGraphics.items;if(!e)return;const t=e.map((({geometry:e})=>({x:e.x,y:e.y})));for(let i=0;i<t.length;i++){const o=[];for(let e=0;e<t.length;e++){if(i===e)continue;const s=t[i],n=t[e];s.x===n.x&&s.y===n.y&&o.push(e)}e[i].attributes.relatedGraphicIndices=o}},a._setupMover=function(){const{enableMovement:e,graphic:t,midpointGraphics:i,vertexGraphics:o,view:s}=this,n=o.concat(i).items;e&&n.push(t),this._mover=new V({enableMoveAllGraphics:!1,highlightsEnabled:!1,indicatorsEnabled:!1,graphics:n,view:s,callbacks:{onGraphicClick:e=>this._onGraphicClickCallback(e),onGraphicMoveStart:e=>this._onGraphicMoveStartCallback(e),onGraphicMove:e=>this._onGraphicMoveCallback(e),onGraphicMoveStop:e=>this._onGraphicMoveStopCallback(e),onGraphicPointerOver:e=>this._onGraphicPointerOverCallback(e),onGraphicPointerOut:e=>this._onGraphicPointerOutCallback(e)}})},a._onGraphicClickCallback=function(e){e.viewEvent.stopPropagation();const t=e.graphic;if(t===this.graphic)this.clearSelection(),this.emit("graphic-click",e),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(e);else if(this._isMidpoint(t)){if(2===e.viewEvent.button)return;const i=this.graphic.clone(),o=this._createVertexFromMidpoint(t);this.refresh(),this._emitVertexAddEvent([t],i,o)}else if(this._isVertex(t))if(e.viewEvent.stopPropagation(),2===e.viewEvent.button)this._removeVertices(t);else{e.viewEvent.native.shiftKey||this._clearSelection(),this.selectedVertices.includes(t)?this._removeFromSelection(t,!0):this._addToSelection(t)}},a._setUpOperation=function(e){const{graphic:t,dx:i,dy:o}=e,s=t===this.graphic;this._resetSnappingStateVars(),this._setUpGeometryHelper(),this._saveSnappingContextForHandle(t,e),this._activeOperationInfo={target:this.graphic,mover:t,operationType:s?"move":"reshape",totalDx:i,totalDy:o}},a._onGraphicMoveStartCallback=function(e){const{dx:t,dy:i,graphic:o}=e;if(o===this.graphic){const{geometry:s}=o;return this._setUpOperation(e),this._emitMoveStartEvent(t,i),void(h.isSome(s)&&"point"===s.type&&this._onHandleMove(o,t,i,e,(()=>{this._updateTooltip(this.graphic,e.viewEvent),this._emitMoveEvent(t,i)})))}if(!this.selectedVertices.includes(o)){if(this._clearSelection(),this._isMidpoint(o)){const e=this.graphic.clone(),t=this._createVertexFromMidpoint(o);this._emitVertexAddEvent([o],e,t)}this._addToSelection(o)}this._setUpOperation(e),this._emitReshapeStartEvent(o),this._onHandleMove(o,t,i,e,(()=>{this._updateTooltip(o,e.viewEvent),this._emitReshapeEvent(o)}))},a._onGraphicMoveCallback=function(e){const t=this._activeOperationInfo;if(!t)return;const{dx:i,dy:o,graphic:s}=e;t.totalDx+=i,t.totalDy+=o;const{operationType:n}=t,{geometry:r}=s;if(!h.isNone(r))if("move"!==n)this._onHandleMove(s,i,o,e,(()=>{this._updateTooltip(s,e.viewEvent),this._emitReshapeEvent(s)}));else if("point"===r.type)this._onHandleMove(s,i,o,e,(()=>{this._updateTooltip(this.graphic,e.viewEvent),this._emitMoveEvent(i,o)}));else if("polyline"===r.type||"polygon"===r.type){const t=this._getCoordinatesForUI(r);this._updateVertexGraphicLocations(t),this._updateTooltip(this.graphic,e.viewEvent),this._emitMoveEvent(i,o)}},a._onGraphicMoveStopCallback=function(e){const t=this._activeOperationInfo;if(!t)return;const{dx:i,dy:o,graphic:s}=e,{operationType:n}=t;t.totalDx+=i,t.totalDy+=o,this._onHandleMove(s,i,o,e,(()=>"move"===n?this._emitMoveStopEvent():this._emitReshapeStopEvent(s))),this._isMidpoint(s)?this.refresh():(this._updateTooltip(this._isVertex(s)?s:null),this._resetSnappingStateVars(),this._activeOperationInfo=null)},a._updateVertexGraphicLocations=function(e){const t=this.view.spatialReference;for(const i of this.vertexGraphics){const{pathIndex:o,pointIndex:s}=i.attributes,[n,r]=e[o][s];i.geometry=new L({x:n,y:r,spatialReference:t})}this._updateMidpointGraphicLocations(e)},a._updateMidpointGraphicLocations=function(e){for(const t of this.midpointGraphics){const{pathIndex:i,pointIndexStart:o,pointIndexEnd:s}=t.attributes,[n,r]=e[i][o],[a,c]=e[i][s],[p,h]=g.getMidpoint([n,r],[a,c]);t.geometry=new L({x:p,y:h,spatialReference:this.view.spatialReference})}},a._getIndicesForVertexGraphic=function({attributes:e}){return[e?.pathIndex||0,e?.pointIndex||0]},a._getVertexFromEditGeometry=function(e){const[t,i]=this._getIndicesForVertexGraphic(e);return this._editGeometryOperations.data.components[t].vertices[i]},a._onHandleMove=function(t,i,o,n,r){var a=this;h.abortMaybe(this._snappingTask);const c=this._snappingContext;if(!c)return;const p=t.geometry,l="graphic-move-stop"===n.type;if(h.isSome(this.snappingManager)&&this.selectedVertices.length<2&&!l){const n=this.snappingManager;this._stagedVertex=n.update({point:p,context:c}),this._syncGeometryAfterVertexMove(t,new L(this._stagedVertex),i,o,l),r(),this._snappingTask=s.createTask(function(){var s=e._asyncToGenerator((function*(e){const s=yield n.snap({point:p,context:c,signal:e});s.valid&&(a._stagedVertex=s.apply(),a._syncGeometryAfterVertexMove(t,new L(a._stagedVertex),i,o,l),r())}));return function(e){return s.apply(this,arguments)}}())}else{const e=h.isSome(this._stagedVertex)?new L(this._stagedVertex):p;this._syncGeometryAfterVertexMove(t,e,i,o,l),r()}},a._syncGeometryAfterVertexMove=function(){var t=e._asyncToGenerator((function*(e,t,i,o,s=!1){const n=this._editGeometryOperations.data.geometry;if("point"===n.type)e.geometry=t;else{const{x:r,y:a}=t,[c,p]=this._getIndicesForVertexGraphic(e);let h=g.geometryToCoordinates(n);const l=h[c].length-1;h[c][p]=[r,a],"polygon"===n.type&&(0===p?h[c][l]=[r,a]:p===l&&(h[c][0]=[r,a])),this._isVertex(e)&&(h=this._moveRelatedCoordinates(h,e,r,a),h=this._moveSelectedHandleCoordinates(h,e,i,o,"polygon"===n.type),this._updateMidpointGraphicLocations(h)),this.graphic.geometry=n.clone();const d=this._getVertexFromEditGeometry(e),y=r-d.pos[0],v=a-d.pos[1];this._editGeometryOperations.moveVertices([d],y,v,0),s&&(this._mover?this._mover.updateGeometry(this._mover.graphics.indexOf(e),t):e.geometry=t)}}));function i(e,i,o,s){return t.apply(this,arguments)}return i}(),a._moveRelatedCoordinates=function(e,t,i,o){const{relatedGraphicIndices:s}=t.attributes;for(const n of s){const s=this.vertexGraphics.getItemAt(n),{pathIndex:r,pointIndex:a}=s.attributes;e[r][a]=[i,o],s.geometry=t.geometry}return e},a._moveSelectedHandleCoordinates=function(e,t,i,o,s){for(const n of this.selectedVertices)if(n!==t){const{pathIndex:t,pointIndex:r,relatedGraphicIndices:a}=n.attributes,c=M.cloneMove(n.geometry,i,o,this.view),p=e[t].length-1;e[t][r]=[c.x,c.y],n.geometry=c,s&&(0===r?e[t][p]=[c.x,c.y]:r===p&&(e[t][0]=[c.x,c.y]));for(const i of a){const t=this.vertexGraphics.getItemAt(i),{pathIndex:o,pointIndex:s}=t.attributes;e[o][s]=[c.x,c.y],t.geometry=c}}return e},a._onGraphicPointerOverCallback=function(e){const t=e.graphic,i=this._isVertex(t);i&&!this._isSelected(t)&&(t.symbol=this.symbols.vertices.hover),this._updateTooltip(i?t:null),this._updateHoverCursor(t)},a._onGraphicPointerOutCallback=function(e){const t=e.graphic;this._isVertex(t)&&!this._isSelected(t)&&(t.symbol=this.symbols.vertices.default),this.view.cursor="default",this._updateTooltip()},a._createVertexFromMidpoint=function(e){const{_graphicAttributes:t,graphic:i}=this,o=i.geometry;if(h.isNone(o)||"polygon"!==o.type&&"polyline"!==o.type)return[];const s=o.clone(),n=[],{pathIndex:r,pointIndexStart:a,pointIndexEnd:c}=e.attributes,{x:p,y:l}=e.geometry,d=0===c?a+1:c,y=g.geometryToCoordinates(s);return y[r].splice(d,0,[p,l]),e.attributes={...t,pathIndex:r,pointIndex:d,relatedGraphicIndices:[]},n.push({coordinates:y[r][d],componentIndex:r,vertexIndex:d}),this.graphic.geometry=s,n},a._addToSelection=function(e){e instanceof o&&(e=[e]);for(const t of e)t.symbol=this.symbols.vertices.selected;this._set("selectedVertices",this.selectedVertices.concat(e)),this._emitSelectEvent(e)},a._removeFromSelection=function(e,t){const{vertices:i}=this.symbols,s=t?i.hover:i.default;e instanceof o&&(e=[e]);for(const o of e)this.selectedVertices.splice(this.selectedVertices.indexOf(o),1),this._set("selectedVertices",this.selectedVertices),o.set("symbol",s);this._emitDeselectEvent(e)},a._clearSelection=function(){if(this.selectedVertices.length){const e=this.selectedVertices;for(const t of this.selectedVertices)t.set("symbol",this.symbols.vertices.default);this._set("selectedVertices",[]),this._emitDeselectEvent(e)}},a._keyDownHandler=function(e){I.SKETCH_KEYS.delete.includes(e.key)&&!e.repeat&&this.selectedVertices.length&&this._removeVertices(this.selectedVertices)},a._removeVertices=function(e){const t=this.graphic.geometry;if(h.isNone(t)||"polygon"!==t.type&&"polyline"!==t.type)return;if("polygon"===t.type&&this.vertexGraphics.length<4||this.vertexGraphics.length<3)return;e instanceof o&&(e=[e]);const i=this.graphic.clone(),s=t.clone();let n=g.geometryToCoordinates(s);const r=[];e instanceof o&&(e=[e]);for(const o of e){const{x:e,y:t}=o.geometry;for(let i=0;i<n.length;i++){const o=n[i];for(let s=0;s<o.length;s++){const[a,c]=o[s];e===a&&t===c&&(r.push({coordinates:n[i][s],componentIndex:i,vertexIndex:s}),n[i].splice(Number(s),1))}}}if("polygon"===s.type)n=n.filter((e=>{if(e.length<2)return!1;const[t,i]=e[0],[o,s]=e[e.length-1];return(2!==e.length||t!==o||i!==s)&&(t===o&&i===s||e.push(e[0]),!0)})),s.rings=n;else{for(const e of n)1===e.length&&n.splice(n.indexOf(e),1);s.paths=n}this.graphic.geometry=s,this.refresh(),this._emitVertexRemoveEvent(e,i,r)},a._isVertex=function(e){return this.vertexGraphics.includes(e)},a._isSelected=function(e){return this._isVertex(e)&&this.selectedVertices.includes(e)},a._isMidpoint=function(e){return this.midpointGraphics.includes(e)},a._updateHoverCursor=function(e){this.view.cursor=this._isMidpoint(e)?"copy":"move"},a._updateTooltip=function(e,t){h.isNone(this._tooltip)||(e?e===this.graphic?this._updateMoveGraphicTooltip(t):this._updateMoveVertexTooltip(t):this._tooltip.clear())},a._updateMoveGraphicTooltip=function(e){const{_tooltip:t,tooltipOptions:i,view:o}=this;if(h.isNone(t))return;const s=new H.TranslateGraphicTooltipInfo({tooltipOptions:i});if(e){const{x:t,y:i}=e.origin,n=o.toMap(e),r=o.toMap(y.createScreenPoint(t,i)),a=A.autoDistanceBetweenPoints2D(r,n);s.distance=h.isSome(a)?a:l.zeroMeters}t.info=s},a._updateMoveVertexTooltip=function(e){const{_tooltip:t,graphic:{geometry:i},tooltipOptions:o,view:s}=this;if(h.isNone(t))return;const n=new H.TranslateVertexTooltipInfo({tooltipOptions:o});if(h.isSome(i)&&("polygon"===i.type?n.area=U.autoArea2D(i):"polyline"===i.type&&(n.totalLength=A.autoLength2D(i))),e){const{x:t,y:i}=e.origin,o=s.toMap(e),r=s.toMap(y.createScreenPoint(t,i)),a=A.autoDistanceBetweenPoints2D(r,o);n.distance=h.isSome(a)?a:l.zeroMeters}t.info=n},a._emitMoveStartEvent=function(e,t){const i=new N(this.graphic,e,t);this.emit("move-start",i),this.callbacks.onMoveStart&&this.callbacks.onMoveStart(i)},a._emitMoveEvent=function(e,t){const i=new B(this.graphic,e,t);this.emit("move",i),this.callbacks.onMove&&this.callbacks.onMove(i)},a._emitMoveStopEvent=function(){const e=this._activeOperationInfo;if(!e)return;const{totalDx:t,totalDy:i}=e,o=new K(this.graphic,t,i);this.emit("move-stop",o),this.callbacks.onMoveStop&&this.callbacks.onMoveStop(o)},a._emitReshapeStartEvent=function(e){const t=new F(this.graphic,e,this.selectedVertices);this.emit("reshape-start",t),this.callbacks.onReshapeStart&&this.callbacks.onReshapeStart(t)},a._emitReshapeEvent=function(e){const t=new z(this.graphic,e,this.selectedVertices);this.emit("reshape",t),this.callbacks.onReshape&&this.callbacks.onReshape(t)},a._emitReshapeStopEvent=function(e){const t=new P(this.graphic,e,this.selectedVertices);this.emit("reshape-stop",t),this.callbacks.onReshapeStop&&this.callbacks.onReshapeStop(t)},a._emitSelectEvent=function(e){const t=new q(e);this.emit("select",t),this.callbacks.onVertexSelect&&this.callbacks.onVertexSelect(t)},a._emitDeselectEvent=function(e){const t=new W(e);this.emit("deselect",t),this.callbacks.onVertexDeselect&&this.callbacks.onVertexDeselect(t)},a._emitVertexAddEvent=function(e,t,i){const o=new Y(e,this.graphic,t,i);this.emit("vertex-add",o),this.callbacks.onVertexAdd&&this.callbacks.onVertexAdd(o)},a._emitVertexRemoveEvent=function(e,t,i){const o=new j(e,this.graphic,t,i);this.emit("vertex-remove",o),this.callbacks.onVertexRemove&&this.callbacks.onVertexRemove(o)},a._logGeometryTypeError=function(){p.getLogger(this.declaredClass).error(new r("reshape:invalid-geometry","Reshape operation not supported for the provided graphic. The geometry type is not supported."))},e._createClass(i,[{key:"highlightsEnabled",set:function(e){this._highlightHelper?.removeAll(),this._set("highlightsEnabled",e),this._setUpHighlights()}},{key:"state",get:function(){const e=!!this.get("view.ready"),t=!(!this.get("graphic")||!this.get("layer"));return e&&t?"active":e?"ready":"disabled"}},{key:"symbols",set:function(e){const{midpoints:t=Q.midpoints,vertices:i=Q.vertices}=e||{};this._set("symbols",{midpoints:t,vertices:i})}}]),i}(a.EventedAccessor);t.__decorate([v.property()],X.prototype,"_tooltip",void 0),t.__decorate([v.property()],X.prototype,"callbacks",void 0),t.__decorate([v.property()],X.prototype,"enableMidpoints",void 0),t.__decorate([v.property()],X.prototype,"enableMovement",void 0),t.__decorate([v.property()],X.prototype,"enableVertices",void 0),t.__decorate([v.property()],X.prototype,"graphic",void 0),t.__decorate([v.property({value:!0})],X.prototype,"highlightsEnabled",null),t.__decorate([v.property()],X.prototype,"layer",void 0),t.__decorate([v.property({readOnly:!0})],X.prototype,"midpointGraphics",void 0),t.__decorate([v.property()],X.prototype,"midpointSymbol",void 0),t.__decorate([v.property({readOnly:!0})],X.prototype,"selectedVertices",void 0),t.__decorate([v.property()],X.prototype,"snappingManager",void 0),t.__decorate([v.property({readOnly:!0})],X.prototype,"state",null),t.__decorate([v.property({value:Q})],X.prototype,"symbols",null),t.__decorate([v.property({type:C})],X.prototype,"tooltipOptions",void 0),t.__decorate([v.property({readOnly:!0})],X.prototype,"type",void 0),t.__decorate([v.property({readOnly:!0})],X.prototype,"vertexGraphics",void 0),t.__decorate([v.property()],X.prototype,"view",void 0),X=t.__decorate([m.subclass("esri.views.draw.support.Reshape")],X);return X}));
