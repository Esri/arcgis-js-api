/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{Milliseconds as t,millisecondsFromSeconds as i}from"../../../core/time.js";import{inOutCoastQuad as e,outExpo as n}from"../easing.js";import{Definition as a}from"./Definition.js";import{defaultSettings as s}from"./Settings.js";import{Path as o}from"./apex/Path.js";const r={zoom:0,pan:0,rotate:0};class m{constructor(i){this.createCamera=i,this._time=t(0),this.definition=new a(i),this.path=new o}get time(){return this._time}update(t,a,s){this.definition.update(t,a,s),this.path.update(this.definition,s),this._time=this._applyTimeSettings(i(this.path.time),s),this._easing=s.easing?s.easing:this._time>=1e3?e:n}cameraAt(t,i){i=i||this.createCamera(),t=Math.min(Math.max(0,t),1),t=this._normalizedEasing(t);const e=this.path.interpolateComponentsAt(t,r);return i.interpolate(this.definition.source,this.definition.target,e),i}_normalizedEasing(t){const i=this._easing(0,this._time),e=this._easing(1,this._time);return(this._easing(t,this._time)-i)/(e-i)}_applyTimeSettings(i,e){const n=null!=e.speedFactor?e.speedFactor:1;null!=e.duration?i=e.duration:null!=e.speedFactor&&(i=t(i/n));const a=null!=e.minDuration?e.minDuration:s.minDuration/n,o=null!=e.maxDuration?e.maxDuration:s.maxDuration/n;return t(Math.min(Math.max(a,i),o))}}export{m as Animation};
