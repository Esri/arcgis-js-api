/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{isNone as t}from"../../core/maybe.js";import{createArea as r}from"../../core/quantityUtils.js";import{areaUnitFromSpatialReference as o}from"../../core/unitUtils.js";import{e}from"../../chunks/earcut.js";import{k as n,c as s,s as i}from"../../chunks/vec3.js";import{c}from"../../chunks/vec3f64.js";import{projectVectorToVector as f}from"../../geometry/projection.js";import{fromPoints as l,wrap as u,projectPointLocal as m}from"../../geometry/support/plane.js";import{areaPoints2d as p}from"../../geometry/support/triangle.js";import{sv3d as a}from"../../geometry/support/vectorStacks.js";import{computeEuclideanMeasurementSR as g}from"./measurementUtils.js";function h(t,r=d()){return y(t,r)}function j(t,r=d()){return y(t,r,!1)}function y(e,h,j=e.hasZ){const y=g(e.spatialReference),d=o(y);if(t(d))return null;const R=(t,r)=>!(r.length<2)&&(i(t,r[0],r[1],j&&r[2]||0),!0);let U=0;for(const t of e.rings){if(t.length<3)continue;const{positionsWorldCoords:r}=h;for(;r.length<t.length;)r.push(c());const o=k;for(let n=0;n<3;n++){if(!R(o,t[n]))return null;if(!f(o,e.spatialReference,r[n],y))return null}if(n(r[0],r[1])||n(r[0],r[2])||n(r[1],r[2]))continue;const i=l(r[0],r[1],r[2],u()),g=s(a.get(),r[0]);for(let t=0;t<3;t++)m(i,g,r[t],r[t]);for(let n=3;n<t.length;n++){if(!R(o,t[n]))return null;f(o,e.spatialReference,r[n],y),m(i,g,r[n],r[n])}const j=v(r);for(let t=0;t<j.length;t+=3)U+=p(r[j[t]],r[j[t+1]],r[j[t+2]])}return r(U,d)}const k=c();function d(){return{positionsWorldCoords:[]}}function v(t){return e(R(t),[],2)}function R(t){const r=new Float64Array(2*t.length);for(let o=0;o<t.length;++o){const e=t[o],n=2*o;r[n+0]=e[0],r[n+1]=e[1]}return r}export{y as computeEuclideanPlanarArea,d as createEuclideanPlanarAreaCache,j as euclideanHorizontalPlanarArea,h as euclideanPlanarArea,v as triangulate};
