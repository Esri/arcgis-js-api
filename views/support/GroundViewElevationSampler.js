/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/Evented","../../core/Logger","../../core/maybe","../../core/accessorSupport/decorators/property","../../core/has","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/subclass","../../geometry/support/aaBoundingRect","../../geometry/support/contains","../../geometry/support/webMercatorUtils","../../layers/support/ElevationSampler","../3d/support/ElevationProvider","../3d/terrain/TerrainConst"],(function(e,t,r,o,n,i,a,s,p,l,c,u,d,v,y){"use strict";const m=o.getLogger("esri.views.support.GroundViewElevationSampler");let h=function(t){function r(e){var r;return(r=t.call(this,e)||this).demResolution={min:-1,max:-1},r.noDataValue=y.ELEVATION_NODATA_VALUE,r}e._inheritsLoose(r,t);var o=r.prototype;return o.initialize=function(){this.view.basemapTerrain.on("elevation-change",(()=>this.emit("changed",{})))},o.elevationAt=function(e){const t=e.spatialReference,r=this.spatialReference;if(!u.canProject(t,r)){const e=t?t.wkid:"unknown";return m.error(`Cannot sample elevation at a location with spatial reference (${e}) different from the view (${r.wkid})`),null}if(n.isNone(this.extent)||!c.extentContainsPoint(this.extent,e)){const t=n.isSome(this.extent)?`${this.extent.xmin}, ${this.extent.ymin}, ${this.extent.xmax}, ${this.extent.ymax}`:null;m.warn("#elevationAt()",`Point used to sample elevation (${e.x}, ${e.y}) is outside of the sampler extent (${t})`)}return v.getElevationAtPoint(this.view.elevationProvider,e)},o.queryElevation=function(e){return d.updateGeometryElevation(e.clone(),this)},e._createClass(r,[{key:"extent",get:function(){const e=this.view.basemapTerrain;return n.isSome(e.extent)&&e.spatialReference?l.toExtent(e.extent,e.spatialReference):null}}]),r}(r.EventedAccessor);return t.__decorate([i.property({readOnly:!0})],h.prototype,"demResolution",void 0),t.__decorate([i.property({readOnly:!0})],h.prototype,"extent",null),t.__decorate([i.property({readOnly:!0})],h.prototype,"noDataValue",void 0),t.__decorate([i.property({readOnly:!0,aliasOf:"view.basemapTerrain.spatialReference"})],h.prototype,"spatialReference",void 0),t.__decorate([i.property({constructOnly:!0})],h.prototype,"view",void 0),h=t.__decorate([p.subclass("esri.views.support.GroundViewElevationSampler")],h),h}));
