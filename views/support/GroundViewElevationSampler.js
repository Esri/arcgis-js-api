/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/Evented","../../core/Logger","../../core/accessorSupport/decorators/property","../../core/has","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/subclass","../../geometry/support/aaBoundingRect","../../geometry/support/contains","../../geometry/support/webMercatorUtils","../../layers/support/ElevationSampler","../3d/support/ElevationProvider","../3d/terrain/TerrainConst"],(function(e,t,r,o,n,a,i,s,p,c,l,u,d,v){"use strict";const y=o.getLogger("esri.views.support.GroundViewElevationSampler");let m=function(t){function r(e){var r;return(r=t.call(this,e)||this).demResolution={min:-1,max:-1},r.noDataValue=v.ELEVATION_NODATA_VALUE,r}e._inheritsLoose(r,t);var o=r.prototype;return o.initialize=function(){this.view.basemapTerrain.on("elevation-change",(()=>this.emit("changed",{})))},o.elevationAt=function(e){const t=e.spatialReference,r=this.spatialReference;if(!l.canProject(t,r)){const e=t?t.wkid:"unknown";return y.error(`Cannot sample elevation at a location with spatial reference (${e}) different from the view (${r.wkid})`),null}if(!c.extentContainsPoint(this.extent,e)){const t=this.extent,r=`${t.xmin}, ${t.ymin}, ${t.xmax}, ${t.ymax}`;y.warn("#elevationAt()",`Point used to sample elevation (${e.x}, ${e.y}) is outside of the sampler extent (${r})`)}return d.getElevationAtPoint(this.view.elevationProvider,e)},o.queryElevation=function(e){return u.updateGeometryElevation(e.clone(),this)},e._createClass(r,[{key:"extent",get:function(){const e=this.view.basemapTerrain;return e.extent&&e.spatialReference?p.toExtent(e.extent,e.spatialReference):null}}]),r}(r.EventedAccessor);return t.__decorate([n.property({readOnly:!0})],m.prototype,"demResolution",void 0),t.__decorate([n.property({readOnly:!0})],m.prototype,"extent",null),t.__decorate([n.property({readOnly:!0})],m.prototype,"noDataValue",void 0),t.__decorate([n.property({readOnly:!0,aliasOf:"view.basemapTerrain.spatialReference"})],m.prototype,"spatialReference",void 0),t.__decorate([n.property({constructOnly:!0})],m.prototype,"view",void 0),m=t.__decorate([s.subclass("esri.views.support.GroundViewElevationSampler")],m),m}));
