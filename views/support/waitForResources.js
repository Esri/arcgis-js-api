/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../core/promiseUtils","../../core/scheduling","../../core/accessorSupport/watch","../../core/watchUtils"],(function(e,n,i,r){"use strict";return function(t){switch(t.type){case"2d":return function(r){const t=e.createResolver();let a=performance.now();const u=function(){var e,t,a,u,o,s;if(i.dispatch(),n.debug.dispatch(),!r.ready||r.updating||!r.stationary||r.rendering||!0===(null==(e=r.layerViewManager)?void 0:e.updating)||!0===(null==(t=r.labelManager)?void 0:t.updating)||!0===(null==(a=r.graphicsView)?void 0:a.updating)||!0===(null==(u=r.magnifier)?void 0:u.visible)&&(null==(o=r._magnifierView)||!o.mask||null==(s=r._magnifierView)||!s.overlay)||r.allLayerViews.some((e=>!0===e.updating)))return!0;return!!r.allLayerViews.find((function(e){const n=!e.isFulfilled(),i=e.updating&&!e.suspended;return n||i}))};function o(){if(!r.destroyed&&u())a=null,setTimeout(o,16);else{a||(a=performance.now());performance.now()-a>=100?t():setTimeout(o,16)}}return setTimeout(o,16),t.promise}(t);case"3d":if(t)return i.dispatch(),n.debug.dispatch(),r.whenNotOnce(t,"updating")}return e.resolve()}}));
