/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["../../core/maybe","../../core/promiseUtils","../../core/reactiveUtils","../../core/scheduling","../../core/accessorSupport/watch"],(function(e,i,r,n,t){"use strict";function a(e){switch(e.type){case"2d":return s(e);case"3d":if(e)return t.dispatch(),n.debug.dispatch(),r.whenOnce((()=>!e.updating))}return Promise.resolve()}function s(r){const a=i.createResolver();let s=performance.now();const o=()=>{if(t.dispatch(),n.debug.dispatch(),!r.ready||r.updating||!r.stationary||r.rendering||!0===r.layerViewManager?.updating||!0===r.labelManager?.updating||!0===r.graphicsView?.updating||!0===r.magnifier?.visible&&e.isSome(r.magnifier?.position)&&(!r._magnifierView?.mask||!r._magnifierView?.overlay)||r.allLayerViews.some((e=>!0===e.updating)))return!0;return!!r.allLayerViews.find((e=>{const i=!e.isFulfilled(),r=e.updating&&!e.suspended;return i||r}))};function c(){if(!r.destroyed&&o())s=null,setTimeout(c,16);else{s||(s=performance.now());performance.now()-s>=200?a():setTimeout(c,16)}}return setTimeout(c,16),a.promise}return a}));
