/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/clock","../InputHandler","./SingleAndDoubleClick","./support"],(function(e,t,i,a,o,n){"use strict";let l=function(e){function a(a=o.DefaultParameters.maximumDoubleClickDelay,n=o.DefaultParameters.maximumDoubleClickDistance,l=o.DefaultParameters.maximumDoubleTouchDelay,u=o.DefaultParameters.maximumDoubleTouchDistance,m=i.clock){var s;return(s=e.call(this,!1)||this)._maximumDoubleClickDelay=a,s._maximumDoubleClickDistance=n,s._maximumDoubleTouchDelay=l,s._maximumDoubleTouchDistance=u,s._clock=m,s._pointerState=new Map,s._immediateDoubleClick=s.registerOutgoing("immediate-double-click"),s.registerIncoming("pointer-down",s._handlePointerDown.bind(t._assertThisInitialized(s))),s.registerIncoming("pointer-up",s._handlePointerUp.bind(t._assertThisInitialized(s))),s}t._inheritsLoose(a,e);var l=a.prototype;return l.onUninstall=function(){this._pointerState.forEach((e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()})),e.prototype.onUninstall.call(this)},l._handlePointerDown=function(e){const t=e.data,i=n.getPointerId(t);if(!this._pointerState.has(i)){const e={downButton:t.native.button,immediateDoubleClick:null};this._pointerState.set(i,e),this.startCapturingPointer(t.native)}},l._handlePointerUp=function(e){const t=e.data,i=n.getPointerId(t),a=this._pointerState.get(i);if(a&&a.downButton===t.native.button){const i=a.immediateDoubleClick;if(i){i.timeoutHandle.remove();const o="touch"===e.data.native.pointerType?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;n.manhattanDistance(i,e.data)>o?this._startImmediateDoubleClick(e,a):(this._immediateDoubleClick.emit(e.data,void 0,i.modifiers),this._removeState(t))}else this._startImmediateDoubleClick(e,a)}},l._startImmediateDoubleClick=function(e,t){const i="touch"===e.data.native.pointerType?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(e.data)),i)}},l._removeState=function(e){const t=n.getPointerId(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()},a}(a.InputHandler);e.ImmediateDoubleClick=l,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
