/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/clock","../../../core/MapUtils","../../../core/maybe","../InputHandler","./support"],(function(e,t,i,n,o,l,a){"use strict";const c={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};let u=function(e){function l(n=c.maximumDoubleClickDelay,o=c.maximumDoubleClickDistance,l=c.maximumDoubleTouchDelay,a=c.maximumDoubleTouchDistance,u=i.clock){var r;return(r=e.call(this,!1)||this)._maximumDoubleClickDelay=n,r._maximumDoubleClickDistance=o,r._maximumDoubleTouchDelay=l,r._maximumDoubleTouchDistance=a,r._clock=u,r._pointerState=new Map,r._click=r.registerOutgoing("click"),r._doubleClick=r.registerOutgoing("double-click"),r.registerIncoming("immediate-click",r._handleImmediateClick.bind(t._assertThisInitialized(r))),r.registerIncoming("pointer-down",r._handlePointerDown.bind(t._assertThisInitialized(r))),r}t._inheritsLoose(l,e);var u=l.prototype;return u.onUninstall=function(){this._pointerState.forEach((e=>e.doubleClickTimer=o.removeMaybe(e.doubleClickTimer)))},u._clearDoubleClickTimer=function(e,t){const i=this._pointerState.get(e);i&&(i.doubleClickTimer=o.removeMaybe(i.doubleClickTimer),t&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())},u._doubleClickTimeoutExceeded=function(e){const t=this._pointerState.get(e);1===t.pointerDownCount&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()},u._getPointerId=function(e){const{pointerId:t,pointerType:i,button:n}=e.native;return"mouse"===i?`${t}:${n}`:`${i}`},u._handleImmediateClick=function(e){const t=e.data,{pointerType:i}=t.native,n=this._getPointerId(t);if(!this._pointerState.has(n))return void this._startClick(e);const o=this._pointerState.get(n),{data:l,modifiers:c}=o.event,u="touch"===i?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;a.manhattanDistance(l,t)>u?(this._clearDoubleClickTimer(n,!0),this._startClick(e)):(this._clearDoubleClickTimer(n,!1),2===o.pointerDownCount&&this._doubleClick.emit(l,void 0,c))},u._handlePointerDown=function(e){const t=a.getPointerId(e.data),i=this._pointerState.get(t);i&&(i.pointerDownCount+=1)},u._startClick=function(e){const{data:t}=e,{native:{pointerType:i}}=t,n=a.getPointerId(t),o="touch"===i?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,l=this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(n)),o),c=1;this._pointerState.set(n,{event:e,doubleClickTimer:l,pointerDownCount:c}),this.refreshHasPendingInputs()},t._createClass(l,[{key:"hasPendingInputs",get:function(){return n.someMap(this._pointerState,(e=>null!=e.doubleClickTimer))}}]),l}(l.InputHandler);e.DefaultParameters=c,e.SingleAndDoubleClick=u,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
