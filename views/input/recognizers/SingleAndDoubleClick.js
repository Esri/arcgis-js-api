/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/clock","../../../core/MapUtils","../../../core/maybe","../InputHandler","./support"],(function(e,t,i,o,n,l,a){"use strict";const u={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};let c=function(e){function l(o=u.maximumDoubleClickDelay,n=u.maximumDoubleClickDistance,l=u.maximumDoubleTouchDelay,a=u.maximumDoubleTouchDistance,c=i.clock){var r;return(r=e.call(this,!1)||this)._maximumDoubleClickDelay=o,r._maximumDoubleClickDistance=n,r._maximumDoubleTouchDelay=l,r._maximumDoubleTouchDistance=a,r._clock=c,r._pointerState=new Map,r._click=r.registerOutgoing("click"),r._doubleClick=r.registerOutgoing("double-click"),r.registerIncoming("immediate-click",r._handleImmediateClick.bind(t._assertThisInitialized(r))),r.registerIncoming("pointer-down",r._handlePointerDown.bind(t._assertThisInitialized(r))),r}t._inheritsLoose(l,e);var c=l.prototype;return c.onUninstall=function(){this._pointerState.forEach((e=>e.doubleClickTimer=n.removeMaybe(e.doubleClickTimer)))},c._clearDoubleClickTimer=function(e,t){const i=this._pointerState.get(e);i&&(i.doubleClickTimer=n.removeMaybe(i.doubleClickTimer),t&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())},c._doubleClickTimeoutExceeded=function(e){const t=this._pointerState.get(e);1===t.pointerDownCount&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()},c._getPointerId=function(e){const{pointerId:t,pointerType:i,button:o}=e.native;return"mouse"===i?`${t}:${o}`:`${i}`},c._handleImmediateClick=function(e){const t=e.data,{pointerType:i}=t.native,o=this._getPointerId(t);if(!this._pointerState.has(o))return void this._startClick(e);const n=this._pointerState.get(o),{data:l,modifiers:u}=n.event,c="touch"===i?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;a.manhattanDistance(l,t)>c?(this._clearDoubleClickTimer(o,!0),this._startClick(e)):(this._clearDoubleClickTimer(o,!1),2===n.pointerDownCount&&this._doubleClick.emit(l,void 0,u))},c._handlePointerDown=function(e){const t=a.getPointerId(e.data),i=this._pointerState.get(t);i&&(i.pointerDownCount+=1)},c._startClick=function(e){const{data:t}=e,{native:{pointerType:i}}=t,o=a.getPointerId(t),n="touch"===i?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,l=this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(o)),n),u=1;this._pointerState.set(o,{event:e,doubleClickTimer:l,pointerDownCount:u}),this.refreshHasPendingInputs()},t._createClass(l,[{key:"hasPendingInputs",get:function(){return o.someMap(this._pointerState,(e=>null!=e.doubleClickTimer))}}]),l}(l.InputHandler);e.DefaultParameters=u,e.SingleAndDoubleClick=c,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
