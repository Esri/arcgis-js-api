/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../chunks/vec3","../../chunks/vec3f64","./FilteredFiniteDifference","./Momentum"],(function(e,t,i,n,s,r){"use strict";let l=function(e){function i(t,i,n,s,r){var l;return(l=e.call(this,t,i,n)||this)._sceneVelocity=s,l.direction=r,l}return t._inheritsLoose(i,e),i.prototype.value=function(t){return e.prototype.valueFromInitialVelocity.call(this,this._sceneVelocity,t)},i}(r.Momentum),c=function(){function e(e=300,t=12,i=.84){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=i,this.enabled=!0,this._time=new s.FilteredFiniteDifference(.6),this._screen=[new s.FilteredFiniteDifference(.4),new s.FilteredFiniteDifference(.4)],this._scene=[new s.FilteredFiniteDifference(.6),new s.FilteredFiniteDifference(.6),new s.FilteredFiniteDifference(.6)],this._tmpDirection=n.create()}var t=e.prototype;return t.add=function(e,t,i){if(this.enabled){if(this._time.hasLastValue()){if(this._time.computeDelta(i)<.015)return}this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._scene[0].update(t[0]),this._scene[1].update(t[1]),this._scene[2].update(t[2]),this._time.update(i)}},t.reset=function(){this._screen[0].reset(),this._screen[1].reset(),this._scene[0].reset(),this._scene[1].reset(),this._scene[2].reset(),this._time.reset()},t.evaluateMomentum=function(){if(!this.enabled||!this._screen[0].hasFilteredDelta()||!this._time.hasFilteredDelta())return null;const e=this._screen[0].filteredDelta,t=this._screen[1].filteredDelta,i=null==e||null==t?0:Math.sqrt(e*e+t*t),n=this._time.filteredDelta,s=null==n||null==i?0:i/n;return Math.abs(s)<this._minimumInitialVelocity?null:this.createMomentum(s,this._stopVelocity,this._friction)},t.createMomentum=function(e,t,n){i.set(this._tmpDirection,this._scene[0].filteredDelta??0,this._scene[1].filteredDelta??0,this._scene[2].filteredDelta??0);const s=i.length(this._tmpDirection);s>0&&i.scale(this._tmpDirection,this._tmpDirection,1/s);const r=this._time.filteredDelta;return new l(e,t,n,null==r?0:s/r,this._tmpDirection)},e}();e.PanPlanarMomentum=l,e.PanPlanarMomentumEstimator=c,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
