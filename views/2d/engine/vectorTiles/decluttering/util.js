/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../enums","./core"],(function(t,e,o,s){"use strict";function l(t,e,o,s,l,i){const n=o-l;if(n>=0)return(e>>n)+(s-(i<<n))*(t>>n);const r=-n;return e-(i-(s<<r))*(t>>r)<<r}let i=function(){function t(t,e,o){this._rows=Math.ceil(e/o),this._columns=Math.ceil(t/o),this._cellSize=o,this.cells=new Array(this._rows);for(let s=0;s<this._rows;s++){this.cells[s]=new Array(this._columns);for(let t=0;t<this._columns;t++)this.cells[s][t]=[]}}var o=t.prototype;return o.getCell=function(t,e){const o=Math.min(Math.max(Math.floor(e/this._cellSize),0),this._rows-1),s=Math.min(Math.max(Math.floor(t/this._cellSize),0),this._columns-1);return this.cells[o]&&this.cells[o][s]||null},o.getCellSpan=function(t,e,o,s){return[Math.min(Math.max(Math.floor(t/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(e/this._cellSize),0),this.rows-1),Math.min(Math.max(Math.floor(o/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(s/this._cellSize),0),this.rows-1)]},e._createClass(t,[{key:"cellSize",get:function(){return this._cellSize}},{key:"columns",get:function(){return this._columns}},{key:"rows",get:function(){return this._rows}}]),t}();function n(t,e,o,l,i,n){const r=e[l++];for(let a=0;a<r;a++){const r=new s.VTLSymbol(n);r.xTile=e[l++],r.yTile=e[l++],r.hash=e[l++],r.priority=e[l++];const a=e[l++];for(let t=0;t<a;t++){const t=e[l++],s=e[l++],i=e[l++],n=e[l++],a=!!e[l++],c=e[l++],h=o[l++],u=o[l++],f=e[l++],m=e[l++];r.colliders.push({xTile:t,yTile:s,dxPixels:i,dyPixels:n,hard:a,partIndex:c,width:f,height:m,minLod:h,maxLod:u})}const c=t[l++];for(let e=0;e<c;e++)r.textVertexRanges.push([t[l++],t[l++]]);const h=t[l++];for(let e=0;e<h;e++)r.iconVertexRanges.push([t[l++],t[l++]]);i.push(r)}return l}function r(t,e,o){for(const[s,l]of t.symbols)a(t,e,o,l,s)}function a(t,e,s,l,i){const n=t.layerData.get(i);if(n.type===o.BucketType.SYMBOL){for(const e of l){const o=e.unique;let l;if(e.selectedForRendering){const e=o.parts[0],i=e.startOpacity,n=e.targetOpacity;t.allSymbolsFadingOut=t.allSymbolsFadingOut&&0===n;const r=s?Math.floor(127*i)|n<<7:n?255:0;l=r<<24|r<<16|r<<8|r}else l=0;for(const[t,s]of e.iconVertexRanges)for(let e=t;e<t+s;e+=4)n.iconOpacity[e/4]=l;if(e.selectedForRendering){const e=o.parts[1],i=e.startOpacity,n=e.targetOpacity;t.allSymbolsFadingOut=t.allSymbolsFadingOut&&0===n;const r=s?Math.floor(127*i)|n<<7:n?255:0;l=r<<24|r<<16|r<<8|r}else l=0;for(const[t,s]of e.textVertexRanges)for(let e=t;e<t+s;e+=4)n.textOpacity[e/4]=l}n.lastOpacityUpdate=e,n.opacityChanged=!0}}t.GridIndex=i,t.deserializeSymbols=n,t.tileCoordChange=l,t.writeOpacityToBuffers=r,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
