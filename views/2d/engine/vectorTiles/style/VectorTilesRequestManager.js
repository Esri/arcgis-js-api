/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../request","../../../../../core/lang","../../../../../core/MapUtils","../../../../../core/promiseUtils"],(function(t,e,r,n,o,i){"use strict";let l=function(){function t(t){this._tileUrl=t,this._promise=null,this._abortController=null,this._abortOptions=[]}var o=t.prototype;return o.getData=function(t){null===this._promise&&(this._abortController=new AbortController,this._promise=this._makeRequest(this._tileUrl,this._abortController.signal));const e=this._abortOptions;return e.push(t),i.onAbort(t,(()=>{e.every((t=>i.isAborted(t)))&&this._abortController.abort()})),this._promise.then((t=>n.clone(t)))},o._makeRequest=function(){var t=e._asyncToGenerator((function*(t,e){const{data:n}=yield r(t,{responseType:"array-buffer",signal:e});return n}));function n(e,r){return t.apply(this,arguments)}return n}(),t}();const s=new Map;function a(t,e,r,n,o){return u(t.replace(/\{z\}/gi,e.toString()).replace(/\{y\}/gi,r.toString()).replace(/\{x\}/gi,n.toString()),o)}function u(t,e){return o.getOrCreateMapValue(s,t,(()=>new l(t))).getData(e).then((e=>(s.delete(t),e))).catch((e=>{throw s.delete(t),e}))}t.request=a,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
