// COPYRIGHT Â© 2018 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.10/esri/copyright.txt for details.

define(["require","exports"],function(t,o){var y,e,T,r;Object.defineProperty(o,"__esModule",{value:!0}),(e=y=o.VectorRole||(o.VectorRole={}))[e.ENTRY=1]="ENTRY",e[e.EXIT=2]="EXIT",e[e.CAP=3]="CAP",(r=T=o.CapPosition||(o.CapPosition={}))[r.START=1]="START",r[r.END=2]="END",o.SYSTEM_MAG_LIMIT=3.8,o.MITER_SAFE_RADS=2*Math.acos(1/o.SYSTEM_MAG_LIMIT);var S=o.SYSTEM_MAG_LIMIT*o.SYSTEM_MAG_LIMIT,J=-1,i=8/(2*Math.PI);function s(t){var o,e={items:new Array,count:0};for(o=0;o<t;++o)e.items.push(void 0);return e}o.allocTriangles=function(t){var o,e={items:new Array,count:0};for(o=0;o<t;++o)e.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]}});return e},o.allocExtrudeVectors=function(){var t=function(t){var o,e={items:new Array,count:0};for(o=0;o<t;++o)e.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]});return e}(30),o={};return o[y.ENTRY]=s(20),o[y.EXIT]=s(20),o[y.CAP]=s(20),{vectors:t,lists:o}},o.copyExtrudeVectors=function(t,o){var e;for(e=0;e<o.vectors.count;++e)t.vectors.items[e].vector[0]=o.vectors.items[e].vector[0],t.vectors.items[e].vector[1]=o.vectors.items[e].vector[1],t.vectors.items[e].texCoords[0]=o.vectors.items[e].texCoords[0],t.vectors.items[e].texCoords[1]=o.vectors.items[e].texCoords[1],t.vectors.items[e].direction[0]=o.vectors.items[e].direction[0],t.vectors.items[e].direction[1]=o.vectors.items[e].direction[1],t.vectors.items[e].base=o.vectors.items[e].base;t.vectors.count=o.vectors.count;var r=o.lists[y.ENTRY],i=t.lists[y.ENTRY],s=o.lists[y.EXIT],c=t.lists[y.EXIT],n=o.lists[y.CAP],v=t.lists[y.CAP];for(e=0;e<r.count;++e)i.items[e]=r.items[e];for(i.count=r.count,e=0;e<s.count;++e)c.items[e]=s.items[e];for(c.count=s.count,e=0;e<n.count;++e)v.items[e]=n.items[e];v.count=n.count,t.capCenter=o.capCenter};var c={vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0],base:void 0};function R(t,o){c.vector[0]=t.vector[0],c.vector[1]=t.vector[1],c.texCoords[0]=t.texCoords[0],c.texCoords[1]=t.texCoords[1],c.direction[0]=t.direction[0],c.direction[1]=t.direction[1],c.base=t.base,t.vector[0]=o.vector[0],t.vector[1]=o.vector[1],t.texCoords[0]=o.texCoords[0],t.texCoords[1]=o.texCoords[1],t.direction[0]=o.direction[0],t.direction[1]=o.direction[1],t.base=o.base,o.vector[0]=c.vector[0],o.vector[1]=c.vector[1],o.texCoords[0]=c.texCoords[0],o.texCoords[1]=c.texCoords[1],o.direction[0]=c.direction[0],o.direction[1]=c.direction[1],o.base=c.base}o.swapExtrudeVectors=R;var n,q=[];for(n=0;n<32;++n)q.push([void 0,void 0]);var N=function(t){var o,e={items:new Array,count:0};for(o=0;o<t;++o)e.items.push([void 0,void 0]);return e}(8);function w(t,o){return t[0]*o[0]+t[1]*o[1]}function u(t){return Math.sqrt(w(t,t))}function L(t,o){var e=u(o);return t[0]=o[0]/e,t[1]=o[1]/e,t}function V(t,o){return t[0]=-o[1],t[1]=o[0],t}function D(t,o){return t[0]*o[1]-t[1]*o[0]}function G(t,o){return t[0]=-o[0],t[1]=-o[1],t}function F(t,o,e){return t[0]=o[0]*e,t[1]=o[1]*e,t}function O(t,o,e){return t[0]=o[0]+e[0],t[1]=o[1]+e[1],t}function _(t,o,e){return r=t,s=e,((i=o)[0]-r[0])*(s[1]-r[1])-(s[0]-r[0])*(i[1]-r[1])<0;var r,i,s}function x(t,o){var e=w(t,o);return.999<e?0:e<-.999?Math.PI:Math.acos(e)}function X(t,o,e,r,i){if(0!==r){var s,c=u(o),n=(i?-1:1)*x(F(q[0],o,1/c),F(q[1],e,1/c))/r,v=Math.cos(n),d=Math.sin(n),C=o[0],a=o[1];for(s=0;s<r-1;++s){var m=C;C=v*m-d*a,a=d*m+v*a,t.items[s][0]=C,t.items[s][1]=a}t.count=r-1}else t.count=0}function j(t){var o,e=t.count,r=Math.floor(e/2);for(o=0;o<r;++o){var i=t.items[o];t.items[o]=t.items[e-o-1],t.items[e-o-1]=i}}o.length=u,o.normalize=L,o.getNumberOfSlices=function(t){return Math.max(Math.round(t*i),1)},o.getRads=x,o.reverse=j;var g=[void 0,void 0],Y=[void 0,void 0],z=[0,0],k=[0,0],B=[0,0],H=[0,0],l=Math.cos(Math.PI/4),f=Math.sin(Math.PI/4),A=Math.sqrt(2),v=function(){function t(t){this._distanceAlongCorrection=t.distanceAlongCorrection}return t.prototype.bridge=function(t,o,e){var r,i,s,c,n=o.vectors,v=o.lists[y.EXIT],d=e.vectors,C=e.lists[y.ENTRY];if(v.count===C.count+1)r=v.items,i=n.items,s=C.items,c=d.items;else if(C.count===v.count+1)r=C.items,i=d.items,s=v.items,c=n.items;else{if(v.count!==C.count)return console.error("Cannot bridge "+v.count+" to "+C.count+"."),void(t.count=0);r=C.items,i=d.items,s=v.items,c=n.items}var a,m=v.count+C.count-2;for(t.count=m,g[0]=r,g[1]=s,Y[0]=i,Y[1]=c,a=0;a<m;++a){var u=t.items[a],x=(a+0)%2,l=Math.floor((a+0)/2),f=Y[x][g[x][l]];u.v1.vector[0]=f.vector[0],u.v1.vector[1]=f.vector[1],u.v1.texCoords[0]=f.texCoords[0],u.v1.texCoords[1]=f.texCoords[1],u.v1.direction[0]=f.direction[0],u.v1.direction[1]=f.direction[1],u.v1.base=f.base;var A=(a+1)%2,T=Math.floor((a+1)/2),p=Y[A][g[A][T]];u.v2.vector[0]=p.vector[0],u.v2.vector[1]=p.vector[1],u.v2.texCoords[0]=p.texCoords[0],u.v2.texCoords[1]=p.texCoords[1],u.v2.direction[0]=p.direction[0],u.v2.direction[1]=p.direction[1],u.v2.base=p.base;var E=(a+2)%2,h=Math.floor((a+2)/2),b=Y[E][g[E][h]];u.v3.vector[0]=b.vector[0],u.v3.vector[1]=b.vector[1],u.v3.texCoords[0]=b.texCoords[0],u.v3.texCoords[1]=b.texCoords[1],u.v3.direction[0]=b.direction[0],u.v3.direction[1]=b.direction[1],u.v3.base=b.base;var M=u.v1.base&&u.v1.base.point||z,I=u.v2.base&&u.v2.base.point||z,P=u.v3.base&&u.v3.base.point||z;k[0]=M[0]+u.v1.vector[0],k[1]=M[1]+u.v1.vector[1],B[0]=I[0]+u.v2.vector[0],B[1]=I[1]+u.v2.vector[1],H[0]=P[0]+u.v3.vector[0],H[1]=P[1]+u.v3.vector[1],_(k,B,H)||R(u.v2,u.v3)}},t.prototype.pie=function(t,o){if(0!==o.lists[y.CAP].count){if(1===o.lists[y.CAP].count)return console.error("A single vector is not enough to define a pie."),void(t.count=0);var e;for(t.count=o.lists[y.CAP].count-1,e=0;e<t.count;++e){var r=t.items[e],i=o.lists[y.CAP].items[e],s=o.vectors.items[i];r.v1.vector[0]=s.vector[0],r.v1.vector[1]=s.vector[1],r.v1.texCoords[0]=s.texCoords[0],r.v1.texCoords[1]=s.texCoords[1],r.v1.direction[0]=s.direction[0],r.v1.direction[1]=s.direction[1],r.v1.base=s.base;var c=o.lists[y.CAP].items[e+1],n=o.vectors.items[c];r.v2.vector[0]=n.vector[0],r.v2.vector[1]=n.vector[1],r.v2.texCoords[0]=n.texCoords[0],r.v2.texCoords[1]=n.texCoords[1],r.v2.direction[0]=n.direction[0],r.v2.direction[1]=n.direction[1],r.v2.base=n.base;var v=o.capCenter,d=o.vectors.items[v];r.v3.vector[0]=d.vector[0],r.v3.vector[1]=d.vector[1],r.v3.texCoords[0]=d.texCoords[0],r.v3.texCoords[1]=d.texCoords[1],r.v3.direction[0]=d.direction[0],r.v3.direction[1]=d.direction[1],r.v3.base=d.base;var C=r.v1.base&&r.v1.base.point||z,a=r.v2.base&&r.v2.base.point||z,m=r.v3.base&&r.v3.base.point||z;k[0]=C[0]+r.v1.vector[0],k[1]=C[1]+r.v1.vector[1],B[0]=a[0]+r.v2.vector[0],B[1]=a[1]+r.v2.vector[1],H[0]=m[0]+r.v3.vector[0],H[1]=m[1]+r.v3.vector[1],_(k,B,H)||R(r.v2,r.v3)}}else t.count=0},t.prototype.buttCap=function(t,o,e){this.fastMiterJoin(t,o,e)},t.prototype.roundCap=function(t,o,e,r,i,s){void 0===s&&(s=0),this.fastMiterJoin(t,o,e);var c=r===T.START?0:1,n=r===T.START?1:0;t.capCenter=t.vectors.count;var v=t.vectors.items[t.capCenter];v.vector[0]=0,v.vector[1]=0,v.texCoords[0]=0,v.texCoords[1]=0,v.direction[0]=0,v.direction[1]=0,++t.vectors.count,X(N,t.vectors.items[c].vector,t.vectors.items[n].vector,i,!1);var d=t.vectors.count,C=t.lists[y.CAP];C.items[0]=c;var a,m=t.vectors.items[c].texCoords[1],u=t.vectors.items[n].texCoords[1];for(a=0;a<N.count;++a){var x=s*(1-Math.abs(N.count/2-a)/(N.count/2)),l=m+a/(N.count-1)*(u-m),f=N.items[a],A=t.vectors.items[d+a];A.vector[0]=f[0],A.vector[1]=f[1],A.texCoords[0]=x,A.texCoords[1]=l,A.direction[0]=0,A.direction[1]=0,C.items[a+1]=d+a}C.items[N.count+1]=n,C.count=N.count+2,t.vectors.count=d+N.count},t.prototype.squareCap=function(t,o,e,r){this.fastMiterJoin(t,o,e);var i=r===T.START?0:1,s=r===T.START?1:0,c=q[0],n=q[1],v=q[2],d=q[3],C=q[4],a=t.vectors.items[i].vector;c[0]=l*a[0]-f*a[1],c[1]=f*a[0]+l*a[1],F(d,c,A),n[0]=l*c[0]-f*c[1],n[1]=f*c[0]+l*c[1],v[0]=l*n[0]-f*n[1],v[1]=f*n[0]+l*n[1],F(C,v,A);var m=t.vectors.items[i];m.vector[0]=d[0],m.vector[1]=d[1];var u=t.vectors.items[s];u.vector[0]=C[0],u.vector[1]=C[1]},t.prototype.squareCapForDashedLines=function(t,o,e,r){if(r===T.START){var i=V(q[0],e),s=G(q[4],i),c=q[1],n=q[2],v=q[3];c[0]=l*i[0]-f*i[1],c[1]=f*i[0]+l*i[1],n[0]=l*c[0]-f*c[1],n[1]=f*c[0]+l*c[1],v[0]=l*n[0]-f*n[1],v[1]=f*n[0]+l*n[1],(d=q[5])[0]=0,d[1]=0,t.capCenter=0,(C=t.vectors.items)[0].vector[0]=d[0],C[0].vector[1]=d[1],C[0].direction[0]=0,C[0].direction[1]=0,C[0].texCoords[0]=0,C[0].texCoords[1]=0,C[1].vector[0]=i[0],C[1].vector[1]=i[1],C[1].direction[0]=0,C[1].direction[1]=0,C[1].texCoords[0]=0,C[1].texCoords[1]=-1,C[2].vector[0]=c[0]*A,C[2].vector[1]=c[1]*A,C[2].direction[0]=0,C[2].direction[1]=0,C[2].texCoords[0]=-1,C[2].texCoords[1]=-1,C[3].vector[0]=v[0]*A,C[3].vector[1]=v[1]*A,C[3].direction[0]=0,C[3].direction[1]=0,C[3].texCoords[0]=-1,C[3].texCoords[1]=1,C[4].vector[0]=s[0],C[4].vector[1]=s[1],C[4].direction[0]=0,C[4].direction[1]=0,C[4].texCoords[0]=0,C[4].texCoords[1]=1,t.vectors.count=5,t.lists[y.CAP].count=4,t.lists[y.CAP].items[0]=1,t.lists[y.CAP].items[1]=2,t.lists[y.CAP].items[2]=3,t.lists[y.CAP].items[3]=4,t.lists[y.ENTRY].count=0,t.lists[y.EXIT].count=3,t.lists[y.EXIT].items[0]=1,t.lists[y.EXIT].items[1]=0,t.lists[y.EXIT].items[2]=4}else{var d,C;i=V(q[0],e),s=G(q[4],i),c=q[1],n=q[2],v=q[3];c[0]=l*s[0]-f*s[1],c[1]=f*s[0]+l*s[1],n[0]=l*c[0]-f*c[1],n[1]=f*c[0]+l*c[1],v[0]=l*n[0]-f*n[1],v[1]=f*n[0]+l*n[1],(d=q[5])[0]=0,d[1]=0,t.capCenter=0,(C=t.vectors.items)[0].vector[0]=d[0],C[0].vector[1]=d[1],C[0].direction[0]=0,C[0].direction[1]=0,C[0].texCoords[0]=0,C[0].texCoords[1]=0,C[1].vector[0]=s[0],C[1].vector[1]=s[1],C[1].direction[0]=0,C[1].direction[1]=0,C[1].texCoords[0]=0,C[1].texCoords[1]=1,C[2].vector[0]=c[0]*A,C[2].vector[1]=c[1]*A,C[2].direction[0]=0,C[2].direction[1]=0,C[2].texCoords[0]=1,C[2].texCoords[1]=1,C[3].vector[0]=v[0]*A,C[3].vector[1]=v[1]*A,C[3].direction[0]=0,C[3].direction[1]=0,C[3].texCoords[0]=1,C[3].texCoords[1]=-1,C[4].vector[0]=i[0],C[4].vector[1]=i[1],C[4].direction[0]=0,C[4].direction[1]=0,C[4].texCoords[0]=0,C[4].texCoords[1]=-1,t.vectors.count=5,t.lists[y.CAP].count=4,t.lists[y.CAP].items[0]=1,t.lists[y.CAP].items[1]=2,t.lists[y.CAP].items[2]=3,t.lists[y.CAP].items[3]=4,t.lists[y.ENTRY].count=3,t.lists[y.ENTRY].items[0]=4,t.lists[y.ENTRY].items[1]=0,t.lists[y.ENTRY].items[2]=1,t.lists[y.EXIT].count=0}},t.prototype.fastMiterJoin=function(t,o,e){var r=V(q[0],e),i=r,s=G(q[1],r),c=t.vectors.items[0];c.vector[0]=i[0],c.vector[1]=i[1],c.texCoords[0]=0,c.texCoords[1]=J,c.direction[0]=0,c.direction[1]=0;var n=t.vectors.items[1];n.vector[0]=s[0],n.vector[1]=s[1],n.texCoords[0]=0,n.texCoords[1]=1,n.direction[0]=0,n.direction[1]=0,t.vectors.count=2;var v=t.lists[y.ENTRY];v.items[0]=0,v.items[1]=1,v.count=2;var d=t.lists[y.EXIT];d.items[0]=0,d.items[1]=1,d.count=2,t.lists[y.CAP].count=0,t.capCenter=void 0},t.prototype.miterJoin=function(t,o,e){var r=V(q[0],o),i=V(q[1],e),s=q[2];s[0]=r[0]+i[0],s[1]=r[1]+i[1];var c=L(q[3],s),n=w(c,r);c=F(q[4],c,1/n);var v=G(q[5],c);if(this._distanceAlongCorrection){(a=t.vectors.items[0]).vector[0]=c[0],a.vector[1]=c[1],a.texCoords[0]=0,a.texCoords[1]=J,a.direction[0]=o[0],a.direction[1]=o[1],(m=t.vectors.items[1]).vector[0]=v[0],m.vector[1]=v[1],m.texCoords[0]=0,m.texCoords[1]=1,m.direction[0]=o[0],m.direction[1]=o[1];var d=t.vectors.items[2];d.vector[0]=c[0],d.vector[1]=c[1],d.texCoords[0]=0,d.texCoords[1]=J,d.direction[0]=e[0],d.direction[1]=e[1];var C=t.vectors.items[3];C.vector[0]=v[0],C.vector[1]=v[1],C.texCoords[0]=0,C.texCoords[1]=1,C.direction[0]=e[0],C.direction[1]=e[1],t.vectors.count=4,(u=t.lists[y.ENTRY]).items[0]=0,u.items[1]=1,u.count=2,(x=t.lists[y.EXIT]).items[0]=2,x.items[1]=3,x.count=2}else{var a,m,u,x;(a=t.vectors.items[0]).vector[0]=c[0],a.vector[1]=c[1],a.texCoords[0]=0,a.texCoords[1]=J,a.direction[0]=0,a.direction[1]=0,(m=t.vectors.items[1]).vector[0]=v[0],m.vector[1]=v[1],m.texCoords[0]=0,m.texCoords[1]=1,m.direction[0]=0,m.direction[1]=0,t.vectors.count=2,(u=t.lists[y.ENTRY]).items[0]=0,u.items[1]=1,u.count=2,(x=t.lists[y.EXIT]).items[0]=0,x.items[1]=1,x.count=2}t.lists[y.CAP].count=0,t.capCenter=void 0},t.prototype.bevelJoin=function(t,o,e,r){var i=r*r,s=D(o,e),c=0<s?[J,1]:[1,J],n=c[0],v=c[1],d=0<s?G(q[0],V(q[1],o)):V(q[2],o),C=0<s?G(q[3],V(q[4],e)):V(q[5],e),a=q[6];a[0]=d[0]+C[0],a[1]=d[1]+C[1];var m=L(q[7],a),u=G(q[8],m),x=w(m,d),l=D(m,d),f=Math.abs(l/x),A=1+f*f,T=A<S?[f,this._distanceAlongCorrection]:[Math.sqrt(S-1),!0],p=T[0],E=T[1],h=A<i?[f,this._distanceAlongCorrection]:[Math.sqrt(i-1),!0],b=h[0],M=h[1];if(M&&E){O((g=t.vectors.items[0]).vector,G(q[9],d),F(q[10],G(q[11],o),p)),g.texCoords[0]=0,g.texCoords[1]=n,g.direction[0]=this._distanceAlongCorrection?o[0]:0,g.direction[1]=this._distanceAlongCorrection?o[1]:0,O((Y=t.vectors.items[1]).vector,G(q[12],C),F(q[13],e,p)),Y.texCoords[0]=0,Y.texCoords[1]=n,Y.direction[0]=this._distanceAlongCorrection?e[0]:0,Y.direction[1]=this._distanceAlongCorrection?e[1]:0,(P=t.vectors.items[2]).vector[0]=0,P.vector[1]=0,P.texCoords[0]=0,P.texCoords[1]=0,P.direction[0]=0,P.direction[1]=0,O((R=t.vectors.items[3]).vector,d,F(q[14],o,b)),R.texCoords[0]=0,R.texCoords[1]=v,R.direction[0]=this._distanceAlongCorrection?o[0]:0,R.direction[1]=this._distanceAlongCorrection?o[1]:0;var I=t.vectors.items[4];if(O(I.vector,C,F(q[15],G(q[16],e),b)),I.texCoords[0]=0,I.texCoords[1]=v,I.direction[0]=this._distanceAlongCorrection?e[0]:0,I.direction[1]=this._distanceAlongCorrection?e[1]:0,t.vectors.count=5,(N=t.lists[y.ENTRY]).items[0]=0,N.items[1]=2,N.items[2]=3,N.count=3,(X=t.lists[y.EXIT]).items[0]=1,X.items[1]=2,X.items[2]=4,X.count=3,A<i)(_=t.lists[y.CAP]).count=0,t.capCenter=void 0;else(_=t.lists[y.CAP]).items[0]=3,_.items[1]=4,_.count=2,t.capCenter=2}else if(!M&&E){O((g=t.vectors.items[0]).vector,G(q[9],d),F(q[10],G(q[11],o),p)),g.texCoords[0]=0,g.texCoords[1]=n,g.direction[0]=this._distanceAlongCorrection?o[0]:0,g.direction[1]=this._distanceAlongCorrection?o[1]:0,O((Y=t.vectors.items[1]).vector,G(q[12],C),F(q[13],e,p)),Y.texCoords[0]=0,Y.texCoords[1]=n,Y.direction[0]=this._distanceAlongCorrection?e[0]:0,Y.direction[1]=this._distanceAlongCorrection?e[1]:0,(P=t.vectors.items[2]).vector[0]=0,P.vector[1]=0,P.texCoords[0]=0,P.texCoords[1]=0,P.direction[0]=0,P.direction[1]=0,F((R=t.vectors.items[3]).vector,m,1/x),R.texCoords[0]=0,R.texCoords[1]=v,R.direction[0]=0,R.direction[1]=0,t.vectors.count=4,(N=t.lists[y.ENTRY]).items[0]=0,N.items[1]=2,N.items[2]=3,N.count=3,(X=t.lists[y.EXIT]).items[0]=1,X.items[1]=2,X.items[2]=3,X.count=3,t.lists[y.CAP].count=0,t.capCenter=void 0}else if(M&&!E){var P,R,_;if(F((g=t.vectors.items[0]).vector,u,1/x),g.texCoords[0]=0,g.texCoords[1]=n,g.direction[0]=0,g.direction[1]=0,(Y=t.vectors.items[1]).vector[0]=0,Y.vector[1]=0,Y.texCoords[0]=0,Y.texCoords[1]=0,Y.direction[0]=0,Y.direction[1]=0,O((P=t.vectors.items[2]).vector,d,F(q[9],o,b)),P.texCoords[0]=0,P.texCoords[1]=v,P.direction[0]=this._distanceAlongCorrection?o[0]:0,P.direction[1]=this._distanceAlongCorrection?o[1]:0,O((R=t.vectors.items[3]).vector,C,F(q[10],G(q[11],e),b)),R.texCoords[0]=0,R.texCoords[1]=v,R.direction[0]=this._distanceAlongCorrection?e[0]:0,R.direction[1]=this._distanceAlongCorrection?e[1]:0,t.vectors.count=4,(N=t.lists[y.ENTRY]).items[0]=0,N.items[1]=1,N.items[2]=2,N.count=3,(X=t.lists[y.EXIT]).items[0]=0,X.items[1]=1,X.items[2]=3,X.count=3,A<i)(_=t.lists[y.CAP]).count=0,t.capCenter=void 0;else(_=t.lists[y.CAP]).items[0]=2,_.items[1]=3,_.count=2,t.capCenter=1}else if(!M&&!E){var g,Y,N,X;F((g=t.vectors.items[0]).vector,u,1/x),g.texCoords[0]=0,g.texCoords[1]=n,g.direction[0]=0,g.direction[1]=0,F((Y=t.vectors.items[1]).vector,m,1/x),Y.texCoords[0]=0,Y.texCoords[1]=v,Y.direction[0]=0,Y.direction[1]=0,t.vectors.count=2,(N=t.lists[y.ENTRY]).items[0]=0,N.items[1]=1,N.count=2,(X=t.lists[y.EXIT]).items[0]=0,X.items[1]=1,X.count=2,t.lists[y.CAP].count=0,t.capCenter=void 0}s<0&&(j(t.lists[y.ENTRY]),j(t.lists[y.EXIT]))},t.prototype.roundJoin=function(t,o,e,r){var i=D(o,e),s=0<i?[J,1]:[1,J],c=s[0],n=s[1],v=0<i?G(q[0],V(q[1],o)):V(q[2],o),d=0<i?G(q[3],V(q[4],e)):V(q[5],e),C=q[6];C[0]=v[0]+d[0],C[1]=v[1]+d[1];var a=L(q[7],C),m=G(q[8],a),u=w(a,v),x=D(a,v),l=Math.abs(x/u),f=1+l*l<S?[l,this._distanceAlongCorrection]:[Math.sqrt(S-1),!0],A=f[0];if(f[1]){(p=t.vectors.items[0]).vector[0]=v[0],p.vector[1]=v[1],p.texCoords[0]=0,p.texCoords[1]=n,p.direction[0]=0,p.direction[1]=0,(E=t.vectors.items[1]).vector[0]=d[0],E.vector[1]=d[1],E.texCoords[0]=0,E.texCoords[1]=n,E.direction[0]=0,E.direction[1]=0,O((h=t.vectors.items[2]).vector,G(q[9],v),F(q[10],G(q[11],o),A)),h.texCoords[0]=0,h.texCoords[1]=c,h.direction[0]=this._distanceAlongCorrection?o[0]:0,h.direction[1]=this._distanceAlongCorrection?o[1]:0,O((b=t.vectors.items[3]).vector,G(q[12],d),F(q[13],e,A)),b.texCoords[0]=0,b.texCoords[1]=c,b.direction[0]=this._distanceAlongCorrection?e[0]:0,b.direction[1]=this._distanceAlongCorrection?e[1]:0;var T=t.vectors.items[4];T.vector[0]=0,T.vector[1]=0,T.texCoords[0]=0,T.texCoords[1]=0,T.direction[0]=0,T.direction[1]=0,t.vectors.count=5,(M=t.lists[y.ENTRY]).items[0]=2,M.items[1]=4,M.items[2]=0,M.count=3,(I=t.lists[y.EXIT]).items[0]=3,I.items[1]=4,I.items[2]=1,I.count=3,t.capCenter=4}else{var p,E,h,b,M,I;(p=t.vectors.items[0]).vector[0]=v[0],p.vector[1]=v[1],p.texCoords[0]=0,p.texCoords[1]=n,p.direction[0]=0,p.direction[1]=0,(E=t.vectors.items[1]).vector[0]=d[0],E.vector[1]=d[1],E.texCoords[0]=0,E.texCoords[1]=n,E.direction[0]=0,E.direction[1]=0,F((h=t.vectors.items[2]).vector,m,1/u),h.texCoords[0]=0,h.texCoords[1]=c,h.direction[0]=0,h.direction[1]=0,(b=t.vectors.items[3]).vector[0]=0,b.vector[1]=0,b.texCoords[0]=0,b.texCoords[1]=0,b.direction[0]=0,b.direction[1]=0,t.vectors.count=4,(M=t.lists[y.ENTRY]).items[0]=2,M.items[1]=3,M.items[2]=0,M.count=3,(I=t.lists[y.EXIT]).items[0]=2,I.items[1]=3,I.items[2]=1,I.count=3,t.capCenter=3}X(N,v,d,r,i<0);var P,R=t.vectors.count,_=t.lists[y.CAP];for(P=_.items[0]=0;P<N.count;++P){var g=N.items[P],Y=t.vectors.items[R+P];Y.vector[0]=g[0],Y.vector[1]=g[1],Y.texCoords[0]=0,Y.texCoords[1]=n,Y.direction[0]=0,Y.direction[1]=0,_.items[P+1]=R+P}_.items[N.count+1]=1,_.count=N.count+2,t.vectors.count=R+N.count,i<0&&(j(t.lists[y.ENTRY]),j(t.lists[y.EXIT]))},t.prototype.unitRoundJoin=function(t,o,e,r){var i=D(o,e),s=0<i?[J,1]:[1,J],c=s[0],n=s[1],v=0<i?G(q[0],V(q[1],o)):V(q[2],o),d=0<i?G(q[3],V(q[4],e)):V(q[5],e),C=t.vectors.items[0];C.vector[0]=v[0],C.vector[1]=v[1],C.texCoords[0]=0,C.texCoords[1]=n,C.direction[0]=0,C.direction[1]=0;var a=t.vectors.items[1];a.vector[0]=d[0],a.vector[1]=d[1],a.texCoords[0]=0,a.texCoords[1]=n,a.direction[0]=0,a.direction[1]=0;var m=t.vectors.items[2];G(m.vector,v),m.texCoords[0]=0,m.texCoords[1]=c,m.direction[0]=0,m.direction[1]=0;var u=t.vectors.items[3];G(u.vector,d),u.texCoords[0]=0,u.texCoords[1]=c,u.direction[0]=0,u.direction[1]=0;var x=t.vectors.items[4];x.vector[0]=0,x.vector[1]=0,x.texCoords[0]=0,x.texCoords[1]=0,x.direction[0]=0,x.direction[1]=0,t.vectors.count=5;var l=t.lists[y.ENTRY];l.items[0]=2,l.items[1]=0,l.count=2;var f=t.lists[y.EXIT];f.items[0]=3,f.items[1]=1,f.count=2,t.capCenter=4,X(N,v,d,r,i<0);var A,T=t.vectors.count,p=t.lists[y.CAP];for(A=p.items[0]=0;A<N.count;++A){var E=N.items[A],h=t.vectors.items[T+A];h.vector[0]=E[0],h.vector[1]=E[1],h.texCoords[0]=0,h.texCoords[1]=n,h.direction[0]=0,h.direction[1]=0,p.items[A+1]=T+A}p.items[N.count+1]=1,p.count=N.count+2,t.vectors.count=T+N.count,i<0&&(j(t.lists[y.ENTRY]),j(t.lists[y.EXIT]))},t.prototype.rectJoin=function(t,o,e){var r=V(q[0],o),i=V(q[1],e),s=t.vectors.items[0];s.vector[0]=r[0],s.vector[1]=r[1],s.texCoords[0]=0,s.texCoords[1]=J,s.direction[0]=0,s.direction[1]=0;var c=t.vectors.items[1];c.vector[0]=i[0],c.vector[1]=i[1],c.texCoords[0]=0,c.texCoords[1]=J,c.direction[0]=0,c.direction[1]=0;var n=t.vectors.items[2];G(n.vector,r),n.texCoords[0]=0,n.texCoords[1]=1,n.direction[0]=0,n.direction[1]=0;var v=t.vectors.items[3];G(v.vector,i),v.texCoords[0]=0,v.texCoords[1]=1,v.direction[0]=0,v.direction[1]=0,t.vectors.count=4;var d=t.lists[y.ENTRY];d.items[0]=0,d.items[1]=2,d.count=2;var C=t.lists[y.EXIT];C.items[0]=1,C.items[1]=3,C.count=2,t.capCenter=void 0},t}();o.Tessellator=v});