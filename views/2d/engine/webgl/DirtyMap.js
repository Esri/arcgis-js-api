/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["./Utils"],(function(t){"use strict";function i(t,i,n){if(!t.allDirty)if(null!=t.from&&null!=t.count){const r=Math.min(t.from,i),e=Math.max(t.from+t.count,i+n)-r;t.from=r,t.count=e}else t.from=i,t.count=n}return function(){function n(){this._dirties=t.createGeometryData((()=>({indices:{from:null,count:null,allDirty:!1}})),(()=>({vertices:{from:null,count:null,allDirty:!1}})))}var r=n.prototype;return r.hasDirty=function(){for(const t of this._dirties)if(null!==t.data.indices.count||t.data.indices.allDirty)return!0;return!1},r.markAllClean=function(){for(const t of this._dirties){t.data.indices.from=null,t.data.indices.count=null,t.data.indices.allDirty=!1;for(const i in t.buffers)t.buffers[i].data.vertices.from=null,t.buffers[i].data.vertices.count=null,t.buffers[i].data.vertices.allDirty=!1}},r.markAllDirty=function(){for(const t of this._dirties){t.data.indices.allDirty=!0;for(const i in t.buffers)t.buffers[i].data.vertices.allDirty=!0}},r.forEach=function(t){for(let i=0;i<this._dirties.length;++i){const n=this._dirties[i],r={};for(const t in n.buffers){const i=n.buffers[t].data.vertices;(i.allDirty||null!=i.from&&null!=i.count&&i.count>0)&&(r[t]=i)}const e=n.data.indices;let s;s=e.allDirty||null!=e.from&&null!=e.count&&e.count>0?{indices:e,vertices:r}:{indices:null,vertices:r},(s.indices||Object.keys(s).length>0)&&t(s,i)}},r.markDirtyIndices=function(t,n,r){i(this._dirties[t].data.indices,n,r)},r.markDirtyVertices=function(t,n,r,e){i(this._dirties[t].buffers[n].data.vertices,r,e)},n}()}));
