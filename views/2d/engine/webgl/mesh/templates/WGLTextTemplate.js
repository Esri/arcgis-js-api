/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/screenUtils","../../alignmentUtils","../../util/BidiText","../../materialKey/MaterialKey","../../color","./WGLBaseTextTemplate","./WGLMeshTemplate"],(function(e,t,i,n,l,o,a,r){"use strict";return function(a){function r(e,n,o,r,s,c,f,h,p,u,m,_,x,d,A,g,y,z=!1){var M;(M=a.call(this)||this)._xOffset=t.pt2px(_),M._yOffset=t.pt2px(x),M._decoration=p||"none",M._color=r,M._haloColor=s,M._haloSize=Math.min(Math.floor(5*t.pt2px(t.toPt(o))),127),M._size=Math.min(Math.round(t.pt2px(n)),127);const b=Math.min(Math.round(t.pt2px(n)),127);M._referenceSize=Math.round(Math.sqrt(256*b)),M._scale=M._size/24,M._angle=m,M._justify=i.getJustification(c||"center"),M._xAlignD=i.getXAnchorDirection(c||"center"),M._yAlignD=i.getYAnchorDirection(f||"baseline"),M._baseline="baseline"===(f||"baseline"),M._bitset=(1===h?1:0)|(u?1:0)<<1;const T=l.MaterialKeyBase.load(e);return T.sdf=!0,M._materialKey=T.data,M._lineWidth=t.pt2px(d)||512,M._lineHeight=A||1,M._textPlacement=g,M.effects=y,M._isCIM=z,M}return e._inheritsLoose(r,a),r.fromText=function(e,t){const i=new r(e.materialKey,e.font.size,e.haloSize||0,e.color&&o.premultiplyAlphaRGBAArray(e.color)||0,e.haloColor&&o.premultiplyAlphaRGBAArray(e.haloColor)||0,e.horizontalAlignment,e.verticalAlignment,0,e.font.decoration,!1,e.angle||0,e.xoffset,e.yoffset,e.lineWidth,e.lineHeight,null,null,!1),[,l]=n.bidiText(e.text);return i.bindTextInfo(t,l),i},r.fromCIMText=function(e,t){const i=e.scaleFactor||1,l=new r(e.materialKey,e.size*e.sizeRatio*i,e.outlineSize*e.sizeRatio,o.premultiplyAlphaRGBA(e.color),o.premultiplyAlphaRGBA(e.outlineColor),e.horizontalAlignment,e.verticalAlignment,e.alignment,e.decoration,e.colorLocked,e.angle,e.offsetX*e.sizeRatio*i,e.offsetY*e.sizeRatio*i,512,1,e.markerPlacement,e.effects,!0),[,a]=n.bidiText(e.text);return l.bindTextInfo(t,a),l},r}(a(r))}));
