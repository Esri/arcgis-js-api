/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/mathUtils","../../../../../../core/screenUtils","../../definitions","../../number","../../materialKey/MaterialKey","../../color","../../GeometryUtils","./WGLMeshTemplate","./WGLBaseFillTemplate"],(function(t,e,o,i,l,r,n,s,c,f){"use strict";const a=128;return function(c){function f(t,e,o,i,l,n,s,f,a){var u;(u=c.call(this)||this)._effects=a;const h=r.FillMaterialKey.load(t);return e&&(h.sdf=e.sdf,h.pattern=!0,h.textureBinding=e.textureBinding),u.fillColor=o,u.tl=i,u.br=l,u.aux1=n,u.aux2=s,u.aux3=f,u._materialKey=h.data,u}return t._inheritsLoose(f,c),f.fromCIMFill=function(t,r){const c=t.color,u=c&&n.premultiplyAlphaRGBA(c)||0,h=t.materialKey;if(!r){return new f(h,null,u,0,0,0,0,l.i8888to32(0,0,0,t.colorLocked?1:0),t.effects)}const{rect:w,width:p,height:x}=r,P=w.x+i.SPRITE_PADDING,y=w.y+i.SPRITE_PADDING,T=P+p,g=y+x;let m=e.nextHighestPowerOfTwo(x);m>255?m=255:m<=0&&(m=e.nextHighestPowerOfTwo(g-y));let d=e.nextHighestPowerOfTwo(p||0);d>255?d=255:d<=0&&(d=e.nextHighestPowerOfTwo(T-P));let I=o.pt2px(t.offsetX||0)+a;I>255&&(I=255);let D=o.pt2px(-t.offsetY||0)+a;D>255&&(D=255);const _=t.scaleX||1,A=1;return new f(h,r,u,l.i1616to32(P,y),l.i1616to32(T,g),l.i8888to32(d,m,I,D),l.i1616to32(a*_,a*A),l.i8888to32(0,0,s.degToByte(t.angle),t.colorLocked?1:0),t.effects)},f.fromSimpleFill=function(t,o,r=!1){const{color:s}=t,c=s&&"esriSFSNull"!==t.style&&n.premultiplyAlphaRGBAArray(s)||0,u=l.i8888to32(0,0,0,r?255:0),h=t.materialKey;if(!o)return new f(h,null,c,0,0,0,0,u,null);const{rect:w,width:p,height:x}=o,P=w.x+i.SPRITE_PADDING,y=w.y+i.SPRITE_PADDING,T=P+p,g=y+x;return new f(h,o,c,l.i1616to32(P,y),l.i1616to32(T,g),l.i8888to32(e.nextHighestPowerOfTwo(T-P),e.nextHighestPowerOfTwo(g-y),0,0),l.i1616to32(a,a),u,null)},f.fromPictureFill=function(t,r,n=!1){const s=i.PICTURE_FILL_COLOR,{rect:c,width:u,height:h}=r,w=c.x+i.SPRITE_PADDING,p=c.y+i.SPRITE_PADDING,x=w+u,P=p+h,y=l.i1616to32(w,p),T=l.i1616to32(x,P);let g=e.nextHighestPowerOfTwo(o.pt2px(t.width));g>255&&(g=255);let m=e.nextHighestPowerOfTwo(o.pt2px(t.height));m>255&&(m=255);let d=o.pt2px(t.xoffset)+a;d>255&&(d=255);let I=o.pt2px(-t.yoffset)+a;I>255&&(I=255);const D=l.i8888to32(g,m,d,I),_=l.i1616to32(a*t.xscale,a*t.yscale),A=l.i8888to32(0,0,0,n?255:0);return new f(t.materialKey,r,s,y,T,D,_,A,null)},f}(f(c))}));
