/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/screenUtils","../../color","../../definitions","../../GeometryUtils","../../number","../../materialKey/MaterialKey","./util","./WGLBaseFillTemplate","./WGLMeshTemplate"],(function(t,e,l,i,o,n,r,_,a,s){"use strict";const u=128;return function(a){function s(t,e,l,o,_,s,u,c,O,I,f,M,T,h,E,p){var A;(A=a.call(this)||this)._effects=h;const d=r.FillMaterialKey.load(t);return e&&(d.sdf=e.sdf,d.pattern=!0,d.textureBinding=e.textureBinding),A.fillColor=l,A.tl=o,A.br=_,A.aux2=n.i8888to32(s,u,c,O),A.aux3=n.i8888to32(I,f,M,0),A._bitset=T,A._minMaxZoom=n.i1616to32(Math.round(E*i.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(p*i.MIN_MAX_ZOOM_PRECISION_FACTOR)),A._materialKey=d.data,A}return t._inheritsLoose(s,a),s.fromCIMFill=function(t,r,a){const c=t.color,O=c&&l.premultiplyAlphaRGBA(c)||0,I=t.materialKey,[f,M]=_.getMinMaxZoom(t.scaleInfo,a);if(!r)return new s(I,null,O,0,0,0,0,0,0,0,0,0,t.colorLocked?i.BITSET_GENERIC_LOCK_COLOR:0,t.effects,f,M);const{rect:T,width:h,height:E}=r,p=t.scaleX||1,A=T.x+i.SPRITE_PADDING,d=T.y+i.SPRITE_PADDING,L=A+h,m=d+E,R=t.height,y=p*R;let C=Math.round(R);C>255?C=255:C<=0&&(C=m-d);let D=Math.round(y);D>255?D=255:D<=0&&(D=L-A);let N=e.pt2px(t.offsetX||0)+u;N>255&&(N=255);let x=e.pt2px(-t.offsetY||0)+u;x>255&&(x=255);return new s(I,r,O,n.i1616to32(A,d),n.i1616to32(L,m),D,C,N,x,u,u,o.degToByte(t.angle),t.colorLocked?i.BITSET_GENERIC_LOCK_COLOR:0,t.effects,f,M)},s.fromSimpleFill=function(t,e,o=!1){const{color:r}=t,a=r&&"esriSFSNull"!==t.style&&l.premultiplyAlphaRGBAArray(r)||0,c=o?i.BITSET_GENERIC_LOCK_COLOR:0,O=t.materialKey;let I;if(e){const{rect:t,width:l,height:o}=e,r=t.x+i.SPRITE_PADDING,f=t.y+i.SPRITE_PADDING,M=r+l,T=f+o;I=new s(O,e,a,n.i1616to32(r,f),n.i1616to32(M,T),l,o,0,0,u,u,0,c,null,_.DEFAULT_MIN_ZOOM,_.DEFAULT_MAX_ZOOM)}else I=new s(O,null,a,0,0,0,0,0,0,0,0,0,c,null,_.DEFAULT_MIN_ZOOM,_.DEFAULT_MAX_ZOOM);return I._maybeAddLineTemplate(t),I},s.fromPictureFill=function(t,l,o=!1){const r=i.PICTURE_FILL_COLOR,{rect:a,width:c,height:O}=l,I=a.x+i.SPRITE_PADDING,f=a.y+i.SPRITE_PADDING,M=I+c,T=f+O,h=n.i1616to32(I,f),E=n.i1616to32(M,T);let p=Math.round(e.pt2px(t.width));p>255&&(p=255);let A=Math.round(e.pt2px(t.height));A>255&&(A=255);let d=e.pt2px(t.xoffset)+u;d>255&&(d=255);let L=e.pt2px(-t.yoffset)+u;L>255&&(L=255);const m=t.materialKey,R=o?i.BITSET_GENERIC_LOCK_COLOR:0,y=new s(m,l,r,h,E,p,A,d,L,u*t.xscale,u*t.yscale,0,R,null,_.DEFAULT_MIN_ZOOM,_.DEFAULT_MAX_ZOOM);return y._maybeAddLineTemplate(t),y},s}(a(s))}));
