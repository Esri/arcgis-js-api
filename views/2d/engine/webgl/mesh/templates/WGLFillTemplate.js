/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/screenUtils","../../color","../../definitions","../../GeometryUtils","../../number","../../materialKey/MaterialKey","./util","./WGLBaseFillTemplate","./WGLMeshTemplate"],(function(t,e,l,i,n,o,r,_,a,s){"use strict";const u=128;return function(a){function s(t,e,l,n,_,s,u,O,I,c,f,p,T,M,A,E){var h;(h=a.call(this)||this)._effects=M;const R=r.FillMaterialKey.load(t);return e&&(R.sdf=e.sdf,R.pattern=!0,R.textureBinding=e.textureBinding),h.fillColor=l,h.tl=n,h.br=_,h.aux21=o.i1616to32(s,u),h.aux22=o.i1616to32(O,I),h.aux3=o.i8888to32(c,f,p,0),h._bitset=T,h._minMaxZoom=o.i1616to32(Math.round(A*i.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(E*i.MIN_MAX_ZOOM_PRECISION_FACTOR)),h._materialKey=R.data,h}return t._inheritsLoose(s,a),s.fromCIMFill=function(t,r,a){const O=t.color,I=O&&l.premultiplyAlphaRGBA(O)||0,c=t.materialKey,[f,p]=_.getMinMaxZoom(t.scaleInfo,a),T=(t.colorLocked?i.BITSET_GENERIC_LOCK_COLOR:0)|(t.applyRandomOffset?i.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(t.sampleAlphaOnly?i.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);if(!r)return new s(c,null,I,0,0,0,0,0,0,0,0,0,T,t.effects,f,p);const{rect:M,width:A,height:E}=r,h=t.scaleX||1,R=M.x+i.SPRITE_PADDING,d=M.y+i.SPRITE_PADDING,L=R+A,m=d+E,y=e.pt2px(t.height),N=h*y;let x=Math.round(y);x<=0&&(x=m-d);let D=Math.round(N);D<=0&&(D=L-R);const C=e.pt2px(t.offsetX||0),P=e.pt2px(-t.offsetY||0);return new s(c,r,I,o.i1616to32(R,d),o.i1616to32(L,m),D,x,C,P,u,u,n.degToByte(t.angle),T,t.effects,f,p)},s.fromSimpleFill=function(t,e,n=!1){const{color:r}=t,a=r&&"esriSFSNull"!==t.style&&l.premultiplyAlphaRGBAArray(r)||0,O=n?i.BITSET_GENERIC_LOCK_COLOR:0,I=t.materialKey;let c;if(e){const{rect:t,width:l,height:n,pixelRatio:r}=e,f=t.x+i.SPRITE_PADDING,p=t.y+i.SPRITE_PADDING,T=f+l,M=p+n;c=new s(I,e,a,o.i1616to32(f,p),o.i1616to32(T,M),l/r,n/r,0,0,u,u,0,O,null,_.DEFAULT_MIN_ZOOM,_.DEFAULT_MAX_ZOOM)}else c=new s(I,null,a,0,0,0,0,0,0,0,0,0,O,null,_.DEFAULT_MIN_ZOOM,_.DEFAULT_MAX_ZOOM);return c._maybeAddLineTemplate(t),c},s.fromPictureFill=function(t,l,n=!1){const r=i.PICTURE_FILL_COLOR,{rect:a,width:O,height:I}=l,c=a.x+i.SPRITE_PADDING,f=a.y+i.SPRITE_PADDING,p=c+O,T=f+I,M=o.i1616to32(c,f),A=o.i1616to32(p,T),E=Math.round(e.pt2px(t.width)),h=Math.round(e.pt2px(t.height)),R=e.pt2px(t.xoffset),d=e.pt2px(-t.yoffset),L=t.materialKey,m=n?i.BITSET_GENERIC_LOCK_COLOR:0,y=new s(L,l,r,M,A,E,h,R,d,u*t.xscale,u*t.yscale,0,m,null,_.DEFAULT_MIN_ZOOM,_.DEFAULT_MAX_ZOOM);return y._maybeAddLineTemplate(t),y},s}(a(s))}));
