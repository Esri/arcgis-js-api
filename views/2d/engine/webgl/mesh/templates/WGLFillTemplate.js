/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/screenUtils","../../color","../../definitions","../../GeometryUtils","../../number","../../materialKey/MaterialKey","./util","./WGLBaseFillTemplate","./WGLMeshTemplate"],(function(t,e,l,i,o,n,r,a,_,s){"use strict";const u=128;return function(_){function s(t,e,l,o,a,s,u,c,f,M,I,O,h,p,A,d){var T;(T=_.call(this)||this)._effects=p;const m=r.FillMaterialKey.load(t);return e&&(m.sdf=e.sdf,m.pattern=!0,m.textureBinding=e.textureBinding),T.fillColor=l,T.tl=o,T.br=a,T.aux2=n.i8888to32(s,u,c,f),T.aux3=n.i8888to32(M,I,O,0),T._bitset=h,T._minMaxZoom=n.i1616to32(Math.round(A*i.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(d*i.MIN_MAX_ZOOM_PRECISION_FACTOR)),T._materialKey=m.data,T}return t._inheritsLoose(s,_),s.fromCIMFill=function(t,r,_){const c=t.color,f=c&&l.premultiplyAlphaRGBA(c)||0,M=t.materialKey,[I,O]=a.getMinMaxZoom(t.scaleInfo,_);if(!r)return new s(M,null,f,0,0,0,0,0,0,0,0,0,t.colorLocked?1:0,t.effects,I,O);const{rect:h,width:p,height:A}=r,d=t.scaleX||1,T=h.x+i.SPRITE_PADDING,m=h.y+i.SPRITE_PADDING,E=T+p,y=m+A,L=t.height,D=d*L;let R=Math.round(L);R>255?R=255:R<=0&&(R=y-m);let x=Math.round(D);x>255?x=255:x<=0&&(x=E-T);let P=e.pt2px(t.offsetX||0)+u;P>255&&(P=255);let N=e.pt2px(-t.offsetY||0)+u;N>255&&(N=255);return new s(M,r,f,n.i1616to32(T,m),n.i1616to32(E,y),x,R,P,N,u,u,o.degToByte(t.angle),t.colorLocked?1:0,t.effects,I,O)},s.fromSimpleFill=function(t,e,o=!1){const{color:r}=t,_=r&&"esriSFSNull"!==t.style&&l.premultiplyAlphaRGBAArray(r)||0,c=o?i.BITSET_GENERIC_LOCK_COLOR:0,f=t.materialKey;let M;if(e){const{rect:t,width:l,height:o}=e,r=t.x+i.SPRITE_PADDING,I=t.y+i.SPRITE_PADDING,O=r+l,h=I+o;M=new s(f,e,_,n.i1616to32(r,I),n.i1616to32(O,h),l,o,0,0,u,u,0,c,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM)}else M=new s(f,null,_,0,0,0,0,0,0,0,0,0,c,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM);return M._maybeAddLineTemplate(t),M},s.fromPictureFill=function(t,l,o=!1){const r=i.PICTURE_FILL_COLOR,{rect:_,width:c,height:f}=l,M=_.x+i.SPRITE_PADDING,I=_.y+i.SPRITE_PADDING,O=M+c,h=I+f,p=n.i1616to32(M,I),A=n.i1616to32(O,h);let d=Math.round(e.pt2px(t.width));d>255&&(d=255);let T=Math.round(e.pt2px(t.height));T>255&&(T=255);let m=e.pt2px(t.xoffset)+u;m>255&&(m=255);let E=e.pt2px(-t.yoffset)+u;E>255&&(E=255);const y=t.materialKey,L=o?i.BITSET_GENERIC_LOCK_COLOR:0,D=new s(y,l,r,p,A,d,T,m,E,u*t.xscale,u*t.yscale,0,L,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM);return D._maybeAddLineTemplate(t),D},s}(_(s))}));
