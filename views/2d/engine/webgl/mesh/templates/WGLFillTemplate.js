/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/mathUtils","../../../../../../core/screenUtils","../../definitions","../../number","../../materialKey/MaterialKey","../../color","../../GeometryUtils","./WGLMeshTemplate","./WGLBaseFillTemplate"],(function(t,e,i,o,l,r,n,s,c,f){"use strict";const a=128;return function(c){function f(t,e,i,o,l,n,s,f,a){var u;(u=c.call(this)||this).effects=a;const h=r.FillMaterialKey.load(t);return e&&(h.sdf=e.sdf,h.pattern=!0,h.textureBinding=e.textureBinding),u.fillColor=i,u.tl=o,u.br=l,u.aux1=n,u.aux2=s,u.aux3=f,u._materialKey=h.data,u}return t._inheritsLoose(f,c),f.fromCIMFill=function(t,r){const c=t.color,u=c&&n.premultiplyAlphaRGBA(c)||0,h=t.materialKey;if(!r){return new f(h,null,u,0,0,0,0,l.i8888to32(0,0,0,t.colorLocked?1:0),t.effects)}const{rect:p,width:x,height:w}=r,P=p.x+o.SPRITE_PADDING,g=p.y+o.SPRITE_PADDING,y=P+x,T=g+w;let m=e.nextHighestPowerOfTwo(i.pt2px(t.height||0));m>255?m=255:m<=0&&(m=e.nextHighestPowerOfTwo(T-g));let d=e.nextHighestPowerOfTwo(i.pt2px(t.height/w*x||0));d>255?d=255:d<=0&&(d=e.nextHighestPowerOfTwo(y-P));let I=i.pt2px(t.offsetX||0)+a;I>255&&(I=255);let D=i.pt2px(-t.offsetY||0)+a;D>255&&(D=255);const A=t.scaleX||1;return new f(h,r,u,l.i1616to32(P,g),l.i1616to32(y,T),l.i8888to32(d,m,I,D),l.i1616to32(a*A,128),l.i8888to32(0,0,s.degToByte(t.angle),t.colorLocked?1:0),t.effects)},f.fromSimpleFill=function(t,i,r=!1){const{color:s}=t,c=s&&"esriSFSNull"!==t.style&&n.premultiplyAlphaRGBAArray(s)||0,u=l.i8888to32(0,0,0,r?255:0),h=t.materialKey;if(!i)return new f(h,null,c,0,0,0,0,u,null);const{rect:p,width:x,height:w}=i,P=p.x+o.SPRITE_PADDING,g=p.y+o.SPRITE_PADDING,y=P+x,T=g+w;return new f(h,i,c,l.i1616to32(P,g),l.i1616to32(y,T),l.i8888to32(e.nextHighestPowerOfTwo(y-P),e.nextHighestPowerOfTwo(T-g),0,0),l.i1616to32(a,a),u,null)},f.fromPictureFill=function(t,r,n=!1){const s=o.PICTURE_FILL_COLOR,{rect:c,width:u,height:h}=r,p=c.x+o.SPRITE_PADDING,x=c.y+o.SPRITE_PADDING,w=p+u,P=x+h,g=l.i1616to32(p,x),y=l.i1616to32(w,P);let T=e.nextHighestPowerOfTwo(i.pt2px(t.width));T>255&&(T=255);let m=e.nextHighestPowerOfTwo(i.pt2px(t.height));m>255&&(m=255);let d=i.pt2px(t.xoffset)+a;d>255&&(d=255);let I=i.pt2px(-t.yoffset)+a;I>255&&(I=255);const D=l.i8888to32(T,m,d,I),A=l.i1616to32(a*t.xscale,a*t.yscale),G=l.i8888to32(0,0,0,n?255:0);return new f(t.materialKey,r,s,g,y,D,A,G,null)},f}(f(c))}));
