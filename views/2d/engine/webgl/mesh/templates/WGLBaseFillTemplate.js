/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../layers/graphics/featureConversionUtils","../../number","../../enums","../../materialKey/MaterialKey","./templateUtils"],(function(t,e,r,a,i,s){"use strict";return o=>function(o){function n(...t){var e;return(e=o.call(this,...t)||this).forceLibtess=!1,e.geometryType=a.WGLGeometryType.FILL,e}t._inheritsLoose(n,o);var l=n.prototype;return l.writeMeshWithGeometry=function(t,r,a,o,n,l){const u=i.FillMaterialKey.load(this._materialKey),h=r.indexVector,c=r.getVector("geometry"),y=c.vertexCount,d=h.length;let p=l?e.deltaDecodeGeometry(e.convertFromGeometry(l),2):a.readUnquantizedGeometry();if(!p)return;if(p=s.clipMarshall(p),!p)return;let m=p.coords;!this.forceLibtess&&s.triangulate(h,p,y)||(m=[],s.triangulateLibtess(m,h,p,y)),this._write(c,a,n,m,u);const f=c.vertexCount-y,g=h.length-d;t.writeDisplayRecord(this.geometryType,this._materialKey,y,f,d,g)},l._write=function(t,e,a,i,s){for(let o=0;o<i.length;o+=2){const n=r.i1616to32(1*i[o],1*i[o+1]);t.data.push(n),t.data.push(a),s.dotDensity?t.data.writeF32(1/Math.abs(e.readGeometryArea())):(t.data.push(this.fillColor),t.data.push(this.tl),t.data.push(this.br),t.data.push(this.aux1),t.data.push(this.aux2),t.data.push(this.aux3))}},n}(o)}));
