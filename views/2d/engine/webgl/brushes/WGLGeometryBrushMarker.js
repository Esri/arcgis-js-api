/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../enums","../Utils","./WGLGeometryBrush","../materialKey/MaterialKey","../../../../webgl/enums"],(function(t,e,a,o,n,i,r){"use strict";const s=t=>o.createProgramDescriptor(t.data,{geometry:[{location:0,name:"a_pos",count:2,type:r.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:r.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:r.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:r.DataType.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:r.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:r.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:r.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:r.DataType.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:r.DataType.UNSIGNED_SHORT}]});let y=function(o){function n(){return o.apply(this,arguments)||this}t._inheritsLoose(n,o);var y=n.prototype;return y.dispose=function(){},y.getGeometryType=function(){return a.WGLGeometryType.MARKER},y.drawGeometry=function(t,a,o,n){const{context:y,painter:p,rendererInfo:l,state:c,passOptions:m}=t,u=i.MarkerMaterialKey.load(o.materialKey),{bufferLayouts:T,attributes:_}=s(u),d=p.materialManager.getMaterialProgram(t,u,"materials/icon",_,n);y.useProgram(d),u.textureBinding&&p.textureManager.bindTextures(y,d,u,!0);let D=r.PrimitiveType.TRIANGLES;e.isSome(m)&&"hittest"===m.type&&(D=r.PrimitiveType.POINTS),this._setSharedUniforms(d,t,a);const E=u.vvRotation?c.displayViewMat3:c.displayMat3;d.setUniformMatrix3fv("u_displayMat3",E),this._setSizeVVUniforms(u,d,l,a),this._setColorAndOpacityVVUniforms(u,d,l),this._setRotationVVUniforms(u,d,l);const N=o.target.getVAO(y,T,_),S=o.indexFrom*Uint32Array.BYTES_PER_ELEMENT;y.bindVAO(N),y.drawElements(D,o.indexCount,r.DataType.UNSIGNED_INT,S)},n}(n);return y}));
