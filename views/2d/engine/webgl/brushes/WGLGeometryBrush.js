/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions","./WGLBrush"],(function(e,t,i,o){"use strict";let n=function(o){function n(){return o.apply(this,arguments)||this}e._inheritsLoose(n,o);var s=n.prototype;return s.prepareState=function({context:e},t,i){const o=i&&-1!==i.indexOf("id");e.setBlendingEnabled(!o),e.setBlendFunctionSeparate(1,771,1,771),e.setColorMask(!0,!0,!0,!0),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0),e.setStencilFunction(514,t.stencilRef,255)},s.draw=function(e,i,o){const n=this.getGeometryType();i.commit(e);const s=i.getGeometry(n);t.isNone(s)||(e.timeline.begin(this.name),e.attributeView.bindTextures(e.context),s.forEachCommand((t=>this.drawGeometry(e,i,t,o))))},s._setSharedUniforms=function(e,t,o){const{displayLevel:n,pixelRatio:s,state:a}=t;e.setUniform1f("u_pixelRatio",s),e.setUniformMatrix3fv("u_dvsMat3",o.transforms.dvs,!1,!0),e.setUniformMatrix3fv("u_displayViewMat3",a.displayViewMat3,!1,!0),e.setUniform1f("u_currentZoom",Math.round(n*i.MIN_MAX_ZOOM_PRECISION_FACTOR)),e.setUniform1i("u_attributeTextureSize",t.attributeView.size),e.setUniform1i("u_attributeData0",i.TEXTURE_BINDING_ATTRIBUTE_DATA_0),e.setUniform1i("u_attributeData1",i.TEXTURE_BINDING_ATTRIBUTE_DATA_1),e.setUniform1i("u_attributeData2",i.TEXTURE_BINDING_ATTRIBUTE_DATA_2),e.setUniform1i("u_attributeData3",i.TEXTURE_BINDING_ATTRIBUTE_DATA_3)},s._setSizeVVUniforms=function(e,t,i,o){if(e.vvSizeMinMaxValue&&t.setUniform4fv("u_vvSizeMinMaxValue",i.vvSizeMinMaxValue),e.vvSizeScaleStops&&t.setUniform1f("u_vvSizeScaleStopsValue",i.vvSizeScaleStopsValue),e.vvSizeFieldStops){const e=i.getSizeVVFieldStops(o.key.level);t.setUniform1fv("u_vvSizeFieldStopsValues",e.values),t.setUniform1fv("u_vvSizeFieldStopsSizes",e.sizes)}e.vvSizeUnitValue&&t.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",i.vvSizeUnitValueToPixelsRatio)},s._setColorAndOpacityVVUniforms=function(e,t,i){e.vvColor&&(t.setUniform1fv("u_vvColorValues",i.vvColorValues),t.setUniform4fv("u_vvColors",i.vvColors)),e.vvOpacity&&(t.setUniform1fv("u_vvOpacityValues",i.vvOpacityValues),t.setUniform1fv("u_vvOpacities",i.vvOpacities))},s._setRotationVVUniforms=function(e,t,i){e.vvRotation&&t.setUniform1f("u_vvRotationType","geographic"===i.vvMaterialParameters.vvRotationType?0:1)},n}(o);return n}));
