/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../enums","../number","./WGLBrush"],(function(e,t,r,n,i,a){"use strict";let s=function(e){function a(){var t;return(t=e.apply(this,arguments)||this)._programOptions={id:!1},t}t._inheritsLoose(a,e);var s=a.prototype;return s.dispose=function(){},s.drawMany=function(e,t){const{context:a,displayLevel:s,requiredLevel:l,state:o,drawPhase:c,painter:u,spriteMosaic:f,styleLayerUID:d}=e;if(!t.some((e=>{var t,r;return null!=(t=null==(r=e.layerData.get(d))?void 0:r.circleIndexCount)&&t})))return;const p=e.styleLayer,y=p.circleMaterial,m=u.vectorTilesMaterialManager,v=1.2,g=p.getPaintValue("circle-translate",s),M=p.getPaintValue("circle-translate-anchor",s),_=c===n.WGLDrawPhase.HITTEST,h=this._programOptions;h.id=_;const x=m.getMaterialProgram(a,y,h);a.useProgram(x),x.setUniformMatrix3fv("u_displayMat3",1===M?o.displayMat3:o.displayViewMat3),x.setUniform2fv("u_circleTranslation",g),x.setUniform1f("u_depth",p.z),x.setUniform1f("u_antialiasingWidth",v);let L=-1;if(_){const e=i.u32to4Xu8(d+1);x.setUniform4fv("u_id",e)}for(const n of t){if(!n.layerData.has(d))continue;n.key.level!==L&&(L=n.key.level,y.setDataUniforms(x,s,p,L,f));const e=n.layerData.get(d);if(!e.circleIndexCount)continue;e.prepareForRendering(a);const t=e.circleVertexArrayObject;r.isNone(t)||(a.bindVAO(t),x.setUniformMatrix3fv("u_dvsMat3",n.transforms.dvs),l!==n.key.level?a.setStencilFunction(514,n.stencilRef,255):a.setStencilFunction(516,255,255),a.drawElements(4,e.circleIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*e.circleIndexStart),n.triangleCount+=e.circleIndexCount/3)}},a}(a);e.WGLBrushVTLCircle=s,Object.defineProperty(e,"__esModule",{value:!0})}));
