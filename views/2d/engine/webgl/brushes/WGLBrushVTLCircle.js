/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../../../../../chunks/vec4f32","../number","../enums","./WGLBrush"],(function(t,e,r,i,o,a,s){"use strict";const n=[1,1,1,1];let c=function(t){function s(){var e;return(e=t.apply(this,arguments)||this)._color=i.create(),e._strokeColor=i.create(),e._programOptions={id:!1},e}e._inheritsLoose(s,t);var c=s.prototype;return c.dispose=function(){},c.drawMany=function(t,e){const{context:i,state:s,drawPhase:c,styleLayerUID:l}=t,u=t.displayLevel,f=t.styleLayer,h=t.painter.getVectorTileProgramCache(),_=f.hasDataDrivenRadius?1:f.getPaintValue("circle-radius",u),d=f.hasDataDrivenColor?n:f.getPaintValue("circle-color",u),p=f.hasDataDrivenOpacity?1:f.getPaintValue("circle-opacity",u),g=f.hasDataDrivenStrokeWidth?1:f.getPaintValue("circle-stroke-width",u),m=f.hasDataDrivenStrokeColor?n:f.getPaintValue("circle-stroke-color",u),y=f.hasDataDrivenStrokeOpacity?1:f.getPaintValue("circle-stroke-opacity",u),v=f.hasDataDrivenBlur?0:f.getPaintValue("circle-blur",u);let D=p*d[3];this._color[0]=D*d[0],this._color[1]=D*d[1],this._color[2]=D*d[2],this._color[3]=D,D=y*m[3],this._strokeColor[0]=D*m[0],this._strokeColor[1]=D*m[1],this._strokeColor[2]=D*m[2],this._strokeColor[3]=D;const P=f.getPaintValue("circle-translate",u),k=f.getPaintValue("circle-translate-anchor",u),V=c===a.WGLDrawPhase.HITTEST,C=V?1:0,U=this._programOptions;U.id=V;const b=h.getProgram(5,C,U);if(i.bindProgram(b),b.setUniformMatrix3fv("u_displayMat3",1===k?s.displayMat3:s.displayViewMat3),b.setUniform2fv("u_circleTranslation",P),b.setUniform1f("u_depth",f.z),b.setUniform1f("u_radius",_),b.setUniform4fv("u_color",this._color),b.setUniform1f("u_blur",v),b.setUniform1f("u_stroke_width",g),b.setUniform4fv("u_stroke_color",this._strokeColor),b.setUniform1f("u_antialiasingWidth",1.2),V){const t=o.u32to4Xu8(l+1);b.setUniform4fv("u_id",t)}for(const t of e){if(!t.layerData.has(l))continue;const e=t.layerData.get(l);e.prepareForRendering(i,h);const o=e.circleVertexArrayObject;r.isNone(o)||(i.bindVAO(o),b.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs),i.setStencilFunction(514,t.stencilRef,255),i.drawElements(4,e.circleIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*e.circleIndexStart),t.triangleCount+=e.circleIndexCount/3)}},s}(s);t.WGLBrushVTLCircle=c,Object.defineProperty(t,"__esModule",{value:!0})}));
