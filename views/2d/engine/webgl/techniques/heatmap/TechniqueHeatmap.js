/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","../../../../../../core/screenUtils","../../../../../../renderers/support/heatmapUtils","../Technique","../../../../../webgl/enums"],(function(e,t,a,n,r,i,s){"use strict";let o=function(e){function i(){return e.apply(this,arguments)||this}return t._inheritsLoose(i,e),i.getStorageSpec=function({field:e,valueExpression:t}){return{visualVariables:!1,attributes:e||t?[{field:e,valueExpression:t}]:null}},i._createRendererSchema=function(){return{type:"heatmap",radius:-1,referenceScale:-1,isFieldActive:0,minDensity:-1,densityRange:-1,kernel:null,gradient:null,gradientHash:"invalid"}},i.createOrUpdateRendererSchema=function(e,t){const{radius:i,minDensity:s,maxDensity:o,referenceScale:c,field:l,valueExpression:u,colorStops:p}=t,d=o-s,m=l||u?1:0,y=p.map((({color:e,ratio:t})=>`${t}:${e.toString()}`)).join();let h,g=!0;return a.isSome(e)&&"heatmap"===e.type?(h=e,g=y!==e.gradientHash):h=this._createRendererSchema(),h.radius=n.pt2px(i),h.minDensity=s,h.densityRange=d,h.referenceScale=c,h.isFieldActive=m,g&&(h.gradient=r.generateGradient(p),h.gradientHash=y),h},i}(i.Technique);o.type="heatmap",o.programSpec={shader:"materials/icon/heatmapAccumulate",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:s.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:s.DataType.SHORT},{location:4,name:"a_id",count:4,type:s.DataType.UNSIGNED_BYTE}]}},e.HeatmapTechnique=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
