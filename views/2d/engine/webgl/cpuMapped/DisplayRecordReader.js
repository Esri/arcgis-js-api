/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions"],(function(t,e,i,n){"use strict";const s=2147483647;let r=function(){function t(t){this._head=t,this._cursor=t}t.from=function(e,i=0,n=e.byteLength/_.BYTES_PER_RECORD-i){return new t(new _(new Int32Array(e,i*_.BYTES_PER_RECORD,n*_.ELEMENTS_PER_RECORD)))};var n=t.prototype;return n.size=function(){let t=this._cursor,e=0;for(;t;)e+=t.size(),t=t._link;return e},n.seekIndex=function(t){let e=t;for(this._cursor=this._head;this._cursor;){const t=this._cursor.size();if(e<t)return this._cursor._index=e,!0;e-=t,this._cursor=this._cursor._link}return!1},n.forEach=function(t){const e=this.getCursor();for(;e.next();)t(e)},n.link=function(t){if(!this._head)return void(this._head=t._head);let e=this._head;for(;e._link;)e=e._link;e._link=t._head,e._link._indexStart=e._indexStart+e.size()},n.getCursor=function(){return this.copy()},n.lookup=function(t){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(t);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor},n.copy=function(){const e=new t(this._head?.copy());if(!e._head)return e;let i=e._head,n=e._head._link;for(;n;)i._link=n.copy(),i=n,n=i._link;return e},n.next=function(){return!!this._cursor&&(!!this._cursor.next()||!!this._cursor._link&&(this._cursor=this._cursor._link,this.next()))},n.peekId=function(){return this._cursor.peekId()??this._cursor._link.peekId()},n.delete=function(t){let e=this._head,n=null;for(;e;){if(e.delete(t))return e.isEmpty()&&(i.isSome(n)&&(n._link=e._link),e===this._head&&(this._head=e._link),e===this._cursor&&(this._cursor=e._link)),!0;n=e,e=e._link}return!1},e._createClass(t,[{key:"id",get:function(){return this._cursor.id},set:function(t){this._cursor.id=t}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(t){this._cursor.materialKey=t}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(t){this._cursor.indexFrom=t}},{key:"indexCount",get:function(){return this._cursor.indexCount},set:function(t){this._cursor.indexCount=t}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(t){this._cursor.vertexFrom=t}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(t){this._cursor.vertexCount=t}},{key:"sortKey",get:function(){return this._cursor.sortKey},set:function(t){this._cursor.sortKey=t}},{key:"index",get:function(){return this._cursor._indexStart+this._cursor._index}}]),t}();r.ELEMENTS_PER_RECORD=n.DISPLAY_RECORD_INT_PER_ELEMENT,r.BYTES_PER_RECORD=r.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;let _=function(){function t(t){this._link=null,this._index=-1,this._indexStart=0,this._packedRecordsF32=null,this._deletedCount=0,this._offsets={instance:null},this._packedRecords=t}t.from=function(e,i=0,n=e.byteLength/this.BYTES_PER_RECORD-i){return new t(new Int32Array(e,i*this.BYTES_PER_RECORD,n*this.ELEMENTS_PER_RECORD))};var n=t.prototype;return n.delete=function(t){const e=this._index,i=this.lookup(t);if(i)for(this.id=s,++this._deletedCount;this.next()&&this.id===t;)this.id=s,++this._deletedCount;return this._index=e,i},n.isEmpty=function(){return this._deletedCount===this.size()},n.link=function(t){this._link?this._link.link(t):this._link=t},n.lookup=function(t){if(i.isNone(this._offsets.instance)){this._offsets.instance=new Map;const t=this.copy();t._index=-1;let e=0;for(;t.next();)t.id!==e&&(this._offsets.instance.set(t.id,t._index),e=t.id)}if(!this._offsets.instance.has(t))return!1;const e=this._index;return this._index=this._offsets.instance.get(t),this.id!==s||(this._index=e,!1)},n.size=function(){return this._packedRecords.length/t.ELEMENTS_PER_RECORD},n.next=function(){for(;++this._index<this.size()&&this.id===s;);return this._index<this.size()},n.peekId=function(){const e=(this._index+1)*t.ELEMENTS_PER_RECORD;return e>=this._packedRecords.length?0:this._packedRecords[e]},n.getCursor=function(){return this.copy()},n.copy=function(){const e=new t(this._packedRecords);return e._indexStart=this._indexStart,e._link=this._link,e._index=this._index,e._offsets=this._offsets,e._deletedCount=this._deletedCount,e},e._createClass(t,[{key:"id",get:function(){return this._packedRecords[this._index*t.ELEMENTS_PER_RECORD]},set:function(e){this._packedRecords[this._index*t.ELEMENTS_PER_RECORD]=e}},{key:"materialKey",get:function(){return this._packedRecords[this._index*t.ELEMENTS_PER_RECORD+1]},set:function(e){this._packedRecords[this._index*t.ELEMENTS_PER_RECORD+1]=e}},{key:"insertAfter",get:function(){return this._packedRecords[this._index*t.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*t.ELEMENTS_PER_RECORD+3]},set:function(e){this._packedRecords[this._index*t.ELEMENTS_PER_RECORD+3]=e}},{key:"indexCount",get:function(){return this._packedRecords[this._index*t.ELEMENTS_PER_RECORD+4]},set:function(e){this._packedRecords[this._index*t.ELEMENTS_PER_RECORD+4]=e}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*t.ELEMENTS_PER_RECORD+5]},set:function(e){this._packedRecords[this._index*t.ELEMENTS_PER_RECORD+5]=e}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*t.ELEMENTS_PER_RECORD+6]},set:function(e){this._packedRecords[this._index*t.ELEMENTS_PER_RECORD+6]=e}},{key:"sortKey",get:function(){return this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer)),this._packedRecordsF32[this._index*t.ELEMENTS_PER_RECORD+7]},set:function(e){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer)),this._packedRecordsF32[this._index*t.ELEMENTS_PER_RECORD+7]=e}},{key:"index",get:function(){return this._index}}]),t}();_.ELEMENTS_PER_RECORD=n.DISPLAY_RECORD_INT_PER_ELEMENT,_.BYTES_PER_RECORD=_.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT,t.DisplayRecordReader=r,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
