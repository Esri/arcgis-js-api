/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat2d","../../../../chunks/mat3","../../../../chunks/mat3f32","../../../../chunks/vec2","../../../../chunks/vec2f32","./definitions","./TiledDisplayObject"],(function(t,e,s,r,n,i,a,o,c){"use strict";let h=function(){function t(){this._cache=new Map}var e=t.prototype;return e.acquire=function(t){const e=this._cache;if(e.has(t)){const s=e.get(t);return s.refCount++,s}const s={refCount:1,version:-1,labelMat2d:n.create(),tileMat3:n.create(),dvs:n.create()};return e.set(t,s),s},e.release=function(t){--this._cache.get(t).refCount||this._cache.delete(t)},t}(),u=function(t){function n(e,s,r){return t.call(this,e,s,r,o.TILE_SIZE,o.TILE_SIZE)||this}e._inheritsLoose(n,t);var c=n.prototype;return c.destroy=function(){t.prototype.destroy.call(this),this._transforms&&n.TransformCache.release(this.key.hash)},c.setTransform=function(t,e){if(t.version===this.transforms.version)return;this.transforms.version=t.version;const n=e/(t.resolution*t.pixelRatio),o=this.transforms.tileMat3,[c,h]=t.toScreenNoRotation([0,0],[this.x,this.y]),u=this.width/this.rangeX*n,l=this.height/this.rangeY*n;r.set(o,u,0,0,0,l,0,c,h,1),r.multiply(this.transforms.dvs,t.displayViewMat3,o);const f=this.transforms.labelMat2d,d=t.getScreenTransform(f,e),m=a.create();i.transformMat2d(m,[this.x,this.y],d),s.identity(f),s.translate(f,f,m),s.multiply(f,t.viewMat2d,f)},c._createTransforms=function(){return n.TransformCache.acquire(this.key.hash)},n}(c.TiledDisplayObject);u.TransformCache=new h,t.WGLTile=u,Object.defineProperty(t,"__esModule",{value:!0})}));
