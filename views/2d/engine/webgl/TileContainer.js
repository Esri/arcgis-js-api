/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/has","./enums","./WGLContainer","./brushes/WGLBrushInfo","./brushes/WGLBrushStencil"],(function(e,t,r,s,n,i,l){"use strict";const o=(e,t)=>e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col;let a=function(e){function n(t){var r;return(r=e.call(this)||this)._tileInfoView=t,r}t._inheritsLoose(n,e);var a=n.prototype;return a.renderChildren=function(t){this.sortChildren(o),this.setStencilReference(t),e.prototype.renderChildren.call(this,t)},a.createRenderParams=function(t){const{state:r}=t,s=e.prototype.createRenderParams.call(this,t);return s.requiredLevel=this._tileInfoView.getClosestInfoForScale(r.scale).level,s.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(r.scale),s},a.prepareRenderPasses=function(t){const n=e.prototype.prepareRenderPasses.call(this,t);return n.push(t.registerRenderPass({name:"stencil",brushes:[l],drawPhase:s.WGLDrawPhase.DEBUG|s.WGLDrawPhase.MAP|s.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()})),r("esri-tiles-debug")&&n.push(t.registerRenderPass({name:"tileInfo",brushes:[i],drawPhase:s.WGLDrawPhase.DEBUG,target:()=>this.children})),n},a.getStencilTarget=function(){return this.children},a.updateTransforms=function(e){for(const t of this.children){const r=this._tileInfoView.getTileResolution(t.key);t.setTransform(e,r)}},a.setStencilReference=function(e){let t=1;for(const r of this.children)r.stencilRef=t++},t._createClass(n,[{key:"requiresDedicatedFBO",get:function(){return!1}}]),n}(n);e.default=a,e.sortByLevel=o,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
