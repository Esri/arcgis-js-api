/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["../../../../chunks/_rollupPluginBabelHelpers","./enums"],(function(e,n){"use strict";function t(e,n,t,...o){n<e.length?e.splice(n,t,...o):e.push(...o)}const o=new Map;o.set(n.WGLDrawPhase.MAP,[n.WGLGeometryType.FILL,n.WGLGeometryType.LINE,n.WGLGeometryType.MARKER,n.WGLGeometryType.TEXT]),o.set(n.WGLDrawPhase.LABEL,[n.WGLGeometryType.LABEL]),o.set(n.WGLDrawPhase.LABEL_ALPHA,[n.WGLGeometryType.LABEL]);let i=function(){function n(){this.symbolLevels=[]}var o=n.prototype;return o.replay=function(e,n,t){for(const o of this.symbolLevels)for(const i of o.zLevels){const o=i.geometryDPInfo.unified;if(o)for(const i of o){const o=e.painter.getGeometryBrush(i.geometryType),r=n.getGeometry(i.geometryType),l={geometryType:i.geometryType,materialKey:i.materialKey,indexFrom:i.indexFrom,indexCount:i.indexCount,target:r};o.prepareState(e,n),o.drawGeometry(e,n,l,t)}}},o.clear=function(){this.symbolLevels.length=0},o.addToList=function(e,n){if(Array.isArray(e))for(const t of e)this._addToList(t,n);else this._addToList(e,n)},o.removeFromList=function(e){Array.isArray(e)||(e=[e]);let n=null;for(const t of e)n=this._removeFromList(t);return n},o.clone=function(){const e=new n;for(const n of this.symbolLevels)e.symbolLevels.push(n.clone());return e},o.splitAfter=function(e){const n=this._getDisplayList(e.symbolLevel,e.zOrder),t=n.length,o=e.indexFrom+e.indexCount;for(let i=0;i<t;++i){const t=n[i];if(t.geometryType===e.geometryType&&o>t.indexFrom&&o<=t.indexFrom+t.indexCount){if(o<t.indexFrom+t.indexCount){const e=new r;e.geometryType=t.geometryType,e.materialKey=t.materialKey,e.indexFrom=o,e.indexCount=t.indexFrom+t.indexCount-o,n.splice(i+1,0,e),t.indexCount=o-t.indexFrom}return i}}},o._addToList=function(e,n){const o=e.symbolLevel,i=e.zOrder,l=this._getDisplayList(o,i),s=null!=n?n:l.length-1,m=s>=0&&s<l.length?l[s]:null;if(null!==m&&m.materialKey===e.materialKey&&m.indexFrom+m.indexCount===e.indexFrom&&m.geometryType===e.geometryType)m.indexCount+=e.indexCount;else{const n=new r;n.indexFrom=e.indexFrom,n.indexCount=e.indexCount,n.materialKey=e.materialKey,n.geometryType=e.geometryType,t(l,s+1,0,n)}},o._removeFromList=function(e){const n=e.symbolLevel,o=e.zOrder,i=this._getDisplayList(n,o),l=i.length;let s;for(let t=0;t<l;++t){const n=i[t];if(e.indexFrom+e.indexCount>n.indexFrom&&e.indexFrom<n.indexFrom+n.indexCount&&n.geometryType===e.geometryType){s=t;break}}if(void 0!==s){const n=i[s];if(e.indexFrom===n.indexFrom)return n.indexCount-=e.indexCount,n.indexFrom+=e.indexCount,0===n.indexCount&&t(i,s,1),s-1;if(e.indexFrom+e.indexCount===n.indexFrom+n.indexCount)return n.indexCount-=e.indexCount,0===n.indexCount?(t(i,s,1),s-1):s;{const o=n.indexFrom,l=e.indexFrom-n.indexFrom,m=e.indexCount,u=n.indexFrom+n.indexCount-(e.indexFrom+e.indexCount);n.indexCount=l;const y=new r;return y.geometryType=n.geometryType,y.materialKey=n.materialKey,y.indexFrom=o+l+m,y.indexCount=u,t(i,s+1,0,y),s}}return null},o._getDisplayList=function(e,n){let t;const o=this.symbolLevels.length;for(let l=0;l<o;l++)if(this.symbolLevels[l].symbolLevel===e){t=this.symbolLevels[l];break}let i;t||(t=new m,t.symbolLevel=e,this.symbolLevels.push(t));const r=t.zLevels.length;for(let l=0;l<r;l++)if(t.zLevels[l].zLevel===n){i=t.zLevels[l];break}return i||(i=new s,i.geometryDPInfo=new l,i.zLevel=n,t.zLevels.push(i)),i.geometryDPInfo.unified||(i.geometryDPInfo.unified=[]),i.geometryDPInfo.unified},o.getDPInfoType=function(){return"unified"},e._createClass(n,[{key:"empty",get:function(){return!this.symbolLevels||0===this.symbolLevels.length}}]),n}(),r=function(){function e(){this.materialKey=null,this.indexFrom=0,this.indexCount=0}return e.prototype.clone=function(){const n=new e;return n.geometryType=this.geometryType,n.materialKey=this.materialKey,n.indexFrom=this.indexFrom,n.indexCount=this.indexCount,n},e}(),l=function(){function e(){this.fill=null,this.line=null,this.marker=null,this.text=null,this.label=null,this.unified=null}return e.prototype.clone=function(){const n=new e;return n.fill=this.fill&&this.fill.map((e=>e.clone())),n.line=this.line&&this.line.map((e=>e.clone())),n.marker=this.marker&&this.marker.map((e=>e.clone())),n.text=this.text&&this.text.map((e=>e.clone())),n.label=this.label&&this.label.map((e=>e.clone())),n.unified=this.unified&&this.unified.map((e=>e.clone())),n},e}(),s=function(){function e(){this.geometryDPInfo=new l}return e.prototype.clone=function(){const n=new e;return n.zLevel=this.zLevel,n.geometryDPInfo=this.geometryDPInfo.clone(),n},e}(),m=function(){function e(){this.zLevels=[]}return e.prototype.clone=function(){const n=new e;n.symbolLevel=this.symbolLevel;for(const e of this.zLevels)n.zLevels.push(e.clone());return n},e}();return i}));
