/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../webgl/brushes/WGLBrush"],(function(e,t,n){"use strict";let r=function(n){function r(){return n.apply(this,arguments)||this}e._inheritsLoose(r,n);var a=r.prototype;return a.dispose=function(){},a.prepareState=function(e){const{context:t}=e;t.setColorMask(!0,!0,!0,!0),t.setStencilFunction(514,0,255)},a.draw=function(e,n){const{context:r}=e,{displayData:a}=n;if(t.isNone(a))return;if("loaded"===a.state.name&&a.prepareForRendering(r,i,o),"attached"!==a.state.name)return;const s=a.state.resources,l=e.painter.materialManager.getProgram(e,{vsPath:"raster/flow",fsPath:"raster/flow",attributes:i});r.setFaceCullingEnabled(!1),r.setBlendingEnabled(!0),r.setBlendFunctionSeparate(1,771,1,1),r.useProgram(l),l.setUniform1f("u_time",e.time/1e3),l.setUniform1f("u_fadeDuration",a.flowStyle.renderSettings.fadeDuration),l.setUniform1f("u_lineSpeed",a.flowStyle.renderSettings.lineSpeed),l.setUniformMatrix3fv("u_dvsMat3",n.transforms.dvs),l.setUniformMatrix3fv("u_displayViewMat3",e.state.displayViewMat3),l.setUniform4f("u_lineColor",a.flowStyle.renderSettings.lineColor[0]*e.globalOpacity,a.flowStyle.renderSettings.lineColor[1]*e.globalOpacity,a.flowStyle.renderSettings.lineColor[2]*e.globalOpacity,a.flowStyle.renderSettings.lineColor[3]*e.globalOpacity),l.setUniform1f("u_lineHalfWidth",a.flowStyle.renderSettings.lineRenderWidth/2),r.bindVAO(s.vertexArray),r.drawElements(4,s.indexBuffer.size,5125,0),a.flowStyle.animated&&n.requestRender()},r}(n);const i=new Map;i.set("a_positionAndSide",0),i.set("a_timeInfo",1),i.set("a_extrude",2);const o={geometry:[{name:"a_positionAndSide",count:3,type:5126,offset:0,stride:32,normalized:!1},{name:"a_timeInfo",count:3,type:5126,offset:12,stride:32,normalized:!1},{name:"a_extrude",count:2,type:5126,offset:24,stride:32,normalized:!1}]};return r}));
