/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6","../../../../core/Accessor","../../../../core/accessorSupport/decorators/property","../../../../core/arrayUtils","../../../../core/has","../../../../core/accessorSupport/ensureType","../../../../core/accessorSupport/decorators/subclass","./dataUtils","./FlowContainer","./FlowStrategy","./FlowStyle"],(function(e,t,r,o,n,a,i,s,c,l,p,d){"use strict";let y=function(t){function r(){var r;return(r=t.apply(this,arguments)||this)._loadImagery=(e,t,o,n)=>c.loadImagery(r.layer,e,t,o,n),r._createStreamlinesMesh=(e,t,o)=>r.layer.createStreamlinesMesh({flowData:t,rendererSettings:e},{signal:o}),r.container=null,r.layer=null,r.type="rasterAnimatedFlow",r.redrawOrRefetch=e._asyncToGenerator((function*(){r._rendererChanged()})),r}e._inheritsLoose(r,t);var o=r.prototype;return o.update=function(e){e.stationary?this._strategy.update(e):this.layerView.requestUpdate()},o.install=function(e){this.container=new l,e.addChild(this.container),this._strategy=new p({flowContainer:this.container}),this._rendererChanged()},o.uninstall=function(){this._strategy.destroy(),this.container.removeAllChildren(),this.container.remove()},o.moveEnd=function(){},o.doRefresh=function(){var t=e._asyncToGenerator((function*(){}));function r(){return t.apply(this,arguments)}return r}(),o.attach=function(){},o._rendererChanged=function(){if("animated-flow"!==this.layer.renderer.type)return;const e=new d(this._loadImagery,this._createStreamlinesMesh,this.layer.renderer);this.container.flowStyle=e,this.layerView.requestUpdate()},e._createClass(r,[{key:"updating",get:function(){return!this._strategy||this._strategy.updating}}]),r}(r);t.__decorate([o.property()],y.prototype,"_strategy",void 0),t.__decorate([o.property()],y.prototype,"container",void 0),t.__decorate([o.property()],y.prototype,"layer",void 0),t.__decorate([o.property()],y.prototype,"layerView",void 0),t.__decorate([o.property()],y.prototype,"type",void 0),t.__decorate([o.property()],y.prototype,"updating",null),y=t.__decorate([s.subclass("esri.views.2d.engine.flow.AnimatedFlowView2D")],y);return y}));
