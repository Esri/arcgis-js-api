/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../../core/maybe","./aspectProcessor","./bandArithmeticProcessor","./compositeBandProcessor","./convolutionProcessor","./extractBandProcessor","./localProcessor","./maskProcessor","./ndviProcessor","./remapProcessor","./reprojectProcessor","./slopeProcessor","./stretchProcessor","../../../../webgl/context-util","../../../../webgl/enums","../../../../webgl/Texture"],(function(e,t,r,o,s,n,c,a,i,u,l,p,d,m,x,T,P){"use strict";const f=new Map;function h(e,t,r){const o={width:t,height:r,target:T.TextureType.TEXTURE_2D,pixelFormat:T.PixelFormat.RGBA,internalFormat:e.type===x.ContextType.WEBGL2?T.SizedPixelFormat.RGBA32F:T.PixelFormat.RGBA,samplingMode:T.TextureSamplingMode.NEAREST,dataType:T.PixelType.FLOAT,isImmutable:e.type===x.ContextType.WEBGL2,wrapMode:T.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1};return new P.Texture(e,o)}function b(e,r,o,s){const{context:n,requestRender:c,allowDelayedRender:a}=e,i=s.createProgram(e,o);if(a&&t.isSome(c)&&!i.compiled)return c(),null;const{width:u,height:l}=o;return n.bindFramebuffer(r),n.setViewport(0,0,u,l),n.useProgram(i),i}function g(e){return f.get(e.toLowerCase())}function w(e,t,r,o){const s=e.rasterFunction.name.toLowerCase(),n="reproject"===s?p:g(s);if(null==n)return;const c=b(e,r,o,n);if(!c)return;n.bindTextureAndUniforms(e,c,o),t.draw();const{width:a,height:i}=o,u=h(e.context,a,i);if(r.copyToTexture(0,0,a,i,0,0,u),"reproject"===s)o.rasterTexture=u,o.projected=!0;else{const t=e.hasBranches?e.rasterFunction.id:0;o.functionTextures[t]=u}}f.set("aspect",r),f.set("bandarithmetic",o),f.set("compositeband",s),f.set("convolution",n),f.set("extractband",c),f.set("local",a),f.set("mask",i),f.set("ndvi",u),f.set("remap",l),f.set("slope",d),f.set("stretch",m),e.createTexture=h,e.process=w,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
