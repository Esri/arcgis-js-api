/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../webgl/rasterUtils"],(function(e,t){"use strict";const n=[1,1],s=[2,0,0,0,2,0,-1,-1,0];function r(e,n,s){const{context:r,rasterFunction:a,hasBranches:i}=e,{raster:o}=a.parameters,u=i?o?.id??-1:0,f=s.functionTextures[u]??s.rasterTexture;t.setTextures(r,n,["u_image"],[f])}function a(e,n,s){const{rasters:a}=e.rasterFunction.parameters;if(!a)return;if(a.length<2)return r(e,n,s);const i=a.filter((e=>"Constant"!==e.name)).map((e=>null!=e.id&&"Identity"!==e.name?s.functionTextures[e.id]:s.rasterTexture));if(t.setTextures(e.context,n,["u_image","u_image1","u_image2"].slice(0,i.length),i),i.length!==a.length)if(2===a.length){const e=a.findIndex((e=>"Constant"===e.name)),t=0===e?[0,1,0,1,0,0,0,0,0]:[1,0,0,0,1,0,0,0,0],{value:s}=a[e].parameters;n.setUniform1f("u_image1Const",s),n.setUniformMatrix3fv("u_imageSwap",t)}else if(3===a.length){const e=[];if(a.forEach(((t,n)=>"Constant"===t.name&&e.push(n))),1===e.length){const{value:t}=a[e[0]].parameters;n.setUniform1f("u_image1Const",t);const s=0===e[0]?[0,1,0,0,0,1,1,0,0]:1===e[0]?[1,0,0,0,0,1,0,1,0]:[1,0,0,0,1,0,0,0,1];n.setUniformMatrix3fv("u_imageSwap",s)}else if(2===e.length){const{value:t}=a[e[0]].parameters;n.setUniform1f("u_image1Const",t);const{value:s}=a[e[1]].parameters;n.setUniform1f("u_image2Const",s);const r=a.findIndex((e=>"Constant"!==e.name)),i=0===r?[1,0,0,0,1,0,0,0,1]:1===r?[0,1,0,1,0,0,0,0,1]:[0,0,1,1,0,0,0,1,0];n.setUniformMatrix3fv("u_imageSwap",i)}}}function i(e){e.setUniform2fv("u_coordScale",n),e.setUniformMatrix3fv("u_dvsMat3",s)}e.setCoordsAndTransforms=i,e.setMultipleImageTextures=a,e.setSingleImageTextures=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
