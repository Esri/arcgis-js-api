/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3","../../../../chunks/mat3f32","./RasterVFDisplayObject","../webgl/TiledDisplayObject"],(function(t,e,s,i,a,l){"use strict";let n=function(t){function l(e,s,i,l,n,o,r=null){var h;return(h=t.call(this,e,s,i,l,n,o)||this).tileData=new a.RasterVFDisplayObject(r),h.tileData.coordScale=[n,o],h.tileData.once("isReady",(()=>h.ready())),h}e._inheritsLoose(l,t);var n=l.prototype;return n.destroy=function(){t.prototype.destroy.call(this),this.tileData.destroy(),this.tileData=null,this.stage=null},n._createTransforms=function(){return{dvs:i.create(),tileMat3:i.create()}},n.setTransform=function(e){t.prototype.setTransform.call(this,e);const i=this.resolution/(e.resolution*e.pixelRatio),a=this.transforms.tileMat3,[l,n]=this.tileData.offset,o=[this.x+l*this.resolution,this.y-n*this.resolution],[r,h]=e.toScreenNoRotation([0,0],o),{symbolTileSize:c}=this.tileData.symbolizerParameters,u=Math.round((this.width-this.tileData.offset[0])/c)*c,f=Math.round((this.height-this.tileData.offset[1])/c)*c,d=u/this.rangeX*i,y=f/this.rangeY*i;s.set(a,d,0,0,0,y,0,r,h,1),s.multiply(this.transforms.dvs,e.displayViewMat3,a),this.tileData.transforms.dvs=this.transforms.dvs},n.onAttach=function(){this.tileData.stage=this.stage},n.onDetach=function(){this.tileData.stage=null},e._createClass(l,[{key:"stencilRef",get:function(){return this.tileData.stencilRef},set:function(t){this.tileData.stencilRef=t}}]),l}(l.TiledDisplayObject);t.RasterVFTile=n,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
