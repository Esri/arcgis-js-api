/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../core/has","../../../core/Logger","../../../core/accessorSupport/ensureType","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/decorators/subclass","../../../core/urlUtils","../../../core/uuid","../../../portal/support/resourceExtension","../../../core/Accessor","../../../geometry/support/webMercatorUtils","../../../geometry/support/contains","../../../geometry/projection","../../../geometry/support/near"],(function(e,t,r,o,n,s,i,a,c,l,p,y,u,m,d,g){"use strict";var h;const f=n.getLogger("esri.views.MapView");e.GeometryConstraint=h=function(e){function r(t){var r;return(r=e.call(this,t)||this).geometry=null,r.spatialReference=null,r}t._inheritsLoose(r,e);var o=r.prototype;return o.constrain=function(e,t){if(!this.normalizedGeometry)return e;const r=e.targetGeometry;if("extent"===this.normalizedGeometry.type?m.extentContainsPoint(this.normalizedGeometry,r):m.polygonContainsPoint(this.normalizedGeometry,r))return e;const{coordinate:o}=g.nearestCoordinate(this.normalizedGeometry,r);return o?(e.targetGeometry=o,e):e},o.clone=function(){var e,t;return new h({geometry:null==(e=this.geometry)?void 0:e.clone(),spatialReference:null==(t=this.spatialReference)?void 0:t.clone()})},t._createClass(r,[{key:"normalizedGeometry",get:function(){return this.geometry&&this.spatialReference?this.spatialReference.equals(this.geometry.spatialReference)?this.geometry:u.canProject(this.geometry,this.spatialReference)?u.project(this.geometry,this.spatialReference):d.isLoaded()?d.project(this.geometry,this.spatialReference):(f.error("#constraints.geometry","unsupported coordinate system. The source geometry cannot be projected to the view's coordinate system. The projection engine cannot be loaded.",{geometry:this.geometry}),null):null}}]),r}(y),r.__decorate([i.property({constructOnly:!0})],e.GeometryConstraint.prototype,"geometry",void 0),r.__decorate([i.property({readOnly:!0,dependsOn:["geometry","spatialReference"]})],e.GeometryConstraint.prototype,"normalizedGeometry",null),r.__decorate([i.property({constructOnly:!0})],e.GeometryConstraint.prototype,"spatialReference",void 0),e.GeometryConstraint=h=r.__decorate([a.subclass("esri.views.2d.constraints.GeometryConstraint")],e.GeometryConstraint),Object.defineProperty(e,"__esModule",{value:!0})}));
