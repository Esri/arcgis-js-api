/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../core/has","../../../core/Logger","../../../core/accessorSupport/ensureType","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/decorators/subclass","../../../core/urlUtils","../../../core/uuid","../../../portal/support/resourceExtension","../../../core/promiseUtils","../../../core/Handles","../../layers/LayerView","./graphics/GraphicsView2D","./LayerView2D"],(function(e,s,r,t,i,o,a,n,p,c,h,l,u,d,w){"use strict";let f=function(s){function r(){var e;return(e=s.apply(this,arguments)||this)._handles=new l,e._popupTemplates=new Map,e.graphicsViews=[],e}e._inheritsLoose(r,s);var t=r.prototype;return t.hitTest=function(e,s){if(this.suspended||!this.graphicsViews.length)return h.resolve();const r=this.graphicsViews.map((r=>r.hitTest(e,s)));return h.all(r).then((e=>e.filter(((e,s)=>(e&&(e.popupTemplate=this._popupTemplates.get(this.graphicsViews[s]),e.layer=this.layer,e.sourceLayer=this.layer),!!e)))[0]||null))},t.update=function(e){if(this.graphicsViews)for(const s of this.graphicsViews)s.processUpdate(e)},t.attach=function(){this.layer.featureCollections.forEach((e=>{const s=new d({view:this.view,graphics:e.source,requestUpdateCallback:()=>this.requestUpdate()});s.renderer=e.renderer,this._popupTemplates.set(s,e.popupTemplate),this.graphicsViews.push(s),this.container.addChild(s.container)}))},t.detach=function(){this.container.removeAllChildren();for(const e of this.graphicsViews)e.destroy(),e.view=null,e.renderer=null;this.graphicsViews.length=0,this._handles.removeAll(),this._popupTemplates=null},t.moveStart=function(){},t.moveEnd=function(){},t.viewChange=function(){for(const e of this.graphicsViews)e.viewChange()},r}(w.LayerView2DMixin(u));return f=s.__decorate([a.subclass("esri.views.2d.layers.RouteLayerView2D")],f),f}));
