/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../core/Handles","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/accessorSupport/ensureType","../../../core/Logger","../../../core/accessorSupport/decorators/subclass","./LayerView2D","./graphics/GraphicContainer","./graphics/GraphicsView2D","../../layers/LayerView"],(function(e,s,i,r,t,a,o,n,c,p,h,l){"use strict";let u=function(s){function r(){var e;return(e=s.apply(this,arguments)||this)._handles=new i,e._popupTemplates=new Map,e.graphicsViews=[],e}e._inheritsLoose(r,s);var t=r.prototype;return t.hitTest=function(e,s){if(this.suspended||!this.graphicsViews.length)return Promise.resolve(null);const i=this.graphicsViews.map((i=>i.hitTest(e,s)));return Promise.all(i).then((e=>e.filter(((e,s)=>(e&&(e.popupTemplate=this._popupTemplates.get(this.graphicsViews[s]),e.layer=this.layer,e.sourceLayer=this.layer),!!e)))[0]||null))},t.update=function(e){if(this.graphicsViews)for(const s of this.graphicsViews)s.processUpdate(e)},t.attach=function(){this.layer.featureCollections.forEach((e=>{const s=new h({view:this.view,graphics:e.source,requestUpdateCallback:()=>this.requestUpdate(),container:new p(this.view.featuresTilingScheme)});s.renderer=e.renderer,this._popupTemplates.set(s,e.popupTemplate),this.graphicsViews.push(s),this.container.addChild(s.container)}))},t.detach=function(){this.container.removeAllChildren();for(const e of this.graphicsViews)e.destroy();this.graphicsViews.length=0,this._handles.removeAll(),this._popupTemplates=null},t.moveStart=function(){},t.moveEnd=function(){},t.viewChange=function(){for(const e of this.graphicsViews)e.viewChange()},r}(c.LayerView2DMixin(l));return u=s.__decorate([n.subclass("esri.views.2d.layers.RouteLayerView2D")],u),u}));
