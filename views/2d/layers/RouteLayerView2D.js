/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../core/Handles","../../../core/maybe","../../../core/Logger","../../../core/accessorSupport/ensureType","../../../core/arrayUtils","../../../core/has","../../../core/accessorSupport/set","../../../core/accessorSupport/decorators/subclass","./LayerView2D","./graphics/GraphicContainer","./graphics/GraphicsView2D","../../layers/LayerView"],(function(e,s,r,i,t,a,n,o,c,p,h,l,u,f){"use strict";let w=function(s){function t(){var e;return(e=s.apply(this,arguments)||this)._handles=new r,e._popupTemplates=new Map,e.graphicsViews=[],e}e._inheritsLoose(t,s);var a=t.prototype;return a.hitTest=function(){var s=e._asyncToGenerator((function*(e,s){if(!this.graphicsViews.length)return null;return(yield Promise.all(this.graphicsViews.map((s=>s.hitTest(e))))).flat().filter(((e,s)=>(e&&(e.popupTemplate=this._popupTemplates.get(this.graphicsViews[s]),e.layer=this.layer,e.sourceLayer=this.layer),!!e)))}));function r(e,r){return s.apply(this,arguments)}return r}(),a.update=function(e){if(this.graphicsViews)for(const s of this.graphicsViews)s.processUpdate(e)},a.attach=function(){i.isNone(this.layer.featureCollections)||this.layer.featureCollections.forEach((e=>{const s=new u({view:this.view,graphics:e.source,requestUpdateCallback:()=>this.requestUpdate(),container:new l(this.view.featuresTilingScheme)});s.renderer=e.renderer,this._popupTemplates.set(s,e.popupTemplate),this.graphicsViews.push(s),this.container.addChild(s.container)}))},a.detach=function(){this.container.removeAllChildren();for(const e of this.graphicsViews)e.destroy();this.graphicsViews.length=0,this._handles.removeAll(),this._popupTemplates=null},a.moveStart=function(){},a.moveEnd=function(){},a.viewChange=function(){for(const e of this.graphicsViews)e.viewChange()},t}(h.LayerView2DMixin(f));w=s.__decorate([p.subclass("esri.views.2d.layers.RouteLayerView2D")],w);return w}));
