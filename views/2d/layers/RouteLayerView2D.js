/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../core/has","../../../core/Logger","../../../core/accessorSupport/ensureType","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/decorators/subclass","../../../core/urlUtils","../../../core/uuid","../../../portal/support/resourceExtension","../../../core/Handles","../../layers/LayerView","./graphics/GraphicsView2D","./graphics/GraphicContainer","./LayerView2D"],(function(e,s,r,i,t,o,a,n,c,p,h,l,u,w,d){"use strict";let f=function(s){function r(){var e;return(e=s.apply(this,arguments)||this)._handles=new h,e._popupTemplates=new Map,e.graphicsViews=[],e}e._inheritsLoose(r,s);var i=r.prototype;return i.hitTest=function(e,s){if(this.suspended||!this.graphicsViews.length)return Promise.resolve(null);const r=this.graphicsViews.map((r=>r.hitTest(e,s)));return Promise.all(r).then((e=>e.filter(((e,s)=>(e&&(e.popupTemplate=this._popupTemplates.get(this.graphicsViews[s]),e.layer=this.layer,e.sourceLayer=this.layer),!!e)))[0]||null))},i.update=function(e){if(this.graphicsViews)for(const s of this.graphicsViews)s.processUpdate(e)},i.attach=function(){this.layer.featureCollections.forEach((e=>{const s=new u({view:this.view,graphics:e.source,requestUpdateCallback:()=>this.requestUpdate(),container:new w(this.view.featuresTilingScheme)});s.renderer=e.renderer,this._popupTemplates.set(s,e.popupTemplate),this.graphicsViews.push(s),this.container.addChild(s.container)}))},i.detach=function(){this.container.removeAllChildren();for(const e of this.graphicsViews)e.destroy();this.graphicsViews.length=0,this._handles.removeAll(),this._popupTemplates=null},i.moveStart=function(){},i.moveEnd=function(){},i.viewChange=function(){for(const e of this.graphicsViews)e.viewChange()},r}(d.LayerView2DMixin(l));return f=s.__decorate([a.subclass("esri.views.2d.layers.RouteLayerView2D")],f),f}));
