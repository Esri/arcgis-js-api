/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../../core/BidiText","../../../../core/maybe","../../../../core/screenUtils","../../../../geometry/Polygon","../../../../geometry/support/aaBoundingRect","../../../../geometry/support/spatialReferenceUtils","../../engine/webgl/alignmentUtils","../../engine/webgl/definitions","../../engine/webgl/mesh/templates/shapingUtils"],(function(e,t,n,i,r,o,a,l,s,c){"use strict";const g=512,p=50;function u(e,t){const n=a.getInfo(t);if(!n)return null;const[i,r]=n.valid;return e[2]>r?[o.create([e[0],e[1],r,e[3]]),o.create([i,e[1],i+e[2]-r,e[3]])]:e[0]<i?[o.create([i,e[1],e[2],e[3]]),o.create([r-(i-e[0]),e[1],r,e[3]])]:null}function m(e){return"text"===e||"esriTS"===e}function f(e){return"simple-marker"===e||"picture-marker"===e||"esriSMS"===e||"esriPMS"===e}function h(e){switch(n.unwrap(e.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0}function x(e,n,r){if(!r||0===r.glyphMosaicItems.length)return e;const o=t.bidiText(n.text)[1],a=r.glyphMosaicItems,g=c.shapeGlyphs(a,o,{scale:i.pt2px(n.font.size)/s.GLYPH_SIZE,angle:n.angle??0,xOffset:n.xoffset??0,yOffset:n.yoffset??0,hAlign:l.getXAnchorDirection(n.horizontalAlignment||"center"),vAlign:l.getYAnchorDirection(n.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(n.lineWidth||512,512)),lineHeight:s.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(n.lineHeight||1,4)),decoration:n.font.decoration||"none",isCIM:!1}).bounds;return e[0]=i.pt2px(g.x-g.halfWidth),e[1]=i.pt2px(g.y-g.halfHeight),e[2]=i.pt2px(g.width),e[3]=i.pt2px(g.height),e}function y(e){if(!e)return null;const{xmin:t,ymin:n,xmax:i,ymax:o,spatialReference:a}=e;return new r({rings:[[[t,n],[t,o],[i,o],[i,n],[t,n]]],spatialReference:a})}e.PIXEL_BUFFER=p,e.TILE_SIZE=g,e.getTextSymbolSize=x,e.graphicGeometryToNumber=h,e.intersectingInternationalDateline=u,e.isMarkerSymbol=f,e.isTextSymbol=m,e.polygonFromExtent=y,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
