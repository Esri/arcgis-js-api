/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../../../core/Logger","../../../core/Error","../../../geometry/support/quantizationUtils"],(function(e,r,t){"use strict";function n(r,t,n,o,u){const i=r.referencesGeometry()&&u?a(t,o,u):t,s=r.repurposeFeature(i);try{return r.evaluate({...n,$feature:s})}catch(c){return e.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",c),null}}const o=new Map;function a(e,r,t){const{transform:n,hasZ:a,hasM:i}=t;o.has(r)||o.set(r,u(r));const s=o.get(r)(e.geometry,n,a,i);return{...e,geometry:s}}function u(n){const o={};switch(n){case"esriGeometryPoint":return(e,r,n,a)=>t.unquantizePoint(r,o,e,n,a);case"esriGeometryPolygon":return(e,r,n,a)=>t.unquantizePolygon(r,o,e,n,a);case"esriGeometryPolyline":return(e,r,n,a)=>t.unquantizePolyline(r,o,e,n,a);case"esriGeometryMultipoint":return(e,r,n,a)=>t.unquantizeMultipoint(r,o,e,n,a);default:return e.getLogger("esri.views.2d.support.arcadeOnDemand").error(new r("mapview-arcade",`Unable to handle geometryType: ${n}`)),e=>e}}return n}));
