/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../../core/Logger","../../../core/Error","../../../geometry/support/quantizationUtils"],(function(e,r,t){"use strict";const n=new Map;return function(o,a,u,i,s){const c=o.referencesGeometry()&&s?function(o,a,u){const{transform:i,hasZ:s,hasM:c}=u;n.has(a)||n.set(a,function(n){const o={};switch(n){case"esriGeometryPoint":return(e,r,n,a)=>t.unquantizePoint(r,o,e,n,a);case"esriGeometryPolygon":return(e,r,n,a)=>t.unquantizePolygon(r,o,e,n,a);case"esriGeometryPolyline":return(e,r,n,a)=>t.unquantizePolyline(r,o,e,n,a);case"esriGeometryMultipoint":return(e,r,n,a)=>t.unquantizeMultipoint(r,o,e,n,a);default:return e.getLogger("esri.views.2d.support.arcadeOnDemand").error(new r("mapview-arcade",`Unable to handle geometryType: ${n}`)),e=>e}}(a));const l=n.get(a)(o.geometry,i,s,c);return{...o,geometry:l}}(a,i,s):a,l=o.repurposeFeature(c);try{return o.evaluate({...u,$feature:l})}catch(r){return e.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",r),null}}}));
