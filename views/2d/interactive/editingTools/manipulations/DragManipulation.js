/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","./Manipulation","../../../../interactive/dragEventPipeline","../../../../interactive/GraphicManipulator","../../../../interactive/editGeometry/interfaces","../../../../interactive/support/utils"],(function(t,i,a,e,n,r,o,l){"use strict";let u=function(t){function u(i){var a;return(a=t.call(this)||this)._view=i.view,a._tool=i.tool,a._graphic=i.graphic,a._manipulator=a._createManipulator(),a.forEachManipulator((t=>a._tool.manipulators.add(t))),a}i._inheritsLoose(u,t);var c=u.prototype;return c.destroy=function(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null,this._graphic=null},c.forEachManipulator=function(t){t(this._manipulator,e.ManipulatorType.TRANSLATE_XY)},c.createDragPipeline=function(t,i){let e=null,r=null,u=0,c=0,s=0;const{offsetX:p,offsetY:h,size:m}=l.getSymbolInfo(a.unwrap(this._graphic.symbol));return n.createManipulatorDragEventPipeline(this._manipulator,((a,l)=>{l.next((i=>{if("start"===i.action){const i=t();e=i.editGeometryOperations,r=i.constraints}return i})).next(n.screenToMap(this._view)).next((t=>{const{x:a,y:n,z:l}=t.mapEnd;if(r&&(a+p<r.xmin||n+h-m<r.ymin||a+p>r.xmax||n+h-m>r.ymax))return t;"start"===t.action&&(u=t.mapStart.x,c=t.mapStart.y,s=t.mapStart.z);const _=a-u,f=n-c,v=l-s;u=a,c=n,s=l;const y=[];for(const i of e.data.components)y.push(...i.vertices);const M="start"===t.action?o.AccumulationBehaviour.NEW_STEP:o.AccumulationBehaviour.ACCUMULATE_STEPS,g=e.moveVertices(y,_,f,v,M);return i(t,g),t}))}))},c._createManipulator=function(){const t=this._view,i=this._graphic;return new r.GraphicManipulator({view:t,graphic:i,selectable:!0,cursor:"move"})},u}(e.Manipulation);t.DragManipulation=u,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
