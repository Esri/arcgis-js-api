/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/tslib.es6","../../../../../geometry","../../../../../Graphic","../../../../../core/handleUtils","../../../../../core/maybe","../../../../../core/accessorSupport/decorators/property","../../../../../core/arrayUtils","../../../../../core/accessorSupport/ensureType","../../../../../core/accessorSupport/decorators/subclass","../../SnappingVisualizer2D","./symbols","../../../../draw/DrawGraphicTool","../../../../draw/DrawOperation","../../../../draw/drawSurfaces","../../../../../geometry/Point","../../../../../geometry/Multipoint"],(function(e,i,t,r,a,s,l,n,o,c,p,u,h,m,y,v,d,g){"use strict";function G(e,i){return(e.attributes?.displayOrder??-1/0)-(i.attributes?.displayOrder??-1/0)}e.DrawGraphicTool2D=function(e){function t(i){var t;return(t=e.call(this,i)||this)._visualElementGraphics={outline:null,regularVertices:null,activeVertex:null},t.activeFillSymbol=null,t.type="draw-2d",t._visualElementSymbols={outline:l.unwrapOr(i.activeLineSymbol,h.outline),regularVertices:l.unwrapOr(i.regularVerticesSymbol,h.regularVertices),activeVertex:l.unwrapOr(i.activeVertexSymbol,h.activeVertex),fill:l.unwrap(i.activeFillSymbol)},t}i._inheritsLoose(t,e);var r=t.prototype;return r.normalizeCtorArgs=function(e){const i={...e};return delete i.activeFillSymbol,delete i.activeVertexSymbol,delete i.regularVerticesSymbol,delete i.activeLineSymbol,i},r.initializeGraphic=function(e){return l.isSome(this._visualElementSymbols.fill)&&(e.symbol=this._visualElementSymbols.fill),null},r.makeDrawOperation=function(){const{defaultZ:e,hasZ:i,view:t}=this;return new y.DrawOperation({view:t,manipulators:this.manipulators,geometryType:m.geometryTypeToDrawOperationGeometryType(this.geometryType),drawingMode:this.mode,hasZ:i,defaultZ:e,snapToSceneEnabled:this.snapToScene,drawSurface:new v.MapDrawSurface(t,i,e),hasM:!1,snappingManager:this.snappingManager,snappingVisualizer:new u.SnappingVisualizer2D(this.internalGraphicsLayer),tooltipOptions:this.tooltipOptions})},r.onActiveVertexChanged=function(e){if("point"===this.geometryType)return null;const[i,t]=e,r=new d({x:i,y:t,spatialReference:this.view.spatialReference});return l.isSome(this._visualElementGraphics.activeVertex)?(this._visualElementGraphics.activeVertex.geometry=r,null):(this._visualElementGraphics.activeVertex=new a({geometry:r,symbol:this._visualElementSymbols.activeVertex,attributes:{displayOrder:2}}),this.internalGraphicsLayer.add(this._visualElementGraphics.activeVertex),this.internalGraphicsLayer.graphics.sort(G),s.makeHandle((()=>{l.isSome(this._visualElementGraphics.activeVertex)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.activeVertex),this._visualElementGraphics.activeVertex=l.destroyMaybe(this._visualElementGraphics.activeVertex))})))},r.onOutlineChanged=function(e){const i=e.clone();if("polyline"===i.type){const e=i.paths[i.paths.length-1];e.splice(0,e.length-2)}return l.isSome(this._visualElementGraphics.outline)?(this._visualElementGraphics.outline.geometry=i,null):(this._visualElementGraphics.outline=new a({geometry:i,symbol:this._visualElementSymbols.outline,attributes:{displayOrder:0}}),this.internalGraphicsLayer.add(this._visualElementGraphics.outline),this.internalGraphicsLayer.graphics.sort(G),s.makeHandle((()=>{l.isSome(this._visualElementGraphics.outline)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.outline),this._visualElementGraphics.outline=l.destroyMaybe(this._visualElementGraphics.outline))})))},r.onRegularVerticesChanged=function(e){const i=new g({points:e,spatialReference:this.view.spatialReference});return l.isSome(this._visualElementGraphics.regularVertices)?(this._visualElementGraphics.regularVertices.geometry=i,null):(this._visualElementGraphics.regularVertices=new a({geometry:i,symbol:this._visualElementSymbols.regularVertices,attributes:{displayOrder:1}}),this.internalGraphicsLayer.add(this._visualElementGraphics.regularVertices),this.internalGraphicsLayer.graphics.sort(G),s.makeHandle((()=>{l.isSome(this._visualElementGraphics.regularVertices)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.regularVertices),this._visualElementGraphics.regularVertices=l.destroyMaybe(this._visualElementGraphics.regularVertices))})))},t}(m.DrawGraphicTool),t.__decorate([n.property()],e.DrawGraphicTool2D.prototype,"activeFillSymbol",void 0),t.__decorate([n.property({readOnly:!0})],e.DrawGraphicTool2D.prototype,"type",void 0),t.__decorate([n.property({constructOnly:!0,nonNullable:!0})],e.DrawGraphicTool2D.prototype,"view",void 0),e.DrawGraphicTool2D=t.__decorate([p.subclass("esri.views.2d.interactive.draw.DrawGraphicTool2D")],e.DrawGraphicTool2D),Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
