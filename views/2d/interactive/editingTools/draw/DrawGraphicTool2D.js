/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/tslib.es6","../../../../../geometry","../../../../../Graphic","../../../../../core/handleUtils","../../../../../core/maybe","../../../../../core/accessorSupport/decorators/property","../../../../../core/arrayUtils","../../../../../core/has","../../../../../core/accessorSupport/ensureType","../../../../../core/accessorSupport/decorators/subclass","../../SnappingVisualizer2D","./symbols","../../../../draw/DrawGraphicTool","../../../../draw/DrawOperation","../../../../draw/drawSurfaces","../../../../../geometry/Point","../../../../../geometry/Multipoint"],(function(e,r,i,t,a,s,l,n,o,c,u,p,h,m,y,v,d,g,G){"use strict";function _(e,r){var i,t,a,s;return(null!=(i=null==(t=e.attributes)?void 0:t.displayOrder)?i:-1/0)-(null!=(a=null==(s=r.attributes)?void 0:s.displayOrder)?a:-1/0)}e.DrawGraphicTool2D=function(e){function i(r){var i;return(i=e.call(this,r)||this)._visualElementGraphics={outline:null,regularVertices:null,activeVertex:null},i.activeFillSymbol=null,i.type="draw-2d",i._visualElementSymbols={outline:l.unwrapOr(r.activeLineSymbol,m.outline),regularVertices:l.unwrapOr(r.regularVerticesSymbol,m.regularVertices),activeVertex:l.unwrapOr(r.activeVertexSymbol,m.activeVertex),fill:l.unwrap(r.activeFillSymbol)},i}r._inheritsLoose(i,e);var t=i.prototype;return t.normalizeCtorArgs=function(e){const r={...e};return delete r.activeFillSymbol,delete r.activeVertexSymbol,delete r.regularVerticesSymbol,delete r.activeLineSymbol,r},t.initializeGraphic=function(e){return l.isSome(this._visualElementSymbols.fill)&&(e.symbol=this._visualElementSymbols.fill),null},t.makeDrawOperation=function(){const e=this.view;return new v.DrawOperation({view:e,manipulators:this.manipulators,geometryType:y.geometryTypeToDrawOperationGeometryType(this.geometryType),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new d.MapDrawSurface(e),hasM:!1,snappingManager:this.snappingManager,snappingVisualizer:new h.SnappingVisualizer2D(this.internalGraphicsLayer)})},t.onActiveVertexChanged=function(e){if("point"===this.geometryType)return null;const[r,i]=e,t=new g({x:r,y:i,spatialReference:this.drawOperation.spatialReference});return l.isSome(this._visualElementGraphics.activeVertex)?(this._visualElementGraphics.activeVertex.geometry=t,null):(this._visualElementGraphics.activeVertex=new a({geometry:t,symbol:this._visualElementSymbols.activeVertex,attributes:{displayOrder:2}}),this.internalGraphicsLayer.add(this._visualElementGraphics.activeVertex),this.internalGraphicsLayer.graphics.sort(_),s.makeHandle((()=>{l.isSome(this._visualElementGraphics.activeVertex)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.activeVertex),this._visualElementGraphics.activeVertex=l.destroyMaybe(this._visualElementGraphics.activeVertex))})))},t.onOutlineChanged=function(e){const r=e.clone();if("polyline"===r.type){const e=r.paths[r.paths.length-1];e.splice(0,e.length-2)}return l.isSome(this._visualElementGraphics.outline)?(this._visualElementGraphics.outline.geometry=r,null):(this._visualElementGraphics.outline=new a({geometry:r,symbol:this._visualElementSymbols.outline,attributes:{displayOrder:0}}),this.internalGraphicsLayer.add(this._visualElementGraphics.outline),this.internalGraphicsLayer.graphics.sort(_),s.makeHandle((()=>{l.isSome(this._visualElementGraphics.outline)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.outline),this._visualElementGraphics.outline=l.destroyMaybe(this._visualElementGraphics.outline))})))},t.onRegularVerticesChanged=function(e){const r=new G({points:e,spatialReference:this.drawOperation.spatialReference});return l.isSome(this._visualElementGraphics.regularVertices)?(this._visualElementGraphics.regularVertices.geometry=r,null):(this._visualElementGraphics.regularVertices=new a({geometry:r,symbol:this._visualElementSymbols.regularVertices,attributes:{displayOrder:1}}),this.internalGraphicsLayer.add(this._visualElementGraphics.regularVertices),this.internalGraphicsLayer.graphics.sort(_),s.makeHandle((()=>{l.isSome(this._visualElementGraphics.regularVertices)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.regularVertices),this._visualElementGraphics.regularVertices=l.destroyMaybe(this._visualElementGraphics.regularVertices))})))},i}(y.DrawGraphicTool),i.__decorate([n.property()],e.DrawGraphicTool2D.prototype,"activeFillSymbol",void 0),i.__decorate([n.property({readOnly:!0})],e.DrawGraphicTool2D.prototype,"type",void 0),i.__decorate([n.property({constructOnly:!0,nonNullable:!0})],e.DrawGraphicTool2D.prototype,"view",void 0),e.DrawGraphicTool2D=i.__decorate([p.subclass("esri.views.2d.interactive.draw.DrawGraphicTool2D")],e.DrawGraphicTool2D),Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
