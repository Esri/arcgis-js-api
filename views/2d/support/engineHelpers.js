/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{bidiText as e}from"../../../core/BidiText.js";import{pt2px as t}from"../../../core/screenUtils.js";import{getXAnchorDirection as i,getYAnchorDirection as n}from"../engine/webgl/alignmentUtils.js";import{MAGIC_LABEL_LINE_HEIGHT as o,GLYPH_SIZE as s}from"../engine/webgl/definitions.js";import{shapeGlyphs as r}from"../engine/webgl/mesh/templates/shapingUtils.js";async function a(a,l,m){const f=i("center"),g=n("middle"),c=l.textureManager.rasterizeItem(a.toJSON(),window.devicePixelRatio||1,null,m),[,d]=e(a.text),h=(await c).glyphMosaicItems;return r(h,d,{angle:a.angle??0,xOffset:t(a.xoffset??0),yOffset:t(a.yoffset??0),lineHeight:o*Math.max(.25,a.lineHeight),maxLineWidth:Math.max(32,Math.min(t(a.lineWidth),512)),decoration:a.font.decoration,scale:Math.min(Math.round(t(a.font.size)),127)/s,hAlign:f,vAlign:g,isCIM:!1}).boundsT}let l=a;async function m(e,t,i){return l(e,t,i)}const f={stubGetTextBounds:e=>l=e,restoreGetTextBounds:()=>l=a};export{m as getTextBounds,f as test};
