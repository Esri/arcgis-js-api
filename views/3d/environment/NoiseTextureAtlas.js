/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../../../core/has","../../../core/maybe","../../webgl/BufferObject","../../webgl/FramebufferObject","../../../chunks/_rollupPluginBabelHelpers","../../webgl/checkWebGLError","../../webgl/enums","../../../chunks/builtins","../../webgl/Texture","../../webgl/VertexArrayObject","./NoiseTextureAtlasTechnique","../webgl-engine/lib/glUtil3D"],(function(e,t,r,i,s,a,o,u,h,n,l,f,c){"use strict";const b=t("esri-mobile")?64:128,_=Math.ceil(Math.sqrt(b)),p=(b+2)*_;let g=function(){function e(e,t){this._shapeTextureDescriptor={target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,hasMipmap:!1,width:1,height:1},this._frameBuffer=new s(e,{colorTarget:0}),this._vao=c.createQuadVAO(e),this.textureAtlas=new n(e,this._shapeTextureDescriptor,null),this._technique=new f.NoiseTextureAtlasTechnique({rctx:e,viewingMode:t.state.viewingMode},null)}var t=e.prototype;return t.destroy=function(){this._technique=r.releaseMaybe(this._technique),this._frameBuffer=r.disposeMaybe(this._frameBuffer),this._vao=r.disposeMaybe(this._vao),this.textureAtlas=r.disposeMaybe(this.textureAtlas)},t.render=function(e){if(r.isNone(this._vao)||r.isNone(this.textureAtlas))return!1;this._frameBuffer.resize(p,p),this.textureAtlas.resize(p,p),this._frameBuffer.attachColorTexture(this.textureAtlas),e.bindFramebuffer(this._frameBuffer);const t=this._technique.program;e.bindVAO(this._vao),t.assertCompatibleVertexAttributeLocations(this._vao),this._technique.bindPipelineState(e),e.useProgram(t),t.setUniform1f("tileSize",b),t.setUniform1f("tileRows",_);const i=e.getViewport();return e.setViewport(0,0,p,p),e.gl.drawArrays(e.gl.TRIANGLE_STRIP,0,4),this._frameBuffer.detachColorTexture(),e.setViewport(i.x,i.y,i.width,i.height),!0},e}();e.ATLAS_SIZE=p,e.NoiseTextureAtlas=g,e.TILE_ROWS=_,e.TILE_SIZE=b,Object.defineProperty(e,"__esModule",{value:!0})}));
