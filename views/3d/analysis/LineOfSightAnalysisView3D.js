/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../core/Accessor","../../../core/Collection","../../../core/Evented","../../../core/maybe","../../../core/accessorSupport/decorators/property","../../../core/arrayUtils","../../../core/accessorSupport/ensureType","../../../core/accessorSupport/decorators/subclass","../../../chunks/vec3f64","./AnalysisView3D","./LineOfSight/LineOfSightConfiguration","./LineOfSight/LineOfSightController","./LineOfSight/LineOfSightTool","./LineOfSight/LineOfSightVisualization","../../analysis/analysisViewUtils"],(function(t,e,i,o,r,s,n,a,l,p,y,c,u,d,_,h,g){"use strict";let f=function(e){function i(t){var i;return(i=e.call(this,t)||this).type="line-of-sight-view-3d",i.analysis=null,i.tool=null,i.computations=new o,i.elevationAlignedObserver=null,i.configuration=new u.LineOfSightConfiguration,i.observerEngineLocation=y.create(),i.cursorTarget=null,i.editable=!0,i}t._inheritsLoose(i,e);var r=i.prototype;return r.initialize=function(){const t=this.view,e=this.analysis;this._analysisController=new d.LineOfSightController({analysis:e,analysisViewData:this,view:t}),this._analysisVisualization=new h.LineOfSightVisualization({analysis:e,analysisViewData:this,view:t}),this.addHandles([this._analysisController.on("result-changed",(t=>{t.target!==this.cursorTarget&&this.emit("result-changed",t)})),g.connectAnalysisViewToTool(this,_.LineOfSightTool)])},r.destroy=function(){g.removeAnalysisViewTool(this),this._analysisController=s.destroyMaybe(this._analysisController),this._analysisVisualization=s.destroyMaybe(this._analysisVisualization)},r.getResultForTarget=function(t){const e=this.computations.find((e=>e.target===t));return s.applySome(e,(t=>t.result))},t._createClass(i,[{key:"results",get:function(){return this.computations.map((t=>t.result))}},{key:"priority",get:function(){return this._analysisController.priority},set:function(t){this._analysisController.priority=t}},{key:"updating",get:function(){return s.isSome(this._analysisController)&&this._analysisController.updating||s.isSome(this._analysisVisualization)&&this._analysisVisualization.updating}},{key:"testInfo",get:function(){return{visualization:this._analysisVisualization,controller:this._analysisController}}}]),i}(c.AnalysisView3D(r.EventedMixin(i)));e.__decorate([n.property({readOnly:!0})],f.prototype,"type",void 0),e.__decorate([n.property({constructOnly:!0,nonNullable:!0})],f.prototype,"analysis",void 0),e.__decorate([n.property()],f.prototype,"tool",void 0),e.__decorate([n.property({readOnly:!0})],f.prototype,"results",null),e.__decorate([n.property()],f.prototype,"priority",null),e.__decorate([n.property()],f.prototype,"computations",void 0),e.__decorate([n.property()],f.prototype,"elevationAlignedObserver",void 0),e.__decorate([n.property()],f.prototype,"configuration",void 0),e.__decorate([n.property()],f.prototype,"observerEngineLocation",void 0),e.__decorate([n.property()],f.prototype,"cursorTarget",void 0),e.__decorate([n.property()],f.prototype,"updating",null),e.__decorate([n.property()],f.prototype,"editable",void 0),e.__decorate([n.property()],f.prototype,"_analysisController",void 0),e.__decorate([n.property()],f.prototype,"_analysisVisualization",void 0),f=e.__decorate([p.subclass("esri.views.3d.analysis.LineOfSightAnalysisView3D")],f);return f}));
