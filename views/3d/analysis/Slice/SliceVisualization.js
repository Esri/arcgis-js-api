/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6","../../../../core/Accessor","../../../../core/Handles","../../../../core/maybe","../../../../core/reactiveUtils","../../../../core/accessorSupport/decorators/property","../../../../core/arrayUtils","../../../../core/accessorSupport/ensureType","../../../../core/accessorSupport/decorators/subclass","../../../../chunks/mat4","../../../../chunks/vec3","../../../../chunks/vec4f64","../../../../geometry/support/vectorStacks","./sliceToolConfig","./sliceToolUtils","../../webgl-engine/materials/lineStippleUtils"],(function(e,i,t,s,l,a,o,n,r,u,c,d,p,h,_,V,m,v){"use strict";e.SliceVisualization=function(e){function t(i){var t;return(t=e.call(this,i)||this)._handles=new l,t._gridVisualElement=null,t._outlineVisualElement=null,t.showGrid=!1,t.preview=!0,t}i._inheritsLoose(t,e);var s=t.prototype;return s.initialize=function(){const e=this.analysisViewData;if(a.isNone(e))throw new Error("expected internal object to be valid");this._gridVisualElement=m.createGridVisualElement(this.view),this._outlineVisualElement=m.createOutlineVisualElement(this.view),this._handles.add([o.watch((()=>({visible:a.isSome(e.plane)&&this.analysisViewData.visible,active:this.analysisViewData.active,preview:this.preview,showGrid:this.showGrid})),(e=>this._updateMaterials(e)),o.syncAndInitial),o.watch((()=>e.plane),(e=>this._updatePlane(e)),o.syncAndInitial)],"internal")},s.destroy=function(){this._handles.destroy(),this._gridVisualElement=a.destroyMaybe(this._gridVisualElement),this._outlineVisualElement=a.destroyMaybe(this._outlineVisualElement),this.set("view",null)},s._updatePlane=function(e){if(a.isNone(e))return;this._gridVisualElement.attached=!0,this._outlineVisualElement.attached=!0;const i=p.set(_.sv3d.get(),p.length(e.basis1),p.length(e.basis2),1),t=d.fromScaling(_.sm4d.get(),i),s=m.calculateBoundedPlaneTranslateRotate(e,_.sm4d.get()),l=d.multiply(t,s,t);this._outlineVisualElement.transform=l,this._gridVisualElement.transform=l},s._updateMaterials=function({visible:e,active:i,preview:t,showGrid:s}){this._outlineVisualElement.color=V.PLANE_OUTLINE_COLOR,this._outlineVisualElement.width=t?V.PLANE_PREVIEW_OUTLINE_WIDTH:V.PLANE_OUTLINE_WIDTH,this._outlineVisualElement.stipplePattern=i?null:v.createStipplePatternSimple(5),this._gridVisualElement.backgroundColor=V.PLANE_BACKGROUND_COLOR,this._gridVisualElement.gridColor=s?V.GRID_COLOR:h.ZEROS,this._gridVisualElement.visible=e,this._outlineVisualElement.visible=e},t}(s),t.__decorate([n.property()],e.SliceVisualization.prototype,"view",void 0),t.__decorate([n.property()],e.SliceVisualization.prototype,"analysis",void 0),t.__decorate([n.property()],e.SliceVisualization.prototype,"analysisViewData",void 0),t.__decorate([n.property()],e.SliceVisualization.prototype,"showGrid",void 0),t.__decorate([n.property()],e.SliceVisualization.prototype,"preview",void 0),e.SliceVisualization=t.__decorate([c.subclass("esri.views.3d.analysis.Slice.SliceVisualization")],e.SliceVisualization),Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
