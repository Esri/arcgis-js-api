/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","../../../core/PooledArray"],(function(t,e,n,r){"use strict";let i=function(){function t(){this.q=new r,this._last=null}var n=t.prototype;return n.resetOne=function(t){this.q.clear(),this.q.push(t),this._last=null},n.reset=function(t){this.q.clear(),t&&this.q.pushArray(t),this._last=null},n.skipSubtree=function(){this._last=null},n.next=function(){return this._last&&!this._last.isLeaf&&this.q.pushArray(this._last.children),this._last=this.q.pop(),this._last},e._createClass(t,[{key:"done",get:function(){return 0===this.q.length&&(!this._last||this._last.isLeaf)}}]),t}(),s=function(){function t(){this.q=new r}var n=t.prototype;return n.reset=function(t){if(this.q.clear(),t){this.q.pushArray(t);for(let t=0;t<this.q.length;++t){const e=this.q.data[t];e.isLeaf||this.q.pushArray(e.children)}}},n.next=function(){return this.q.pop()},e._createClass(t,[{key:"done",get:function(){return 0===this.q.length}}]),t}();function l(t){return t?t[0]+"/"+t[1]+"/"+t[2]:"null"}function o(t,e){if(e(t),!t.isLeaf)for(const n of t.children)o(n,e)}function a(t,e,n){const r=t.screenDepth,i=e.screenDepth;return r<i?-n:r>i?n:0}t.IteratorPostorder=s,t.IteratorPreorder=i,t.compareTiles=a,t.computeUpsampleInfo=function(t,e,n){let r=1,i=0,s=0;for(;t!==e;)if(r*=.5,i*=.5,s*=.5,1&t.lij[2]&&(i+=.5),0==(1&t.lij[1])&&(s+=.5),null==(t=t.parent))throw new Error("tile was not a descendant of upsampleTile");n.init(e,i,s,r)},t.fallsWithinLayer=function(t,e,r){if(n.isNone(e))return!1;const i=e.fullExtent,s=t.extent;if(r){if(s[0]<i.xmin||s[1]<i.ymin||s[2]>i.xmax||s[3]>i.ymax)return!1}else if(i.xmin>s[2]||i.ymin>s[3]||i.xmax<s[0]||i.ymax<s[1])return!1;const l=t.surface.tilingScheme.levels[t.lij[0]].scale;return!(e.minScale>0&&l>1.00000001*e.minScale)&&!(e.maxScale>0&&l<.99999999*e.maxScale)},t.hasVisibleSiblings=function(t){for(let e=0;e<t.length;e++){const n=t[e],r=n.parent;if(r)for(let t=0;t<4;t++){const e=r.children[t];if(e&&e!==n&&e.visible)return!0}}return!1},t.lij2str=l,t.sortTiles=function(t,e){e.sort(((e,n)=>a(e,n,t)))},t.sortTilesByPOI=function(t,e){const n=new Map;t.forAll((t=>n.set(t,t.distanceToSquared(e)))),t.sort(((t,e)=>n.get(t)-n.get(e)))},t.tile2str=function(t){return t?l(t.lij):"null"},t.tilesAreRelated=function(t,e){if(!t||!e||t[0]===e[0])return!1;const n=t[0]<e[0],r=n?t:e,i=n?e:t,s=1<<i[0]-r[0];return Math.floor(i[1]/s)===r[1]&&Math.floor(i[2]/s)===r[2]},t.traverseTilesPreorder=function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)o(t[n],e);else o(t,e)},Object.defineProperty(t,"__esModule",{value:!0})}));
