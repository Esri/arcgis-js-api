/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/mathUtils","../../../core/maybe","../../../chunks/vec3f64","../../../geometry/support/aaBoundingBox","../../../geometry/support/frustum","../../../geometry/support/spatialReferenceUtils","./PatchGeometryFactory","./Tile","../webgl-engine/materials/internal/MaterialUtil"],(function(t,e,i,n,a,r,s,o,h,l,c){"use strict";let u=function(t){function a(e,i,n){var a;return(a=t.call(this)||this).horizontalScaleFactor=1,void 0!==e&&a.init(e,i,n),a}e._inheritsLoose(a,t);var l=a.prototype;return l.init=function(e,a,r){t.prototype.init.call(this,e,a,r);const s=r.view.renderSpatialReference,h=n.isSome(s)&&o.isPlateCarree(s)&&r.spatialReference.isGeographic;this.horizontalScaleFactor=h?this.ellipsoid.radius*Math.PI/180:1,this._edgeLen=(this.extent[2]-this.extent[0])*this.horizontalScaleFactor,this._edgeLen2=this._edgeLen*this._edgeLen,this.centerAtSeaLevel[0]=i.lerp(this.extent[0],this.extent[2],.5)*this.horizontalScaleFactor,this.centerAtSeaLevel[1]=i.lerp(this.extent[1],this.extent[3],.5)*this.horizontalScaleFactor,this.centerAtSeaLevel[2]=0,this.updateRadiusAndCenter()},l.updateRadiusAndCenter=function(){this._updateCenter();const t=(this.extent[2]-this.extent[0])*Math.SQRT1_2,e=.5*(this.elevationBounds[0]-this.elevationBounds[1]);this._center[1][3]=Math.sqrt(t*t+e*e)},l._isVisible=function(t){return s.intersectsAABB(t,this._aabb())},l._aabb=function(){return r.wrap(this.extent[0]*this.horizontalScaleFactor,this.extent[1]*this.horizontalScaleFactor,this.elevationBounds[0],this.extent[2]*this.horizontalScaleFactor,this.extent[3]*this.horizontalScaleFactor,this.elevationBounds[1])},l.intersectsRay=function(t,e,i,n,a){p[0]=1/e[0],p[1]=1/e[1],p[2]=1/e[2];const r=a*(this.extent[2]-this.extent[0])*this.horizontalScaleFactor*.1;return c.intersectAabbInvDirBefore(this._aabb(),t,p,i+r,n)},l.createGeometry=function(t,e){h.createPlanarGlobePatch(t,this.extent,e,this.horizontalScaleFactor,this.renderData),this.setMemoryDirty()},l.getDefaultVerticesPerRowOnLevel=function(){return this.level<9?3:2},a}(l.Tile);const p=a.create();t.PlanarPatch=u,Object.defineProperty(t,"__esModule",{value:!0})}));
