/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../core/Accessor","../../../core/ObjectPool","../../../core/PooledArray","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/ensureType","../../../core/arrayUtils","../../../core/accessorSupport/decorators/subclass","../../../chunks/vec4","../../../chunks/vec4f64"],(function(e,t,r,s,i,n,u,o,a,c,l,h){"use strict";let p=function(){this.extent=h.create(),this.minLevel=0,this.maxLevel=0,this.callback=null};e.ScaleRangeQueries=function(e){function r(){var t;return(t=e.apply(this,arguments)||this)._queries=new n({initialSize:10}),t._queriesInvPtr=0,t._queryQueue=new n({initialSize:30}),t._queryPool=new i(p),t}t._inheritsLoose(r,e);var s=r.prototype;return s.queryVisibleLevelRange=function(e,t,r,s){const i=this._queryPool.acquire();l.copy(i.extent,e),i.minLevel=t??-Number.MAX_VALUE,i.maxLevel=r??Number.MAX_VALUE,i.callback=s,this._queryQueue.push(i),this.notifyChange("updating")},s.prepare=function(){for(;this._queries.length<this._queries.data.length&&this._queryQueue.length>0;){const e=this._queryQueue.pop();this._queries.push(e)}this._queriesInvPtr=this._queries.length},s.process=function(){for(let e=0;e<this._queries.length;e++){const t=this._queries.data[e];this._queryPool.release(t),t.callback(e>=this._queriesInvPtr),t.callback=null}this._queries.clear(),this.notifyChange("updating")},s.queriesForTile=function(e){const t=e.level;let r=0;for(;r<this._queriesInvPtr;){const s=this._queries.data[r],i=s.extent;t>=s.minLevel&&t<=s.maxLevel&&i[0]<=e.extent[2]&&i[2]>=e.extent[0]&&i[1]<=e.extent[3]&&i[3]>=e.extent[1]?(this._queries.swapElements(r,this._queriesInvPtr-1),this._queriesInvPtr--):r++}},t._createClass(r,[{key:"updating",get:function(){return 0!==this._queryQueue.length}}]),r}(s),r.__decorate([u.property()],e.ScaleRangeQueries.prototype,"updating",null),e.ScaleRangeQueries=r.__decorate([c.subclass("esri.views.3d.terrain.ScaleRangeQueries")],e.ScaleRangeQueries),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
