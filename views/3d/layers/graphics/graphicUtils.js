/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../core/maybe","../../../../geometry/support/coordsUtils","../../../../geometry/support/centroid","../../../../core/mathUtils","../../../../chunks/vec3f64","../../../../chunks/mat4","../../../../geometry/support/aaBoundingRect","../../../../geometry/projection","../../../../chunks/mat4f64","../../../../chunks/vec2f64","../../../../chunks/vec4f64","../../../../chunks/vec4","../../../../geometry/support/aaBoundingBox","../../../../layers/graphics/dehydratedFeatures","../../../../layers/graphics/hydratedFeatures"],(function(e,t,n,o,r,i,s,a,u,l,c,m,f,h,d,p){"use strict";function y(e){const t=e.paths[0];if(!t||0===t.length)return null;const o=n.getPointOnPath(t,n.getPathLength(t)/2);return d.makeDehydratedPoint(o[0],o[1],o[2],e.spatialReference)}function g(e,t,n){const o=n?e:p.clonePoint(e);return t&&e?u.projectPoint(e,o,t)?o:null:o}function x(e){if(Array.isArray(e)){for(const t of e)if(!x(t))return!1;return!0}return null==e||e>=0}const P={"bottom-left":c.fromValues(0,0),bottom:c.fromValues(.5,0),"bottom-right":c.fromValues(1,0),left:c.fromValues(0,.5),center:c.fromValues(.5,.5),right:c.fromValues(1,.5),"top-left":c.fromValues(0,1),top:c.fromValues(.5,1),"top-right":c.fromValues(1,1)};e.computeCentroid=function(e,t){if("point"===e.type)return g(e,t,!1);if(p.isHydratedGeometry(e))switch(e.type){case"extent":return g(e.center,t,!1);case"polygon":return g(e.centroid,t,!1);case"polyline":return g(y(e),t,!0);case"mesh":return g(e.extent.center,t,!1)}else switch(e.type){case"extent":return g(function(e){const t=r.isFinite(e.zmin);return d.makeDehydratedPoint(.5*(e.xmax+e.xmin),.5*(e.ymax+e.ymin),t?.5*(e.zmax+e.zmin):void 0,e.spatialReference)}(e),t,!0);case"polygon":return g(function(e){const t=e.rings[0];if(!t||0===t.length)return null;const n=o.ringsCentroid(e.rings,e.hasZ);return d.makeDehydratedPoint(n[0],n[1],n[2],e.spatialReference)}(e),t,!0);case"polyline":return g(y(e),t,!0)}},e.computeObjectRotation=function(e,t,n,o=l.create()){const r=e||0,i=t||0,a=n||0;return 0!==r&&s.rotateZ(o,o,-r/180*Math.PI),0!==i&&s.rotateX(o,o,i/180*Math.PI),0!==a&&s.rotateY(o,o,a/180*Math.PI),o},e.computeObjectScale=function(e=i.ONES,n,o,r=1){const s=new Array(3);if(t.isNone(n)||t.isNone(o))s[0]=1,s[1]=1,s[2]=1;else{let t,r=0;for(let i=2;i>=0;i--){const a=e[i];let u;const l=null!=a,c=0===i&&!t&&!l,m=o[i];"symbol-value"===a||c?u=0!==m?n[i]/m:1:l&&"proportional"!==a&&isFinite(a)&&(u=0!==m?a/m:1),null!=u&&(s[i]=u,t=u,r=Math.max(r,Math.abs(u)))}for(let e=2;e>=0;e--)null==s[e]?s[e]=t:0===s[e]&&(s[e]=.001*r)}for(let e=2;e>=0;e--)s[e]/=r;return i.fromArray(s)},e.demResolutionForBoundingBox=function(e,t){return null!=t.minDemResolution?t.minDemResolution:h.isPoint(e)?t.minDemResolutionForPoints:.01*h.maximumDimension(e)},e.enlargeExtent=function(e,t,n,o=0){if(e){t||(t=a.create());const r=e;let i=.5*r.width*(n-1),s=.5*r.height*(n-1);return r.width<1e-7*r.height?i+=s/20:r.height<1e-7*r.width&&(s+=i/20),f.set(t,r.xmin-i-o,r.ymin-s-o,r.xmax+i+o,r.ymax+s+o),t}return null},e.isValidSize=x,e.mixinColorAndOpacity=function(e,n){const o=m.clone(m.ONES);return t.isSome(e)&&(o[0]=e[0],o[1]=e[1],o[2]=e[2]),t.isSome(n)?o[3]=n:t.isSome(e)&&e.length>3&&(o[3]=e[3]),o},e.namedAnchorToHUDMaterialAnchorPos=P,e.overrideColor=function(e,n,o,r,i,s=[0,0,0,0]){for(let n=0;n<3;++n)t.isSome(e)&&null!=e[n]?s[n]=e[n]:t.isSome(o)&&null!=o[n]?s[n]=o[n]:s[n]=i[n];return t.isSome(n)?s[3]=n:t.isSome(r)?s[3]=r:s[3]=i[3],s},e.updateVertexAttributeAuxpos1w=function(e,t){for(let n=0;n<e.geometries.length;++n){const o=e.geometries[n].data.vertexAttributes.auxpos1;o&&o.data[3]!==t&&(o.data[3]=t,e.geometryVertexAttrsUpdated(n))}},e.validateSymbolLayerSize=function(e){return null!=e.isPrimitive&&(e=[e.width,e.depth,e.height]),x(e)?null:"Symbol sizes may not be negative values"},Object.defineProperty(e,"__esModule",{value:!0})}));
