/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../core/maybe","../../../../geometry/support/coordsUtils","../../../../chunks/vec3f64","../../../../geometry/projection","../../../../chunks/mat4f64","../../../../geometry/support/aaBoundingBox","../../../../layers/graphics/dehydratedFeatures","../../webgl-engine/lib/Object3D","./graphicUtils","./elevationAlignmentUtils"],(function(e,t,n,o,r,i,a,c,l,s,p){"use strict";const u=o.create();e.createStageObjectForHUD=function(e,n,o,c,s,d,g,h,m,y,f){const P=o?o.length:0,v=e.clippingExtent;if(r.projectPointToVector(n,u,e.elevationProvider.spatialReference),t.isSome(v)&&!a.containsPoint(v,u))return null;const j=e.renderCoordsHelper.spatialReference;r.projectPointToVector(n,u,j);const x=e.localOriginFactory.getOrigin(u),E=new l({castShadow:!1,metadata:{layerUid:m,graphicUid:y,usesVerticalDistanceToGround:!0},idHint:h});for(let e=0;e<P;e++){const t=s?s[e]:i.IDENTITY;E.addGeometry(o[e],c[e],t,d,x,f)}return{object:E,sampledElevation:p.applyElevationAlignmentForHUD(E,n,e.elevationProvider,e.renderCoordsHelper,g)}},e.extendPointGraphicElevationContext=function(e,t,n){const o=e.elevationContext,i=n.spatialReference;r.projectPointToVector(t,u,i),o.centerPointInElevationSR=c.makeDehydratedPoint(u[0],u[1],t.hasZ?u[2]:0,i)},e.geometryToRenderInfo=function(e,t,n,o,r){const i=new Float64Array(3*e.length),a=new Float64Array(i.length);e.forEach(((e,t)=>{i[3*t+0]=e[0],i[3*t+1]=e[1],i[3*t+2]=e.length>2?e[2]:0}));const c=p.applyPerVertexElevationAlignment(i,t,0,a,0,i,0,i.length/3,n,o,r),l=null!=c;return{numVertices:e.length,position:i,mapPosition:a,projectionSuccess:l,sampledElevation:c}},e.placePointOnGeometry=function(e){switch(e.type){case"point":return e;case"polygon":case"extent":return s.computeCentroid(e);case"polyline":{const t=e.paths[0];if(!t||0===t.length)return null;const o=n.getPointOnPath(t,n.getPathLength(t)/2);return c.makeDehydratedPoint(o[0],o[1],o[2],e.spatialReference)}case"mesh":return e.extent.center}return null},Object.defineProperty(e,"__esModule",{value:!0})}));
