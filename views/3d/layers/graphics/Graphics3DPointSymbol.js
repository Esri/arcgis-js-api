/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/promiseUtils","../../../../core/asyncUtils","./Graphics3DCalloutSymbolLayerFactory","./Graphics3DSymbol"],(function(t,r,o,l,a){"use strict";return function(a){function e(t,r,o){var e;return(e=a.call(this,t,r,o)||this).calloutSymbolLayer=null,e.symbol.hasVisibleCallout()&&(e.calloutSymbolLayer=l.make(e.symbol,r)),e}t._inheritsLoose(e,a);var i=e.prototype;return i.doLoad=async function(t){const l=this.calloutSymbolLayer?o.result(this.calloutSymbolLayer.load()):null;try{await a.prototype.doLoad.call(this,t)}catch(c){var e;throw null==(e=this.calloutSymbolLayer)||e.abortLoad(),c}var i;if(r.isAborted(t))throw null==(i=this.calloutSymbolLayer)||i.abortLoad(),r.createAbortError();l&&await l},i.destroy=function(){a.prototype.destroy.call(this),this.calloutSymbolLayer&&this.calloutSymbolLayer.destroy()},i.createGraphics3DGraphic=function(t,r){const o=a.prototype.createGraphics3DGraphic.call(this,t,r);if(this.calloutSymbolLayer){const r=this.createCalloutGraphic(t);r&&o.addAuxiliaryGraphic(r)}return o},i.globalPropertyChanged=function(t,r){return!!a.prototype.globalPropertyChanged.call(this,t,r)&&(!this.calloutSymbolLayer||this.calloutSymbolLayer.globalPropertyChanged(t,r,(t=>this._getCalloutGraphicLayer(t))))},i.updateGeometry=function(t,r){const o=a.prototype.updateGeometry.call(this,t,r);if(o&&this.calloutSymbolLayer){const o=this._getCalloutGraphicLayer(t);if(o)return this.calloutSymbolLayer.updateGeometry(o,r)}return o},i.createCalloutGraphic=function(t){const r=t.renderingInfo,o={renderer:r.renderer,symbol:r.symbol,translation:[0,0,0],centerOffset:[0,0,0,0],screenOffset:[0,0],centerOffsetUnits:"world",elevationOffset:0,materialCollection:null};return t.renderingInfo=o,this.calloutSymbolLayer.createGraphics3DGraphic(t)},i._getCalloutGraphicLayer=function(t){for(const r of t._auxiliaryGraphics)if(r.graphics3DSymbolLayer===this.calloutSymbolLayer)return r},e}(a)}));
