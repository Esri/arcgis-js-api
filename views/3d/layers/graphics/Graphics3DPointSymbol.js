/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/asyncUtils","../../../../core/promiseUtils","./Graphics3DCalloutSymbolLayerFactory","./Graphics3DSymbol"],(function(t,r,o,l,e){"use strict";let a=function(e){function a(t,r,o){var a;return(a=e.call(this,t,r,o)||this).calloutSymbolLayer=null,a.symbol.hasVisibleCallout()&&(a.calloutSymbolLayer=l.make(a.symbol,r)),a}t._inheritsLoose(a,e);var i=a.prototype;return i.doLoad=function(){var l=t._asyncToGenerator((function*(t){const l=this.calloutSymbolLayer?r.result(this.calloutSymbolLayer.load()):null;try{yield e.prototype.doLoad.call(this,t)}catch(c){var a;throw null==(a=this.calloutSymbolLayer)||a.abortLoad(),c}var i;if(o.isAborted(t))throw null==(i=this.calloutSymbolLayer)||i.abortLoad(),o.createAbortError();l&&(yield l)}));function a(t){return l.apply(this,arguments)}return a}(),i.destroy=function(){e.prototype.destroy.call(this),this.calloutSymbolLayer&&this.calloutSymbolLayer.destroy()},i.createGraphics3DGraphic=function(t,r){const o=e.prototype.createGraphics3DGraphic.call(this,t,r);if(this.calloutSymbolLayer){const r=this.createCalloutGraphic(t);r&&o.addAuxiliaryGraphic(r)}return o},i.globalPropertyChanged=function(t,r){return!!e.prototype.globalPropertyChanged.call(this,t,r)&&(!this.calloutSymbolLayer||this.calloutSymbolLayer.globalPropertyChanged(t,r,(t=>this._getCalloutGraphicLayer(t))))},i.updateGeometry=function(t,r){const o=e.prototype.updateGeometry.call(this,t,r);if(o&&this.calloutSymbolLayer){const o=this._getCalloutGraphicLayer(t);if(o)return this.calloutSymbolLayer.updateGeometry(o,r)}return o},i.createCalloutGraphic=function(t){const r=t.renderingInfo,o={renderer:r.renderer,symbol:r.symbol,translation:[0,0,0],centerOffset:[0,0,0,0],screenOffset:[0,0],centerOffsetUnits:"world",elevationOffset:0,materialCollection:null};return t.renderingInfo=o,this.calloutSymbolLayer.createGraphics3DGraphic(t)},i._getCalloutGraphicLayer=function(t){for(const r of t._auxiliaryGraphics)if(r.graphics3DSymbolLayer===this.calloutSymbolLayer)return r},a}(e);return a}));
