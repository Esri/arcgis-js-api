/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../geometry","../../../../core/maybe","../../../../core/promiseUtils","../../../../layers/graphics/dehydratedFeatures","../../../../support/elevationInfoUtils","./elevationAlignmentUtils","./ElevationContext","./featureExpressionInfoUtils","../../../../geometry/SpatialReference"],(function(e,t,o,n,r,i,a,s,l,c,f){"use strict";function p(e,t,o,n,r){return d.apply(this,arguments)}function d(){return d=t._asyncToGenerator((function*(e,t,o,i,l){const{elevationProvider:f,renderCoordsHelper:p,spatialReference:d}=e,{elevationInfo:I}=t,g=!0,h=c.extractExpressionInfo(I,g),m=yield c.createContext(h,d,l);r.throwIfAborted(l);const x=[],E=new Set,b=new Set;for(const{objectId:r,points:c}of i){const i=o(r);if(n.isNone(i)){for(const e of c)x.push(e[2]);E.add(r);continue}i.isDraped&&b.add(r);const l=i.graphic.geometry;u.setFromElevationInfo(a.getGeometryEffectiveElevationInfo(l,I)),u.updateFeatureExpressionInfoContext(m,i.graphic,t),v.spatialReference=e.spatialReference;for(const{x:e,y:t,z:o}of c)v.x=e,v.y=t,v.z=o??0,s.evaluateElevationInfoAtPoint(v,f,u,p,y),x.push(y.z)}return{elevations:x,drapedObjectIds:b,failedObjectIds:E}})),d.apply(this,arguments)}const u=new l.ElevationContext,v=i.makeDehydratedPoint(0,0,0,f.WGS84),y=new s.SampleElevationInfo;e.elevationAlignPointsInFeatures=p,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
