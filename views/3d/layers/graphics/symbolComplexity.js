/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../core/compilerUtils","../../../../core/maybe","../../../../symbols/support/ObjectSymbol3DLayerResource","./Graphics3DPathSymbolLayerConstants","./primitiveObjectSymbolUtils","../support/edgeUtils","../../webgl-engine/lib/VertexAttribute","../../webgl-engine/lib/lodRendering/LodResources"],(function(e,r,t,a,s,i,o,u,y){"use strict";const b={primitivesPerFeature:0,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!0,memory:{bytesPerFeature:0,bytesPerCoordinate:0,bytesPerFeatureLabel:0,resourceBytes:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}}};function P(e){if("web-style"===e.type)return b;return d(e.symbolLayers.toArray().map((r=>l(e,r))))}function d(e){let r=0,a=0,s=0,i=!1,o=0;const u={bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}};for(const y of e)t.isNone(y)||(r+=y.primitivesPerFeature,a+=y.primitivesPerCoordinate,s+=y.drawCallsPerFeature,u.bytesPerFeature+=y.memory.bytesPerFeature,u.bytesPerFeatureLabel+=y.memory.bytesPerFeatureLabel,u.bytesPerCoordinate+=y.memory.bytesPerCoordinate,u.resourceBytes+=y.memory.resourceBytes,u.draped.bytesPerFeature+=y.memory.bytesPerFeature,u.draped.bytesPerFeatureLabel+=y.memory.bytesPerFeatureLabel,u.draped.bytesPerCoordinate+=y.memory.bytesPerCoordinate,i=i||y.estimated,++o);return{primitivesPerFeature:r,primitivesPerCoordinate:a,drawCallsPerFeature:s,estimated:i,memory:u,numComplexities:o}}function n(e){const r=d(e);return r.numComplexities>0&&(r.primitivesPerFeature/=r.numComplexities,r.primitivesPerCoordinate/=r.numComplexities,r.drawCallsPerFeature/=r.numComplexities,r.memory.bytesPerFeature/=r.numComplexities,r.memory.bytesPerFeatureLabel/=r.numComplexities,r.memory.bytesPerCoordinate/=r.numComplexities,r.memory.resourceBytes/=r.numComplexities,r.memory.draped.bytesPerFeature/=r.numComplexities,r.memory.draped.bytesPerFeatureLabel/=r.numComplexities,r.memory.draped.bytesPerCoordinate/=r.numComplexities),r}const m={};function l(e,i){const u=F(e,i),y=o.hasEdges(i)?2:0;switch(i.type){case"extrude":return{primitivesPerFeature:-4,primitivesPerCoordinate:4,drawCallsPerFeature:y,estimated:!1,memory:u};case"fill":return"mesh-3d"===e.type?{primitivesPerFeature:0,primitivesPerCoordinate:0,drawCallsPerFeature:y,estimated:!1,memory:u}:t.isSome(i.outline)&&i.outline.size>0?{primitivesPerFeature:-4,primitivesPerCoordinate:3,drawCallsPerFeature:0,estimated:!1,memory:u}:{primitivesPerFeature:-2,primitivesPerCoordinate:1,drawCallsPerFeature:0,estimated:!1,memory:u};case"water":return{primitivesPerFeature:-2,primitivesPerCoordinate:1,drawCallsPerFeature:0,estimated:!1,memory:u};case"line":return{primitivesPerFeature:-2,primitivesPerCoordinate:2,drawCallsPerFeature:0,estimated:!1,memory:u};case"object":if(i.resource&&i.resource.href)return{primitivesPerFeature:16,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!0,memory:u};return{...c(i.resource&&i.resource.primitive||a.defaultPrimitive),memory:u};case"path":{let e=0,t=0;switch(i.profile){case"circle":e=s.PATH_NUM_CIRCLE_PROFILE_SUBDIVISIONS;break;case"quad":e=4;break;default:return void r.neverReached(i.profile)}switch(i.join??"simple"){case"round":t=s.PATH_NUM_ROUND_JOIN_SUBDIVISIONS;break;case"miter":case"bevel":t=1;break;default:return}const a=2*e,o=e*t*2;let y=-2*o-a;switch(i.cap){case"none":break;case"butt":case"square":y+=2*(e-1);break;case"round":y+=2*(e*(s.PATH_NUM_ROUND_CAP_EXTRUSION_SUBDIVISIONS-1)*2+e);break;default:return}return{primitivesPerFeature:y,primitivesPerCoordinate:o+a,drawCallsPerFeature:0,estimated:!1,memory:u}}case"text":case"icon":return{primitivesPerFeature:2,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:u};default:return}}function F(e,a){const s="point-3d"===e.type;switch(a.type){case"extrude":return a.edges&&a.edges.size>0?C.EXTRUDE_EDGES:C.EXTRUDE;case"fill":return t.isSome(a.outline)&&a.outline.size>0?C.FILL_OUTLINE:C.FILL;case"water":return C.FILL;case"line":return"round"===a.join?C.LINE_ROUND:C.LINE_MITER;case"path":switch(a.join){case"round":switch(a.profile){case"circle":return C.PATH_ROUND_CIRCLE;case"quad":return C.PATH_ROUND_QUAD;default:return void r.neverReached(a.profile)}case"miter":case"bevel":switch(a.profile){case"circle":return C.PATH_MITER_CIRCLE;case"quad":return C.PATH_MITER_QUAD;default:return void r.neverReached(a.profile)}default:return}case"object":return s?C.OBJECT_POINT:C.OBJECT_POLYGON;case"icon":case"text":return s?C.ICON_POINT:C.ICON_POLYGON;default:return}}function c(e){let r=m[e];if(r)return r;const t=i.primitiveLodResources(e,null);return r={primitivesPerFeature:y.geometriesFromLodLevelResources(t.levels[0]).reduce(((e,r)=>e+r.indices.get(u.VertexAttribute.POSITION).length/3),0),primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1},m[e]=r,r}const C={ICON_POINT:{bytesPerFeature:3293.7707557538765,bytesPerFeatureLabel:1020.2764,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:2213.51585392203,bytesPerFeatureLabel:1008.84664,bytesPerCoordinate:0}},ICON_POLYGON:{bytesPerFeature:4745.397589234022,bytesPerFeatureLabel:1006.5440666666666,bytesPerCoordinate:3.8971910718981526,resourceBytes:0,draped:{bytesPerFeature:3711.9299672493826,bytesPerFeatureLabel:991.1003999999999,bytesPerCoordinate:3.916858016273668}},OBJECT_POINT:{bytesPerFeature:1751.6405617660876,bytesPerFeatureLabel:1024.7827699999998,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:1751.6405617660876,bytesPerFeatureLabel:1024.7827699999998,bytesPerCoordinate:0}},OBJECT_POLYGON:{bytesPerFeature:3265.877223973855,bytesPerFeatureLabel:1002.3207366666666,bytesPerCoordinate:4.003101524580855,resourceBytes:0,draped:{bytesPerFeature:3265.877223973855,bytesPerFeatureLabel:1002.3207366666666,bytesPerCoordinate:4.003101524580855}},LINE_MITER:{bytesPerFeature:5757.019675077085,bytesPerFeatureLabel:998.6150266666667,bytesPerCoordinate:24.456810187064043,resourceBytes:0,draped:{bytesPerFeature:4101.480288021862,bytesPerFeatureLabel:1007.7540599999999,bytesPerCoordinate:18.25629912730874}},LINE_ROUND:{bytesPerFeature:5770.95297166408,bytesPerFeatureLabel:1017.77396,bytesPerCoordinate:24.60919037084966,resourceBytes:0,draped:{bytesPerFeature:4089.5796612121826,bytesPerFeatureLabel:987.8320266666666,bytesPerCoordinate:18.43599029126731}},PATH_MITER_CIRCLE:{bytesPerFeature:36120.81813311945,bytesPerFeatureLabel:977.3815,bytesPerCoordinate:2713.2216607858863,resourceBytes:0,draped:{bytesPerFeature:36120.81813311945,bytesPerFeatureLabel:977.3815,bytesPerCoordinate:2713.2216607858863}},PATH_ROUND_CIRCLE:{bytesPerFeature:23268.96777866874,bytesPerFeatureLabel:985.2637,bytesPerCoordinate:5284.873051323177,resourceBytes:0,draped:{bytesPerFeature:23268.96777866874,bytesPerFeatureLabel:985.2637,bytesPerCoordinate:5284.873051323177}},PATH_MITER_QUAD:{bytesPerFeature:24548.629753007182,bytesPerFeatureLabel:964.6924,bytesPerCoordinate:2114.107276663994,resourceBytes:0,draped:{bytesPerFeature:24548.629753007182,bytesPerFeatureLabel:964.6924,bytesPerCoordinate:2114.107276663994}},PATH_ROUND_QUAD:{bytesPerFeature:34316.219663191616,bytesPerFeatureLabel:975.7985,bytesPerCoordinate:3331.3952550120293,resourceBytes:0,draped:{bytesPerFeature:34316.219663191616,bytesPerFeatureLabel:975.7985,bytesPerCoordinate:3331.3952550120293}},FILL:{bytesPerFeature:6141.501452970723,bytesPerFeatureLabel:1008.2056066666665,bytesPerCoordinate:9.669541106191478,resourceBytes:0,draped:{bytesPerFeature:4615.812654782311,bytesPerFeatureLabel:1004.2114200000001,bytesPerCoordinate:7.378043214430644}},FILL_OUTLINE:{bytesPerFeature:9038.575581319641,bytesPerFeatureLabel:1017.9996066666668,bytesPerCoordinate:14.96569682175086,resourceBytes:0,draped:{bytesPerFeature:6369.386021594582,bytesPerFeatureLabel:1008.9863733333334,bytesPerCoordinate:10.25287774000214}},EXTRUDE:{bytesPerFeature:20071.2337049912,bytesPerFeatureLabel:1019.49468,bytesPerCoordinate:49.39369614206849,resourceBytes:0,draped:{bytesPerFeature:20071.2337049912,bytesPerFeatureLabel:1019.49468,bytesPerCoordinate:49.39369614206849}},EXTRUDE_EDGES:{bytesPerFeature:22300.21739345088,bytesPerFeatureLabel:1017.4348466666665,bytesPerCoordinate:49.40242281963031,resourceBytes:0,draped:{bytesPerFeature:22300.21739345088,bytesPerFeatureLabel:1017.4348466666665,bytesPerCoordinate:49.40242281963031}}};e.averageSymbolComplexities=n,e.defaultSymbolComplexity=P,e.defaultSymbolLayerComplexity=l,e.defaultSymbolLayerMemoryComplexity=F,e.emptySymbolComplexity=b,e.memoryEstimators=C,e.totalSymbolComplexities=d,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
