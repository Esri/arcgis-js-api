// COPYRIGHT Â© 2020 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.17/esri/copyright.txt for details.

define(["require","exports","tslib","../../../../core/compilerUtils","../../../../core/maybe","../../../../symbols/support/ObjectSymbol3DLayerResource","./primitiveObjectSymbolUtils","../../webgl-engine/lib/Util","../../webgl-engine/lib/lodRendering/LodResources"],(function(e,r,t,a,s,i,o,y,b){"use strict";function m(e){for(var r=0,t=0,a=!1,i={bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}},o=0,y=e;o<y.length;o++){var b=y[o];s.isNone(b)||(r+=b.primitivesPerFeature,t+=b.primitivesPerCoordinate,i.bytesPerFeature+=b.memory.bytesPerFeature,i.bytesPerFeatureLabel+=b.memory.bytesPerFeatureLabel,i.bytesPerCoordinate+=b.memory.bytesPerCoordinate,i.draped.bytesPerFeature+=b.memory.bytesPerFeature,i.draped.bytesPerFeatureLabel+=b.memory.bytesPerFeatureLabel,i.draped.bytesPerCoordinate+=b.memory.bytesPerCoordinate,a=a||b.estimated)}return{primitivesPerFeature:r,primitivesPerCoordinate:t,estimated:a,memory:i}}Object.defineProperty(r,"__esModule",{value:!0}),r.memoryEstimators=r.defaultSymbolLayerMemoryComplexity=r.defaultSymbolLayerComplexity=r.totalSymbolComplexities=r.defaultSymbolComplexity=r.emptySymbolComplexity=void 0,r.emptySymbolComplexity={primitivesPerFeature:0,primitivesPerCoordinate:0,estimated:!0,memory:{bytesPerFeature:0,bytesPerCoordinate:0,bytesPerFeatureLabel:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}}},r.defaultSymbolComplexity=function(e){return"web-style"===e.type?r.emptySymbolComplexity:m(e.symbolLayers.toArray().map((function(r){return d(e,r)})))},r.totalSymbolComplexities=m;var u={};function d(e,r){var m=P(e,r);switch(r.type){case"extrude":return{primitivesPerFeature:-4,primitivesPerCoordinate:4,estimated:!1,memory:m};case"fill":return"mesh-3d"===e.type?{primitivesPerFeature:0,primitivesPerCoordinate:0,estimated:!1,memory:m}:s.isSome(r.outline)&&r.outline.size>0?{primitivesPerFeature:-4,primitivesPerCoordinate:3,estimated:!1,memory:m}:{primitivesPerFeature:-2,primitivesPerCoordinate:1,estimated:!1,memory:m};case"water":return{primitivesPerFeature:-2,primitivesPerCoordinate:1,estimated:!1,memory:m};case"line":return{primitivesPerFeature:-2,primitivesPerCoordinate:2,estimated:!1,memory:m};case"object":if(r.resource&&r.resource.href)return{primitivesPerFeature:16,primitivesPerCoordinate:0,estimated:!0,memory:m};var d=r.resource&&r.resource.primitive||i.defaultPrimitive;return t.__assign(t.__assign({},function(e){var r=u[e];if(r)return r;var t=o.primitiveLodResources(e,null,null),a=b.geometriesFromLodLevelResources(t.levels[0]).reduce((function(e,r){return e+r.data.getIndices(y.VertexAttrConstants.POSITION).length/3}),0);return r={primitivesPerFeature:a,primitivesPerCoordinate:0,estimated:!1},u[e]=r,r}(d)),{memory:m});case"path":var n=0,l=0;switch(r.profile){case"circle":n=10;break;case"quad":n=4;break;default:return void a.neverReached(r.profile)}switch(r.join){case"round":l=3;break;case"miter":case"bevel":l=1;break;default:return void a.neverReached(r.join)}var F=2*n,c=n*l*2,p=-2*c-F;switch(r.cap){case"none":break;case"butt":case"square":p+=2*(n-1);break;case"round":p+=2*(2*n*2+n);break;default:return void a.neverReached(r.cap)}return{primitivesPerFeature:p,primitivesPerCoordinate:c+F,estimated:!1,memory:m};case"text":case"icon":return{primitivesPerFeature:2,primitivesPerCoordinate:0,estimated:!1,memory:m};default:return void a.neverReached(r)}}function P(e,t){var i="point-3d"===e.type;switch(t.type){case"extrude":return t.edges&&t.edges.size>0?r.memoryEstimators.EXTRUDE_EDGES:r.memoryEstimators.EXTRUDE;case"fill":return s.isSome(t.outline)&&t.outline.size>0?r.memoryEstimators.FILL_OUTLINE:r.memoryEstimators.FILL;case"water":return r.memoryEstimators.FILL;case"line":return"round"===t.join?r.memoryEstimators.LINE_ROUND:r.memoryEstimators.LINE_MITER;case"path":switch(t.join){case"round":switch(t.profile){case"circle":return r.memoryEstimators.PATH_ROUND_CIRCLE;case"quad":return r.memoryEstimators.PATH_ROUND_QUAD;default:return void a.neverReached(t.profile)}case"miter":case"bevel":switch(t.profile){case"circle":return r.memoryEstimators.PATH_MITER_CIRCLE;case"quad":return r.memoryEstimators.PATH_MITER_QUAD;default:return void a.neverReached(t.profile)}default:return void a.neverReached(t.join)}case"object":return i?r.memoryEstimators.OBJECT_POINT:r.memoryEstimators.OBJECT_POLYGON;case"icon":case"text":return i?r.memoryEstimators.ICON_POINT:r.memoryEstimators.ICON_POLYGON;default:return void a.neverReached(t)}}r.defaultSymbolLayerComplexity=d,r.defaultSymbolLayerMemoryComplexity=P,r.memoryEstimators={ICON_POINT:{bytesPerFeature:7127.413186968842,bytesPerFeatureLabel:4826.302896296296,bytesPerCoordinate:0,draped:{bytesPerFeature:3929.4396628895197,bytesPerFeatureLabel:3550.1332222222227,bytesPerCoordinate:0}},ICON_POLYGON:{bytesPerFeature:9329.452613976147,bytesPerFeatureLabel:3675.3372604938268,bytesPerCoordinate:60.177252982212096,draped:{bytesPerFeature:6190.247450139383,bytesPerFeatureLabel:3744.074358024691,bytesPerCoordinate:59.488211068026104}},OBJECT_POINT:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0,draped:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0}},OBJECT_POLYGON:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506,draped:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506}},LINE_MITER:{bytesPerFeature:7321.028181375921,bytesPerFeatureLabel:4048.0226716049388,bytesPerCoordinate:186.55621386363578,draped:{bytesPerFeature:4246.856619435009,bytesPerFeatureLabel:3852.3737679012347,bytesPerCoordinate:163.47884002621583}},LINE_ROUND:{bytesPerFeature:7482.205842738954,bytesPerFeatureLabel:4045.886987654321,bytesPerCoordinate:191.5452524171851,draped:{bytesPerFeature:4473.481387957992,bytesPerFeatureLabel:3842.1112395061728,bytesPerCoordinate:167.27703460226945}},PATH_MITER_CIRCLE:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275,draped:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275}},PATH_ROUND_CIRCLE:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957,draped:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957}},PATH_MITER_QUAD:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203,draped:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203}},PATH_ROUND_QUAD:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826,draped:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826}},FILL:{bytesPerFeature:9478.244183633637,bytesPerFeatureLabel:3713.816824691358,bytesPerCoordinate:95.9343604185578,draped:{bytesPerFeature:6287.911108168086,bytesPerFeatureLabel:3790.785032098766,bytesPerCoordinate:83.08783220478168}},FILL_OUTLINE:{bytesPerFeature:13085.871870349445,bytesPerFeatureLabel:3392.613241975309,bytesPerCoordinate:118.63968023169875,draped:{bytesPerFeature:8437.199992480122,bytesPerFeatureLabel:3973.5431172839503,bytesPerCoordinate:106.33556817014312}},EXTRUDE:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477,draped:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477}},EXTRUDE_EDGES:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312,draped:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312}}}}));