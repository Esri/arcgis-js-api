/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/PooledArray","../../../../geometry/support/aaBoundingRect","../../../support/Scheduler"],(function(t,e,n,r,s){"use strict";let o=function(){function t(){this.extents=new n({allocator:t=>t||r.create()}),this.tempExtent=r.create(),this.dirty=!1}var o=t.prototype;return o.clear=function(){this.extents.clear()},o.add=function(t){this.contains(t)||(this.removeContained(t),r.set(this.extents.pushNew(),t),this.dirty=!0)},o.pop=function(){return this.dirty&&this.mergeTight(),this.extents.pop()},o.merge=function(t){return this.mergeTight(t),t.hasProgressed},o.mergeTight=function(t=s.noBudget){const e=this.extents,n=new Set;let o=0;for(;o!==e.length;){e.sort(((t,e)=>t[0]-e[0])),o=e.length,n.clear();for(let s=0;s<e.length;++s){if(t.done)return;const o=e.getItemAt(s);for(let t=s+1;t<e.length;++t){const r=e.getItemAt(t);if(r[0]>=o[2])break;n.add(r)}n.forEach((s=>{if(o===s)return;if(s[2]<=o[0])return void n.delete(s);const i=r.area(o),c=r.area(s),a=this.tempExtent;r.expand(o,s,a);const u=i+c;(r.area(a)-u)/u<.05&&(r.set(o,a),n.delete(s),e.remove(s),t.madeProgress())})),n.add(o)}}this.dirty=!1},o.contains=function(t){return this.extents.some((e=>r.contains(e,t)))},o.removeContained=function(t){this.extents.filterInPlace((e=>!r.contains(t,e)))},e._createClass(t,[{key:"empty",get:function(){return 0===this.extents.length}},{key:"test",get:function(){const t=this;return{containsPoint:e=>t.extents.some((t=>r.containsPoint(t,e)))}}}]),t}();t.ExtentSet=o,Object.defineProperty(t,"__esModule",{value:!0})}));
