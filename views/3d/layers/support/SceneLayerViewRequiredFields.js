/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6","../../../../core/AsyncUpdate","../../../../core/HandleOwner","../../../../core/Logger","../../../../core/maybe","../../../../core/accessorSupport/decorators/property","../../../../core/accessorSupport/ensureType","../../../../core/arrayUtils","../../../../core/accessorSupport/decorators/subclass","../../../../layers/support/fieldUtils"],(function(e,r,i,t,n,l,o,s,a,d,c,u){"use strict";const p="esri.views.3d.layers.support.SceneLayerViewRequiredFields";function y(e){return F.apply(this,arguments)}function F(){return(F=r._asyncToGenerator((function*(e){const r=new Set;try{return yield e(r),Array.from(r).sort()}catch(i){return l.getLogger(p).error(i),null}}))).apply(this,arguments)}e.SceneLayerViewRequiredFields=function(e){function i(r){return e.call(this,r)||this}return r._inheritsLoose(i,e),i.prototype.initialize=function(){var e=this;this.handles.add([this.autoUpdateAsync("rendererFields",r._asyncToGenerator((function*(){const{fieldsIndex:r,renderer:i}=e.layer;return i?y((e=>i.collectRequiredFields(e,r))):null}))),this.autoUpdateAsync("labelingFields",r._asyncToGenerator((function*(){const{layer:r}=e;return r.labelsVisible?y((e=>u.collectLabelingFields(e,r))):null}))),this.autoUpdateAsync("viewFilterFields",(()=>{const{layer:e,filter:r}=this.layerView;return y((i=>u.collectFilterFields(i,e,r)))}))])},r._createClass(i,[{key:"layer",get:function(){return this.layerView.layer}},{key:"requiredFields",get:function(){const{layerView:{layer:{fieldsIndex:e},definitionExpressionFields:r},rendererFields:i,labelingFields:t,viewFilterFields:n}=this;return u.fixFields(e,[...o.unwrapOr(r,[]),...o.unwrapOr(i,[]),...o.unwrapOr(t,[]),...o.unwrapOr(n,[])])}}]),i}(t.AsyncUpdateMixin(n.HandleOwner)),i.__decorate([s.property()],e.SceneLayerViewRequiredFields.prototype,"layerView",void 0),i.__decorate([s.property()],e.SceneLayerViewRequiredFields.prototype,"layer",null),i.__decorate([s.property()],e.SceneLayerViewRequiredFields.prototype,"requiredFields",null),i.__decorate([s.property()],e.SceneLayerViewRequiredFields.prototype,"rendererFields",void 0),i.__decorate([s.property()],e.SceneLayerViewRequiredFields.prototype,"labelingFields",void 0),i.__decorate([s.property()],e.SceneLayerViewRequiredFields.prototype,"viewFilterFields",void 0),e.SceneLayerViewRequiredFields=i.__decorate([c.subclass(p)],e.SceneLayerViewRequiredFields),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
