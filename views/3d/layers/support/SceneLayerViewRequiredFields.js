/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6","../../../../core/has","../../../../core/maybe","../../../../core/Logger","../../../../core/accessorSupport/ensureType","../../../../core/accessorSupport/decorators/property","../../../../core/accessorSupport/decorators/subclass","../../../../core/urlUtils","../../../../core/uuid","../../../../portal/support/resourceExtension","../../../../layers/support/fieldUtils","../../../../core/AsyncUpdate","../../../../core/HandleOwner"],(function(e,r,i,t,s,l,o,n,d,a,c,u,p,y,F){"use strict";const w=l.getLogger("esri.views.3d.layers.support.SceneLayerViewRequiredFields");async function _(e){const r=new Set;try{return await e(r),Array.from(r).sort()}catch(i){return w.error(i),null}}e.SceneLayerViewRequiredFields=function(e){function i(r){return e.call(this,r)||this}return r._inheritsLoose(i,e),i.prototype.initialize=function(){const e=this.layerView.layer;this.layer=e,this.handles.add([this.autoUpdateAsync("rendererFields",(()=>{const{fields:e,renderer:r}=this.layer;return r?_((i=>r.collectRequiredFields(i,e))):null})),this.autoUpdateAsync("labelingFields",(()=>{const{layer:e}=this;return e.labelsVisible?_((r=>p.collectLabelingFields(r,e))):null})),this.autoUpdateAsync("viewFilterFields",(()=>{const{layer:e,filter:r}=this.layerView;return _((i=>p.collectFilterFields(i,e,r)))}))])},r._createClass(i,[{key:"requiredFields",get:function(){const{layerView:{layer:{fields:e},definitionExpressionFields:r},rendererFields:i,labelingFields:t,viewFilterFields:l}=this;return p.fixFields(e,[...s.unwrapOr(r,[]),...s.unwrapOr(i,[]),...s.unwrapOr(t,[]),...s.unwrapOr(l,[])])}}]),i}(y.AsyncUpdateMixin(F.HandleOwner)),i.__decorate([n.property()],e.SceneLayerViewRequiredFields.prototype,"layerView",void 0),i.__decorate([n.property()],e.SceneLayerViewRequiredFields.prototype,"layer",void 0),i.__decorate([n.property()],e.SceneLayerViewRequiredFields.prototype,"requiredFields",null),i.__decorate([n.property()],e.SceneLayerViewRequiredFields.prototype,"rendererFields",void 0),i.__decorate([n.property()],e.SceneLayerViewRequiredFields.prototype,"labelingFields",void 0),i.__decorate([n.property()],e.SceneLayerViewRequiredFields.prototype,"viewFilterFields",void 0),e.SceneLayerViewRequiredFields=i.__decorate([d.subclass("esri.views.3d.layers.support.SceneLayerViewRequiredFields")],e.SceneLayerViewRequiredFields),Object.defineProperty(e,"__esModule",{value:!0})}));
