/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../geometry/support/aaBoundingRect","../../webgl-engine/lib/Attribute","../../webgl-engine/lib/DoubleArray","../../webgl-engine/lib/FloatArray","../../webgl-engine/lib/Geometry","../../webgl-engine/lib/GeometryUtil","../../webgl-engine/lib/VertexAttribute"],(function(e,t,r,i,n,o,u,h){"use strict";function b(e,r,i){const n=t.width(e)/t.height(e),o={width:i,height:i};return n>1.0001?o.height=i/n:n<.9999&&(o.width=i*n),o.width=Math.round(o.width/(t.width(e)/t.width(r))),o.height=Math.round(o.height/(t.height(e)/t.height(r))),o}function a(e,t){return u.createSquareGeometry(e,[[t[0],t[1],-1],[t[2],t[1],-1],[t[2],t[3],-1],[t[0],t[3],-1]])}function g(e,u,b){if(!t.intersects(u,b))return a(e,b);const g=[u[1]-b[1],Math.min(u[3],b[3])-Math.max(u[1],b[1]),b[3]-u[3],123456],w=[u[0]-b[0],Math.min(u[2],b[2])-Math.max(u[0],b[0]),b[2]-u[2],123456],c=b[2]-b[0],A=b[3]-b[1],m=w[0]>0&&w[2]>0?3:2,y=g[0]>0&&g[2]>0?3:2,d=(y+1)*(m+1),s=i.newDoubleArray(3*d),x=n.newFloatArray(2*d),f=new Array(6*(y*m-1));let M=0,V=0,O=0,p=0,G=0;for(let t=0;t<4;t++){const e=g[t];if(e<=0)continue;let r=0;for(let i=0;i<4;i++){const e=w[i];e<=0||(s[V++]=b[0]+r,s[V++]=b[1]+M,s[V++]=-1,x[O++]=r/c,x[O++]=M/A,i<3&&t<3&&(1!==i||1!==t)&&(f[G++]=p,f[G++]=p+1,f[G++]=p+m+1,f[G++]=p+1,f[G++]=p+m+2,f[G++]=p+m+1),p++,r+=e)}M+=e}const I=new Array(f.length);return new o.Geometry(e,[[h.VertexAttribute.POSITION,new r.Attribute(s,3,!0)],[h.VertexAttribute.NORMAL,new r.Attribute(l,3,!0)],[h.VertexAttribute.UV0,new r.Attribute(x,2,!0)]],[[h.VertexAttribute.POSITION,f],[h.VertexAttribute.NORMAL,I],[h.VertexAttribute.UV0,f]])}const l=[0,0,1];e.computeImageExportSize=b,e.createGeometryForExtent=a,e.createOuterImageGeometry=g,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
