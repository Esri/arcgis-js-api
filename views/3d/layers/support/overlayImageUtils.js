/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["exports","../../../../geometry/support/aaBoundingRect","../../webgl-engine/lib/Geometry","../../webgl-engine/lib/GeometryUtil"],(function(e,t,i,n){"use strict";function r(e,i,n){const r=t.width(e)/t.height(e),o={width:n,height:n};return r>1.0001?o.height=n/r:r<.9999&&(o.width=n*r),o.width=Math.round(o.width/(t.width(e)/t.width(i))),o.height=Math.round(o.height/(t.height(e)/t.height(i))),o}function o(e){return n.createSquareGeometry([[e[0],e[1],-1],[e[2],e[1],-1],[e[2],e[3],-1],[e[0],e[3],-1]])}function a(e,n){if(!t.intersects(e,n))return o(n);const r=[e[1]-n[1],Math.min(e[3],n[3])-Math.max(e[1],n[1]),n[3]-e[3],123456],a=[e[0]-n[0],Math.min(e[2],n[2])-Math.max(e[0],n[0]),n[2]-e[2],123456],u=n[2]-n[0],c=n[3]-n[1],s=a[0]>0&&a[2]>0?3:2,l=r[0]>0&&r[2]>0?3:2,d=(l+1)*(s+1),g=new Float64Array(3*d),m=new Float32Array(2*d),w=new Uint32Array(6*(l*s-1));let y=0,f=0,p=0,x=0,M=0;for(let t=0;t<4;t++){const e=r[t];if(e<=0)continue;let i=0;for(let r=0;r<4;r++){const e=a[r];e<=0||(g[f++]=n[0]+i,g[f++]=n[1]+y,g[f++]=-1,m[p++]=i/u,m[p++]=y/c,r<3&&t<3&&(1!==r||1!==t)&&(w[M++]=x,w[M++]=x+1,w[M++]=x+s+1,w[M++]=x+1,w[M++]=x+s+2,w[M++]=x+s+1),x++,i+=e)}y+=e}const v=new Uint32Array(w.length);return new i.Geometry([["position",{size:3,data:g,exclusive:!0}],["normal",{size:3,data:h,exclusive:!0}],["uv0",{size:2,data:m,exclusive:!0}]],[["position",w],["normal",v],["uv0",w]])}const h=[0,0,1];e.computeImageExportSize=r,e.createGeometryForExtent=o,e.createOuterImageGeometry=a,Object.defineProperty(e,"__esModule",{value:!0})}));
