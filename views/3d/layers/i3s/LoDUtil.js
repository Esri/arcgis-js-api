/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/vec3"],(function(e,t){"use strict";function n(e,t,n){for(let l=0;l<t.length;l++)r[l]=!1,d[l]=null;for(let r=0;r<e.length;r++)l[r]=!1,o[r]=null;for(let l=0;l<t.length;l++){const d=u(t[l],e,n);d>=0&&(r[l]=!0,null!=o[d]?o[d].push(t[l]):o[d]=[t[l]])}for(let o=0;o<e.length;o++){const r=u(e[o],t,n);r>=0&&(l[o]=!0,null!=d[r]?d[r].push(e[o]):d[r]=[e[o]])}const h=[];for(let r=0;r<e.length;r++)null!=o[r]||l[r]||h.push({load:[],remove:[e[r]]});for(let l=0;l<t.length;l++)null!=d[l]||r[l]||h.push({load:[t[l]],remove:[]});for(let l=0;l<t.length;l++)null!=d[l]&&(d[l].length>1||d[l][0]!==t[l])&&h.push({load:[t[l]],remove:d[l]});for(let l=0;l<e.length;l++)null!=o[l]&&(o[l].length>1||o[l][0]!==e[l])&&h.push({load:o[l],remove:[e[l]]});return h}const l=[!1],o=[null],r=[!1],d=[null];function u(e,t,n){let l=e;for(;l>0;){const e=t.indexOf(l);if(e>=0)return e;l=n.getParentId(l)}return t.indexOf(l)}function h(e,n,l){return e.sort(((e,o)=>{if(0===e.load.length&&0===o.load.length)return 0;if(0===e.load.length)return-1;if(0===o.load.length)return 1;if(0===e.remove.length&&0===o.remove.length){const r=l.getRenderCenter(e.load[0]),d=l.getRenderCenter(o.load[0]);return t.dot(r,n)-t.dot(d,n)}if(0===e.remove.length)return-1;if(0===o.remove.length)return 1;if(1===e.load.length&&1===o.load.length){const r=l.getRenderCenter(e.load[0]),d=l.getRenderCenter(o.load[0]);return t.dot(r,n)-t.dot(d,n)}if(1===e.load.length)return-1;if(1===o.load.length)return 1;{const r=l.getRenderCenter(e.remove[0]),d=l.getRenderCenter(o.remove[0]);return t.dot(r,n)-t.dot(d,n)}}))}function g(e,t,n){for(let l=0;l<e.length;++l){const o=e[l];o.load.length>t&&1===o.remove.length&&f(e,o,n)}}function f(e,t,n){const l=[t.remove[0]],o=[];for(;1===l.length;){const e=l.pop();o.length=0;for(let r=0;r<t.load.length;r++){let d=t.load[r],u=n.getParentId(d);for(;u!==e;)d=u,u=n.getParentId(d);let h=l.indexOf(d);h<0&&(h=l.length,l.push(d),o.push([])),o[h].push(t.load[r])}}t.load=l;for(let r=0;r<l.length;r++)o[r].length>1?e.push({remove:[l[r]],load:o[r]}):l[r]=o[r][0]}e.nodeDiff=n,e.sortFrontToBack=h,e.splitWorkEntries=g,e.splitWorkEntry=f,Object.defineProperty(e,"__esModule",{value:!0})}));
