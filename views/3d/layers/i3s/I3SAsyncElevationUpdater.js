/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6","../../../../core/Accessor","../../../../core/maybe","../../../../core/accessorSupport/decorators/property","../../../../core/arrayUtils","../../../../core/accessorSupport/ensureType","../../../../core/accessorSupport/decorators/subclass","../graphics/ExtentSet","../../../support/Scheduler"],(function(e,t,n,r,s,o,i,a,u,d,c){"use strict";e.I3SAsyncElevationUpdater=function(e){function n(n,r,s){var o;return(o=e.call(this,{})||this)._updateExtent=r,o._updateNode=s,o.running=!1,o._extentSet=new d.ExtentSet,o._nodeSet=new Set,o.addHandles(n.registerTask(c.TaskPriority.ELEVATION_ALIGNMENT,t._assertThisInitialized(o))),o}t._inheritsLoose(n,e);var r=n.prototype;return r.normalizeCtorArgs=function(){return{}},r.addExtent=function(e){this._extentSet.add(e),this.running=!0},r.schedule=function(e){this._nodeSet.add(e),this.running=!0},r.remove=function(e){this._nodeSet.delete(e),this._updateRunning()},r.runTask=function(e){const t=this._extentSet;for(e.run((()=>t.merge(e)));!t.empty&&!e.done;){const n=this._updateExtent(t.pop());if(s.isNone(n))return;n.forAll((e=>this.schedule(e))),e.madeProgress()}if(e.done)return;const n=this._nodeSet;for(const r of n)if(n.delete(r),this._updateNode(r),e.madeProgress(),e.done)break;this._updateRunning()},r._updateRunning=function(){this.running=this._nodeSet.size>0||this._extentSet.size>0},n}(r),n.__decorate([o.property()],e.I3SAsyncElevationUpdater.prototype,"running",void 0),e.I3SAsyncElevationUpdater=n.__decorate([u.subclass("esri.views.3d.layers.i3s.I3SAsyncElevationUpdater.ts")],e.I3SAsyncElevationUpdater),Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
