/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/tslib.es6","../../../../../core/Accessor","../../../../../core/Handles","../../../../../core/maybe","../../../../../core/accessorSupport/decorators/property","../../../../../core/has","../../../../../core/accessorSupport/ensureType","../../../../../core/Logger","../../../../../core/accessorSupport/decorators/subclass","../../../../../geometry/projection","../../../../../geometry/projectionEllipsoid","./MeasurementData","../support/UnitNormalizer"],(function(e,r,t,a,o,s,n,i,l,c,p,u,d,h,m){"use strict";e.AreaMeasurementController=function(e){function t(r){var t;return(t=e.call(this,r)||this)._handles=new o,t}r._inheritsLoose(t,e);var a=t.prototype;return a.initialize=function(){const e=this.view.spatialReference,r=d.getSphericalPCPF(e),t=r===d.SphericalECEFSpatialReference?d.WGS84ECEFSpatialReference:r,a=!e||u.canProjectWithoutEngine(e,t)?t:e,o=new m.UnitNormalizer(a);this._measurementDataManager=new h.MeasurementDataManager(this.view,o),this._handles.add([this.layerViewData.path.on("change",(()=>this._update()))]),this._update()},a.destroy=function(){this._handles=s.destroyMaybe(this._handles)},a._update=function(e=!1){const r=this.layerViewData,t={maxRelativeErrorCoplanar:.005,maxRelativeErrorAlmostCoplanar:.01,verticalAngleThreshold:80};if(this._measurementDataManager.update(r.path,this.view,r.validMeasurement,t,e)){const e=this._measurementDataManager.getData();this._set("measurementData",e),r.measurementData=e}},t}(a),t.__decorate([n.property({constructOnly:!0})],e.AreaMeasurementController.prototype,"view",void 0),t.__decorate([n.property({constructOnly:!0})],e.AreaMeasurementController.prototype,"analysis",void 0),t.__decorate([n.property({readOnly:!0})],e.AreaMeasurementController.prototype,"measurementData",void 0),t.__decorate([n.property({constructOnly:!0})],e.AreaMeasurementController.prototype,"layerViewData",void 0),e.AreaMeasurementController=t.__decorate([p.subclass("esri.views.3d.layers.analysis.AreaMeasurement.AreaMeasurementController")],e.AreaMeasurementController),Object.defineProperty(e,"__esModule",{value:!0})}));
