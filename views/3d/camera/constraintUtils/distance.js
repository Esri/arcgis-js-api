/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/vec3f64","../../../../chunks/vec3","../../support/mathUtils","../../support/geometryUtils","./common"],(function(e,t,n,r,i,o){"use strict";function c(e,t,n=o.defaultApplyOptions){if(!e.state.isLocal)return 0;const r=e.state.constraints.distance;if(!e.pointsOfInterest.surfaceOrigin.renderLocation||r===1/0)return 0;s.min=0,s.max=r,function(e,t,n){const r=t.interactionType;if(0===r)return;const{min:i,max:s}=n,{interactionStartCamera:u,interactionFactor:f}=t,p=1===r||4===r,d=c(e,u),m=0===d?0:a(e,u);n.min=i,n.max=s;const y=.05*m;o.adjustRangeForInteraction(d,m,p,f,y,n)}(e,n,s);const i=a(e,t),u=s.max-i;return u>=-1e-6?0:u}function a(e,t){const r=e.pointsOfInterest.surfaceOrigin;return n.distance(t.eye,r.renderLocation)}const s={min:0,max:0},u=t.create(),f=t.create(),p=t.create(),d=t.create();e.applyDistanceConstraint=function(e,t,s=o.defaultApplyOptions){const m=c(e,t,s);if(0===m)return!1;const y=e.pointsOfInterest.surfaceOrigin,l=a(e,t)+m,O=n.copy(u,t.eye),g=o.interactionDirectionTowardsConstraintMinimization(t,s.interactionDirection,function(e,t,n){const i=e.pointsOfInterest.surfaceOrigin;return r.directionFromTo(n,t.eye,i.renderLocation)}(e,t,d),p);if(i.sphere.intersectRay(i.sphere.wrap(l,y.renderLocation),i.ray.wrap(t.eye,g),t.eye)){const r=n.subtract(f,t.eye,O);n.add(t.center,t.center,r),t.markViewDirty();const i=e.renderCoordsHelper.getAltitude(t.center);return e.renderCoordsHelper.intersectInfiniteManifold(t.ray,i,t.center),t.markViewDirty(),!0}return!1},e.getDistanceConstraintError=c,Object.defineProperty(e,"__esModule",{value:!0})}));
