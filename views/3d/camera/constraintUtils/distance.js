/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../../core/maybe","../../../../chunks/vec3","../../../../chunks/vec3f64","../../../../geometry/support/ray","../../../../chunks/sphere","./common","./InteractionType"],(function(e,t,n,r,i,o,c,a){"use strict";function s(e,t,n=c.defaultConstraintOptions){if(!e.state.isLocal)return 0;const r=e.state.constraints.distance;if(!e.pointsOfInterest.surfaceOrigin.renderLocation||r===1/0)return 0;y.min=0,y.max=r,f(e,n,y);const i=d(e,t),o=y.max-i;return o>=-1e-6?0:o}function u(e,r,a=c.defaultConstraintOptions){const u=s(e,r,a);if(0===u)return!1;const f=e.pointsOfInterest.surfaceOrigin,y=d(e,r)+u,C=n.copy(m,r.eye),T=c.interactionDirectionTowardsConstraintMinimization(r,a.interactionDirection,p(e,r,g),l);if(!o.intersectRay(o.fromCenterAndRadius(f.renderLocation,y),i.wrap(r.eye,T),I))return!1;r.eye=I;const x=n.subtract(O,r.eye,C);r.center=n.add(I,r.center,x);const L=e.renderCoordsHelper.getAltitude(r.center),M=e.renderCoordsHelper.intersectInfiniteManifold(r.ray,L,I);return t.isSome(M)&&(r.center=M),!0}function f(e,t,n){const r=t.interactionType;if(r===a.InteractionType.NONE)return;const{min:i,max:o}=n,{interactionStartCamera:u,interactionFactor:f}=t,p=r===a.InteractionType.ZOOM||r===a.InteractionType.PAN,y=s(e,u),m=0===y?0:d(e,u);n.min=i,n.max=o;const O=.05*m;c.adjustRangeForInteraction(y,m,p,f,O,n)}function d(e,t){const r=e.pointsOfInterest.surfaceOrigin;return n.distance(t.eye,r.renderLocation)}function p(e,t,r){const i=e.pointsOfInterest.surfaceOrigin;return n.direction(r,t.eye,i.renderLocation)}const y={min:0,max:0},m=r.create(),O=r.create(),l=r.create(),g=r.create(),I=r.create();e.applyDistanceConstraint=u,e.getDistanceConstraintError=s,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
