/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../../../core/maybe","../../../../chunks/vec3","../../../../chunks/vec3f64","../../../../geometry/support/ray","../../../../chunks/sphere","./common"],(function(e,t,n,r,i,o,c){"use strict";function a(e,t,n=c.defaultApplyOptions){if(!e.state.isLocal)return 0;const r=e.state.constraints.distance;if(!e.pointsOfInterest.surfaceOrigin.renderLocation||r===1/0)return 0;p.min=0,p.max=r,u(e,n,p);const i=f(e,t),o=p.max-i;return o>=-1e-6?0:o}function s(e,r,s=c.defaultApplyOptions){const u=a(e,r,s);if(0===u)return!1;const p=e.pointsOfInterest.surfaceOrigin,C=f(e,r)+u,x=n.copy(m,r.eye),I=c.interactionDirectionTowardsConstraintMinimization(r,s.interactionDirection,d(e,r,O),l);if(!o.intersectRay(o.fromCenterAndRadius(p.renderLocation,C),i.wrap(r.eye,I),g))return!1;r.eye=g;const L=n.subtract(y,r.eye,x);r.center=n.add(g,r.center,L);const h=e.renderCoordsHelper.getAltitude(r.center),A=e.renderCoordsHelper.intersectInfiniteManifold(r.ray,h,g);return t.isSome(A)&&(r.center=A),!0}function u(e,t,n){const r=t.interactionType;if(0===r)return;const{min:i,max:o}=n,{interactionStartCamera:s,interactionFactor:u}=t,d=1===r||4===r,p=a(e,s),m=0===p?0:f(e,s);n.min=i,n.max=o;const y=.05*m;c.adjustRangeForInteraction(p,m,d,u,y,n)}function f(e,t){const r=e.pointsOfInterest.surfaceOrigin;return n.distance(t.eye,r.renderLocation)}function d(e,t,r){const i=e.pointsOfInterest.surfaceOrigin;return n.direction(r,t.eye,i.renderLocation)}const p={min:0,max:0},m=r.create(),y=r.create(),l=r.create(),O=r.create(),g=r.create();e.applyDistanceConstraint=s,e.getDistanceConstraintError=a,Object.defineProperty(e,"__esModule",{value:!0})}));
