/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../../../../core/mathUtils","../../../../core/maybe","../../../../chunks/vec3","../../../../chunks/vec3f64","../../../../geometry/support/ray","./common","../../support/intersectionUtils"],(function(t,e,n,r,i,o,a,s){"use strict";function c(t,e,i=a.defaultApplyOptions){const c=u(t,e,i);if(0===c)return!1;const l=t.renderCoordsHelper,d=l.getAltitude(e.eye)+c,m=a.interactionDirectionTowardsConstraintMinimization(e,i.interactionDirection,p(t,e,Math.sign(c),A),f),y=r.copy(C,e.viewForward),x=l.intersectInfiniteManifold(o.wrap(e.eye,m),d,g);return e.eye=n.isSome(x)?x:l.setAltitude(g,d,e.eye),e.center=s.closestPointOnRay(g,e.eye,y,e.center),!0}function u(t,n,r=a.defaultApplyOptions){if(!l(t,r))return 0;const i=m(t.state.constraints.altitude,y);d(t,r,i);const o=t.renderCoordsHelper.getAltitude(n.eye),s=e.clamp(o,i.min,i.max)-o;return Math.abs(s)<=1e-6?0:s}function l(t,e){const n=t.state.constraints.altitude;return!(!t.state.isGlobal||!n)&&(2!==e.interactionType||!a.hasConstraintType(e.selection,1))}function d(t,e,n){const r=e.interactionType;if(0===r)return;const{min:i,max:o}=n,{interactionStartCamera:s,interactionFactor:c}=e,l=2===r||1===r,d=u(t,s),p=0===d?0:t.renderCoordsHelper.getAltitude(s.eye);n.min=i,n.max=o;const m=.05*p;a.adjustRangeForInteraction(d,p,l,c,m,n)}function p(t,e,n,i){return t.renderCoordsHelper.worldUpAtPosition(e.eye,i),r.scale(i,i,n),i}function m(t,e){return e.min=t.min,e.max=t.max,e}const y={min:0,max:0},f=i.create(),A=i.create(),C=i.create(),g=i.create();t.applyAltitudeConstraint=c,t.getAltitudeConstraintError=u,Object.defineProperty(t,"__esModule",{value:!0})}));
