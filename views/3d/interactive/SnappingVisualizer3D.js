/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../Color","../../../core/has","../../../core/handleUtils","../../../core/maybe","../../../chunks/vec3","../../../chunks/vec3f64","../../../geometry/Point","./visualElements/ExtendedLineVisualElement","./visualElements/ParallelLineVisualElement","./visualElements/PointVisualElement","./visualElements/RightAngleQuadVisualElement","../webgl-engine/lib/Material","../../interactive/snapping/Settings","../../interactive/snapping/SnappingDomain","../../interactive/snapping/snappingUtils","../../interactive/snapping/SnappingVisualizer","../../interactive/support/viewUtils"],(function(e,n,t,i,a,o,l,r,s,d,u,c,p,g,f,h,v,E,m){"use strict";let S=function(e){function i(){return e.apply(this,arguments)||this}n._inheritsLoose(i,e);var s=i.prototype;return s.visualizeIntersectionPoint=function(e,n){const{coordinateHelper:i,view:l}=n;return a.destroyHandle(new c.PointVisualElement({view:l,primitive:"circle",geometry:i.vectorToPoint(e.intersectionPoint),elevationInfo:o.unwrapOr(e.elevationInfo,n.elevationInfo),size:20,outlineSize:2,color:[0,0,0,0],outlineColor:t.toUnitRGBA(f.defaults.orange),pixelSnappingEnabled:!1}))},s.visualizePoint=function(e,n){const{view:i,coordinateHelper:o}=n,l=this._alignPoint(e.point,e.domain,n);return a.destroyHandle(new c.PointVisualElement({view:i,primitive:"circle",geometry:o.vectorToPoint(l),elevationInfo:this._hintElevationInfo(e,n),size:20,outlineSize:2,color:[0,0,0,0],outlineColor:t.toUnitRGBA(f.defaults.orange),pixelSnappingEnabled:!1}))},s.visualizeLine=function(e,n){const{view:t,coordinateHelper:i}=n,o=this._alignPoint(e.lineStart,e.domain,n),l=this._alignPoint(e.lineEnd,e.domain,n);return a.destroyHandle(this._createLineSegmentHintFromMap(e.type,o,l,i,this._hintElevationInfo(e,n),t,e.fadeLeft,e.fadeRight))},s.visualizeParallelSign=function(e,n){const{view:i,coordinateHelper:o}=n,r=this._hintElevationInfo(e,n),s=this._alignPoint(e.lineStart,e.domain,n),d=this._alignPoint(e.lineEnd,e.domain,n),c=m.anyMapPointToRender(s,o,r,i),p=m.anyMapPointToRender(d,o,r,i),h=l.lerp(p,c,p,.5),v=new u.ParallelLineVisualElement({view:i,attached:!1,offset:f.defaults.parallelLineHintOffset,length:f.defaults.parallelLineHintLength,width:f.defaults.parallelLineHintWidth,color:t.toUnitRGBA(f.defaults.orange),location:h,renderOccluded:g.RenderOccludedFlag.Opaque});return v.setDirectionFromPoints(c,h),v.attached=!0,a.destroyHandle(v)},s.visualizeRightAngleQuad=function(e,n){const{view:i,coordinateHelper:o}=n,l=this._hintElevationInfo(e,n),r=this._alignPoint(e.previousVertex,e.domain,n),s=this._alignPoint(e.centerVertex,e.domain,n),d=this._alignPoint(e.nextVertex,e.domain,n);return a.destroyHandle(new p.RightAngleQuadVisualElement({view:i,attached:!0,color:t.toUnitRGBA(f.defaults.orange),renderOccluded:g.RenderOccludedFlag.Transparent,outlineRenderOccluded:g.RenderOccludedFlag.Opaque,outlineColor:t.toUnitRGBA(f.defaults.orange),outlineSize:f.defaults.rightAngleHintOutlineSize,size:f.defaults.rightAngleHintSize,geometry:{previous:m.anyMapPointToRender(r,o,l,i),center:m.anyMapPointToRender(s,o,l,i),next:m.anyMapPointToRender(d,o,l,i)}}))},s._createLineSegmentHintFromMap=function(e,n,t,i,a,o,l=!0,s=!0){const d=r.create(),u=r.create();return m.anyMapPointsToRenderWithEqualRelativeZ(n,t,i,a,o,d,u),this._createLineSegmentHint(e,o,d,u,l,s)},s._createLineSegmentHint=function(e,n,i,a,o=!0,l=!0){const r=new d.ExtendedLineVisualElement({view:n,extensionType:d.ExtensionType.FADED,start:i,end:a,color:t.toUnitRGBA(f.defaults.orange),renderOccluded:g.RenderOccludedFlag.Opaque});switch(e){case v.LineSegmentHintType.TARGET:r.width=f.defaults.lineHintWidthTarget,r.fadedExtensions={start:0,end:f.defaults.lineHintFadedExtensions};break;case v.LineSegmentHintType.REFERENCE_EXTENSION:r.width=f.defaults.lineHintWidthReference,r.fadedExtensions={start:0,end:0};break;case v.LineSegmentHintType.REFERENCE:r.width=f.defaults.lineHintWidthReference,r.fadedExtensions={start:o?f.defaults.lineHintFadedExtensions:0,end:l?f.defaults.lineHintFadedExtensions:0}}return r.attached=!0,r},s._alignPoint=function(e,n,t){const i=this._getSelfSnappingZ(n,t);if(o.isNone(i))return e;const a=t.coordinateHelper,l=a.vectorToPoint(e,P);return l.z=i,a.pointToVector(l)},s._hintElevationInfo=function(e,n){return o.isSome(this._getSelfSnappingZ(e.domain,n))?o.unwrap(n.selfSnappingZ).elevationInfo:o.unwrapOr(e.elevationInfo,n.elevationInfo)},s._getSelfSnappingZ=function(e,{selfSnappingZ:n}){return e===h.SnappingDomain.SELF&&o.isSome(n)?n.value:null},i}(E.SnappingVisualizer);const P=new s;e.SnappingVisualizer3D=S,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
