/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../webgl-engine/lib/Object3D","../../webgl-engine/lib/Geometry","../../webgl-engine/lib/Layer","../../webgl-engine/lib/Texture","./VisualElement"],(function(e,s,t,i,r,o,c,n){"use strict";let u=function(e){function n(s){var t;return(t=e.call(this,s.view)||this)._resources=null,t}s._inheritsLoose(n,e);var u=n.prototype;return u.recreate=function(){this.attached&&this.createResources()},u.recreateGeometry=function(){if(t.isNone(this._resources))return;const e=this._resources.object,s=this.view._stage;e.geometries.forEach((e=>{s.remove(2,e.id)})),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),e.geometries.forEach((e=>{s.add(2,e)}))},u.createResources=function(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new o("element",{isPickable:!1});e.add(0,s),e.addToViewContent([s.id]);const t=new i({idHint:"element",castShadow:!1});this.createExternalResources(),this.createGeometries(t),t.geometries.forEach((s=>{e.add(2,s)})),this.forEachExternalResource((s=>{e.add(this._contentTypeFromResource(s),s)})),e.add(1,t),s.addObject(t),this.visible||t.setVisible(!1),this._resources={layer:s,object:t}},u._contentTypeFromResource=function(e){return e instanceof r?2:e instanceof c?4:3},u.destroyResources=function(){const e=this.view._stage;!t.isNone(this._resources)&&e&&(e.remove(1,this._resources.object.id),e.remove(0,this._resources.layer.id),this.forEachExternalResource((s=>{e.remove(this._contentTypeFromResource(s),s.id),s.dispose()})),this._resources.object.geometries.forEach((s=>{e.remove(2,s.id)})),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)},u.updateVisibility=function(e){t.isNone(this._resources)||this._resources.object.setVisible(e)},s._createClass(n,[{key:"object",get:function(){return t.isSome(this._resources)?this._resources.object:null}}]),n}(n.VisualElement);e.Object3DVisualElement=u,Object.defineProperty(e,"__esModule",{value:!0})}));
