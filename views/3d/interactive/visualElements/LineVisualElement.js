/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../chunks/vec3f64","../../../../chunks/vec3","../../../../chunks/vec4","../../webgl-engine/lib/Geometry","../../webgl-engine/materials/RibbonLineMaterial","../../layers/graphics/lineUtils","../../../../chunks/vec4f32","./Object3DVisualElement"],(function(e,t,i,r,n,s,o,l,a,h,u){"use strict";let c=function(e){function u(t){var i;return(i=e.call(this,t)||this)._origin=r.create(),i._renderOccluded=4,i._width=1,i._color=h.fromValues(1,0,1,1),i._innerWidth=1,i._innerColor=null,i._stipplePattern=null,i._stippleOffColor=null,i._stippleIntegerRepeats=!1,i._writeDepthEnabled=!0,i._falloff=0,i._polygonOffset=!1,i.applyProps(t),i}t._inheritsLoose(u,e);var c=u.prototype;return c.setGeometryFromExtent=function(e){const t=this.view.spatialReference,i=r.create(),s=r.create(),o=100,l=[];n.set(i,e[0],e[1],o),this.view.renderCoordsHelper.toRenderCoords(i,t,s),l.push([s[0],s[1],s[2]]),n.set(i,e[2],e[1],o),this.view.renderCoordsHelper.toRenderCoords(i,t,s),l.push([s[0],s[1],s[2]]),n.set(i,e[2],e[3],o),this.view.renderCoordsHelper.toRenderCoords(i,t,s),l.push([s[0],s[1],s[2]]),n.set(i,e[0],e[3],o),this.view.renderCoordsHelper.toRenderCoords(i,t,s),l.push([s[0],s[1],s[2]]),n.set(i,e[0],e[1],o),this.view.renderCoordsHelper.toRenderCoords(i,t,s),l.push([s[0],s[1],s[2]]),n.set(i,e[0],e[1],o),this.view.renderCoordsHelper.toRenderCoords(i,t,s),l.push([s[0],s[1],s[2]]),this.geometry=[l]},c.setGeometryFromFrustum=function(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]},c.setGeometryFromSegment=function(e){const{points:t}=e.createRenderGeometry(this._origin,this.view.renderCoordsHelper);this.geometry=[t]},c.createExternalResources=function(){this._material=new l.RibbonLineMaterial(this.materialParameters,"lineVisualElement")},c.destroyExternalResources=function(){this._material=null},c.createGeometries=function(e){const t=this._createLineGeometries();if(0!==t.length)for(let i=0;i<t.length;++i){const r=a.createGeometryData(t[i]),n=new o(r,"lineVisualElement");e.addGeometry(n,this._material)}},c.forEachExternalResource=function(e){e(this._material)},c._updateMaterial=function(){this.attached&&this._material.setParameterValues(this.materialParameters)},c._createLineGeometries=function(){const e=this.geometry;if(i.isNone(e))return[];const t=[];return e.forEach((e=>{const i=e.length,r=new Float64Array(3*i);e.forEach(((e,t)=>{r[3*t+0]=e[0],r[3*t+1]=e[1],r[3*t+2]=e[2]}));const n={attributeData:{position:r},removeDuplicateStartEnd:0};t.push(n)})),t},t._createClass(u,[{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this.recreateGeometry()}},{key:"width",get:function(){return this._width},set:function(e){e!==this._width&&(this._width=e,this._updateMaterial())}},{key:"color",get:function(){return this._color},set:function(e){s.exactEquals(e,this._color)||(s.copy(this._color,e),this._updateMaterial())}},{key:"innerWidth",get:function(){return this._innerWidth},set:function(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}},{key:"innerColor",get:function(){return this._innerColor},set:function(e){s.exactEquals(e,this._innerColor)||(this._innerColor=s.copy(h.create(),e),this._updateMaterial())}},{key:"stipplePattern",get:function(){return this._stipplePattern},set:function(e){const t=i.isSome(e)!==i.isSome(this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}},{key:"stippleOffColor",get:function(){return this._stippleOffColor},set:function(e){(i.isNone(e)||i.isNone(this._stippleOffColor)||!s.exactEquals(e,this._stippleOffColor))&&(this._stippleOffColor=i.isSome(e)?h.clone(e):null,this._updateMaterial())}},{key:"stippleIntegerRepeats",get:function(){return this._stippleIntegerRepeats},set:function(e){this._stippleIntegerRepeats!==e&&(this._stippleIntegerRepeats=e,this._updateMaterial())}},{key:"writeDepthEnabled",get:function(){return this._writeDepthEnabled},set:function(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}},{key:"falloff",get:function(){return this._falloff},set:function(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}},{key:"polygonOffset",get:function(){return this._polygonOffset},set:function(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}},{key:"materialParameters",get:function(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,stippleIntegerRepeats:this._stippleIntegerRepeats,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}}]),u}(u.Object3DVisualElement);e.LineVisualElement=c,Object.defineProperty(e,"__esModule",{value:!0})}));
