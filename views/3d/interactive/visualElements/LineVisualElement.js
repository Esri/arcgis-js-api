/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../chunks/mat4","../../../../chunks/mat4f64","../../../../chunks/vec3","../../../../chunks/vec3f64","../../../../chunks/vec4","../../../../chunks/vec4f32","./Object3DVisualElement","../../layers/graphics/lineUtils","../../webgl-engine/lib/Material","../../webgl-engine/materials/RibbonLineMaterial"],(function(e,t,r,i,n,s,o,l,a,h,u,c,p){"use strict";let f=function(e){function n(t){var r;return(r=e.call(this,t)||this)._renderOccluded=c.RenderOccludedFlag.OccludeAndTransparent,r._width=1,r._color=a.fromValues(1,0,1,1),r._innerWidth=1,r._innerColor=null,r._stipplePattern=null,r._stippleOffColor=null,r._stipplePreferContinuous=!0,r._writeDepthEnabled=!0,r._falloff=0,r._polygonOffset=!1,r.applyProps(t),r}t._inheritsLoose(n,e);var h=n.prototype;return h.setGeometryFromRenderSpacePoint=function(e){const t=1e3,r=[];r.push([[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]]),r.push([[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]]),r.push([[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]),this.geometry=r},h.setGeometryFromExtent=function(e){const t=this.view.spatialReference,r=o.create(),i=o.create(),n=100,l=[];s.set(r,e[0],e[1],n),this.view.renderCoordsHelper.toRenderCoords(r,t,i),l.push([i[0],i[1],i[2]]),s.set(r,e[2],e[1],n),this.view.renderCoordsHelper.toRenderCoords(r,t,i),l.push([i[0],i[1],i[2]]),s.set(r,e[2],e[3],n),this.view.renderCoordsHelper.toRenderCoords(r,t,i),l.push([i[0],i[1],i[2]]),s.set(r,e[0],e[3],n),this.view.renderCoordsHelper.toRenderCoords(r,t,i),l.push([i[0],i[1],i[2]]),s.set(r,e[0],e[1],n),this.view.renderCoordsHelper.toRenderCoords(r,t,i),l.push([i[0],i[1],i[2]]),s.set(r,e[0],e[1],n),this.view.renderCoordsHelper.toRenderCoords(r,t,i),l.push([i[0],i[1],i[2]]),this.geometry=[l]},h.setGeometryFromFrustum=function(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]},h.setGeometryFromBoundedPlane=function(e){const t=[],r=e.origin,i=e.basis1,n=e.basis2,s=.5,l=o.create(),a=o.create(),h=o.create(),u=o.create();l[0]=r[0]-i[0]*s-n[0]*s,l[1]=r[1]-i[1]*s-n[1]*s,l[2]=r[2]-i[2]*s-n[2]*s,a[0]=r[0]-i[0]*s+n[0]*s,a[1]=r[1]-i[1]*s+n[1]*s,a[2]=r[2]-i[2]*s+n[2]*s,h[0]=r[0]+i[0]*s+n[0]*s,h[1]=r[1]+i[1]*s+n[1]*s,h[2]=r[2]+i[2]*s+n[2]*s,u[0]=r[0]+i[0]*s-n[0]*s,u[1]=r[1]+i[1]*s-n[1]*s,u[2]=r[2]+i[2]*s-n[2]*s,t.push([l[0],l[1],l[2]]),t.push([a[0],a[1],a[2]]),t.push([h[0],h[1],h[2]]),t.push([u[0],u[1],u[2]]),t.push([l[0],l[1],l[2]]),this.geometry=[t]},h.setGeometryFromSegment=function(e){const t=e.endRenderSpace;this.transform=i.fromTranslation(d,t);const{points:r}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[r]},h.setGeometryFromSegments=function(e,t=o.ZEROS){this.transform=i.fromTranslation(d,t),this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))},h.createExternalResources=function(){this._material=new p.RibbonLineMaterial(this.materialParameters)},h.destroyExternalResources=function(){this._material=null},h.createGeometries=function(e){const t=this._createLineGeometries();if(0!==t.length)for(let r=0;r<t.length;++r){const i=u.createGeometry(t[r]);e.addGeometry(i,this._material)}},h.forEachExternalMaterial=function(e){e(this._material)},h._updateMaterial=function(){this.attached&&this._material.setParameters(this.materialParameters)},h._createLineGeometries=function(){const e=this.geometry;if(r.isNone(e)||0===e.length)return[];const t=[];return e.forEach((e=>{const r=e.length,i=new Float64Array(3*r);e.forEach(((e,t)=>{i[3*t+0]=e[0],i[3*t+1]=e[1],i[3*t+2]=e[2]}));const n={overlayInfo:null,attributeData:{position:i},removeDuplicateStartEnd:u.RemoveDuplicateStartEnd.KEEP};t.push(n)})),t},t._createClass(n,[{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this.recreateGeometry()}},{key:"width",get:function(){return this._width},set:function(e){e!==this._width&&(this._width=e,this._updateMaterial())}},{key:"color",get:function(){return this._color},set:function(e){l.exactEquals(e,this._color)||(l.copy(this._color,e),this._updateMaterial())}},{key:"innerWidth",get:function(){return this._innerWidth},set:function(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}},{key:"innerColor",get:function(){return this._innerColor},set:function(e){r.isSome(e)?!r.isNone(this._innerColor)&&l.exactEquals(e,this._innerColor)||(this._innerColor=l.copy(a.create(),e),this._updateMaterial()):r.isSome(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}},{key:"stipplePattern",get:function(){return this._stipplePattern},set:function(e){const t=r.isSome(e)!==r.isSome(this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}},{key:"stippleOffColor",get:function(){return this._stippleOffColor},set:function(e){(r.isNone(e)||r.isNone(this._stippleOffColor)||!l.exactEquals(e,this._stippleOffColor))&&(this._stippleOffColor=r.isSome(e)?a.clone(e):null,this._updateMaterial())}},{key:"stipplePreferContinuous",get:function(){return this._stipplePreferContinuous},set:function(e){this._stipplePreferContinuous!==e&&(this._stipplePreferContinuous=e,this._updateMaterial())}},{key:"writeDepthEnabled",get:function(){return this._writeDepthEnabled},set:function(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}},{key:"falloff",get:function(){return this._falloff},set:function(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}},{key:"polygonOffset",get:function(){return this._polygonOffset},set:function(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}},{key:"materialParameters",get:function(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}}]),n}(h.Object3DVisualElement);const d=n.create();e.LineVisualElement=f,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
