/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/tslib.es6","../../../../../core/has","../../../../../core/maybe","../../../../../core/Logger","../../../../../core/accessorSupport/ensureType","../../../../../core/accessorSupport/decorators/property","../../../../../core/accessorSupport/decorators/aliasOf","../../../../../core/accessorSupport/decorators/subclass","../../../../../core/urlUtils","../../../../../core/uuid","../../../../../portal/support/resourceExtension","../../../../../core/Accessor","../../../../../geometry/Point","../../../../../core/Handles","../../../support/PropertiesPool","../../graphics/DirectLineMeasurement3D/DirectLineMeasurement3D"],(function(e,t,o,r,s,i,n,a,c,u,l,d,p,h,m,y,_){"use strict";let f=function(t){function o(){var o;return(o=t.apply(this,arguments)||this)._handles=new m,o._propertiesPool=new y.PropertiesPool({startPoint:h,endPoint:h},e._assertThisInitialized(o)),o.model=new _.DirectLineMeasurement3D,o.cursorPoint=null,o.state="initial",o.active=!1,o.geodesicMeasurementDistanceThreshold=1e5,o}e._inheritsLoose(o,t);var s=o.prototype;return s.initialize=function(){this.sceneView.analyses.add(this.model),this.reset()},s.destroy=function(){this._handles.destroy(),this._handles=null,this.sceneView.analyses.remove(this.model),this._propertiesPool.destroy(),this._propertiesPool=null,this.model.destroy()},s.reset=function(){this.clearMeasurement()},s.clearMeasurement=function(){this.state="initial",this.startPoint=null,this.endPoint=null,this.cursorPoint=null,this._clearOverride("measurementSurfaceLocation")},s.finishMeasurement=function(){if(!this._isOverridden("measurementSurfaceLocation")){const e=this.measurementSurfaceLocation,t="camera-dependent"===e?this.sceneView.state.camera.aboveGround?"above-the-surface":"below-the-surface":e;this._override("measurementSurfaceLocation",t)}this.state="measured"},e._createClass(o,[{key:"startPointSurfaceLocation",set:function(e){this._set("startPointSurfaceLocation",e)}},{key:"endPointSurfaceLocation",set:function(e){this._set("endPointSurfaceLocation",e)}},{key:"measurementSurfaceLocation",get:function(){const e=this.startPointSurfaceLocation,t=this.endPointSurfaceLocation;return null==e||null==t||"above-the-surface"===e&&"below-the-surface"===t||"below-the-surface"===e&&"above-the-surface"===t||"on-the-surface"===e&&"on-the-surface"===t?"camera-dependent":"above-the-surface"===e||"above-the-surface"===t?"above-the-surface":"below-the-surface"}},{key:"validMeasurement",get:function(){return r.isSome(this.model.startPoint)&&r.isSome(this.model.endPoint)}},{key:"isMeasuring",get:function(){return!!this.startPoint}},{key:"geodesicDistanceExceeded",get:function(){return r.isSome(this.model.measurement)&&this.model.measurement.horizontalDistance&&this.model.measurement.horizontalDistance.value>this.geodesicMeasurementDistanceThreshold}}]),o}(p);return t.__decorate([n.property()],f.prototype,"messages",void 0),t.__decorate([n.property({constructOnly:!0})],f.prototype,"sceneView",void 0),t.__decorate([n.property()],f.prototype,"model",void 0),t.__decorate([a.aliasOf("model.startPoint")],f.prototype,"startPoint",void 0),t.__decorate([n.property({value:null})],f.prototype,"startPointSurfaceLocation",null),t.__decorate([a.aliasOf("model.endPoint")],f.prototype,"endPoint",void 0),t.__decorate([n.property({value:null})],f.prototype,"endPointSurfaceLocation",null),t.__decorate([n.property()],f.prototype,"measurementSurfaceLocation",null),t.__decorate([n.property()],f.prototype,"cursorPoint",void 0),t.__decorate([n.property()],f.prototype,"state",void 0),t.__decorate([a.aliasOf("model.settings.unit")],f.prototype,"unit",void 0),t.__decorate([n.property()],f.prototype,"active",void 0),t.__decorate([n.property({readOnly:!0})],f.prototype,"validMeasurement",null),t.__decorate([n.property({readOnly:!0})],f.prototype,"isMeasuring",null),t.__decorate([n.property()],f.prototype,"geodesicMeasurementDistanceThreshold",void 0),t.__decorate([n.property({readOnly:!0})],f.prototype,"geodesicDistanceExceeded",null),f=t.__decorate([c.subclass("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DModel")],f),f}));
