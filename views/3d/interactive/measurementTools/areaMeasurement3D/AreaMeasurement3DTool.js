/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/tslib.es6","../../../../../core/Handles","../../../../../core/accessorSupport/decorators/property","../../../../../core/has","../../../../../core/accessorSupport/ensureType","../../../../../core/Logger","../../../../../core/accessorSupport/decorators/subclass","./AreaMeasurement3DController","./AreaMeasurement3DModel","./AreaMeasurement3DView","../../../../interactive/InteractiveToolBase"],(function(e,t,s,i,r,n,a,o,c,l,u,h){"use strict";let d=function(t){function i(e){var i;return(i=t.call(this,e)||this)._handles=new s,i.model=new l({sceneView:e.view}),i.measurementView=new u({model:i.model,unit:e.unit,manipulators:i.manipulators}),i}e._inheritsLoose(i,t);var r=i.prototype;return r.initialize=function(){this.measurementView.when().then((()=>this._initialize()))},r._initialize=function(){switch(this.toolState){case"pending":case"creating":case"created":break;case"destroyed":return}this._controller=new c(this.model,this.measurementView,this.manipulators),this.visible&&this.measurementView.show();const e=this.watch("state",(e=>{switch(e){case"measured":this.complete();break;case"measuring":case"ready":default:this.finishToolCreation()}}));this._handles.add(e),"measured"===this.state?this.complete():this.startToolCreation()},r.destroy=function(){switch(this.toolState){case"pending":this.measurementView.destroy(),this._set("measurementView",null),this.model.destroy(),this._set("model",null);break;case"creating":case"created":this.detach(),this.measurementView.destroy(),this._set("measurementView",null),this.model.destroy(),this._set("model",null),this._controller.destroy(),this._controller=null,this._handles.destroy(),this._handles=null}},r.activate=function(){this.model.active=!0},r.deactivate=function(){switch(this.toolState){case"created":case"creating":case"pending":this.model.active=!1}},r.onShow=function(){this.created&&this.measurementView.show()},r.onHide=function(){this.created&&this.measurementView.hide()},r.onDetach=function(){switch(this.toolState){case"created":case"creating":this.measurementView.path.clear(),this.measurementView.cursorPoint=null,this.model.state="initial"}},r.onInputEvent=function(e){this._controller.handleInputEvent(e)},e._createClass(i,[{key:"state",get:function(){switch(this.model.state){case"initial":return this.measurementView.path.numVertices>=1?"measuring":"ready";case"drawing":case"editing":return"measuring";case"measured":return"measured"}}},{key:"isSupported",get:function(){return"3d"===this.get("view.type")}},{key:"cursor",get:function(){switch(this.toolState){case"destroyed":return null;default:if(this.model.active&&("initial"===this.model.state||"drawing"===this.model.state))return"crosshair"}return null}},{key:"unit",set:function(e){this._set("unit",e),"ready"===this.measurementView.state&&(this.measurementView.layerView.unit=e)}}]),i}(h.InteractiveToolBase);return t.__decorate([i.property({readOnly:!0})],d.prototype,"state",null),t.__decorate([i.property({readOnly:!0})],d.prototype,"isSupported",null),t.__decorate([i.property({readOnly:!0})],d.prototype,"cursor",null),t.__decorate([i.property()],d.prototype,"unit",null),t.__decorate([i.property({constructOnly:!0})],d.prototype,"model",void 0),t.__decorate([i.property({constructOnly:!0})],d.prototype,"measurementView",void 0),d=t.__decorate([o.subclass("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],d),d}));
