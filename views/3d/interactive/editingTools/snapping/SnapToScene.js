/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../../../../../support/elevationInfoUtils","../../../../interactive/dragEventPipeline"],(function(e,t,n,i,s){"use strict";let a=function(){function e(){this._view=null,this._elevationInfo=null,this._lastDragEvent=null,this._next=null,this._enabled=!1}var a=e.prototype;return a._snap=function(e){const t=n.isSome(this._view)?this._view.toMap(e,{exclude:[]}):null;return n.isSome(t)&&n.isSome(this._view)&&(t.z=i.getZForElevationMode(t,this._view,this._elevationInfo)),t},a.createDragEventPipelineStep=function(e,t){this._view=e,this._elevationInfo=t,this._lastDragEvent=null;const i=new s.EventPipeline;this._next=i;return[e=>{if(this._lastDragEvent="end"!==e.action?{...e}:null,this._enabled){const t=this._snap(e.screenEnd);return n.isSome(t)?{action:e.action,mapStart:e.mapStart,mapEnd:t,screenStart:e.screenStart,screenEnd:e.screenEnd}:null}return{action:e.action,mapStart:e.mapStart,mapEnd:e.mapEnd,screenStart:e.screenStart,screenEnd:e.screenEnd}},i]},t._createClass(e,[{key:"enabled",get:function(){return this._enabled},set:function(e){if(this._enabled!==e&&n.isSome(this._lastDragEvent)&&n.isSome(this._next)){const t=this._lastDragEvent.mapEnd,i=this._snap(this._lastDragEvent.screenEnd);if(n.isSome(i)){const n={action:"update",mapStart:this._lastDragEvent.mapStart,mapEnd:!0===e?i:t,screenStart:this._lastDragEvent.screenEnd,screenEnd:this._lastDragEvent.screenEnd};this._next.execute(n)}}this._enabled=e}}]),e}();e.SnapToScene=a,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
