/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Handles","../../../../../core/handleUtils","../../../../../core/has","../../../../../core/maybe","../ManipulatorType","./config","./Manipulation","./MoveXYAxisManipulation","./MoveXYDiscManipulation","./MoveZManipulation"],(function(i,a,n,e,t,o,s,l,r,u,p,c){"use strict";let h=function(r){function h(i){var a;(a=r.call(this)||this)._handles=new n,a._angleDeferred=null,a._interactive=!0;const{tool:e,view:t,snapToScene:o,radius:s}=i;return a._view=t,a.xyManipulation=new p.MoveXYDiscManipulation({tool:e,view:t,snapToScene:o,radius:s}),a.xyAxisManipulation=new u.MoveXYAxisManipulation({tool:e,view:t,radius:s}),a.zManipulation=new c.MoveZManipulation({tool:e,view:t,radius:s}),a.xyManipulation.available=i.xyAvailable,a.xyAxisManipulation.available=i.xyAxisAvailable,a.zManipulation.available=i.zAvailable,a._autoHideXYAxis(),a.forEachManipulator((i=>{a._handles.add(i.events.on("grab-changed",(()=>a._updateManipulatorInteractivity())))})),a}a._inheritsLoose(h,r);var y=h.prototype;return y.destroy=function(){this._handles.destroy(),this.xyManipulation.destroy(),this.xyAxisManipulation.destroy(),this.zManipulation.destroy()},y.createGraphicDragPipeline=function(a,n,t){return e.handlesGroup([this.xyManipulation.createGraphicDragPipeline(((n,e,t,o,s)=>a(i.ManipulationType.XY,n,e,t,o,s)),n,t),this.xyAxisManipulation.createGraphicDragPipeline(((n,e,t,o,s)=>a(i.ManipulationType.XY_AXIS,n,e,t,o,s)),n,t),this.zManipulation.createGraphicDragPipeline(((n,e,t,o,s)=>a(i.ManipulationType.Z,n,e,t,o,s)),n,t)])},y.createDragPipeline=function(a,n,t,o){return e.handlesGroup([this.xyManipulation.createDragPipeline(((n,e,t,o,s)=>a(i.ManipulationType.XY,n,e,t,o,s)),n,t,o),this.xyAxisManipulation.createDragPipeline(((n,e,t,o,s)=>a(i.ManipulationType.XY_AXIS,n,e,t,o,s)),n,t,o),this.zManipulation.createDragPipeline(((n,e,t,o,s)=>a(i.ManipulationType.Z,n,e,t,o,s)),t)])},y.forEachManipulator=function(i){this.xyManipulation.forEachManipulator((a=>i(a,s.ManipulatorType.TRANSLATE_XY))),this.xyAxisManipulation.forEachManipulator((a=>i(a,s.ManipulatorType.TRANSLATE_XY))),this.zManipulation.forEachManipulator((a=>i(a,s.ManipulatorType.TRANSLATE_Z)))},y._autoHideXYAxis=function(){const i=this.xyAxisManipulation,a=this.xyManipulation;if(t("esri-mobile"))return;const n=[];a.forEachManipulator((i=>n.push(i))),i.forEachManipulator((i=>n.push(i)));const e=()=>{const a=[];this.xyAxisVisible?o.isSome(this._angleDeferred)&&(this.angle=this._angleDeferred()):i.forEachManipulator((i=>a.push(i.disableDisplay()))),this._handles.remove(M),this._handles.add(a,M)};for(const t of n)this._handles.add(t.events.on("focus-changed",e));this._view.inputManager&&this._handles.add(this._view.inputManager.watch("latestPointerType",e)),e()},y._updateManipulatorInteractivity=function(){const i=this.grabbing;this.forEachManipulator((a=>{a.interactive=!i&&this._interactive||a.grabbing}))},h.radiusForSymbol=function(i){const a=o.isSome(i)&&"point-3d"===i.type&&i.symbolLayers;return!!a&&a.length>0&&a.some((i=>"icon"===i.type))?l.DISC_RADIUS_SMALL:l.DISC_RADIUS},a._createClass(h,[{key:"snapToScene",set:function(i){this.xyManipulation.snapToScene=i}},{key:"angle",set:function(i){this._angleDeferred=null,this.xyAxisManipulation.angle=i}},{key:"angleDeferred",set:function(i){this.xyAxisVisible?this.angle=i():this._angleDeferred=i}},{key:"interactive",set:function(i){this._interactive!==i&&(this._interactive=i,this._updateManipulatorInteractivity())}},{key:"radius",set:function(i){this.xyAxisManipulation.radius=i,this.xyManipulation.radius=i,this.zManipulation.radius=i}},{key:"displayScale",set:function(i){this.xyManipulation.displayScale=i,this.xyAxisManipulation.displayScale=i}},{key:"xyAxisVisible",get:function(){const i=this.xyManipulation.someManipulator((i=>i.focused))||this.xyAxisManipulation.someManipulator((i=>i.focused));return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||i}}]),h}(r.Manipulation);const M="disable-xy-axis-display";var y;i.ManipulationType=void 0,(y=i.ManipulationType||(i.ManipulationType={}))[y.XY=0]="XY",y[y.XY_AXIS=1]="XY_AXIS",y[y.Z=2]="Z",i.MoveManipulation=h,Object.defineProperties(i,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
