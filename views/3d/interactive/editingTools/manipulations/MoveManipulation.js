// COPYRIGHT Â© 2020 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.17/esri/copyright.txt for details.

define(["require","exports","tslib","../../../../../core/Handles","../../../../../core/handleUtils","../../../../../core/has","../../../../../core/maybe","./config","./Manipulation","./MoveXYAxisManipulation","./MoveXYDiscManipulation","./MoveZManipulation"],(function(i,e,n,a,t,o,r,u,l,s,p,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MoveManipulation=void 0;var h=function(i){function e(e){var n=i.call(this)||this;n._handles=new a,n._angleDeferred=null,n._interactive=!0;var t=e.tool,o=e.view,r=e.snapToScene,u=e.radius;return n._view=o,n.xyManipulation=new p.MoveXYDiscManipulation({tool:t,view:o,snapToScene:r,radius:u}),n.xyAxisManipulation=new s.MoveXYAxisManipulation({tool:t,view:o,radius:u}),n.zManipulation=new c.MoveZManipulation({tool:t,view:o,radius:u}),n.xyManipulation.available=e.xyAvailable,n.xyAxisManipulation.available=e.xyAxisAvailable,n.zManipulation.available=e.zAvailable,n.autoHideXYAxis(),n.forEachManipulator((function(i){n._handles.add(i.events.on("grab-changed",(function(){return n.updateManipulatorInteractivity()})))})),n}return n.__extends(e,i),e.prototype.destroy=function(){this._handles.destroy(),this.xyManipulation.destroy(),this.xyAxisManipulation.destroy(),this.zManipulation.destroy()},e.prototype.createGraphicDragPipeline=function(i,e){return t.handlesGroup([this.xyManipulation.createGraphicDragPipeline(i,e),this.xyAxisManipulation.createGraphicDragPipeline(i,e),this.zManipulation.createGraphicDragPipeline(i,e)])},e.prototype.createDragPipeline=function(i,e,n){return t.handlesGroup([this.xyManipulation.createDragPipeline(i,e,n),this.xyAxisManipulation.createDragPipeline(i,e,n),this.zManipulation.createDragPipeline(i,n)])},Object.defineProperty(e.prototype,"snapToScene",{set:function(i){this.xyManipulation.snapToScene=i},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{set:function(i){this._angleDeferred=null,this.xyAxisManipulation.angle=i},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angleDeferred",{set:function(i){this.xyAxisVisible?this.angle=i():this._angleDeferred=i},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"interactive",{set:function(i){this._interactive!==i&&(this._interactive=i,this.updateManipulatorInteractivity())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radius",{set:function(i){this.xyAxisManipulation.radius=i,this.xyManipulation.radius=i,this.zManipulation.radius=i},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displayScale",{set:function(i){this.xyManipulation.displayScale=i,this.xyAxisManipulation.displayScale=i},enumerable:!1,configurable:!0}),e.prototype.forEachManipulator=function(i){this.xyManipulation.forEachManipulator((function(e){return i(e,1)})),this.xyAxisManipulation.forEachManipulator((function(e){return i(e,1)})),this.zManipulation.forEachManipulator((function(e){return i(e,0)}))},Object.defineProperty(e.prototype,"xyAxisVisible",{get:function(){var i=this.xyManipulation.someManipulator((function(i){return i.focused}))||this.xyAxisManipulation.someManipulator((function(i){return i.focused}));return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||i},enumerable:!1,configurable:!0}),e.prototype.autoHideXYAxis=function(){var i=this,e=this.xyAxisManipulation,n=this.xyManipulation;if(!o("esri-mobile")){var a=[];n.forEachManipulator((function(i){return a.push(i)})),e.forEachManipulator((function(i){return a.push(i)}));for(var t=function(){var n=[];i.xyAxisVisible?r.isSome(i._angleDeferred)&&(i.angle=i._angleDeferred()):e.forEachManipulator((function(i){return n.push(i.disableDisplay())})),i._handles.remove(y),i._handles.add(n,y)},u=0,l=a;u<l.length;u++){var s=l[u];this._handles.add(s.events.on("focus-changed",t))}this._view.inputManager&&this._handles.add(this._view.inputManager.watch("latestPointerType",t)),t()}},e.prototype.updateManipulatorInteractivity=function(){var i=this,e=this.grabbing;this.forEachManipulator((function(n){n.interactive=!e&&i._interactive||n.grabbing}))},e.radiusForSymbol=function(i){var e=r.isSome(i)&&"point-3d"===i.type&&i.symbolLayers;return!!e&&e.length>0&&e.some((function(i){return"icon"===i.type}))?u.DISC_RADIUS_SMALL:u.DISC_RADIUS},e}(l.Manipulation);e.MoveManipulation=h;var y="disable-xy-axis-display"}));