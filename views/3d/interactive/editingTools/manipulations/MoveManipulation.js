/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Handles","../../../../../core/handleUtils","../../../../../core/has","../../../../../core/maybe","./config","./Manipulation","./MoveXYAxisManipulation","./MoveXYDiscManipulation","./MoveZManipulation"],(function(i,a,n,e,t,s,o,l,r,u,p){"use strict";let c=function(i){function l(a){var e;(e=i.call(this)||this)._handles=new n,e._angleDeferred=null,e._interactive=!0;const{tool:t,view:s,snapToScene:o,radius:l}=a;return e._view=s,e.xyManipulation=new u.MoveXYDiscManipulation({tool:t,view:s,snapToScene:o,radius:l}),e.xyAxisManipulation=new r.MoveXYAxisManipulation({tool:t,view:s,radius:l}),e.zManipulation=new p.MoveZManipulation({tool:t,view:s,radius:l}),e.xyManipulation.available=a.xyAvailable,e.xyAxisManipulation.available=a.xyAxisAvailable,e.zManipulation.available=a.zAvailable,e.autoHideXYAxis(),e.forEachManipulator((i=>{e._handles.add(i.events.on("grab-changed",(()=>e.updateManipulatorInteractivity())))})),e}a._inheritsLoose(l,i);var c=l.prototype;return c.destroy=function(){this._handles.destroy(),this.xyManipulation.destroy(),this.xyAxisManipulation.destroy(),this.zManipulation.destroy()},c.createGraphicDragPipeline=function(i,a,n){return e.handlesGroup([this.xyManipulation.createGraphicDragPipeline(((a,n,e,t,s)=>i(0,a,n,e,t,s)),a,n),this.xyAxisManipulation.createGraphicDragPipeline(((a,n,e,t,s)=>i(1,a,n,e,t,s)),a,n),this.zManipulation.createGraphicDragPipeline(((a,n,e,t,s)=>i(2,a,n,e,t,s)),a,n)])},c.createDragPipeline=function(i,a,n,t){return e.handlesGroup([this.xyManipulation.createDragPipeline(((a,n,e,t,s)=>i(0,a,n,e,t,s)),a,n,t),this.xyAxisManipulation.createDragPipeline(((a,n,e,t,s)=>i(1,a,n,e,t,s)),a,n,t),this.zManipulation.createDragPipeline(((a,n,e,t,s)=>i(2,a,n,e,t,s)),n)])},c.forEachManipulator=function(i){this.xyManipulation.forEachManipulator((a=>i(a,1))),this.xyAxisManipulation.forEachManipulator((a=>i(a,1))),this.zManipulation.forEachManipulator((a=>i(a,0)))},c.autoHideXYAxis=function(){const i=this.xyAxisManipulation,a=this.xyManipulation;if(t("esri-mobile"))return;const n=[];a.forEachManipulator((i=>n.push(i))),i.forEachManipulator((i=>n.push(i)));const e=()=>{const a=[];this.xyAxisVisible?s.isSome(this._angleDeferred)&&(this.angle=this._angleDeferred()):i.forEachManipulator((i=>a.push(i.disableDisplay()))),this._handles.remove(h),this._handles.add(a,h)};for(const t of n)this._handles.add(t.events.on("focus-changed",e));this._view.inputManager&&this._handles.add(this._view.inputManager.watch("latestPointerType",e)),e()},c.updateManipulatorInteractivity=function(){const i=this.grabbing;this.forEachManipulator((a=>{a.interactive=!i&&this._interactive||a.grabbing}))},l.radiusForSymbol=function(i){const a=s.isSome(i)&&"point-3d"===i.type&&i.symbolLayers;return!!a&&a.length>0&&a.some((i=>"icon"===i.type))?o.DISC_RADIUS_SMALL:o.DISC_RADIUS},a._createClass(l,[{key:"snapToScene",set:function(i){this.xyManipulation.snapToScene=i}},{key:"angle",set:function(i){this._angleDeferred=null,this.xyAxisManipulation.angle=i}},{key:"angleDeferred",set:function(i){this.xyAxisVisible?this.angle=i():this._angleDeferred=i}},{key:"interactive",set:function(i){this._interactive!==i&&(this._interactive=i,this.updateManipulatorInteractivity())}},{key:"radius",set:function(i){this.xyAxisManipulation.radius=i,this.xyManipulation.radius=i,this.zManipulation.radius=i}},{key:"displayScale",set:function(i){this.xyManipulation.displayScale=i,this.xyAxisManipulation.displayScale=i}},{key:"xyAxisVisible",get:function(){const i=this.xyManipulation.someManipulator((i=>i.focused))||this.xyAxisManipulation.someManipulator((i=>i.focused));return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||i}}]),l}(l.Manipulation);const h="disable-xy-axis-display";i.MoveManipulation=c,Object.defineProperty(i,"__esModule",{value:!0})}));
