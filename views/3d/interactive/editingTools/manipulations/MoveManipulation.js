/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/has","../../../../../core/maybe","../../../../../core/handleUtils","../../../../../core/Handles","./config","./Manipulation","./MoveXYAxisManipulation","./MoveXYDiscManipulation","./MoveZManipulation"],(function(i,a,n,e,t,s,o,l,r,u,p){"use strict";let c=function(i){function l(a){var n;(n=i.call(this)||this)._handles=new s,n._angleDeferred=null,n._interactive=!0;const{tool:e,view:t,snapToScene:o,radius:l}=a;return n._view=t,n.xyManipulation=new u.MoveXYDiscManipulation({tool:e,view:t,snapToScene:o,radius:l}),n.xyAxisManipulation=new r.MoveXYAxisManipulation({tool:e,view:t,radius:l}),n.zManipulation=new p.MoveZManipulation({tool:e,view:t,radius:l}),n.xyManipulation.available=a.xyAvailable,n.xyAxisManipulation.available=a.xyAxisAvailable,n.zManipulation.available=a.zAvailable,n.autoHideXYAxis(),n.forEachManipulator((i=>{n._handles.add(i.events.on("grab-changed",(()=>n.updateManipulatorInteractivity())))})),n}a._inheritsLoose(l,i);var c=l.prototype;return c.destroy=function(){this._handles.destroy(),this.xyManipulation.destroy(),this.xyAxisManipulation.destroy(),this.zManipulation.destroy()},c.createGraphicDragPipeline=function(i,a,n){return t.handlesGroup([this.xyManipulation.createGraphicDragPipeline(((a,n,e,t,s)=>i(0,a,n,e,t,s)),a,n),this.xyAxisManipulation.createGraphicDragPipeline(((a,n,e,t,s)=>i(1,a,n,e,t,s)),a,n),this.zManipulation.createGraphicDragPipeline(((a,n,e,t,s)=>i(2,a,n,e,t,s)),a,n)])},c.createDragPipeline=function(i,a,n,e){return t.handlesGroup([this.xyManipulation.createDragPipeline(((a,n,e,t,s)=>i(0,a,n,e,t,s)),a,n,e),this.xyAxisManipulation.createDragPipeline(((a,n,e,t,s)=>i(1,a,n,e,t,s)),a,n,e),this.zManipulation.createDragPipeline(((a,n,e,t,s)=>i(2,a,n,e,t,s)),n)])},c.forEachManipulator=function(i){this.xyManipulation.forEachManipulator((a=>i(a,1))),this.xyAxisManipulation.forEachManipulator((a=>i(a,1))),this.zManipulation.forEachManipulator((a=>i(a,0)))},c.autoHideXYAxis=function(){const i=this.xyAxisManipulation,a=this.xyManipulation;if(n("esri-mobile"))return;const t=[];a.forEachManipulator((i=>t.push(i))),i.forEachManipulator((i=>t.push(i)));const s=()=>{const a=[];this.xyAxisVisible?e.isSome(this._angleDeferred)&&(this.angle=this._angleDeferred()):i.forEachManipulator((i=>a.push(i.disableDisplay()))),this._handles.remove(h),this._handles.add(a,h)};for(const n of t)this._handles.add(n.events.on("focus-changed",s));this._view.inputManager&&this._handles.add(this._view.inputManager.watch("latestPointerType",s)),s()},c.updateManipulatorInteractivity=function(){const i=this.grabbing;this.forEachManipulator((a=>{a.interactive=!i&&this._interactive||a.grabbing}))},l.radiusForSymbol=function(i){const a=e.isSome(i)&&"point-3d"===i.type&&i.symbolLayers;return!!a&&a.length>0&&a.some((i=>"icon"===i.type))?o.DISC_RADIUS_SMALL:o.DISC_RADIUS},a._createClass(l,[{key:"snapToScene",set:function(i){this.xyManipulation.snapToScene=i}},{key:"angle",set:function(i){this._angleDeferred=null,this.xyAxisManipulation.angle=i}},{key:"angleDeferred",set:function(i){this.xyAxisVisible?this.angle=i():this._angleDeferred=i}},{key:"interactive",set:function(i){this._interactive!==i&&(this._interactive=i,this.updateManipulatorInteractivity())}},{key:"radius",set:function(i){this.xyAxisManipulation.radius=i,this.xyManipulation.radius=i,this.zManipulation.radius=i}},{key:"displayScale",set:function(i){this.xyManipulation.displayScale=i,this.xyAxisManipulation.displayScale=i}},{key:"xyAxisVisible",get:function(){const i=this.xyManipulation.someManipulator((i=>i.focused))||this.xyAxisManipulation.someManipulator((i=>i.focused));return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||i}}]),l}(l.Manipulation);const h="disable-xy-axis-display";i.MoveManipulation=c,Object.defineProperty(i,"__esModule",{value:!0})}));
