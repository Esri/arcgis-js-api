// COPYRIGHT Â© 2020 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.17/esri/copyright.txt for details.

define(["require","exports","tslib","../../../../Color","../../../../core/colorUtils","../../../../core/compilerUtils","../../../../core/libs/gl-matrix-2/vec4f64","../../webgl-engine/materials/lineStippleUtils"],(function(o,e,t,i,l,n,r,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.settings=e.colors=void 0,e.colors={main:new i([255,127,0]),selected:new i([255,255,255]),staged:new i([12,207,255]),outline:new i([0,0,0,.5]),selectedOutline:new i([255,255,255])};function c(o,e){var t=o.clone();return t.a*=e,t}function a(o,e){var t=o.clone(),i=l.toHSV(t);i.s*=e;var n=l.toRGB(i);return t.r=n.r,t.g=n.g,t.b=n.b,t}function h(o,e){if(e)for(var t in e)o[t]=e[t]}var u=function(){function o(o){this.color=e.colors.main,this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.occludedMode="always",h(this,o)}return Object.defineProperty(o.prototype,"occludedFlag",{get:function(){return W(this.occludedMode)},enumerable:!1,configurable:!0}),o}(),d=function(){function o(o){this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=e.colors.main,this.outlineColor=e.colors.outline,this.occludedMode="always",this.hoverOutlineColor=e.colors.selectedOutline,h(this,o)}return Object.defineProperty(o.prototype,"renderOccludedFlag",{get:function(){return W(this.occludedMode)},enumerable:!1,configurable:!0}),o.prototype.apply=function(o,e){var t=this[o];e.setParameterValues({color:P(t),transparent:"color"!==o||t.a<1}),e.renderOccluded=this.renderOccludedFlag},o}(),f=function(o){this.vertex=new d({color:e.colors.main,outlineColor:e.colors.outline}),this.edge=new d({color:a(c(e.colors.main,2/3),.5),outlineColor:c(e.colors.outline,.5),size:8,collisionPadding:8}),this.selected=new d({color:e.colors.selected,outlineColor:e.colors.outline}),h(this,o)},p=function(){function o(o){this.color=e.colors.selected,this.width=1.5,this.stipplePattern=s.createStipplePattern([5,5]),this.stippleOffColor=e.colors.outline,this.falloff=0,this.innerWidth=1.5,this.innerColor=e.colors.selected,this.occludedMode="transparent",this.occludedLayer="default",h(this,o)}return o.prototype.apply=function(o){o.color=P(this.color),o.width=this.width,o.stipplePattern=this.stipplePattern,o.stippleOffColor=P(this.stippleOffColor),o.falloff=this.falloff,o.innerWidth=this.innerWidth,o.innerColor=P(this.innerColor),o.occludedMode=W(this.occludedMode,{layer:this.occludedLayer})},o}(),g=function(){function o(o){this.color=e.colors.selected,this.size=4,this.outlineSize=1,this.outlineColor=e.colors.outline,this.shape="square",h(this,o)}return o.prototype.apply=function(o){o.color=P(this.color),o.size=this.size,o.outlineSize=this.outlineSize,o.outlineColor=P(this.outlineColor),o.primitive=this.shape},o}(),w=function(){function o(o){this.innerColor=e.colors.selected,this.innerWidth=1,this.glowColor=e.colors.main,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=.3,this.globalAlphaContrastBoost=1.5,this.radius=3,this.heightFillColor=e.colors.main,h(this,o)}return o.prototype.apply=function(o,e){void 0===e&&(e=1);var t={glowColor:i.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:i.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*e,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in o?o.style=t:o.laserlineStyle=t},o}(),C=function(o){this.outline=new p({color:e.colors.selected,occludedMode:"transparent",occludedLayer:"foreground",stippleOffColor:e.colors.outline,stipplePattern:s.createStipplePattern([5,5]),width:1.5}),this.staged=new p({color:e.colors.selected,occludedMode:"transparent",occludedLayer:"foreground",innerColor:e.colors.staged,stippleOffColor:e.colors.outline,stipplePattern:s.createStipplePattern([5,5]),width:1.5}),this.shadowStyle=new w({globalAlpha:.3,glowColor:e.colors.main,glowFalloff:8,glowWidth:8,innerColor:e.colors.selected,innerWidth:1}),h(this,o)},y=function(o){this.outline=new g({color:e.colors.selected,outlineColor:e.colors.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new w({globalAlpha:.3,glowColor:e.colors.main,glowFalloff:1.5,glowWidth:6,innerColor:e.colors.selected,innerWidth:1,radius:2}),h(this,o)},b=function(o){function e(e){var t=o.call(this)||this;return t.infinite="ground",h(t,e),t}return t.__extends(e,o),Object.defineProperty(e.prototype,"infiniteType",{get:function(){switch(this.infinite){case"single":return 1;case"double":return 2;case"ground":return 3;default:return n.neverReached(this.infinite),1}},enumerable:!1,configurable:!0}),e}(p),m=function(o){this.lineGraphics=new C,this.pointGraphics=new y,this.heightPlane=new w({globalAlpha:.3,glowColor:e.colors.main,glowFalloff:8,glowWidth:8,innerColor:e.colors.selected,innerWidth:1}),this.heightBox=new w({globalAlpha:.3,glowColor:e.colors.main,glowFalloff:8,glowWidth:8,innerColor:e.colors.selected,innerWidth:0,heightFillColor:e.colors.main}),this.zVerticalLine=new b({color:c(e.colors.main,.5),falloff:2,innerColor:c(e.colors.selected,0),occludedMode:"transparent",stipplePattern:null,width:5,infinite:"ground"}),this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,h(this,o)},v=function(){function o(o){this.visualElements=new m,this.reshapeManipulators=new f,this.zManipulator=new u,h(this,o)}return o.prototype.colorToVec4=function(o){return P(o)},o}();function P(o){return r.vec4f64.fromArray(i.toUnitRGBA(o))}function W(o,e){var t=e&&"foreground"===e.layer;switch(o){case"always":return t?32:16;case"transparent":return t?8:4;case"always-transparent":return 2;default:n.neverReached(o)}return 1}e.settings=new v}));