/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../geometry/projection","../../../../geometry/support/triangulationUtils","../../layers/graphics/elevationAlignmentUtils","../../terrain/OverlayRenderer","../../webgl-engine/lib/DoubleArray"],(function(n,o,e,t,i,r,s,l){"use strict";function u(n,o,e,t){const s=i.pathsToTriangulationInfo(n.rings,!!n.hasZ,i.CounterClockwiseMode.CCW_IS_HOLE),u=l.newDoubleArray(s.position.length),a=r.applyPerVertexElevationAlignment(s.position,n.spatialReference,0,u,0,s.position,0,s.position.length/3,o,e,t),h=null!=a;return new d(s.position,u,c(s.polygons,s.position,u),p(s.outlines,s.position,u),h,a)}function a(n,o){const e=i.pathsToTriangulationInfo(n.rings,!1,i.CounterClockwiseMode.CCW_IS_HOLE),r=t.projectBuffer(e.position,n.spatialReference,0,e.position,o,0,e.position.length/3);for(let t=2;t<e.position.length;t+=3)e.position[t]=s.DRAPED_Z;return{position:e.position,polygons:c(e.polygons,e.position),outlines:p(e.outlines,e.position),projectionSuccess:r}}function p(n,o,t=null){return n.filter((({count:n})=>n>1)).map((({index:n,count:i})=>{const r=3*n,s=3*i;return e.isSome(t)?new g(n,i,l.doubleSubArray(o,r,s),l.doubleSubArray(t,r,s)):new h(n,i,l.doubleSubArray(o,r,s))}))}function c(n,o,t=null){const i=(e.isSome(t),new Array);for(const{index:r,count:s,holeIndices:u,pathLengths:a}of n){if(s<=1)continue;const n=3*r,p=3*s,c=u.map((n=>n-r)),h=e.isSome(t)?new f(r,s,l.doubleSubArray(o,3*r,3*s),l.doubleSubArray(t,n,p),c,a):new y(r,s,l.doubleSubArray(o,3*r,3*s),c,a);i.push(h)}return i}let h=function(n,o,e){this.index=n,this.count=o,this.position=e},g=function(n){function e(o,e,t,i){var r;return(r=n.call(this,o,e,t)||this).mapPositions=i,r}return o._inheritsLoose(e,n),e}(h),f=function(n){function e(o,e,t,i,r,s){var l;return(l=n.call(this,o,e,t,i)||this).holeIndices=r,l.pathLengths=s,l}return o._inheritsLoose(e,n),e}(g),y=function(n){function e(o,e,t,i,r){var s;return(s=n.call(this,o,e,t)||this).holeIndices=i,s.pathLengths=r,s}return o._inheritsLoose(e,n),e}(h),d=function(n,o,e,t,i,r){this.position=n,this.mapPositions=o,this.polygons=e,this.outlines=t,this.projectionSuccess=i,this.sampledElevation=r};n.PolygonRenderInfo=d,n.PolygonVertexData=f,n.PolygonVertexDataDraped=y,n.geometryToRenderInfo=u,n.geometryToRenderInfoDraped=a,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})}));
