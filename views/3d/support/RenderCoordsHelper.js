/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","../../../core/unitUtils","../../../chunks/mat4","../../../chunks/vec3","../../../geometry/projection","../../../geometry/SpatialReference","../../../geometry/support/coordinateSystem","../../../geometry/support/plane","../../../geometry/support/vectorStacks","../../../layers/graphics/dehydratedFeatureUtils"],(function(t,e,o,i,n,s,r,c,a,d,l,u){"use strict";let h=function(){function t(t,e,o,i){this.viewingMode=t,this.spatialReference=e,this.unitInMeters=o,this.coordinateSystem=i,this._coordinateSystem=a.create(i)}var h=t.prototype;return h.getAltitude=function(t){return a.altitudeAt(this.coordinateSystem,t)},h.setAltitude=function(t,e,o=t){return a.setAltitudeAt(this.coordinateSystem,o,e,t)},h.setAltitudeOfTransformation=function(t,e){a.setAltitudeOfTransformation(this.coordinateSystem,e,t,e)},h.worldUpAtPosition=function(t,e){return a.normalAt(this.coordinateSystem,t,e)},h.worldBasisAtPosition=function(t,e,o){return a.axisAt(this.coordinateSystem,t,e,o)},h.basisMatrixAtPosition=function(t,e){const o=this.worldBasisAtPosition(t,0,l.sv3d.get()),i=this.worldBasisAtPosition(t,1,l.sv3d.get()),s=this.worldBasisAtPosition(t,2,l.sv3d.get());return n.set(e,o[0],o[1],o[2],0,i[0],i[1],i[2],0,s[0],s[1],s[2],0,0,0,0,1),e},h.intersectManifoldClosestSilhouette=function(t,e,o){return a.elevate(this.coordinateSystem,e,this._coordinateSystem),a.intersectRayClosestSilhouette(this._coordinateSystem,t,o),o},h.intersectManifold=function(t,e,o){a.elevate(this.coordinateSystem,e,this._coordinateSystem);const i=l.sv3d.get();return a.intersectRay(this._coordinateSystem,t,i)?s.copy(o,i):null},h.intersectInfiniteManifold=function(t,e,o){if(1===this.viewingMode)return this.intersectManifold(t,e,o);a.elevate(this.coordinateSystem,e,this._coordinateSystem);const i=this._coordinateSystem.value,n=l.sv3d.get();return d.intersectRay(i.plane,t,n)?s.copy(o,n):null},h.toRenderCoords=function(t,e,o){return u.isDehydratedPoint(t)?r.projectPointToVector(t,e,this.spatialReference):r.projectVectorToVector(t,e,o,this.spatialReference)},h.fromRenderCoords=function(t,e,i=null){return u.isDehydratedPoint(e)?(o.isSome(i)&&(e.spatialReference=i),r.projectVectorToDehydratedPoint(t,this.spatialReference,e)):e instanceof c?r.projectVectorToPoint(t,this.spatialReference,e):r.projectVectorToVector(t,this.spatialReference,e,i)?e:null},t.create=function(e,o){switch(e){case 2:return new t(2,o,i.getMetersPerUnitForSR(o),a.createLocal());case 1:return new t(1,o,1,a.createGlobal(o))}},e._createClass(t,[{key:"extent",set:function(t){t&&a.setExtent(this.coordinateSystem,t,this.coordinateSystem)}}]),t}();t.RenderCoordsHelper=h,Object.defineProperty(t,"__esModule",{value:!0})}));
