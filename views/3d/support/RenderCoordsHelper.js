/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","../../../core/unitUtils","../../../chunks/mat4","../../../chunks/vec3","../../../geometry/projection","../../../geometry/SpatialReference","../../../geometry/support/coordinateSystem","../../../geometry/support/plane","../../../geometry/support/vectorStacks","../../../layers/graphics/dehydratedFeatureUtils","../../support/spatialReferenceSupport"],(function(t,e,o,i,r,n,s,c,a,u,d,l,f){"use strict";let h=function(){function t(t,e,o,i){this.viewingMode=t,this.spatialReference=e,this.unitInMeters=o,this.coordinateSystem=i,this._coordinateSystem=a.create(i)}var f=t.prototype;return f.getAltitude=function(t){return a.altitudeAt(this.coordinateSystem,t)},f.setAltitude=function(t,e,o=t){return a.setAltitudeAt(this.coordinateSystem,o,e,t)},f.setAltitudeOfTransformation=function(t,e){a.setAltitudeOfTransformation(this.coordinateSystem,e,t,e)},f.worldUpAtPosition=function(t,e){return a.normalAt(this.coordinateSystem,t,e)},f.worldBasisAtPosition=function(t,e,o){return a.axisAt(this.coordinateSystem,t,e,o)},f.basisMatrixAtPosition=function(t,e){const o=this.worldBasisAtPosition(t,0,d.sv3d.get()),i=this.worldBasisAtPosition(t,1,d.sv3d.get()),n=this.worldBasisAtPosition(t,2,d.sv3d.get());return r.set(e,o[0],o[1],o[2],0,i[0],i[1],i[2],0,n[0],n[1],n[2],0,0,0,0,1),e},f.intersectManifoldClosestSilhouette=function(t,e,o){return a.elevate(this.coordinateSystem,e,this._coordinateSystem),a.intersectRayClosestSilhouette(this._coordinateSystem,t,o),o},f.intersectManifold=function(t,e,o){a.elevate(this.coordinateSystem,e,this._coordinateSystem);const i=d.sv3d.get();return a.intersectRay(this._coordinateSystem,t,i)?n.copy(o,i):null},f.intersectInfiniteManifold=function(t,e,o){if(1===this.viewingMode)return this.intersectManifold(t,e,o);a.elevate(this.coordinateSystem,e,this._coordinateSystem);const i=this._coordinateSystem.value,r=d.sv3d.get();return u.intersectRay(i.plane,t,r)?n.copy(o,r):null},f.toRenderCoords=function(t,e,o){return l.isDehydratedPoint(t)?s.projectPointToVector(t,e,this.spatialReference):s.projectVectorToVector(t,e,o,this.spatialReference)},f.fromRenderCoords=function(t,e,i=null){return l.isDehydratedPoint(e)?(o.isSome(i)&&(e.spatialReference=i),s.projectVectorToDehydratedPoint(t,this.spatialReference,e)):e instanceof c?s.projectVectorToPoint(t,this.spatialReference,e):s.projectVectorToVector(t,this.spatialReference,e,i)?e:null},t.create=function(e,o){switch(e){case 2:return new t(2,o,i.getMetersPerUnitForSR(o),a.createLocal());case 1:return new t(1,o,1,a.createGlobal(o))}},t.renderUnitScaleFactor=function(t,e){return p(t)/p(e)},e._createClass(t,[{key:"extent",set:function(t){t&&a.setExtent(this.coordinateSystem,t,this.coordinateSystem)}}]),t}();function p(t){if(f.isSpatialReferenceSupported(t,1))return 1;const e=a.renderSRFromViewSR(!1,t);return i.getMetersPerUnitForSR(e)}t.RenderCoordsHelper=h,Object.defineProperty(t,"__esModule",{value:!0})}));
