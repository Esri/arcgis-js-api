/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["../../../core/byteSizeEstimations","../../../core/maybe","../layers/support/MemoryManagedLayerView","./LayerPerformanceInfo","../terrain/terrainUtils"],(function(e,r,o,t,s){"use strict";return function(i){if(this.totalMemory=0,this.usedMemory=0,this.quality=1,this.load=0,this.terrainMemory=0,this.edgesMemory=0,this.layerPerformanceInfos=new Array,r.isSome(i.resourceController)){const r=i.resourceController.memoryController;this.totalMemory=(r.maxMemory??0)*e.ByteSizeUnit.MEGABYTES,this.usedMemory=Math.round(r.usedMemory*this.totalMemory),this.quality=r.memoryFactor,this.load=i.resourceController.scheduler.load}this.terrainMemory=i.basemapTerrain?.getUsedMemory()??0;const a=i._stage&&i._stage.renderView&&i._stage.renderer.edgeView;this.edgesMemory=r.isSome(a)?a.usedMemory:0,i.allLayerViews.items.forEach((e=>{(o.isMemoryManagedLayerView(e)||s.isSurfaceLayerView(e))&&this.layerPerformanceInfos.push(new t(e,i))})),this.layerPerformanceInfos.sort(((e,r)=>r.memory-e.memory))}}));
