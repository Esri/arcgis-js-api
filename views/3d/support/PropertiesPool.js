/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../core/ReentrantObjectPool","../../../core/accessorSupport/watch"],(function(e,t,o){"use strict";let r=function(){function e(e,r){this._owner=r,this._properties={},this._afterDispatchHandle=null;for(const o in e){const r=e[o],i=new t.ReentrantObjectPool(r,void 0,void 0,2,2);this._properties[o]={pool:i,acquired:[]}}this._afterDispatchHandle=o.afterDispatch((()=>this._release()))}var r=e.prototype;return r.destroy=function(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const t=this._properties[e];for(const e of t.acquired)o.isValueInUse(e)||t.pool.release(e);t.pool.destroy(),t.pool=null,t.acquired=null}this._properties=null,this._owner=null},r.get=function(e){const t=this._owner._get(e),o=this._properties[e];let r=o.pool.acquire();for(o.acquired.push(r);r===t;)o.acquired.push(r),r=o.pool.acquire();return r},r._release=function(){for(const e in this._properties){const t=this._properties[e];let r=0;for(const e of t.acquired)o.isValueInUse(e)?t.acquired[r++]=e:t.pool.release(e);t.acquired.length=r}},e}();e.PropertiesPool=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
