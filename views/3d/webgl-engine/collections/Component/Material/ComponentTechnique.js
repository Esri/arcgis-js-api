/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["require","exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../ViewingMode","./ComponentTechniqueConfiguration","../../../../../../chunks/ComponentShader.glsl","../../../core/shaderLibrary/ShaderOutput","../../../core/shaderLibrary/util/DoublePrecision.glsl","../../../core/shaderTechnique/ReloadableShaderModule","../../../core/shaderTechnique/ShaderTechnique","../../../lib/basicInterfaces","../../../lib/OrderIndependentTransparency","../../../lib/Program","../../../lib/StencilUtils","../../../lib/TransparencyPassType","../../../lib/VertexAttribute","../../../../../webgl/context-util","../../../../../webgl/renderState"],(function(e,t,n,i,r,a,l,o,s,u,c,d,h,p,b,g,f,P){"use strict";let O=function(e){function t(){return e.apply(this,arguments)||this}n._inheritsLoose(t,e);var a=t.prototype;return a.initializeConfiguration=function(e,t){t.hasWebGL2Context=e.rctx.type===f.ContextType.WEBGL2,t.spherical=e.viewingMode===i.ViewingMode.Global,t.doublePrecisionRequiresObfuscation=o.doublePrecisionRequiresObfuscation(e.rctx)},a.initializeProgram=function(e){return new h.Program(e.rctx,t.shader.get().build(this.configuration),T)},a._setPipelineState=function(e){const t=this.configuration,n=t.integratedMeshMode!==r.IntegratedMeshMode.None,i=e===b.TransparencyPassType.NONE,a=e===b.TransparencyPassType.FrontFace;return P.makePipelineState({blending:t.output!==l.ShaderOutput.Color&&t.output!==l.ShaderOutput.Alpha||!t.blendingEnabled?null:i?d.blendingDefault:d.oitBlending(e),culling:P.cullingParams(t.cullFace),depthTest:{func:d.oitDepthTest(e)},depthWrite:i||a?P.defaultDepthWriteParams:null,colorWrite:P.defaultColorWriteParams,stencilWrite:n||t.hasOccludees?p.stencilWriteMaskOn:null,stencilTest:n?p.replaceBitWhenDepthTestPasses(c.StencilBits.IntegratedMeshMaskExcluded):t.hasOccludees?p.stencilBaseAllZerosParams:null,polygonOffset:i||a?t.hasPolygonOffset?{factor:2,units:2}:null:d.OITPolygonOffset})},a.initializePipeline=function(){return this._setPipelineState(this.configuration.transparencyPassType)},t}(u.ShaderTechnique);O.shader=new s.ReloadableShaderModule(a.ComponentShader,(()=>new Promise(((t,n)=>e(["./shader/ComponentShader.glsl"],t,n)))));const T=new Map([[g.VertexAttribute.POSITION,0],[g.VertexAttribute.NORMAL,1],[g.VertexAttribute.NORMALCOMPRESSED,1],[g.VertexAttribute.COLOR,2],[g.VertexAttribute.UV0,3],[g.VertexAttribute.UVREGION,4],[g.VertexAttribute.COMPONENTINDEX,5]]);t.ComponentTechnique=O,t.attributeLocations=T,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
