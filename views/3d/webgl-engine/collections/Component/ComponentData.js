/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/typedArrayUtil","../../../../../core/maybe","../../lib/AutoDisposable","./IndexRange/ComponentRangeRunLengthEncoded"],(function(e,t,i,n,s){"use strict";return function(n){function h(e,i){var h;(h=n.call(this)||this).pickability=null,h.highlightCounts=null,h.cachedGeometryRanges=null,h.cachedHighlightRanges=null,h.offsets=t.slice(i);const a=h.count;h.visibility=new s.ComponentRangeRunLengthEncoded(a),h.materialDataBuffer=e.getBuffer(a),h.materialDataIndices=new Uint16Array(a);for(let e=0;e<a;e++)h.materialDataIndices[e]=h.materialDataBuffer.acquireIndex();return h}e._inheritsLoose(h,n);var a=h.prototype;return a.dispose=function(){n.prototype.dispose.call(this);for(let e=0;e<this.count;e++)this.materialDataBuffer.releaseIndex(this.materialDataIndices[e])},a.highlightsDirty=function(){this.cachedHighlightRanges=null},a.visibilityDirty=function(){this.cachedGeometryRanges=null,this.cachedHighlightRanges=null},e._createClass(h,[{key:"count",get:function(){return this.offsets.length-1}},{key:"geometryRanges",get:function(){return i.isNone(this.cachedGeometryRanges)&&(this.cachedGeometryRanges=this.visibility.computeOffsetRanges(this.offsets)),this.cachedGeometryRanges}},{key:"highlightRanges",get:function(){return i.isNone(this.highlightCounts)?null:(i.isNone(this.cachedHighlightRanges)&&(this.cachedHighlightRanges=function(e,t,i){const n=[];let s=i.length;t.forEachComponent((t=>(e[t]>0&&(s!==t-1&&(n.length&&n.push(i[s+1]-n[n.length-1]),n.push(i[t])),s=t),!0))),n.length&&n.push(i[s+1]-n[n.length-1]);return n}(this.highlightCounts,this.visibility,this.offsets)),this.cachedHighlightRanges)}}]),h}(n.AutoDisposable)}));
