/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{c as e}from"../../../../chunks/mat3f64.js";import{f as t,c as i}from"../../../../chunks/vec3f64.js";import{f as s}from"../../../../chunks/vec4f64.js";import{ViewingMode as r}from"../../../ViewingMode.js";import{ShaderOutput as o}from"../core/shaderLibrary/ShaderOutputOptions.js";import{TextureCoordinateAttributeType as a}from"../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js";import{VertexNormalPassParameters as l,VertexNormalDrawParameters as n}from"../core/shaderLibrary/attributes/VertexNormal.glsl.js";import{defaultMaskAlphaCutoff as h}from"../core/shaderLibrary/util/AlphaCutoff.js";import{doublePrecisionRequiresObfuscation as c}from"../core/shaderLibrary/util/DoublePrecision.glsl.js";import{ReloadableShaderModule as u}from"../core/shaderTechnique/ReloadableShaderModule.js";import{ShaderTechnique as p}from"../core/shaderTechnique/ShaderTechnique.js";import{CullFaceOptions as d,DepthTestFunction as m,AlphaDiscardMode as f,TransparencyPassType as b}from"../lib/basicInterfaces.js";import{Default3D as v}from"../lib/DefaultVertexAttributeLocations.js";import{RenderOccludedFlag as S}from"../lib/Material.js";import{blendingDefault as g,oitBlending as x,oitDepthTest as y,getOITPolygonOffset as P}from"../lib/OrderIndependentTransparency.js";import{Program as j}from"../lib/Program.js";import{stencilWriteMaskOn as O,stencilToolMaskBaseParams as T,stencilBaseAllZerosParams as M}from"../lib/StencilUtils.js";import{D as C}from"../../../../chunks/DefaultMaterial.glsl.js";import{CompareFunction as z}from"../../../webgl/enums.js";import{makePipelineState as D,cullingParams as L,defaultDepthWriteParams as w,defaultColorWriteParams as A}from"../../../webgl/renderState.js";class F extends l{constructor(){super(...arguments),this.isSchematic=!1,this.usePBR=!1,this.mrrFactors=t(0,1,.5),this.hasVertexColors=!1,this.hasSymbolColors=!1,this.doubleSided=!1,this.doubleSidedType="normal",this.cullFace=d.Back,this.emissiveFactor=t(0,0,0),this.instancedDoublePrecision=!1,this.normals="default",this.receiveSSAO=!0,this.receiveShadows=!0,this.castShadows=!0,this.shadowMappingEnabled=!1,this.ambient=t(.2,.2,.2),this.diffuse=t(.8,.8,.8),this.externalColor=s(1,1,1,1),this.colorMixMode="multiply",this.opacity=1,this.layerOpacity=1,this.origin=i(),this.hasSlicePlane=!1,this.hasSliceHighlight=!0,this.offsetTransparentBackfaces=!1,this.vvSizeEnabled=!1,this.vvSizeMinSize=[1,1,1],this.vvSizeMaxSize=[100,100,100],this.vvSizeOffset=[0,0,0],this.vvSizeFactor=[1,1,1],this.vvSizeValue=[1,1,1],this.vvColorEnabled=!1,this.vvColorValues=[0,0,0,0,0,0,0,0],this.vvColorColors=[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],this.vvSymbolAnchor=[0,0,0],this.vvSymbolRotationMatrix=e(),this.vvOpacityEnabled=!1,this.vvOpacityValues=[],this.vvOpacityOpacities=[],this.transparent=!1,this.writeDepth=!0,this.customDepthTest=m.Less,this.textureAlphaMode=f.Blend,this.textureAlphaCutoff=h,this.textureAlphaPremultiplied=!1,this.hasOccludees=!1,this.renderOccluded=S.Occlude}}class _ extends n{constructor(){super(...arguments),this.origin=i(),this.slicePlaneLocalOrigin=this.origin}}class E extends p{initializeConfiguration(e,t){t.spherical=e.viewingMode===r.Global,t.doublePrecisionRequiresObfuscation=c(e.rctx),t.textureCoordinateType=t.hasColorTexture||t.hasMetalnessAndRoughnessTexture||t.hasEmissionTexture||t.hasOcclusionTexture||t.hasNormalTexture?a.Default:a.None}initializeProgram(e){return this._initializeProgram(e,E.shader)}_initializeProgram(e,t){const i=t.get().build(this.configuration);return new j(e.rctx,i,v)}_convertDepthTestFunction(e){return e===m.Lequal?z.LEQUAL:z.LESS}_setPipeline(e,t){const i=this.configuration,s=e===b.NONE,r=e===b.FrontFace;return D({blending:i.output!==o.Color&&i.output!==o.Alpha||!i.transparent?null:s?g:x(e),culling:V(i)&&L(i.cullFace),depthTest:{func:y(e,this._convertDepthTestFunction(i.customDepthTest))},depthWrite:s||r?i.writeDepth&&w:null,colorWrite:A,stencilWrite:i.hasOccludees?O:null,stencilTest:i.hasOccludees?t?T:M:null,polygonOffset:s||r?null:P(i.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipeline(this.configuration.transparencyPassType,!0),this._setPipeline(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}}function V(e){return e.cullFace!==d.None||!e.hasSlicePlane&&(!e.transparent&&!e.doubleSidedMode)}E.shader=new u(C,(()=>import("./DefaultMaterial.glsl.js")));export{_ as DefaultMaterialDrawParameters,F as DefaultMaterialPassParameters,E as DefaultMaterialTechnique};
