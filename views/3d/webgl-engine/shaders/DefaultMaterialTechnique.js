/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["require","exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3f64","../../../../chunks/vec3f64","../../../../chunks/vec4f64","../../../ViewingMode","../core/shaderLibrary/ShaderOutput","../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl","../core/shaderLibrary/attributes/VertexNormal.glsl","../core/shaderLibrary/util/AlphaCutoff","../core/shaderLibrary/util/DoublePrecision.glsl","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../lib/basicInterfaces","../lib/DefaultVertexAttributeLocations","../lib/Material","../lib/OrderIndependentTransparency","../lib/Program","../lib/StencilUtils","../lib/TransparencyPassType","../../../../chunks/DefaultMaterial.glsl","../../../webgl/context-util","../../../webgl/enums","../../../webgl/renderState"],(function(e,t,a,i,r,n,l,o,s,u,c,d,h,p,f,b,m,g,P,v,y,S,T,O,x){"use strict";let M=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).isSchematic=!1,t.usePBR=!1,t.mrrFactors=r.fromValues(0,1,.5),t.hasVertexColors=!1,t.hasSymbolColors=!1,t.doubleSided=!1,t.doubleSidedType="normal",t.cullFace=f.CullFaceOptions.Back,t.emissiveFactor=r.fromValues(0,0,0),t.instancedDoublePrecision=!1,t.normals="default",t.receiveSSAO=!0,t.receiveShadows=!0,t.castShadows=!0,t.shadowMappingEnabled=!1,t.ambient=r.fromValues(.2,.2,.2),t.diffuse=r.fromValues(.8,.8,.8),t.externalColor=n.fromValues(1,1,1,1),t.colorMixMode="multiply",t.opacity=1,t.layerOpacity=1,t.origin=r.create(),t.hasSlicePlane=!1,t.hasSliceHighlight=!0,t.offsetTransparentBackfaces=!1,t.vvSizeEnabled=!1,t.vvSizeMinSize=[1,1,1],t.vvSizeMaxSize=[100,100,100],t.vvSizeOffset=[0,0,0],t.vvSizeFactor=[1,1,1],t.vvSizeValue=[1,1,1],t.vvColorEnabled=!1,t.vvColorValues=[0,0,0,0,0,0,0,0],t.vvColorColors=[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],t.vvSymbolAnchor=[0,0,0],t.vvSymbolRotationMatrix=i.create(),t.vvOpacityEnabled=!1,t.vvOpacityValues=[],t.vvOpacityOpacities=[],t.transparent=!1,t.writeDepth=!0,t.customDepthTest=f.DepthTestFunction.Less,t.textureAlphaMode=f.AlphaDiscardMode.Blend,t.textureAlphaCutoff=c.defaultMaskAlphaCutoff,t.textureAlphaPremultiplied=!1,t.hasOccludees=!1,t.renderOccluded=m.RenderOccludedFlag.Occlude,t}return a._inheritsLoose(t,e),t}(u.VertexNormalPassParameters),D=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).origin=r.create(),t.slicePlaneLocalOrigin=t.origin,t}return a._inheritsLoose(t,e),t}(u.VertexNormalDrawParameters),C=function(e){function t(){return e.apply(this,arguments)||this}a._inheritsLoose(t,e);var i=t.prototype;return i.initializeConfiguration=function(e,t){t.hasWebGL2Context=e.rctx.type===T.ContextType.WEBGL2,t.spherical=e.viewingMode===l.ViewingMode.Global,t.doublePrecisionRequiresObfuscation=d.doublePrecisionRequiresObfuscation(e.rctx),t.textureCoordinateType=t.hasColorTexture||t.hasMetallicRoughnessTexture||t.hasEmissionTexture||t.hasOcclusionTexture||t.hasNormalTexture?s.TextureCoordinateAttributeType.Default:s.TextureCoordinateAttributeType.None,t.objectAndLayerIdColorInstanced=t.instanced},i.initializeProgram=function(e){return this._initializeProgram(e,t.shader)},i._initializeProgram=function(e,t){return new P.Program(e.rctx,t.get().build(this.configuration),b.Default3D)},i._convertDepthTestFunction=function(e){return e===f.DepthTestFunction.Lequal?O.CompareFunction.LEQUAL:O.CompareFunction.LESS},i._makePipeline=function(e,t){const a=this.configuration,i=e===y.TransparencyPassType.NONE,r=e===y.TransparencyPassType.FrontFace;return x.makePipelineState({blending:a.output!==o.ShaderOutput.Color&&a.output!==o.ShaderOutput.Alpha||!a.transparent?null:i?g.blendingDefault:g.oitBlending(e),culling:L(a)&&x.cullingParams(a.cullFace),depthTest:{func:g.oitDepthTest(e,this._convertDepthTestFunction(a.customDepthTest))},depthWrite:i||r?a.writeDepth&&x.defaultDepthWriteParams:null,colorWrite:x.defaultColorWriteParams,stencilWrite:a.hasOccludees?v.stencilWriteMaskOn:null,stencilTest:a.hasOccludees?t?v.stencilToolMaskBaseParams:v.stencilBaseAllZerosParams:null,polygonOffset:i||r?null:g.getOITPolygonOffset(a.enableOffset)})},i.initializePipeline=function(){return this._occludeePipelineState=this._makePipeline(this.configuration.transparencyPassType,!0),this._makePipeline(this.configuration.transparencyPassType,!1)},i.getPipelineState=function(t,a){return a?this._occludeePipelineState:e.prototype.getPipelineState.call(this,t,a)},t}(p.ShaderTechnique);function L(e){return e.cullFace!==f.CullFaceOptions.None||!e.hasSlicePlane&&(!e.transparent&&!e.doubleSidedMode)}C.shader=new h.ReloadableShaderModule(S.DefaultMaterial,(()=>new Promise(((t,a)=>e(["./DefaultMaterial.glsl"],t,a))))),t.DefaultMaterialDrawParameters=D,t.DefaultMaterialPassParameters=M,t.DefaultMaterialTechnique=C,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
