/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["require","exports","../../../../chunks/_rollupPluginBabelHelpers","../../../ViewingMode","../../../../chunks/Terrain.glsl","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../lib/basicInterfaces","../lib/Program","../lib/StencilUtils","../lib/VertexAttribute","../../../webgl/context-util","../../../webgl/enums","../../../webgl/renderState"],(function(e,t,i,n,r,l,a,c,u,o,s,d,h,p){"use strict";let b=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).useStencil=!1,t}i._inheritsLoose(t,e);var r=t.prototype;return r.initializeConfiguration=function(e,t){t.hasWebGL2Context=e.rctx.type===d.ContextType.WEBGL2,t.spherical=e.viewingMode===n.ViewingMode.Global},r.initializeProgram=function(e){return new u.Program(e.rctx,t.shader.get().build(this.configuration),g)},r.initializePipeline=function(){return this._stencilPipelineState=this._createPipeline(!0),this._createPipeline(!1)},r._createPipeline=function(e){const t=this.configuration,i=t.backfaceCullingEnabled&&!t.renderOccluded;return p.makePipelineState({blending:t.renderOccluded?p.simpleBlendingParams(h.BlendFactor.ONE,h.BlendFactor.ONE_MINUS_SRC_ALPHA):null,culling:i?p.backFaceCullingParams:null,depthTest:t.renderOccluded?null:{func:h.CompareFunction.LESS},depthWrite:t.renderOccluded?null:p.defaultDepthWriteParams,colorWrite:p.defaultColorWriteParams,stencilTest:e?o.renderWhenBitIsNotSet(c.StencilBits.IntegratedMeshMaskExcluded):null})},r.getPipelineState=function(t,i){return this.useStencil?this._stencilPipelineState:e.prototype.getPipelineState.call(this,t,i)},t}(a.ShaderTechnique);b.shader=new l.ReloadableShaderModule(r.Terrain,(()=>new Promise(((t,i)=>e(["../core/shaderLibrary/terrain/Terrain.glsl"],t,i)))));const g=new Map([[s.VertexAttribute.POSITION,0],[s.VertexAttribute.UV0,1],[s.VertexAttribute.NORMALCOMPRESSED,2]]);t.TerrainTechnique=b,t.terrainVertexAttributeLocations=g,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
