/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["require","exports","../../../../chunks/_rollupPluginBabelHelpers","../../../ViewingMode","../../../../chunks/Terrain.glsl","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../lib/basicInterfaces","../lib/Program","../lib/StencilUtils","../lib/VertexAttribute","../../../webgl/context-util","../../../webgl/enums","../../../webgl/renderState"],(function(e,t,i,r,n,l,a,c,o,u,s,d,h,p){"use strict";let b=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).useStencil=!1,t}i._inheritsLoose(t,e);var n=t.prototype;return n.initializeConfiguration=function(e,t){t.hasWebGL2Context=e.rctx.type===d.ContextType.WEBGL2,t.spherical=e.viewingMode===r.ViewingMode.Global},n.initializeProgram=function(e){return new o.Program(e.rctx,t.shader.get().build(this.configuration),g)},n.initializePipeline=function(){return this._stencilPipelineState=this._createPipeline(!0),this._createPipeline(!1)},n._createPipeline=function(e){const t=this.configuration,i=t.backfaceCullingEnabled&&!t.renderOccluded;return p.makePipelineState({blending:t.renderOccluded?p.simpleBlendingParams(h.BlendFactor.ONE,h.BlendFactor.ONE_MINUS_SRC_ALPHA):null,culling:i&&p.backFaceCullingParams,depthTest:!t.renderOccluded&&{func:h.CompareFunction.LESS},depthWrite:!t.renderOccluded&&p.defaultDepthWriteParams,colorWrite:p.defaultColorWriteParams,stencilTest:e?u.renderWhenBitIsNotSet(c.StencilBits.IntegratedMeshMaskExcluded):null})},n.getPipelineState=function(t,i){return this.useStencil?this._stencilPipelineState:e.prototype.getPipelineState.call(this,t,i)},t}(a.ShaderTechnique);b.shader=new l.ReloadableShaderModule(n.Terrain,(()=>new Promise(((t,i)=>e(["../core/shaderLibrary/terrain/Terrain.glsl"],t,i)))));const g=new Map([[s.VertexAttribute.POSITION,0],[s.VertexAttribute.UV0,1],[s.VertexAttribute.NORMALCOMPRESSED,2]]);t.TerrainTechnique=b,t.terrainVertexAttributeLocations=g,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
