/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["require","exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6","../../../../chunks/Terrain.glsl","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../core/shaderTechnique/ShaderTechniqueConfiguration","../lib/DefaultVertexAttributeLocations","../lib/Program","../lib/StencilUtils","../../../webgl/renderState"],(function(e,r,t,i,a,o,n,d,l,c,s,u){"use strict";let p=function(e){function r(){var r;return(r=e.apply(this,arguments)||this).useStencil=!1,r}t._inheritsLoose(r,e);var i=r.prototype;return i.initializeProgram=function(e){const t=r.shader.get(),i=this.configuration,a=t.build({overlayMode:i.overlayMode,output:i.output,viewingMode:e.viewingMode,slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,textureFadingEnabled:i.textureFadingEnabled&&!i.renderOccluded,hasBackgroundColor:i.hasBackgroundColor,useGrid:i.useGrid,receiveShadows:i.receiveShadows&&!i.renderOccluded,receiveAmbientOcclusion:!1,atmosphere:i.atmosphere,tileBorders:i.tileBorders,screenSizePerspective:i.screenSizePerspective,pbrMode:0,ssrEnabled:i.ssrEnabled,highStepCount:!1});return new c.Program(e.rctx,a,l.Default3D)},i.initializePipeline=function(){return this._stencilPipelineState=this.createPipeline(!0),this.createPipeline(!1)},i.createPipeline=function(e){const r=this.configuration,t=r.backfaceCullingEnabled&&!r.renderOccluded;return u.makePipelineState({blending:r.renderOccluded?u.simpleBlendingParams(1,771):null,culling:t&&u.backFaceCullingParams,depthTest:!r.renderOccluded&&{func:513},depthWrite:!r.renderOccluded&&u.defaultDepthWriteParams,colorWrite:u.defaultColorWriteParams,stencilTest:e?s.renderWhenBitIsNotSet(1):null})},i.getPipelineState=function(r,t){return this.useStencil?this._stencilPipelineState:e.prototype.getPipelineState.call(this,r,t)},r}(n.ShaderTechnique);p.shader=new o.ReloadableShaderModule(a.TerrainShader,(()=>new Promise(((r,t)=>e(["../core/shaderLibrary/terrain/Terrain.glsl"],r,t)))));let h=function(e){function r(){var r;return(r=e.apply(this,arguments)||this).output=0,r.overlayMode=0,r.atmosphere=!1,r.receiveShadows=!1,r.slicePlaneEnabled=!1,r.backfaceCullingEnabled=!1,r.stencilEnabled=!1,r.textureFadingEnabled=!1,r.hasBackgroundColor=!1,r.useGrid=!1,r.renderOccluded=!1,r.ssrEnabled=!1,r.tileBorders=!1,r.screenSizePerspective=!1,r}return t._inheritsLoose(r,e),r}(d.ShaderTechniqueConfiguration);i.__decorate([d.parameter({count:8})],h.prototype,"output",void 0),i.__decorate([d.parameter({count:3})],h.prototype,"overlayMode",void 0),i.__decorate([d.parameter()],h.prototype,"atmosphere",void 0),i.__decorate([d.parameter()],h.prototype,"receiveShadows",void 0),i.__decorate([d.parameter()],h.prototype,"slicePlaneEnabled",void 0),i.__decorate([d.parameter()],h.prototype,"backfaceCullingEnabled",void 0),i.__decorate([d.parameter()],h.prototype,"stencilEnabled",void 0),i.__decorate([d.parameter()],h.prototype,"textureFadingEnabled",void 0),i.__decorate([d.parameter()],h.prototype,"hasBackgroundColor",void 0),i.__decorate([d.parameter()],h.prototype,"useGrid",void 0),i.__decorate([d.parameter()],h.prototype,"renderOccluded",void 0),i.__decorate([d.parameter()],h.prototype,"ssrEnabled",void 0),i.__decorate([d.parameter()],h.prototype,"tileBorders",void 0),i.__decorate([d.parameter()],h.prototype,"screenSizePerspective",void 0),r.TerrainTechnique=p,r.TerrainTechniqueConfiguration=h,Object.defineProperty(r,"__esModule",{value:!0})}));
