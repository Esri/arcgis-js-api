/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["require","exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../core/shaderTechnique/ShaderTechniqueConfiguration","../lib/DefaultVertexAttributeLocations","../../../webgl/Program","../../../webgl/renderState","../lib/StencilUtils","../../../../chunks/Terrain.glsl"],(function(e,r,t,a,i,n,o,d,l,c,s,u){"use strict";let p=function(e){function r(){return e.apply(this,arguments)||this}t._inheritsLoose(r,e);var a=r.prototype;return a.initializeProgram=function(e){const t=r.shader.get(),a=this.configuration,i=t.build({overlayMode:a.overlayMode,output:a.output,viewingMode:e.viewingMode,slicePlaneEnabled:a.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,textureFadingEnabled:a.textureFadingEnabled&&!a.renderOccluded,receiveShadows:a.receiveShadows&&!a.renderOccluded,receiveAmbientOcclusion:!1,useOldSceneLightInterface:!0,atmosphere:a.atmosphere,tileBorders:a.tileBorders,screenSizePerspective:a.screenSizePerspective,pbrMode:0,ssrEnabled:a.ssrEnabled,highStepCount:!1});return new l(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),d.Default3D)},a.initializePipeline=function(){const e=this.configuration,r=e.backfaceCullingEnabled&&!e.renderOccluded;return c.makePipelineState({blending:e.renderOccluded?c.simpleBlendingParams(1,771):null,culling:r&&c.backFaceCullingParams,depthTest:!e.renderOccluded&&{func:513},depthWrite:!e.renderOccluded&&c.defaultDepthWriteParams,colorWrite:c.defaultColorWriteParams,stencilTest:e.stencilEnabled?s.renderWhenBitIsNotSet(1):null})},r}(n.ShaderTechnique);p.shader=new i.ReloadableShaderModule(u.TerrainShader,(()=>new Promise((function(r,t){e(["../core/shaderLibrary/terrain/Terrain.glsl"],r,t)}))));let h=function(e){function r(){var r;return(r=e.apply(this,arguments)||this).output=0,r.overlayMode=0,r.atmosphere=!1,r.receiveShadows=!1,r.slicePlaneEnabled=!1,r.backfaceCullingEnabled=!1,r.stencilEnabled=!1,r.textureFadingEnabled=!1,r.renderOccluded=!1,r.ssrEnabled=!1,r.tileBorders=!1,r.screenSizePerspective=!1,r}return t._inheritsLoose(r,e),r}(o.ShaderTechniqueConfiguration);a.__decorate([o.parameter({count:8})],h.prototype,"output",void 0),a.__decorate([o.parameter({count:3})],h.prototype,"overlayMode",void 0),a.__decorate([o.parameter()],h.prototype,"atmosphere",void 0),a.__decorate([o.parameter()],h.prototype,"receiveShadows",void 0),a.__decorate([o.parameter()],h.prototype,"slicePlaneEnabled",void 0),a.__decorate([o.parameter()],h.prototype,"backfaceCullingEnabled",void 0),a.__decorate([o.parameter()],h.prototype,"stencilEnabled",void 0),a.__decorate([o.parameter()],h.prototype,"textureFadingEnabled",void 0),a.__decorate([o.parameter()],h.prototype,"renderOccluded",void 0),a.__decorate([o.parameter()],h.prototype,"ssrEnabled",void 0),a.__decorate([o.parameter()],h.prototype,"tileBorders",void 0),a.__decorate([o.parameter()],h.prototype,"screenSizePerspective",void 0),r.TerrainTechnique=p,r.TerrainTechniqueConfiguration=h,Object.defineProperty(r,"__esModule",{value:!0})}));
