/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["require","exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6","../../../../core/has","../../../../core/mathUtils","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../core/shaderTechnique/ShaderTechniqueConfiguration","../lib/DefaultVertexAttributeLocations","../../../webgl/Program","../../../webgl/renderState","../../../webgl/checkWebGLError","../../../webgl/FramebufferObject","../../../../chunks/ShadowHighlight.glsl"],(function(e,i,r,t,o,a,n,h,s,l,g,d,p,c,u){"use strict";let f=function(e){function i(){return e.apply(this,arguments)||this}r._inheritsLoose(i,e);var t=i.prototype;return t.initializeProgram=function(e){const r=i.shader.get().build(this.configuration);return new g(e.rctx,r.generateSource("vertex"),r.generateSource("fragment"),l.Default3D)},t.initializePipeline=function(e){return d.makePipelineState({blending:d.separateBlendingParams(770,1,771,771),colorWrite:d.defaultColorWriteParams,depthTest:null,depthWrite:null})},t.bindPass=function(e,i,r){e.bindTexture(i.depthMap,2),e.bindTexture(i.highlightMap,3),this.program.setUniform4fv("color",i.color),this.program.setUniform1f("opacity",i.opacity),this.program.setUniform1f("occludedOpacity",i.occludedOpacity),this.program.setUniform1f("terminationFactor",i.terminationFactor),this.program.setUniform2fv("nearFar",i.nearFar),this.program.setUniformMatrix4fv("inverseView",i.inverseView),this.program.setUniform4fv("projInfo",i.projInfo),this.program.setUniform2fv("zScale",i.zScale),this.program.setUniform1i("depthMap",2),this.program.setUniform3fv("lightingMainDirectionView",i.lightDirView),this.program.setUniform1i("highlightMap",3),this.program.setUniform2fv("texelSize",i.texelSize),i.shadowMap.setUniforms(this.program),i.shadowMap.bindView(this.program,i.origin),i.shadowMap.bindSnapshot(i.highlightSnapshotSlot,6),this.program.setUniform1i("highlightDepthTex",6),i.shadowMap.bindSnapshot(i.defaultSnapshotSlot,7),this.program.setUniform1i("defaultDepthTex",7)},r._createClass(i,[{key:"primitiveType",get:function(){return 5}}]),i}(h.ShaderTechnique);f.shader=new n.ReloadableShaderModule(u.ShadowHighlightShader,(()=>new Promise((function(i,r){e(["./ShadowHighlight.glsl"],i,r)}))));let m=function(e){function i(){var i;return(i=e.apply(this,arguments)||this).highlightedThreshold=.99999,i.selfShadowThreshold=.025,i}return r._inheritsLoose(i,e),i}(s.ShaderTechniqueConfiguration);t.__decorate([s.parameter()],m.prototype,"highlightedThreshold",void 0),t.__decorate([s.parameter()],m.prototype,"selfShadowThreshold",void 0),i.ShadowHighlightTechnique=f,i.ShadowHighlightTechniqueConfiguration=m,Object.defineProperty(i,"__esModule",{value:!0})}));
