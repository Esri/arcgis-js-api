/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["require","exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6","../core/shaderLibrary/ShaderOutput","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../core/shaderTechnique/ShaderTechniqueConfiguration","../lib/basicInterfaces","../lib/OrderIndependentTransparency","../lib/Program","../lib/StencilUtils","../lib/TransparencyPassType","../lib/VertexAttribute","../materials/DefaultTechniqueConfiguration","../materials/PatternStyle","../../../../chunks/Pattern.glsl","../../../webgl/context-util","../../../webgl/renderState"],(function(e,t,r,a,o,n,i,l,s,p,c,u,d,h,y,f,P,T,_){"use strict";let g=function(e){function t(){return e.apply(this,arguments)||this}r._inheritsLoose(t,e);var a=t.prototype;return a.initializeConfiguration=function(e,t){t.hasWebGL2Context=e.rctx.type===T.ContextType.WEBGL2},a.initializeProgram=function(e){return new c.Program(e.rctx,t.shader.get().build(this.configuration),S)},a._setPipelineState=function(e,t){const r=this.configuration,a=e===d.TransparencyPassType.NONE,n=e===d.TransparencyPassType.FrontFace;return _.makePipelineState({blending:r.output===o.ShaderOutput.Color||r.output===o.ShaderOutput.Alpha?a?p.blendingDefault:p.oitBlending(e):null,culling:_.cullingParams(r.cullFace),depthTest:{func:p.oitDepthTest(e)},depthWrite:a?r.writeDepth?_.defaultDepthWriteParams:null:p.oitDepthWrite(e),colorWrite:_.defaultColorWriteParams,stencilWrite:r.hasOccludees?u.stencilWriteMaskOn:null,stencilTest:r.hasOccludees?t?u.stencilToolMaskBaseParams:u.stencilBaseAllZerosParams:null,polygonOffset:a||n?r.polygonOffset?O:null:p.getOITPolygonOffset(r.enableOffset)})},a.initializePipeline=function(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)},a.getPipelineState=function(t,r){return r?this._occludeePipelineState:e.prototype.getPipelineState.call(this,t,r)},t}(i.ShaderTechnique);g.shader=new n.ReloadableShaderModule(P.Pattern,(()=>new Promise(((t,r)=>e(["./Pattern.glsl"],t,r)))));const O={factor:1,units:1};let b=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).output=o.ShaderOutput.Color,t.cullFace=s.CullFaceOptions.None,t.transparencyPassType=d.TransparencyPassType.NONE,t.hasSlicePlane=!1,t.hasVertexColors=!1,t.polygonOffset=!1,t.writeDepth=!0,t.hasOccludees=!1,t.enableOffset=!0,t.hasMultipassTerrain=!1,t.cullAboveGround=!1,t}return r._inheritsLoose(t,e),t}(y.DefaultTechniqueConfiguration);a.__decorate([l.parameter({count:o.ShaderOutput.COUNT})],b.prototype,"output",void 0),a.__decorate([l.parameter({count:s.CullFaceOptions.COUNT})],b.prototype,"cullFace",void 0),a.__decorate([l.parameter({count:f.Style.COUNT})],b.prototype,"style",void 0),a.__decorate([l.parameter({count:d.TransparencyPassType.COUNT})],b.prototype,"transparencyPassType",void 0),a.__decorate([l.parameter()],b.prototype,"hasSlicePlane",void 0),a.__decorate([l.parameter()],b.prototype,"hasVertexColors",void 0),a.__decorate([l.parameter()],b.prototype,"polygonOffset",void 0),a.__decorate([l.parameter()],b.prototype,"writeDepth",void 0),a.__decorate([l.parameter()],b.prototype,"hasOccludees",void 0),a.__decorate([l.parameter()],b.prototype,"patternSpacing",void 0),a.__decorate([l.parameter()],b.prototype,"lineWidth",void 0),a.__decorate([l.parameter()],b.prototype,"enableOffset",void 0),a.__decorate([l.parameter()],b.prototype,"draped",void 0),a.__decorate([l.parameter()],b.prototype,"hasMultipassTerrain",void 0),a.__decorate([l.parameter()],b.prototype,"cullAboveGround",void 0);const S=new Map([[h.VertexAttribute.POSITION,0],[h.VertexAttribute.COLOR,3],[h.VertexAttribute.UVMAPSPACE,4],[h.VertexAttribute.BOUNDINGRECT,5]]);t.PatternTechnique=g,t.PatternTechniqueConfiguration=b,t.vertexAttributeLocations=S,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
