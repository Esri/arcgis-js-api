/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["require","exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/tslib.es6","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../core/shaderTechnique/ShaderTechniqueConfiguration","../lib/DefaultVertexAttributeLocations","../../../webgl/Program","../../../webgl/renderState","../core/shaderLibrary/util/View.glsl","../lib/OrderIndependentTransparency","../core/shaderLibrary/shading/MultipassTerrainTest.glsl","../../../../chunks/CheckerBoard.glsl"],(function(e,r,t,a,n,i,o,s,l,p,c,u,d,h){"use strict";let f=function(e){function r(){return e.apply(this,arguments)||this}t._inheritsLoose(r,e);var a=r.prototype;return a.initializeProgram=function(e){const t=r.shader.get(),a=this.configuration,n=t.build({OITEnabled:0===a.transparencyPassType,multipassTerrainEnabled:a.multipassTerrainEnabled,cullAboveGround:a.cullAboveGround});return new l(e.rctx,n.generateSource("vertex"),n.generateSource("fragment"),s.Default3D)},a.bindPass=function(e,r,t){c.View.bindProjectionMatrix(this.program,t.camera.projectionMatrix),this.program.setUniform2fv("size",r.size),this.program.setUniform4fv("color1",r.color1),this.program.setUniform4fv("color2",r.color2),t.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",t.camera.nearFar),this.program.setUniform2fv("inverseViewport",t.inverseViewport),d.bindMultipassTerrainUniforms(this.program,e,t))},a.bindDraw=function(e){c.View.bindView(this.program,e)},a.setPipelineState=function(e){const r=this.configuration,t=3===e,a=2===e;return p.makePipelineState({blending:r.transparent?t?g:u.OITBlending(e):null,depthTest:{func:u.OITDepthTest(e)},depthWrite:t?r.writeDepth&&p.defaultDepthWriteParams:u.OITDepthWrite(e),colorWrite:p.defaultColorWriteParams,polygonOffset:t||a?r.polygonOffset&&m:{factor:-1,units:-25}})},a.initializePipeline=function(){return this.setPipelineState(this.configuration.transparencyPassType)},r}(i.ShaderTechnique);f.shader=new n.ReloadableShaderModule(h.CheckerBoardShader,(()=>new Promise((function(r,t){e(["./CheckerBoard.glsl"],r,t)}))));const m={factor:0,units:-25},g=p.separateBlendingParams(770,1,771,771);let b=function(e){function r(){var r;return(r=e.apply(this,arguments)||this).transparent=!1,r.writeDepth=!0,r.polygonOffset=!1,r.transparencyPassType=3,r.multipassTerrainEnabled=!1,r.cullAboveGround=!0,r}return t._inheritsLoose(r,e),r}(o.ShaderTechniqueConfiguration);a.__decorate([o.parameter()],b.prototype,"transparent",void 0),a.__decorate([o.parameter()],b.prototype,"writeDepth",void 0),a.__decorate([o.parameter()],b.prototype,"polygonOffset",void 0),a.__decorate([o.parameter({count:4})],b.prototype,"transparencyPassType",void 0),a.__decorate([o.parameter()],b.prototype,"multipassTerrainEnabled",void 0),a.__decorate([o.parameter()],b.prototype,"cullAboveGround",void 0),r.CheckerBoardTechnique=f,r.CheckerBoardTechniqueConfiguration=b,Object.defineProperty(r,"__esModule",{value:!0})}));
