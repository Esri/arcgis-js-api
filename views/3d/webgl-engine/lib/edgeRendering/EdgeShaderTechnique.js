/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["require","exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/tslib.es6","../../core/shaderLibrary/attributes/VertexPosition.glsl","../../core/shaderTechnique/ReloadableShaderModule","../../core/shaderTechnique/ShaderTechnique","../../core/shaderTechnique/ShaderTechniqueConfiguration","../Program","./bufferLayouts","../../../../../chunks/EdgeShaderProgram.glsl","../../shaders/sources/edgeRenderer/EdgeUtil.glsl","../../../../webgl/enums","../../../../webgl/renderState"],(function(e,r,a,i,o,t,n,l,s,d,c,u,p,m){"use strict";const f=-4e-4,h=.5;let g=function(e){function r(){return e.apply(this,arguments)||this}a._inheritsLoose(r,e);var i=r.prototype;return i.bindPass=function(e){const r=this.program,{edgeRenderParameters:a,bindParameters:i}=e;o.bindViewProjTransform(r,a.viewProjectionTransform),r.setUniformMatrix3fv("transformNormalViewFromGlobal",a.transformNormalViewFromGlobal),r.setUniformMatrix4fv("proj",i.camera.projectionMatrix),r.setUniform2f("depthBias",h,f),r.setUniform2f("pixelToNDC",2/i.camera.fullViewport[2],2/i.camera.fullViewport[3]),r.setUniform2f("ndcToPixel",i.camera.fullViewport[2]/2,i.camera.fullViewport[3]/2),r.setUniform1f("distanceFalloffFactor",a.distanceFalloffFactor),r.setUniform2f("inverseViewport",1/i.camera.fullViewport[2],1/i.camera.fullViewport[3]),r.setUniform1f("pixelRatio",i.camera.pixelRatio||1)},i.initializeProgram=function(e){const a=r.shader.get(),i=this.configuration,o=a.build({slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,silhouette:i.silhouette,legacy:i.legacy,antialiasing:i.antialiasing,mode:i.mode,doublePrecisionRequiresObfuscation:i.doublePrecisionRequiresObfuscation,multipassTerrainEnabled:i.multipassTerrainEnabled,cullAboveGround:i.cullAboveGround});return new s.Program(e.rctx,o,d.EdgeShaderAttributeLocations)},i.initializePipeline=function(e){const r=e.rctx.capabilities.blendMinMax;return r?m.makePipelineState({blending:m.separateBlendingParams(p.BlendFactor.ONE,p.BlendFactor.ONE,p.BlendFactor.ZERO,p.BlendFactor.ONE,p.BlendOperation.ADD,r.MAX),depthTest:{func:p.CompareFunction.LEQUAL},colorWrite:m.defaultColorWriteParams}):m.makePipelineState({depthTest:{func:p.CompareFunction.LEQUAL},depthWrite:m.defaultDepthWriteParams,colorWrite:m.defaultColorWriteParams})},r}(n.ShaderTechnique);g.shader=new t.ReloadableShaderModule(c.EdgeShaderProgram,(()=>new Promise(((r,a)=>e(["../../shaders/sources/edgeRenderer/EdgeShaderProgram.glsl"],r,a)))));let b=function(e){function r(){var r;return(r=e.apply(this,arguments)||this).slicePlaneEnabled=!1,r.silhouette=!1,r.legacy=!1,r.antialiasing=!1,r.mode=u.EdgeUtilMode.SOLID,r.doublePrecisionRequiresObfuscation=!1,r.multipassTerrainEnabled=!1,r.cullAboveGround=!1,r}return a._inheritsLoose(r,e),r}(l.ShaderTechniqueConfiguration);i.__decorate([l.parameter()],b.prototype,"slicePlaneEnabled",void 0),i.__decorate([l.parameter()],b.prototype,"silhouette",void 0),i.__decorate([l.parameter()],b.prototype,"legacy",void 0),i.__decorate([l.parameter()],b.prototype,"antialiasing",void 0),i.__decorate([l.parameter({count:u.EdgeUtilMode.COUNT})],b.prototype,"mode",void 0),i.__decorate([l.parameter()],b.prototype,"doublePrecisionRequiresObfuscation",void 0),i.__decorate([l.parameter()],b.prototype,"multipassTerrainEnabled",void 0),i.__decorate([l.parameter()],b.prototype,"cullAboveGround",void 0),r.EdgeShaderTechnique=g,r.EdgeShaderTechniqueConfiguration=b,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
