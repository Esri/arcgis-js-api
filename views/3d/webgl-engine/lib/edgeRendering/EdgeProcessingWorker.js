/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../geometry/support/meshUtils/deduplicate","../../../support/meshProcessing","../../../support/buffer/workerHelper","./bufferLayouts","./edgeBufferWriters","./edgePreprocessing"],(function(e,t,r,n,i,s,u,a){"use strict";function f(e){return o.apply(this,arguments)}function o(){return(o=t._asyncToGenerator((function*(e){const t=d(e),r=c(t),n=[t.data.buffer];return{result:g(r,n),transferList:n}}))).apply(this,arguments)}function c(e){const t=l(e.data,e.skipDeduplicate,e.indices,e.indicesLength);return p.updateSettings(e.writerSettings),h.updateSettings(e.writerSettings),a.extractEdges(t,p,h)}function d(e){return{data:s.EdgeInputBufferLayout.createView(e.dataBuffer),indices:"Uint32Array"===e.indicesType?new Uint32Array(e.indicesBuffer):"Uint16Array"===e.indicesType?new Uint16Array(e.indicesBuffer):void 0,indicesLength:e.indicesLength,writerSettings:e.writerSettings,skipDeduplicate:e.skipDeduplicate}}function g(e,t){t.push(e.regular.lodInfo.lengths.buffer),t.push(e.silhouette.lodInfo.lengths.buffer);return{regular:{instancesData:i.packInterleavedBuffer(e.regular.instancesData,t),lodInfo:{lengths:e.regular.lodInfo.lengths.buffer}},silhouette:{instancesData:i.packInterleavedBuffer(e.silhouette.instancesData,t),lodInfo:{lengths:e.silhouette.lodInfo.lengths.buffer}},averageEdgeLength:e.averageEdgeLength}}function l(e,t,i,u){if(t){return{faces:i,facesLength:u,neighbors:n.computeNeighbors(i,u,e.count),vertices:e}}const a=r.deduplicate(e.buffer,e.stride/4,{originalIndices:i,originalIndicesLength:u}),f=n.computeNeighbors(a.indices,u,a.uniqueCount);return{faces:a.indices,facesLength:a.indices.length,neighbors:f,vertices:s.EdgeInputBufferLayout.createView(a.buffer)}}const p=new u.RegularEdgeBufferWriter,h=new u.SilhouetteEdgeBufferWriter;e.work=c,e.wrappedWork=f,Object.defineProperty(e,"__esModule",{value:!0})}));
