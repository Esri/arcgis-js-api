/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../../geometry/support/meshUtils/deduplicate","./bufferLayouts","./edgeBufferWriters","../../../support/buffer/workerHelper","../../../support/meshProcessing","./edgePreprocessing"],(function(e,t,r,n,i,s,u){"use strict";function a(e){const n=function(e,n,i){if(n&&i){return{faces:i,neighbors:s.computeNeighbors(i,e.count),vertices:e}}{const n=t.deduplicate(e.buffer,e.stride/4,{originalIndices:i}),u=s.computeNeighbors(n.indices,n.uniqueCount);return{faces:n.indices,neighbors:u,vertices:r.EdgeInputBufferLayout.createView(n.buffer)}}}(e.data,e.skipDeduplicate,e.originalIndices);return o.updateSettings(e.writerSettings),f.updateSettings(e.writerSettings),u.extractEdges(n,o,f)}const o=new n.RegularEdgeBufferWriter,f=new n.SilhouetteEdgeBufferWriter;e.work=a,e.wrappedWork=async function(e){const t=function(e){return{data:r.EdgeInputBufferLayout.createView(e.dataBuffer),originalIndices:"Uint32Array"===e.originalIndicesType?new Uint32Array(e.originalIndicesBuffer):"Uint16Array"===e.originalIndicesType?new Uint16Array(e.originalIndicesBuffer):void 0,writerSettings:e.writerSettings,skipDeduplicate:e.skipDeduplicate}}(e),n=a(t),s=[t.data.buffer];return{result:function(e,t){t.push(e.regular.lodInfo.lengths.buffer),t.push(e.silhouette.lodInfo.lengths.buffer);return{regular:{instancesData:i.packInterleavedBuffer(e.regular.instancesData,t),lodInfo:{lengths:e.regular.lodInfo.lengths.buffer}},silhouette:{instancesData:i.packInterleavedBuffer(e.silhouette.instancesData,t),lodInfo:{lengths:e.silhouette.lodInfo.lengths.buffer}},averageEdgeLength:e.averageEdgeLength}}(n,s),transferList:s}},Object.defineProperty(e,"__esModule",{value:!0})}));
