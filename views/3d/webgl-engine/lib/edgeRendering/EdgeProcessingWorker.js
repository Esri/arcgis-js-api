/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../../../../geometry/support/meshUtils/deduplicate","./bufferLayouts","./edgeBufferWriters","../../../support/buffer/workerHelper","../../../support/meshProcessing","./edgePreprocessing"],(function(e,t,r,n,i,s,u){"use strict";async function a(e){const t=o(e),r=f(t),n=[t.data.buffer];return{result:c(r,n),transferList:n}}function f(e){const t=d(e.data,e.skipDeduplicate,e.indices,e.indicesLength);return g.updateSettings(e.writerSettings),l.updateSettings(e.writerSettings),u.extractEdges(t,g,l)}function o(e){return{data:r.EdgeInputBufferLayout.createView(e.dataBuffer),indices:"Uint32Array"===e.indicesType?new Uint32Array(e.indicesBuffer):"Uint16Array"===e.indicesType?new Uint16Array(e.indicesBuffer):void 0,indicesLength:e.indicesLength,writerSettings:e.writerSettings,skipDeduplicate:e.skipDeduplicate}}function c(e,t){t.push(e.regular.lodInfo.lengths.buffer),t.push(e.silhouette.lodInfo.lengths.buffer);return{regular:{instancesData:i.packInterleavedBuffer(e.regular.instancesData,t),lodInfo:{lengths:e.regular.lodInfo.lengths.buffer}},silhouette:{instancesData:i.packInterleavedBuffer(e.silhouette.instancesData,t),lodInfo:{lengths:e.silhouette.lodInfo.lengths.buffer}},averageEdgeLength:e.averageEdgeLength}}function d(e,n,i,u){if(n){return{faces:i,facesLength:u,neighbors:s.computeNeighbors(i,u,e.count),vertices:e}}const a=t.deduplicate(e.buffer,e.stride/4,{originalIndices:i,originalIndicesLength:u}),f=s.computeNeighbors(a.indices,u,a.uniqueCount);return{faces:a.indices,facesLength:a.indices.length,neighbors:f,vertices:r.EdgeInputBufferLayout.createView(a.buffer)}}const g=new n.RegularEdgeBufferWriter,l=new n.SilhouetteEdgeBufferWriter;e.work=f,e.wrappedWork=a,Object.defineProperty(e,"__esModule",{value:!0})}));
