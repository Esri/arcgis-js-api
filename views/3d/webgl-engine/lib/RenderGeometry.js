/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../chunks/vec3","../../support/mathUtils","../../../../chunks/mat4","../../../../chunks/mat4f64","../../../../chunks/vec4f64","./geometryDataUtils","./Object3DStateID","../materials/renderers/utils"],(function(t,i,n,e,r,a,s,o,h,u,c){"use strict";let m=function(){function t(t,i,n=null,e=null,r,a,s,h,u){this.data=t,this.material=i,this.layerUid=n,this.graphicUid=e,this.boundingSphere=o.create(),this.instanceParameters={highlights:null,occludees:null,visible:!0},this.shaderTransformationDirty=!0,this.boundingInfo=r,this.material=i,this.origin=null,this.transformation=null,this.calculateShaderTransformation=s,a&&this.updateTransformation(a,h),this.castShadow=u}var m=t.prototype;return m.updateTransformation=function(t,i){this.transformation=t,this.shaderTransformationDirty=!0,this.computeBoundingSphere(t,i,this.boundingSphere)},m.shaderTransformationChanged=function(){this.shaderTransformationDirty=!0},m.computeBoundingSphere=function(t,i,a){n.isNone(this.boundingInfo)||(i=i||r.maxScale(t),e.transformMat4(a,this.boundingInfo.getCenter(),t),a[3]=this.boundingInfo.getBSRadius()*i)},m.getShaderTransformation=function(){return n.isNone(this.calculateShaderTransformation)?n.unwrapOr(this.transformation,s.IDENTITY):(this.shaderTransformationDirty&&(this.shaderTransformation||(this.shaderTransformation=s.create()),a.copy(this.shaderTransformation,this.calculateShaderTransformation(n.unwrapOr(this.transformation,s.IDENTITY))),this.shaderTransformationDirty=!1),this.shaderTransformation)},m.computeAttachmentOrigin=function(t){if(this.material.computeAttachmentOrigin)return!!this.material.computeAttachmentOrigin(this,t)&&(n.isSome(this.transformation)&&e.transformMat4(t,t,this.transformation),!0);const i=this.indices.get("position"),r=this.vertexAttributes.get("position");return!!h.computeAttachmentOriginTriangles(r,i,t)&&(n.isSome(this.transformation)&&e.transformMat4(t,t,this.transformation),!0)},m.addHighlight=function(){const t=new u.Object3DStateID(0),i=this.instanceParameters;return i.highlights=c.addObject3DStateID(i.highlights,t),t},m.removeHighlight=function(t){const i=this.instanceParameters;i.highlights=c.removeObject3DStateID(i.highlights,t)},i._createClass(t,[{key:"hasShaderTransformation",get:function(){return n.isSome(this.calculateShaderTransformation)}},{key:"primitiveType",get:function(){return this.data.primitiveType}},{key:"indices",get:function(){return this.data.indices}},{key:"vertexAttributes",get:function(){return this.data.vertexAttributes}}]),t}();t.RenderGeometry=m,Object.defineProperty(t,"__esModule",{value:!0})}));
