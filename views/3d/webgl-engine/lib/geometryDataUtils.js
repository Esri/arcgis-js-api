/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/vec3f64","../../../../chunks/vec3","../../../../chunks/triangle"],(function(t,e,n,r){"use strict";let s=1,c=null;const a=new Uint32Array([0]);let d=0;const o=e.create(),i=e.create(),l=e.create(),f=e.create();t.computeAttachmentOriginLines=function(t,e,r,s){if(!t)return!1;const{strideIdx:c,offsetIdx:a,data:d}=t;n.set(s,0,0,0),n.set(f,0,0,0);let l=0,u=0;const g=e?e.length-1:d.length/c-1,h=g+(r?2:0);for(let t=0;t<h;t+=2){const r=t<g?t:g,h=t<g?t+1:0,x=(e?e[r]:r)*c+a,I=(e?e[h]:h)*c+a;o[0]=d[x+0],o[1]=d[x+1],o[2]=d[x+2],i[0]=d[I+0],i[1]=d[I+1],i[2]=d[I+2],n.scale(o,n.add(o,o,i),.5);const A=n.dist(o,i);A>0?(n.add(s,s,n.scale(o,o,A)),l+=A):(n.add(f,f,o),u++)}return 0!==l?(n.scale(s,s,1/l),!0):0!==u&&(n.scale(s,f,1/u),!0)},t.computeAttachmentOriginPoints=function(t,e,r){if(!t||!e)return!1;const{strideIdx:s,offsetIdx:c,data:a}=t;n.set(r,0,0,0);let d=-1,o=0;for(let t=0;t<e.length;t++){const n=e[t]*s+c;d!==n&&(r[0]+=a[n+0],r[1]+=a[n+1],r[2]+=a[n+2],o++),d=n}return o>1&&n.scale(r,r,1/o),o>0},t.computeAttachmentOriginTriangles=function(t,e,s){if(!t)return!1;const{strideIdx:c,offsetIdx:a,data:d}=t;n.set(s,0,0,0),n.set(f,0,0,0);let u=0,g=0;for(let t=0;t<e.length-2;t+=3){const h=e[t+0]*c+a,x=e[t+1]*c+a,I=e[t+2]*c+a;n.set(o,d[h+0],d[h+1],d[h+2]),n.set(i,d[x+0],d[x+1],d[x+2]),n.set(l,d[I+0],d[I+1],d[I+2]);const A=r.areaPoints3d(o,i,l);A?(n.add(o,o,i),n.add(o,o,l),n.scale(o,o,1/3*A),n.add(s,s,o),u+=A):(n.add(f,f,o),n.add(f,f,i),n.add(f,f,l),g+=3)}return(0!==g||0!==u)&&(0!==u?(n.scale(s,s,1/u),!0):0!==g&&(n.scale(s,f,1/g),!0))},t.generateDefaultIndexArray=function(t){if(1===t)return a;if(t>s||null==c){for(;t>s;)s*=2;c=new Uint32Array(s);for(let t=0;t<s;t++)c[t]=t}return new Uint32Array(c.buffer,0,t)},t.getNewId=function(){return d++},Object.defineProperty(t,"__esModule",{value:!0})}));
