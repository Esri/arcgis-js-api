/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","./GLMaterial"],(function(e,t,r){"use strict";return function(r){function i(e){var t;return(t=r.call(this,e)||this)._textureIDs=new Set,t._textureRepository=e.textureRep,t._textureId=e.textureId,t._initTransparent=!!e.initTextureTransparent,t._texture=t._acquire(t._textureId),t._textureNormal=t._acquire(e.normalTextureId),t._textureEmissive=t._acquire(e.emissiveTextureId),t._textureOcclusion=t._acquire(e.occlusionTextureId),t._textureMetallicRoughness=t._acquire(e.metallicRoughnessTextureId),t}e._inheritsLoose(i,r);var u=i.prototype;return u.dispose=function(){this._textureIDs.forEach((e=>this._textureRepository.release(e))),this._textureIDs.clear()},u.updateTexture=function(e){e!==this._textureId&&(this._release(this._textureId),this._textureId=e,this._texture=this._acquire(this._textureId))},u.bindTextures=function(e){t.isSome(this._texture)&&e.bindTexture(this._texture.glTexture,"tex"),t.isSome(this._textureNormal)&&e.bindTexture(this._textureNormal.glTexture,"normalTexture"),t.isSome(this._textureEmissive)&&e.bindTexture(this._textureEmissive.glTexture,"texEmission"),t.isSome(this._textureOcclusion)&&e.bindTexture(this._textureOcclusion.glTexture,"texOcclusion"),t.isSome(this._textureMetallicRoughness)&&e.bindTexture(this._textureMetallicRoughness.glTexture,"texMetallicRoughness")},u.bindTextureScale=function(e){const r=t.isSome(this._texture)&&this._texture.glTexture;r&&r.descriptor.textureCoordinateScaleFactor?e.setUniform2fv("textureCoordinateScaleFactor",r.descriptor.textureCoordinateScaleFactor):e.setUniform2f("textureCoordinateScaleFactor",1,1)},u._acquire=function(e){if(!t.isNone(e))return this._textureIDs.add(e),this._textureRepository.acquire(e,this._initTransparent)},u._release=function(e){t.isNone(e)||(this._textureIDs.delete(e),this._textureRepository.release(e))},i}(r)}));
