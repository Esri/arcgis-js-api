/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../core/mathUtils","../../../../chunks/vec3f64","../../../../chunks/mat4","../../../../chunks/vec2f64","../../../../chunks/vec4f64","../../../../chunks/vec2","../../../../chunks/vec4"],(function(t,n,r,o,e,a,c,u){"use strict";const i=a.create();let s=function(){function t(t){this.message=t}return t.prototype.toString=function(){return`AssertException: ${this.message}`},t}();function f(t,n){if(!t){n=n||"assert";const t=new Error(n);throw t.stack&&console.log(t.stack),new s(n)}}function h(t){for(const n in t)return n}function l(t,n){t[12]=n[0],t[13]=n[1],t[14]=n[2]}function M(t,n=0){let r=0;for(let o=0;o<4;o++)r+=t[n+o]*d[o];return r}const v=[1,256,65536,16777216],d=[1/256,1/65536,1/16777216,1/4294967296],p=M(new Uint8ClampedArray([255,255,255,255]));t.AssertException=s,t.VertexAttrConstants={POSITION:"position",NORMAL:"normal",UV0:"uv0",UVMAPSPACE:"uvMapSpace",MEANVERTEXPOSITION:"meanVertexPosition",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",BOUND1:"bound1",BOUND2:"bound2",BOUND3:"bound3",COLOR:"color",SYMBOLCOLOR:"symbolColor",SIZE:"size",TANGENT:"tangent"},t.assert=f,t.createTranslationMatrix=function(t,n){return l(t=o.identity(t),n),t},t.dec2hex=function(t){const n=t.toString(16);return"00000000".substr(0,8-n.length)+n},t.encodeInt16=function(t){return n.clamp(Math.round(32767*t),-32767,32767)},t.encodeNormal=function(t,n){const r=Math.abs(t[0]),o=Math.abs(t[1]),e=1/(r+o+Math.abs(t[2])),a=r*e,c=o*e,u=Math.min(t[2]*e,0);n[0]=(t[0]<0?-1:1)*(a-u),n[1]=(t[1]<0?-1:1)*(c-u)},t.fallbackIfUndefined=function(t,n){return void 0===t?n:t},t.fovd2fovx=function(t,n,r){return 2*Math.atan(n*Math.tan(.5*t)/Math.sqrt(n*n+r*r))},t.fovd2fovy=function(t,n,r){return 2*Math.atan(r*Math.tan(.5*t)/Math.sqrt(n*n+r*r))},t.fovx2fovd=function(t,n,r){return 2*Math.atan(Math.sqrt(n*n+r*r)*Math.tan(.5*t)/n)},t.fovx2fovy=function(t,n,r){return 2*Math.atan(r*Math.tan(.5*t)/n)},t.fovy2fovd=function(t,n,r){return 2*Math.atan(Math.sqrt(n*n+r*r)*Math.tan(.5*t)/r)},t.fovy2fovx=function(t,n,r){return 2*Math.atan(n*Math.tan(.5*t)/r)},t.getFirstObjectKey=h,t.getFirstObjectValue=function(t){return t[h(t)]},t.getMatrixTranslation=function(t,n=r.create()){return n[0]=t[12],n[1]=t[13],n[2]=t[14],n},t.hex2rgb=function(t){return[((t=Math.floor(t))>>16&255)/255,(t>>8&255)/255,(255&t)/255]},t.inverseProjectionInfo=function(t,n,r,o,e){const a=t;0===t[11]?(o[0]=2/(n*a[0]),o[1]=2/(r*a[5]),o[2]=(1+a[12])/a[0],o[3]=(1+a[13])/a[5],c.set(e,0,1)):(o[0]=-2/(n*a[0]),o[1]=-2/(r*a[5]),o[2]=(1-a[8])/a[0],o[3]=(1-a[9])/a[5],c.set(e,1,0))},t.isTranslationMatrix=function(t){return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&1===t[15]},t.logWithBase=function(t,n){return Math.log(t)/Math.log(n)},t.objectEmpty=function(t){for(const n in t)return!1;return!0},t.packFloatRGBA=function(t,r,o=0){const e=n.clamp(t,0,p);for(let t=0;t<4;t++)r[o+t]=Math.floor(256*((a=e*v[t])-Math.floor(a)));var a},t.project=function(t,n,r,o,e){e||(e=t),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1,u.transformMat4(i,i,n),e.length>2&&(e[2]=-i[2]),u.transformMat4(i,i,r),f(0!==i[3]),e[0]=i[0]/i[3],e[1]=i[1]/i[3],e[2]=i[2]/i[3],e[0]=(.5*e[0]+.5)*o[2]+o[0],e[1]=(.5*e[1]+.5)*o[3]+o[1]},t.rayBoxTest=function(t,n,r,o){let e,a=(r[0]-t[0])/n[0],c=(o[0]-t[0])/n[0];a>c&&(e=a,a=c,c=e);let u=(r[1]-t[1])/n[1],i=(o[1]-t[1])/n[1];if(u>i&&(e=u,u=i,i=e),a>i||u>c)return!1;u>a&&(a=u),i<c&&(c=i);let s=(r[2]-t[2])/n[2],f=(o[2]-t[2])/n[2];return s>f&&(e=s,s=f,f=e),!(a>f||s>c)&&(f<c&&(c=f),!(c<0))},t.rayRay2D=function(t,n,r,o,a,c=e.create()){const u=(o[a]-r[a])*(n[0]-t[0])-(o[0]-r[0])*(n[a]-t[a]),i=(o[0]-r[0])*(t[a]-r[a])-(o[a]-r[a])*(t[0]-r[0]);if(0===u)return!1;const s=i/u;return c[0]=t[0]+s*(n[0]-t[0]),c[1]=t[a]+s*(n[a]-t[a]),!0},t.rayTriangle3D=function(t,n,o,e,a,c,u,i,s=r.create()){const f=1e-5,h=e[u]-o[c],l=e[u+1]-o[c+1],M=e[u+2]-o[c+2],v=a[i]-o[c],d=a[i+1]-o[c+1],p=a[i+2]-o[c+2],x=n[1]*p-d*n[2],g=n[2]*v-p*n[0],m=n[0]*d-v*n[1],y=h*x+l*g+M*m;if(y>-f&&y<f)return!1;const O=1/y,b=t[0]-o[c],A=t[1]-o[c+1],k=t[2]-o[c+2];if(s[1]=O*(b*x+A*g+k*m),s[1]<0||s[1]>1)return!1;const T=A*M-l*k,E=k*h-M*b,S=b*l-h*A;return s[2]=O*(n[0]*T+n[1]*E+n[2]*S),!(s[2]<0||s[1]+s[2]>1)&&(s[0]=O*(v*T+d*E+p*S),!0)},t.rgb2hex=function(t){return"0x"+((n.clamp(Math.round(255*t[0]),0,255)<<16)+(n.clamp(Math.round(255*t[1]),0,255)<<8)+n.clamp(Math.round(255*t[2]),0,255)).toString(16)},t.setMatrixTranslation=l,t.setMatrixTranslation3=function(t,n,r,o){t[12]=n,t[13]=r,t[14]=o},t.unpackFloatRGBA=M,t.verify=function(t,n){t||(n=n||"",console.warn("Verify failed: "+n+"\n"+new Error("verify").stack))},Object.defineProperty(t,"__esModule",{value:!0})}));
