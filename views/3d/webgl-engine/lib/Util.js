/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../../../../core/mathUtils","../../../../chunks/mat4","../../../../chunks/vec2","../../../../chunks/vec2f64","../../../../chunks/vec3f64","../../../../chunks/vec4","../../../../chunks/vec4f64"],(function(t,n,r,e,o,a,c,i){"use strict";const u=i.create();let s=function(){function t(t){this.message=t}return t.prototype.toString=function(){return`AssertException: ${this.message}`},t}();function f(t,n){if(!t){n=n||"assert";const t=new Error(n);throw t.stack&&console.log(t.stack),new s(n)}}function h(t,n){t||(n=n||"",console.warn("Verify failed: "+n+"\n"+new Error("verify").stack))}function M(t){return n.clamp(Math.round(32767*t),-32767,32767)}function l(t,n){const r=Math.abs(t[0]),e=Math.abs(t[1]),o=1/(r+e+Math.abs(t[2])),a=r*o,c=e*o,i=Math.min(t[2]*o,0);n[0]=(t[0]<0?-1:1)*(a-i),n[1]=(t[1]<0?-1:1)*(c-i)}function v(t,n){return void 0===t?n:t}function d(t){return[((t=Math.floor(t))>>16&255)/255,(t>>8&255)/255,(255&t)/255]}function x(t){return"0x"+((n.clamp(Math.round(255*t[0]),0,255)<<16)+(n.clamp(Math.round(255*t[1]),0,255)<<8)+n.clamp(Math.round(255*t[2]),0,255)).toString(16)}function g(t){const n=t.toString(16);return"00000000".substr(0,8-n.length)+n}function y(t,n,r,e,o,c,i,u,s=a.create()){const f=1e-5,h=e[i]-r[c],M=e[i+1]-r[c+1],l=e[i+2]-r[c+2],v=o[u]-r[c],d=o[u+1]-r[c+1],x=o[u+2]-r[c+2],g=n[1]*x-d*n[2],y=n[2]*v-x*n[0],m=n[0]*d-v*n[1],p=h*g+M*y+l*m;if(p>-f&&p<f)return!1;const b=1/p,k=t[0]-r[c],T=t[1]-r[c+1],j=t[2]-r[c+2];if(s[1]=b*(k*g+T*y+j*m),s[1]<0||s[1]>1)return!1;const w=T*l-M*j,E=j*h-l*k,q=k*M-h*T;return s[2]=b*(n[0]*w+n[1]*E+n[2]*q),!(s[2]<0||s[1]+s[2]>1)&&(s[0]=b*(v*w+d*E+x*q),!0)}function m(t,n,r,e){let o,a=(r[0]-t[0])/n[0],c=(e[0]-t[0])/n[0];a>c&&(o=a,a=c,c=o);let i=(r[1]-t[1])/n[1],u=(e[1]-t[1])/n[1];if(i>u&&(o=i,i=u,u=o),a>u||i>c)return!1;i>a&&(a=i),u<c&&(c=u);let s=(r[2]-t[2])/n[2],f=(e[2]-t[2])/n[2];return s>f&&(o=s,s=f,f=o),!(a>f||s>c)&&(f<c&&(c=f),!(c<0))}function p(t,n,r,e,a,c=o.create()){const i=(e[a]-r[a])*(n[0]-t[0])-(e[0]-r[0])*(n[a]-t[a]),u=(e[0]-r[0])*(t[a]-r[a])-(e[a]-r[a])*(t[0]-r[0]);if(0===i)return!1;const s=u/i;return c[0]=t[0]+s*(n[0]-t[0]),c[1]=t[a]+s*(n[a]-t[a]),!0}function b(t,n,r,e,o){o||(o=t),u[0]=t[0],u[1]=t[1],u[2]=t[2],u[3]=1,c.transformMat4(u,u,n),o.length>2&&(o[2]=-u[2]),c.transformMat4(u,u,r),f(0!==u[3]),o[0]=u[0]/u[3],o[1]=u[1]/u[3],o[2]=u[2]/u[3],o[0]=(.5*o[0]+.5)*e[2]+e[0],o[1]=(.5*o[1]+.5)*e[3]+e[1]}function k(t){for(const n in t)return n}function T(t){for(const n in t)return!1;return!0}function j(t,n){return Math.log(t)/Math.log(n)}function w(t,n){t[12]=n[0],t[13]=n[1],t[14]=n[2]}function E(t,n,r,e){t[12]=n,t[13]=r,t[14]=e}function q(t,n=a.create()){return n[0]=t[12],n[1]=t[13],n[2]=t[14],n}function I(t,n){return w(t=r.identity(t),n),t}function S(t){return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&1===t[15]}function A(t,n,r){return 2*Math.atan(r*Math.tan(.5*t)/n)}function B(t,n,r){return 2*Math.atan(n*Math.tan(.5*t)/r)}function D(t,n,r){return 2*Math.atan(Math.sqrt(n*n+r*r)*Math.tan(.5*t)/n)}function O(t,n,r){return 2*Math.atan(Math.sqrt(n*n+r*r)*Math.tan(.5*t)/r)}function P(t,n,r){return 2*Math.atan(n*Math.tan(.5*t)/Math.sqrt(n*n+r*r))}function U(t,n,r){return 2*Math.atan(r*Math.tan(.5*t)/Math.sqrt(n*n+r*r))}function _(t,n,r,o,a){const c=t;0===t[11]?(o[0]=2/(n*c[0]),o[1]=2/(r*c[5]),o[2]=(1+c[12])/c[0],o[3]=(1+c[13])/c[5],e.set(a,0,1)):(o[0]=-2/(n*c[0]),o[1]=-2/(r*c[5]),o[2]=(1-c[8])/c[0],o[3]=(1-c[9])/c[5],e.set(a,1,0))}t.AssertException=s,t.assert=f,t.createTranslationMatrix=I,t.dec2hex=g,t.encodeInt16=M,t.encodeNormal=l,t.fallbackIfUndefined=v,t.fovd2fovx=P,t.fovd2fovy=U,t.fovx2fovd=D,t.fovx2fovy=A,t.fovy2fovd=O,t.fovy2fovx=B,t.getFirstObjectKey=k,t.getMatrixTranslation=q,t.hex2rgb=d,t.inverseProjectionInfo=_,t.isTranslationMatrix=S,t.logWithBase=j,t.objectEmpty=T,t.project=b,t.rayBoxTest=m,t.rayRay2D=p,t.rayTriangle3D=y,t.rgb2hex=x,t.setMatrixTranslation=w,t.setMatrixTranslation3=E,t.verify=h,Object.defineProperty(t,"__esModule",{value:!0})}));
