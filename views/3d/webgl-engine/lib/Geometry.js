/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","./basicInterfaces","./BoundingInfo","./ContentObject","./ContentObjectType","./geometryDataUtils","./Indices","./Util","./VertexAttribute"],(function(t,e,n,i,r,o,s,u,c,g,l){"use strict";let a=function(t){function o(e,n=[],r=i.PrimitiveType.Triangle,o=null,u=-1){var g;(g=t.call(this)||this)._primitiveType=r,g.objectAndLayerIdColor=o,g.edgeIndicesLength=u,g.type=s.ContentObjectType.Geometry,g._vertexAttributes=new Map,g._indices=new Map,g._boundingInfo=null;for(const[t,i]of e)i&&g._vertexAttributes.set(t,{...i});if(null==n||0===n.length){const t=d(g._vertexAttributes),e=c.generateDefaultIndexArray(t);g.edgeIndicesLength=g.edgeIndicesLength<0?t:g.edgeIndicesLength;for(const n of g._vertexAttributes.keys())g._indices.set(n,e)}else for(const[t,i]of n)i&&(g._indices.set(t,c.compactIndices(i)),t===l.VertexAttribute.POSITION&&(g.edgeIndicesLength=g.edgeIndicesLength<0?g._indices.get(t).length:g.edgeIndicesLength));return g}e._inheritsLoose(o,t);var a=o.prototype;return a.cloneShallow=function(){const t=new o([],void 0,this._primitiveType,this.objectAndLayerIdColor,void 0),{_vertexAttributes:e,_indices:n}=t;return this._vertexAttributes.forEach(((t,n)=>e.set(n,t))),this._indices.forEach(((t,e)=>n.set(e,t))),t.screenToWorldRatio=this.screenToWorldRatio,t._boundingInfo=this._boundingInfo,t},a.getMutableAttribute=function(t){const e=this._vertexAttributes.get(t);return e&&!e.exclusive&&(e.data=Array.from(e.data),e.exclusive=!0),e},a.computeAttachmentOrigin=function(t){return this.primitiveType===i.PrimitiveType.Triangle?this._computeAttachmentOriginTriangles(t):this._computeAttachmentOriginPoints(t)},a._computeAttachmentOriginTriangles=function(t){const e=this.indices.get(l.VertexAttribute.POSITION),n=this.vertexAttributes.get(l.VertexAttribute.POSITION);return u.computeAttachmentOriginTriangles(n,e,t)},a._computeAttachmentOriginPoints=function(t){const e=this.indices.get(l.VertexAttribute.POSITION),n=this.vertexAttributes.get(l.VertexAttribute.POSITION);return u.computeAttachmentOriginPoints(n,e,t)},a.invalidateBoundingInfo=function(){this._boundingInfo=null},a._calculateBoundingInfo=function(){const t=this.indices.get(l.VertexAttribute.POSITION);if(!t||0===t.length)return null;const e=this.primitiveType===i.PrimitiveType.Triangle?3:1;g.assert(t.length%e==0,"Indexing error: "+t.length+" not divisible by "+e);const n=c.generateDefaultIndexArray(t.length/e),o=this.vertexAttributes.get(l.VertexAttribute.POSITION);return o?new r.BoundingInfo(n,e,t,o):null},e._createClass(o,[{key:"vertexAttributes",get:function(){return this._vertexAttributes}},{key:"indices",get:function(){return this._indices}},{key:"indexCount",get:function(){const t=this._indices.values().next().value;return t?t.length:0}},{key:"primitiveType",get:function(){return this._primitiveType}},{key:"faceCount",get:function(){return this.indexCount/3}},{key:"boundingInfo",get:function(){return n.isNone(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}}]),o}(o.ContentObject);function d(t){const e=t.values().next().value;return null==e?0:e.data.length/e.size}t.Geometry=a,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
