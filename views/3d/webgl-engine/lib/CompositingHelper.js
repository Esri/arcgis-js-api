/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{disposeMaybe as s,isNone as t}from"../../../../core/maybe.js";import{OverlayIndex as i}from"../../terrain/interfaces.js";import{createQuadVAO as r}from"./glUtil3D.js";import{C as e}from"../../../../chunks/Compositing.glsl.js";import{CompositingTechnique as a}from"../shaders/CompositingTechnique.js";import{CompositingTechniqueConfiguration as o,AlphaMode as n,CompositingFunction as h}from"../shaders/CompositingTechniqueConfiguration.js";import{PrimitiveType as c}from"../../../webgl/enums.js";import{vertexCount as p}from"../../../webgl/Util.js";class _{constructor(s,t){this._rctx=s,this._techniqueRepository=t,this._configuration=new o,this._passParameters=new e}dispose(){this._vao=s(this._vao)}compositeTransparent(s,t,i,r,e=1){this._configuration.alphaMode=n.Alpha,this._configuration.function=h.Transparency,this._configuration.hasOpacityFactor=1!==e,this._passParameters.colorTexture=t,this._passParameters.alphaTexture=i,this._passParameters.frontFaceTexture=r;const o=this._rctx,_=this._techniqueRepository.acquire(a,this._configuration);o.bindTechnique(_,this._passParameters,s);const m=this._ensureVAO();o.bindVAO(m),o.drawArrays(c.TRIANGLE_STRIP,0,p(m,"geometry")),_.release()}composite(s,t,r=n.None,e=1,o=h.Standard,_=i.INNER){const m=this._rctx;this._configuration.alphaMode=r,this._configuration.function=o,this._configuration.hasOpacityFactor=1!==e,this._passParameters.overlayIndex=_,this._passParameters.texture=t,this._passParameters.opacity=e;const u=this._techniqueRepository.acquire(a,this._configuration);m.bindTechnique(u,this._passParameters,s);const f=this._ensureVAO();m.bindVAO(f),m.drawArrays(c.TRIANGLE_STRIP,0,p(f,"geometry")),u.release()}_ensureVAO(){return t(this._vao)&&(this._vao=r(this._rctx)),this._vao}}export{_ as default};
