/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{isSome as r,isNone as t,applySome as e}from"../../../../core/maybe.js";import{x as n}from"../../../../chunks/mat4.js";import{c as i}from"../../../../chunks/vec3f64.js";import{diameter as a}from"../../../../geometry/support/aaBoundingBox.js";import{d as o}from"../../../../chunks/sphere.js";import{isPclIntersectorResult as u,isI3sIntersectorResult as c}from"../../layers/i3s/Intersector.js";import{isTerrainIntersectorResult as s,isOverlayIntersectorResult as l}from"../../terrain/Intersector.js";import{isObjectIntersectorResult as p,isHudIntersectorResult as g}from"./intersectorUtils.js";import{isLodIntersectorResult as f}from"./lodRendering/Intersector.js";function m(r,t){return p(r)||g(r)?B(r.target.object.metadata,t):s(r)?t.map?.ground:u(r)||c(r)||l(r)?B(r.target,t):null}function d(t,e){const n=h(t,e);return r(n)&&"graphic"===n.type?n.graphic:null}function h(r,e){if(t(r))return null;if(p(r)||g(r))return y(r.target.object.metadata,e);if(u(r)){const t=r.target.createGraphic();return{type:"graphic",graphic:t,layer:t.layer}}return l(r)||f(r)?y(r.target,e):c(r)?j(r.target,e):null}function y(r,e){if(t(r)||t(r.graphicUid))return null;const n=B(r,e);if(t(n))return null;if(n===e.graphics)return t(e.graphicsView)||"number"!=typeof r.graphicUid?null:e.graphicsView.getHit(r.graphicUid);const i=e.allLayerViews.find((r=>r.layer===n));return!i||i.suspended||t(r.graphicUid)?null:"getHit"in i?i.getHit(r.graphicUid):null}function j(r,e){const n=B(r,e);if(t(n))return null;const i=e.allLayerViews.find((r=>r.layer===n));return i&&!i.suspended&&"getGraphicFromIntersectorTarget"in i?b(i.getGraphicFromIntersectorTarget(r)):null}function U(r,e){const n=B(r,e);if(t(n))return null;const i=e.allLayerViews.find((r=>r.layer===n));return i&&!i.suspended&&"getAABBFromIntersectorTarget"in i?i.getAABBFromIntersectorTarget(r):null}function b(t){return r(t)?{type:"graphic",graphic:t,layer:t.layer}:null}function B(e,n){return t(e.layerUid)?null:r(n.graphicsView)&&e.layerUid===n.graphicsView.processor.layer.id?n.graphics:n.map.findLayerByUid(e.layerUid)}function V(r,t){if(p(r)||g(r))return o(r.target.object.boundingVolumeWorldSpace.bounds);if(f(r)){n(I,r.transformation);const t=Math.max(I[0],I[1],I[2]);return r.target.baseBoundingSphere.radius*t}return c(r)?e(U(r.target,t),(r=>.5*a(r))):null}function w(r){return!p(r)&&!g(r)&&(f(r)?r.target.numLodLevels>1:!!c(r))}const I=i();export{V as getIntersectedFeatureBSRadius,w as hasLod,d as toGraphic,h as toHit,m as toOwner};
