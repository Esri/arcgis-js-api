/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../lib/AnimationTimer","../lib/GLMaterials","../lib/Material","../lib/OrderIndependentTransparency","./WaterGLMaterial","./WaterTechnique","./internal/DefaultBufferWriter","./internal/MaterialUtil","./internal/waterMaterialUtils"],(function(e,t,i,a,r,n,s,u,o,l,c){"use strict";let h=function(e){function r(t){var a;return(a=e.call(this,t,c.defaultWaterMaterialParameters)||this)._techniqueConfig=new u.WaterTechniqueConfiguration,a.animation=new i.AnimationTimer,a}t._inheritsLoose(r,e);var h=r.prototype;return h.getTechniqueConfig=function(e,t){return this._techniqueConfig.output=e,this._techniqueConfig.writeDepth=this.parameters.writeDepth,this._techniqueConfig.receiveShadows=this.parameters.receiveShadows,this._techniqueConfig.slicePlaneEnabled=this.parameters.slicePlaneEnabled,this._techniqueConfig.transparent=this.parameters.transparent,this._techniqueConfig.useSSR=this.parameters.ssrEnabled,this._techniqueConfig.isDraped=this.parameters.isDraped,this._techniqueConfig.transparencyPassType=t.transparencyPassType,this._techniqueConfig.enableOffset=t.camera.relativeElevation<n.OITPolygonOffsetLimit,this._techniqueConfig.multipassTerrainEnabled=t.multipassTerrainEnabled,this._techniqueConfig.cullAboveGround=t.cullAboveGround,this._techniqueConfig},h.update=function(e){const t=Math.min(e.camera.relativeElevation,e.camera.distance);this.animation.enabled=Math.sqrt(this.parameters.waveTextureRepeat/this.parameters.waveStrength)*t<p;const i=this.animation.advance(e);return this.animation.enabled&&i},h.intersect=function(e,t,i,a,r,n,s){l.intersectTriangleGeometry(e,t,a,r,n,void 0,s)},h.requiresSlot=function(e,t){switch(a.outputFromPass(t)){case 2:return 21===e;case 0:if(this.parameters.isDraped)return 20===e;break;case 4:return 2===e||20===e}let i=2;return this.parameters.transparent&&(i=this.parameters.writeDepth?4:7),e===i},h.createGLMaterial=function(e){if(0===e.output&&this.parameters.isDraped)return e.output=5,new s.WaterGLMaterial(e);switch(e.output){case 0:case 2:case 4:case 7:return new s.WaterGLMaterial(e)}return null},h.createBufferWriter=function(){return new o.DefaultBufferWriter(o.PositionUVLayout)},r}(r.Material);const p=35e3;e.WaterMaterial=h,Object.defineProperty(e,"__esModule",{value:!0})}));
