/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../lib/AnimationTimer","../lib/Material","../lib/OrderIndependentTransparency","./WaterGLMaterial","./WaterTechnique","./internal/DefaultBufferWriter","./internal/MaterialUtil","./internal/waterMaterialUtils"],(function(e,t,i,a,n,r,s,u,o,l){"use strict";let c=function(e){function a(t){var a;return(a=e.call(this,t,l.defaultWaterMaterialParameters)||this).animation=new i.AnimationTimer,a.techniqueConfig=new s.WaterTechniqueConfiguration,a}t._inheritsLoose(a,e);var c=a.prototype;return c.getTechniqueConfig=function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.receiveShadows=this.params.receiveShadows,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.useSSR=this.params.ssrEnabled,this.techniqueConfig.isDraped=this.params.isDraped,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<n.OITPolygonOffsetLimit,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!!t&&t.cullAboveGround,this.techniqueConfig},c.update=function(e){const t=Math.min(e.camera.relativeElevation,e.camera.distance);this.animation.enabled=Math.sqrt(this.params.waveTextureRepeat/this.params.waveStrength)*t<h;const i=this.animation.advance(e.dt);return this.animation.enabled&&i},c.intersect=function(e,t,i,a,n,r,s){o.intersectTriangleGeometry(e,t,a,n,r,void 0,s)},c.getGLMaterial=function(e){if(0===e.output&&this.params.isDraped){const t=e;return t.output=5,new r.WaterGLMaterial(t)}switch(e.output){case 0:case 2:case 4:case 7:return new r.WaterGLMaterial(e)}},c.createBufferWriter=function(){return new u.DefaultBufferWriter(u.PositionUVLayout)},a}(a.Material);const h=35e3;e.WaterMaterial=c,Object.defineProperty(e,"__esModule",{value:!0})}));
