/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./internal/MaterialUtil","../lib/Material","../lib/OrderIndependentTransparency","./WaterTechnique","./WaterGLMaterial","./internal/DefaultBufferWriter","../lib/AnimationTimer","./internal/waterMaterialUtils"],(function(e,t,i,a,n,r,s,u,o,l){"use strict";let c=function(e){function a(t){var i;return(i=e.call(this,t,l.defaultWaterMaterialParameters)||this).animation=new o.AnimationTimer,i.techniqueConfig=new r.WaterTechniqueConfiguration,i}t._inheritsLoose(a,e);var c=a.prototype;return c.getTechniqueConfig=function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.receiveShadows=this.params.receiveShadows,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.useSSR=this.params.ssrEnabled,this.techniqueConfig.isDraped=this.params.isDraped,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<n.OITPolygonOffsetLimit,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!t||t.cullAboveGround,this.techniqueConfig},c.update=function(e){const t=Math.min(e.camera.relativeElevation,e.camera.distance);return this.animation.enabled=Math.sqrt(this.params.waveTextureRepeat/this.params.waveStrength)*t<h,this.animation.advance(e.dt),this.animation.enabled},c.intersect=function(e,t,a,n,r,s,u){i.intersectTriangleGeometry(e,t,n,r,s,void 0,u)},c.getGLMaterial=function(e){if(0===e.output&&this.params.isDraped){const t=e;return t.output=5,new s.WaterGLMaterial(t)}switch(e.output){case 0:case 2:case 4:case 7:return new s.WaterGLMaterial(e)}},c.createBufferWriter=function(){return new u.DefaultBufferWriter(u.PositionUVLayout)},a}(a.Material);const h=35e3;e.WaterMaterial=c,Object.defineProperty(e,"__esModule",{value:!0})}));
