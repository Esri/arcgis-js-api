/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/time","../../../../chunks/vec2f64","../../../../chunks/vec4f64","../core/shaderLibrary/ShaderOutput","../lib/AnimationTimer","../lib/Material","../lib/OrderIndependentTransparency","../lib/RenderSlot","./WaterGLMaterial","./WaterTechnique","./internal/DefaultBufferWriter","./internal/MaterialUtil"],(function(e,t,r,a,i,n,s,o,l,u,c,h,p,f){"use strict";let d=function(e){function a(t){var r;return(r=e.call(this,t,new m)||this)._configuration=new h.WaterTechniqueConfiguration,r.animation=new s.AnimationTimer,r}t._inheritsLoose(a,e);var i=a.prototype;return i.getConfiguration=function(e,t){return this._configuration.output=e,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.receiveShadows=this.parameters.receiveShadows,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.hasScreenSpaceReflections=this.parameters.hasScreenSpaceReflections,this._configuration.hasCloudsReflections=this.parameters.hasCloudsReflections,this._configuration.isDraped=this.parameters.isDraped,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<l.OITPolygonOffsetLimit,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration},i.update=function(e){const t=Math.min(e.camera.relativeElevation,e.camera.distance);this.animation.enabled=Math.sqrt(this.parameters.waveTextureRepeat/this.parameters.waveStrength)*t<S;const a=this.animation.advance(e);return this.setParameters({timeElapsed:r.secondsFromMilliseconds(this.animation.time)*this.parameters.animationSpeed},!1),this.animation.enabled&&a},i.intersect=function(e,t,r,a,i,n,s){f.intersectTriangleGeometry(e,t,a,i,n,void 0,s)},i.requiresSlot=function(e,t){switch(t){case n.ShaderOutput.Normal:return e===u.RenderSlot.DRAPED_WATER;case n.ShaderOutput.Color:if(this.parameters.isDraped)return e===u.RenderSlot.DRAPED_MATERIAL;break;case n.ShaderOutput.Alpha:break;case n.ShaderOutput.Highlight:return e===u.RenderSlot.OPAQUE_MATERIAL||e===u.RenderSlot.DRAPED_MATERIAL;default:return!1}let r=u.RenderSlot.OPAQUE_MATERIAL;return this.parameters.transparent&&(r=this.parameters.writeDepth?u.RenderSlot.TRANSPARENT_MATERIAL:u.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===r},i.createGLMaterial=function(e){return new c.WaterGLMaterial(e)},i.createBufferWriter=function(){return new p.DefaultBufferWriter(p.PositionUVLayout)},a}(o.Material),m=function(e){function r(){var t;return(t=e.apply(this,arguments)||this).waveStrength=.06,t.waveTextureRepeat=32,t.waveDirection=a.fromValues(1,0),t.waveVelocity=.05,t.flowStrength=.015,t.flowOffset=-.5,t.animationSpeed=.35,t.timeElapsed=0,t.color=i.fromValues(0,0,0,0),t.transparent=!0,t.writeDepth=!0,t.hasSlicePlane=!1,t.isDraped=!1,t.receiveShadows=!0,t.hasScreenSpaceReflections=!1,t.hasCloudsReflections=!1,t}return t._inheritsLoose(r,e),r}(o.MaterialParameters);const S=35e3;e.WaterMaterial=d,e.WaterMaterialParameters=m,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
