/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../../../core/maybe","../../../webgl/BufferObject","../../../webgl/FramebufferObject","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/has","../../../webgl/enums","../../../webgl/RenderingContext","../../../../chunks/builtins","../../../webgl/Texture","../../../webgl/VertexArrayObject"],(function(e,t,r,n,i,u,o,s,c,a,l){"use strict";let h=function(){function e(e){this._rctx=e,this.cache=new Map}var r=e.prototype;return r.dispose=function(){this.cache.forEach((e=>e.texture=t.disposeMaybe(e.texture))),this.cache.clear()},r.acquire=function(e){if(t.isNone(e))return null;const r=this.patternId(e),n=this.cache.get(r);if(n)return n.refCount++,n.bind;const i=2,u=this.patternToTextureData(e,2),o=u.length/i,s={refCount:1,texture:null,bind:e=>(t.isNone(s.texture)&&(s.texture=new a(this._rctx,{width:u.length,height:1,internalFormat:6406,pixelFormat:6406,dataType:5121,wrapMode:33071},u)),e.bindTexture(s.texture,"stipplePatternTexture"),o)};return this.cache.set(r,s),s.bind},r.release=function(e){if(t.isNone(e))return;const r=this.patternId(e),n=this.cache.get(r);n&&(n.refCount--,0===n.refCount&&(t.isSome(n.texture)&&n.texture.dispose(),this.cache.delete(r)))},r.swap=function(e,t){const r=this.acquire(t);return this.release(e),r},r.patternId=function(e){return e.join(",")},r.patternToTextureData=function(e,t){const r=e.reduce(((e,t)=>e+t))*t,n=new Uint8Array(r);let i=!0,u=0;for(const o of e){for(let e=0;e<o*t;e++)n[u++]=i?255:0;i=!i}return n},e}();e.StippleTextureRepository=h,Object.defineProperty(e,"__esModule",{value:!0})}));
