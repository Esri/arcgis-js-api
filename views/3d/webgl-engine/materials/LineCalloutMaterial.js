/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/vec2f32","../../support/buffer/InterleavedLayout","../lib/Util","../lib/GLMaterial","../lib/Material","./internal/bufferWriterUtils","../shaders/LineCalloutTechnique"],(function(e,t,n,i,r,s,a,u,o){"use strict";let c=function(e){function n(t,i){var r;return(r=e.call(this,i,t,f)||this).techniqueConfig=new o.LineCalloutTechniqueConfiguration,r._uniqueMaterialIdentifier=n.uniqueMaterialIdentifier(r.params),r}t._inheritsLoose(n,e);var i=n.prototype;return i.dispose=function(){},i.getGLMaterial=function(e){return 0===e.output?new l(e):void 0},i.getPassParameters=function(){return this.params},i.getTechniqueConfig=function(e){return this.techniqueConfig.occlusionTestEnabled=this.params.occlusionTest,this.techniqueConfig.verticalOffset=!!this.params.verticalOffset,this.techniqueConfig.screenSizePerspective=!!this.params.screenSizePerspective,this.techniqueConfig.depthHudEnabled=e,this.techniqueConfig.depthHudAlignStartEnabled=!!this.params.depthHUDAlignStart,this.techniqueConfig.screenCenterOffsetUnitsEnabled="screen"===this.params.centerOffsetUnits?1:0,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig},i.intersect=function(){},i.createBufferWriter=function(){return new p},i.validateParameterValues=function(e){const t=n.uniqueMaterialIdentifier(e);t!==this._uniqueMaterialIdentifier&&(this._uniqueMaterialIdentifier=t)},n.uniqueMaterialIdentifier=function(e){return JSON.stringify({screenOffset:e.screenOffset||[0,0],centerOffsetUnits:e.centerOffsetUnits||"world"})},t._createClass(n,[{key:"uniqueMaterialIdentifier",get:function(){return this._uniqueMaterialIdentifier}}]),n}(a.Material),l=function(e){function n(t){var n;return(n=e.call(this,t)||this).isRenderSlot=!0,n.updateParameters(),n}t._inheritsLoose(n,e);var i=n.prototype;return i.updateParameters=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(o.LineCalloutTechnique,this.material.getTechniqueConfig(!1),this.technique),this.depthTechnique=this.techniqueRep.acquireAndReleaseExisting(o.LineCalloutTechnique,this.material.getTechniqueConfig(!0),this.depthTechnique)},i.beginSlot=function(e){switch(e){case 20:return this.isRenderSlot=!0,!0;case 21:return this.isRenderSlot=!1,!0}return!1},i.getTechnique=function(){return this.isRenderSlot?this.technique:this.depthTechnique},i.bind=function(e,t){const n=this.getTechnique();e.bindProgram(n.program),n.bindPass(e,this.material.getPassParameters(),t)},n}(s);const f={verticalOffset:null,screenSizePerspective:null,screenOffset:[0,0],color:[0,0,0,1],size:1,borderColor:null,occlusionTest:!1,shaderPolygonOffset:1e-5,depthHUDAlignStart:!1,centerOffsetUnits:"world",slicePlaneEnabled:!1,...a.materialParametersDefaults},h=i.newLayout().vec3f(r.VertexAttrConstants.POSITION).vec3f(r.VertexAttrConstants.NORMAL).vec2f(r.VertexAttrConstants.UV0).vec4f(r.VertexAttrConstants.AUXPOS1),d=[n.fromValues(0,0),n.fromValues(1,0),n.fromValues(0,1),n.fromValues(1,0),n.fromValues(1,1),n.fromValues(0,1)];let p=function(){function e(){this.vertexBufferLayout=h}var t=e.prototype;return t.allocate=function(e){return this.vertexBufferLayout.createBuffer(e)},t.elementCount=function(e){return 6*e.indices[r.VertexAttrConstants.POSITION].length},t.write=function(e,t,n,i){u.writePosition(t.indices[r.VertexAttrConstants.POSITION],t.vertexAttr[r.VertexAttrConstants.POSITION].data,e.transformation,n.position,i,6),u.writeNormal(t.indices[r.VertexAttrConstants.NORMAL],t.vertexAttr[r.VertexAttrConstants.NORMAL].data,e.invTranspTransformation,n.normal,i,6),u.writeBufferVec4(t.indices[r.VertexAttrConstants.AUXPOS1],t.vertexAttr[r.VertexAttrConstants.AUXPOS1].data,n.auxpos1,i,6);for(let e=0;e<d.length;++e)n.uv0.setVec(i+e,d[e])},e}();e.LineCalloutMaterial=c,Object.defineProperty(e,"__esModule",{value:!0})}));
