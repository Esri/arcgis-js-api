/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../chunks/vec2f32","../../../../chunks/vec2f64","../../support/buffer/InterleavedLayout","../core/shaderLibrary/ShaderOutput","../core/shaderLibrary/hud/HUD.glsl","../lib/GLMaterial","../lib/Material","../lib/RenderSlot","../lib/VertexAttribute","./internal/bufferWriterUtils","../shaders/LineCalloutTechnique","../shaders/LineCalloutTechniqueConfiguration"],(function(e,t,r,i,n,a,s,u,o,c,l,f,h,d,p){"use strict";let S=function(e){function i(t){var r;return(r=e.call(this,t,new b)||this)._configuration=new p.LineCalloutTechniqueConfiguration,r._uniqueMaterialIdentifier=i.uniqueMaterialIdentifier(r.parameters),r}t._inheritsLoose(i,e);var n=i.prototype;return n.getPassParameters=function(){return this.parameters},n.getConfiguration=function(e,t){const i=t?.slot!==l.RenderSlot.LINE_CALLOUTS;return this._configuration.occlusionTestEnabled=this.parameters.occlusionTest,this._configuration.hasVerticalOffset=r.isSome(this.parameters.verticalOffset),this._configuration.hasScreenSizePerspective=r.isSome(this.parameters.screenSizePerspective),this._configuration.depthHudEnabled=i,this._configuration.depthHudAlignStartEnabled=!!this.parameters.depthHUDAlignStart,this._configuration.screenCenterOffsetUnitsEnabled="screen"===this.parameters.centerOffsetUnits?u.HUDSpace.Screen:u.HUDSpace.World,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasMultipassGeometry=t.multipassGeometry.enabled,this._configuration},n.intersect=function(){},n.requiresSlot=function(e,t){if(t===s.ShaderOutput.Color)switch(e){case l.RenderSlot.LINE_CALLOUTS:case l.RenderSlot.LINE_CALLOUTS_HUD_DEPTH:return!0}return!1},n.createGLMaterial=function(e){return new g(e)},n.createBufferWriter=function(){return new L},n.validateParameters=function(e){const t=i.uniqueMaterialIdentifier(e);t!==this._uniqueMaterialIdentifier&&(this._uniqueMaterialIdentifier=t)},i.uniqueMaterialIdentifier=function(e){return JSON.stringify({screenOffset:e.screenOffset||[0,0],centerOffsetUnits:e.centerOffsetUnits||"world"})},t._createClass(i,[{key:"uniqueMaterialIdentifier",get:function(){return this._uniqueMaterialIdentifier}}]),i}(c.Material),g=function(e){function r(){return e.apply(this,arguments)||this}return t._inheritsLoose(r,e),r.prototype.beginSlot=function(e){return this.ensureTechnique(d.LineCalloutTechnique,e)},r}(o),b=function(e){function r(){var t;return(t=e.apply(this,arguments)||this).screenOffset=n.ZEROS,t.color=[0,0,0,1],t.size=1,t.occlusionTest=!1,t.shaderPolygonOffset=1e-5,t.depthHUDAlignStart=!1,t.centerOffsetUnits="world",t.hasSlicePlane=!1,t}return t._inheritsLoose(r,e),r}(c.MaterialParameters);const O=a.newLayout().vec3f(f.VertexAttribute.POSITION).vec3f(f.VertexAttribute.NORMAL).vec2f(f.VertexAttribute.UV0).vec4f(f.VertexAttribute.AUXPOS1),m=[i.fromValues(0,0),i.fromValues(1,0),i.fromValues(0,1),i.fromValues(1,0),i.fromValues(1,1),i.fromValues(0,1)];let L=function(){function e(){this.vertexBufferLayout=O}var t=e.prototype;return t.allocate=function(e){return this.vertexBufferLayout.createBuffer(e)},t.elementCount=function(e){return 6*e.indices.get(f.VertexAttribute.POSITION).length},t.write=function(e,t,r,i,n){h.writePosition(r.indices.get(f.VertexAttribute.POSITION),r.vertexAttributes.get(f.VertexAttribute.POSITION).data,e,i.position,n,6),h.writeNormal(r.indices.get(f.VertexAttribute.NORMAL),r.vertexAttributes.get(f.VertexAttribute.NORMAL).data,t,i.normal,n,6),h.writeBufferVec4(r.indices.get(f.VertexAttribute.AUXPOS1),r.vertexAttributes.get(f.VertexAttribute.AUXPOS1).data,i.auxpos1,n,6);for(let a=0;a<m.length;++a)i.uv0.setVec(n+a,m[a])},e}();e.LineCalloutMaterial=S,e.Parameters=b,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
