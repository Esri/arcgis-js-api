/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../core/has","../../../../core/maybe","../../../../chunks/builtins","../../../webgl/Texture","../../../webgl/FramebufferObject","../../../webgl/RenderingContext"],(function(e,t,n,r,i,u,o){"use strict";let c=function(){function e(){this.cache=new Map}var t=e.prototype;return t.dispose=function(){this.cache.forEach((e=>{n.isSome(e.texture)&&(e.texture.dispose(),e.texture=null)})),this.cache.clear()},t.acquire=function(e){if(n.isNone(e))return null;const t=this.patternId(e),r=this.cache.get(t);if(r)return r.refCount++,r.bind;const u=this.patternToTextureData(e,2),o=u.length/2,c={refCount:1,texture:null,bind:(e,t)=>(n.isNone(c.texture)&&(c.texture=new i(e,{width:u.length,height:1,internalFormat:6406,pixelFormat:6406,dataType:5121,wrapMode:33071},u)),e.bindTexture(c.texture,t),o)};return this.cache.set(t,c),c.bind},t.release=function(e){if(n.isNone(e))return;const t=this.patternId(e),r=this.cache.get(t);r&&(r.refCount--,0===r.refCount&&(n.isSome(r.texture)&&r.texture.dispose(),this.cache.delete(t)))},t.swap=function(e,t){const n=this.acquire(t);return this.release(e),n},t.patternId=function(e){return e.join(",")},t.patternToTextureData=function(e,t){const n=e.reduce(((e,t)=>e+t))*t,r=new Uint8Array(n);let i=!0,u=0;for(const n of e){for(let e=0;e<n*t;e++)r[u++]=i?255:0;i=!i}return r},e}();e.StippleTextureRepository=c,e.createStipplePattern=function(e){return n.isNone(e)?e:e.slice()},e.createStipplePatternSimple=function(e){return[e,e]},Object.defineProperty(e,"__esModule",{value:!0})}));
