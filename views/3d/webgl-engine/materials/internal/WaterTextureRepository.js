/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/tslib.es6","../../../../../assets","../../../../../core/Accessor","../../../../../core/Logger","../../../../../core/maybe","../../../../../core/accessorSupport/decorators/property","../../../../../core/accessorSupport/ensureType","../../../../../core/arrayUtils","../../../../../core/accessorSupport/decorators/subclass","../../../../../support/requestImageUtils","../../core/shaderModules/interfaces","../../lib/basicInterfaces","../../../../webgl/enums","../../../../webgl/Texture"],(function(e,t,r,a,s,o,i,n,p,u,l,c,d,g,h,m){"use strict";e.WaterTextureRepository=function(e){function r(){var t;return(t=e.apply(this,arguments)||this)._passParameters=new y,t._loading=0,t}t._inheritsLoose(r,e);var s=r.prototype;return s.destroy=function(){this._passParameters.waveNormal=i.disposeMaybe(this._passParameters.waveNormal),this._passParameters.wavePertubation=i.disposeMaybe(this._passParameters.wavePertubation)},s.ensureResources=function(e){if(this._loading>0)return g.ResourceState.LOADING;if(i.isSome(this._passParameters.waveNormal)&&i.isSome(this._passParameters.wavePertubation))return g.ResourceState.LOADED;const t={target:h.TextureType.TEXTURE_2D,pixelFormat:h.PixelFormat.RGBA,dataType:h.PixelType.UNSIGNED_BYTE,wrapMode:h.TextureWrapMode.REPEAT,samplingMode:h.TextureSamplingMode.LINEAR_MIPMAP_LINEAR,hasMipmap:!0,maxAnisotropy:8};return++this._loading,c.requestImage(a.getAssetUrl("esri/images/materials/water/normals.jpg")).then((r=>this._passParameters.waveNormal=new m.Texture(e,{...t,width:r.width,height:r.height},r))).catch((e=>o.getLogger(this.declaredClass).error("Failed to load water material normal texture.",e))).finally((()=>--this._loading)),++this._loading,c.requestImage(a.getAssetUrl("esri/images/materials/water/perturbation.jpg")).then((r=>this._passParameters.wavePertubation=new m.Texture(e,{...t,width:r.width,height:r.height},r))).catch((e=>o.getLogger(this.declaredClass).error("Failed to load water material pertubation texture.",e))).finally((()=>--this._loading)),g.ResourceState.LOADING},t._createClass(r,[{key:"passParameters",get:function(){return this._passParameters}},{key:"updating",get:function(){return this._loading>0}}]),r}(s),r.__decorate([n.property()],e.WaterTextureRepository.prototype,"_loading",void 0),r.__decorate([n.property({type:Boolean,readOnly:!0})],e.WaterTextureRepository.prototype,"updating",null),e.WaterTextureRepository=r.__decorate([l.subclass("esri.views.3d.webgl-engine.materials.internal.WaterTextureRepository")],e.WaterTextureRepository);let y=function(e){function r(){return e.apply(this,arguments)||this}return t._inheritsLoose(r,e),r}(d.NoParameters);e.WaterTexturePassParameters=y,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
