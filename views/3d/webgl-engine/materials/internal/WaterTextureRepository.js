/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/tslib.es6","../../../../../assets","../../../../../core/Accessor","../../../../../core/Logger","../../../../../core/accessorSupport/decorators/property","../../../../../core/arrayUtils","../../../../../core/has","../../../../../core/accessorSupport/ensureType","../../../../../core/accessorSupport/decorators/subclass","../../../../../support/requestImageUtils","../../lib/basicInterfaces","../../../../webgl/enums","../../../../webgl/Texture"],(function(e,t,r,a,o,s,i,n,u,l,p,c,d,g,h){"use strict";const y=s.getLogger("esri.views.3d.webgl-engine.materials.internal.waterMaterialUtils");e.WaterTextureRepository=function(e){function r(){var t;return(t=e.apply(this,arguments)||this)._data=new Array,t.loadingState=d.ResourceState.NOT_LOADED,t}t._inheritsLoose(r,e);var o=r.prototype;return o.dispose=function(){this.loadingState=d.ResourceState.NOT_LOADED,this._data.forEach((e=>e.dispose())),this._data.length=0},o.loadTextures=function(e){const t=[a.getAssetUrl("esri/images/materials/water/normals.jpg"),a.getAssetUrl("esri/images/materials/water/perturbation.jpg")];this.loadingState=d.ResourceState.LOADING,Promise.all(t.map((e=>c.requestImage(e)))).then((t=>{t.forEach((t=>this._data.push(new h.Texture(e,{target:g.TextureType.TEXTURE_2D,pixelFormat:g.PixelFormat.RGBA,dataType:g.PixelType.UNSIGNED_BYTE,wrapMode:g.TextureWrapMode.REPEAT,samplingMode:g.TextureSamplingMode.LINEAR_MIPMAP_LINEAR,hasMipmap:!0,maxAnisotropy:8,width:t.width,height:t.height},t)))),this.loadingState=d.ResourceState.LOADED})).catch((e=>{y.error("Failed to load textures for water material.",e),this.loadingState=d.ResourceState.NOT_LOADED}))},o.bind=function(e){this.ready&&(e.bindTexture(this._data[0],"texWaveNormal"),e.bindTexture(this._data[1],"texWavePerturbation"))},t._createClass(r,[{key:"updating",get:function(){return this.loadingState===d.ResourceState.LOADING}},{key:"ready",get:function(){return this.loadingState===d.ResourceState.LOADED}}]),r}(o),r.__decorate([i.property()],e.WaterTextureRepository.prototype,"loadingState",void 0),r.__decorate([i.property({type:Boolean,readOnly:!0})],e.WaterTextureRepository.prototype,"updating",null),e.WaterTextureRepository=r.__decorate([p.subclass("esri.views.3d.webgl-engine.materials.internal.WaterTextureRepository")],e.WaterTextureRepository),Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
