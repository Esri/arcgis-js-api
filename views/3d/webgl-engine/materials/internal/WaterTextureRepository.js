/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/tslib.es6","../../../../../core/has","../../../../../core/Logger","../../../../../core/accessorSupport/ensureType","../../../../../core/accessorSupport/decorators/property","../../../../../core/accessorSupport/decorators/subclass","../../../../../core/urlUtils","../../../../../core/uuid","../../../../../portal/support/resourceExtension","../../../../../core/Accessor","../../../../../assets","../../../../../support/requestImageUtils","../../../../webgl/Texture"],(function(e,t,r,a,o,s,i,n,l,p,u,c,d,g,h){"use strict";const y=o.getLogger("esri.views.3d.webgl-engine.materials.internal.waterMaterialUtils");e.WaterTextureRepository=function(e){function r(){var t;return(t=e.apply(this,arguments)||this).data=[],t.loadingState=0,t}t._inheritsLoose(r,e);var a=r.prototype;return a.dispose=function(){this.loadingState=0,this.data.forEach((e=>{e.dispose(),e=null})),this.data=null},a.getTextureProps=function(e,t,r=!1){return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:10497,samplingMode:9987,hasMipmap:r,maxAnisotropy:8,width:e,height:t}},a.loadTextures=function(e){const t=[d.getAssetUrl("esri/images/materials/water/normals.jpg"),d.getAssetUrl("esri/images/materials/water/perturbation.jpg")];this.loadingState=1,Promise.all(t.map((e=>g.requestImage(e)))).then((t=>{t.forEach(((t,r)=>{this.data[r]=new h(e,this.getTextureProps(t.width,t.height,!0),t)})),this.loadingState=2})).catch((e=>{y.error("Failed to load textures for water material.",e),this.loadingState=0}))},a.bindRepo=function(e){for(let t=0;t<this.data.length;t++)e.bindTexture(this.data[t],t)},t._createClass(r,[{key:"updating",get:function(){return 1===this.loadingState}},{key:"ready",get:function(){return 2===this.loadingState}}]),r}(c),r.__decorate([i.property()],e.WaterTextureRepository.prototype,"loadingState",void 0),r.__decorate([i.property({type:Boolean,readOnly:!0})],e.WaterTextureRepository.prototype,"updating",null),e.WaterTextureRepository=r.__decorate([n.subclass("esri.views.3d.webgl-engine.materials.internal.WaterTextureRepository")],e.WaterTextureRepository),Object.defineProperty(e,"__esModule",{value:!0})}));
