/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Logger"],(function(e,n,t){"use strict";const r=t.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");let i=function(){function e(){this.includedModules=new Map}return e.prototype.include=function(e,n){this.includedModules.has(e)?this.includedModules.get(e)!==n&&r.error("Trying to include shader module multiple times with different sets of options."):(this.includedModules.set(e,n),e(this.builder,n))},e}(),s=function(e){function t(){var n;return(n=e.apply(this,arguments)||this).vertex=new c,n.fragment=new c,n.attributes=new a,n.varyings=new d,n.extensions=new h,n.defines=new f,n}return n._inheritsLoose(t,e),t.prototype.generateSource=function(e){const n=this.extensions.generateSource(e),t=this.attributes.generateSource(e),r=this.varyings.generateSource(),i="vertex"===e?this.vertex:this.fragment,s=i.uniforms.generateSource(),o=i.code.generateSource(),u="vertex"===e?l:p,c=this.defines.generateSource().concat(i.defines.generateSource());return`\n${n.join("\n")}\n\n${c.join("\n")}\n\n${u}\n\n${s.join("\n")}\n\n${t.join("\n")}\n\n${r.join("\n")}\n\n${o.join("\n")}`},n._createClass(t,[{key:"builder",get:function(){return this}}]),t}(i),o=function(){function e(){this._entries=new Array,this._set=new Set}var n=e.prototype;return n.add=function(e,n,t){const r=`${e}_${n}_${t}`;return this._set.has(r)||(this._entries.push([e,n,t]),this._set.add(r)),this},n.generateSource=function(){return this._entries.map((e=>{return`uniform ${e[1]} ${e[0]}${n=e[2],n?`[${n}]`:""};`;var n}))},e}(),u=function(){function e(){this._entries=new Array}var n=e.prototype;return n.add=function(e){this._entries.push(e)},n.generateSource=function(){return this._entries},e}(),c=function(e){function t(){var n;return(n=e.apply(this,arguments)||this).uniforms=new o,n.code=new u,n.defines=new f,n}return n._inheritsLoose(t,e),n._createClass(t,[{key:"builder",get:function(){return this}}]),t}(i),a=function(){function e(){this._entries=new Array}var n=e.prototype;return n.add=function(e,n){this._entries.push([e,n])},n.generateSource=function(e){return"fragment"===e?[]:this._entries.map((e=>`attribute ${e[1]} ${e[0]};`))},e}(),d=function(){function e(){this._entries=new Array}var n=e.prototype;return n.add=function(e,n){this._entries.push([e,n])},n.generateSource=function(){return this._entries.map((e=>`varying ${e[1]} ${e[0]};`))},e}(),h=function(){function e(){this._entries=new Set}var n=e.prototype;return n.add=function(e){this._entries.add(e)},n.generateSource=function(n){const t="vertex"===n?e.ALLOWLIST_VERTEX:e.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((e=>t.includes(e))).map((e=>`#extension ${e} : enable`))},e}();h.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],h.ALLOWLIST_VERTEX=[];let f=function(){function e(){this._entries=new Map}var n=e.prototype;return n.addInt=function(e,n){const t=n%1==0?n.toFixed(0):n.toString();this._entries.set(e,t)},n.addFloat=function(e,n){const t=n%1==0?n.toFixed(1):n.toString();this._entries.set(e,t)},n.generateSource=function(){return Array.from(this._entries,(([e,n])=>`#define ${e} ${n}`))},e}();const p="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",l="precision highp float;\nprecision highp sampler2D;";e.Code=u,e.Includes=i,e.ShaderBuilder=s,e.Stage=c,Object.defineProperty(e,"__esModule",{value:!0})}));
