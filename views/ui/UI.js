/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/Logger","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/cast","../../core/accessorSupport/decorators/subclass","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../core/Evented","../../core/Handles","../../core/watchUtils","../../core/domUtils","../../widgets/support/widgetUtils","./Component"],(function(t,n,o,i,e,r,s,a,c,d,p,l,u,h,f,m){"use strict";const _={left:0,top:0,bottom:0,right:0},g={bottom:30,top:15,right:15,left:15},y="manual",C={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function v(t){return t&&!t._started&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}function L(t){return"object"==typeof t&&!(t instanceof m)&&!("declaredClass"in t)&&("component"in t||"index"in t||"position"in t)?t:null}function b(t,{top:n,bottom:o,left:i,right:e}){t.style.top=n,t.style.bottom=o,t.style.left=i,t.style.right=e}let P=function(n){function o(t){var o;return(o=n.call(this,t)||this)._cornerNameToContainerLookup={},o._positionNameToContainerLookup={},o._components=new Array,o._componentToKey=new Map,o._handles=new l,o.view=null,o._initContainers(),o}t._inheritsLoose(o,n);var i=o.prototype;return i.initialize=function(){this._handles.add([u.init(this,"view.padding, container",this._applyViewPadding.bind(this)),u.init(this,"padding",this._applyUIPadding.bind(this))])},i.destroy=function(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()},i.castPadding=function(t){return"number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...g,...t}},i.add=function(t,n){let o,i;if(Array.isArray(t))return void t.forEach((t=>this.add(t,n)));const e=L(t);e&&({index:o,position:n,component:t,key:i}=e),n&&"object"==typeof n&&({index:o,key:i,position:n}=n),!t||n&&!this._isValidPosition(n)||this._add(t,n,o,i)},i.remove=function(t,n){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,n)));const o=this._find(t);if(o){const i=this._componentToKey;if(i.has(t)&&i.get(t)!==n)return;const e=this._components.indexOf(o);return o.node.parentNode&&o.node.parentNode.removeChild(o.node),this._componentToKey.delete(t),this._components.splice(e,1)[0]}},i.empty=function(t){if(Array.isArray(t))return t.map((t=>this.empty(t))).reduce(((t,n)=>t.concat(n)));if((t=t||y)===y){return Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(C.corner))).map((t=>this.remove(t)))}return this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null},i.move=function(t,n){if(Array.isArray(t)&&t.forEach((t=>this.move(t,n))),!t)return;let o;const i=L(t)||L(n);if(i&&(o=i.index,n=i.position,t=i.component||t),n&&!this._isValidPosition(n))return;const e=this.remove(t);e&&this.add(e,{position:n,index:o})},i.find=function(t){if(!t)return null;const n=this._findById(t);return n&&(n.widget||n.node)},i.getPosition=function(t){for(const n in this._positionNameToContainerLookup){if(this._positionNameToContainerLookup[n].contains(t))return n}return null},i._add=function(t,n,o,i){t instanceof m||(t=new m({node:t})),this._place({component:t,position:n,index:o}),this._components.push(t),i&&this._componentToKey.set(t,i)},i._find=function(t){return t?t instanceof m?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null},i._getViewPadding=function(){return this.get("view.padding")||_},i._attachContainers=function(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)},i._initContainers=function(){const t=document.createElement("div");t.classList.add(C.innerContainer),t.classList.add(C.cornerContainer);const n=document.createElement("div");n.classList.add(C.innerContainer),n.classList.add(C.manualContainer);const o=document.createElement("div");o.classList.add(C.topLeft),o.classList.add(C.corner),t.appendChild(o);const i=document.createElement("div");i.classList.add(C.topRight),i.classList.add(C.corner),t.appendChild(i);const e=document.createElement("div");e.classList.add(C.bottomLeft),e.classList.add(C.corner),t.appendChild(e);const r=document.createElement("div");r.classList.add(C.bottomRight),r.classList.add(C.corner),t.appendChild(r),this._innerContainer=t,this._manualContainer=n;const s=f.isRTL();this._cornerNameToContainerLookup={"top-left":o,"top-right":i,"bottom-left":e,"bottom-right":r,"top-leading":s?i:o,"top-trailing":s?o:i,"bottom-leading":s?r:e,"bottom-trailing":s?e:r},this._positionNameToContainerLookup={manual:n,...this._cornerNameToContainerLookup}},i._isValidPosition=function(t){return!!this._positionNameToContainerLookup[t]},i._place=function(t){const n=t.component,o=t.position||y,i=t.index,e=this._positionNameToContainerLookup[o],r=i>-1;if(v(n.widget)&&n.widget.startup(),!r)return void e.appendChild(n.node);const s=Array.prototype.slice.call(e.children);if(0===i)return void(e.firstChild?h.insertBefore(n.node,e.firstChild):e.appendChild(n.node));i>=s.length?e.appendChild(n.node):h.insertBefore(n.node,s[i])},i._applyViewPadding=function(){const t=this.container;t&&b(t,this._toPxPosition(this._getViewPadding()))},i._applyUIPadding=function(){const t=this._innerContainer;t&&b(t,this._toPxPosition(this.padding))},i._toPxPosition=function(t){return{top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}},i._toPxUnit=function(t){return 0===t?"0":t+"px"},i._findByComponent=function(t){let n,o=null;return this._components.some((i=>(n=i===t,n&&(o=i),n))),o},i._findById=function(t){let n,o=null;return this._components.some((i=>(n=i.id===t,n&&(o=i),n))),o},i._findByNode=function(t){let n,o=null;return this._components.some((i=>(n=i.node===t,n&&(o=i),n))),o},t._createClass(o,[{key:"container",set:function(t){const n=this._get("container");t!==n&&(t&&(t.classList.add(C.ui),this._attachContainers(t)),n&&(n.classList.remove(C.ui),b(n,{top:"",bottom:"",left:"",right:""}),h.empty(n)),this._set("container",t))}},{key:"height",get:function(){const t=this.get("view.height")||0;if(0===t)return t;const n=this._getViewPadding(),o=n.top+n.bottom;return Math.max(t-o,0)}},{key:"padding",get:function(){return this._get("padding")},set:function(t){t?this._override("padding",t):this._clearOverride("padding")}},{key:"width",get:function(){const t=this.get("view.width")||0;if(0===t)return t;const n=this._getViewPadding(),o=n.left+n.right;return Math.max(t-o,0)}}]),o}(p.EventedAccessor);return n.__decorate([e.property()],P.prototype,"container",null),n.__decorate([e.property()],P.prototype,"height",null),n.__decorate([e.property({value:g})],P.prototype,"padding",null),n.__decorate([r.cast("padding")],P.prototype,"castPadding",null),n.__decorate([e.property()],P.prototype,"view",void 0),n.__decorate([e.property()],P.prototype,"width",null),P=n.__decorate([s.subclass("esri.views.ui.UI")],P),P}));
