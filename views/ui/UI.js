/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/Logger","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/cast","../../core/accessorSupport/decorators/subclass","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../core/Evented","../../core/Handles","../../core/watchUtils","../../core/domUtils","../../widgets/support/widgetUtils","./Component"],(function(t,n,e,i,o,s,r,a,d,c,p,l,u,h,f,_){"use strict";const m={left:0,top:0,bottom:0,right:0},y={bottom:30,top:15,right:15,left:15},g="manual",C="esri-ui",v="esri-ui-corner",w="esri-ui-inner-container",P="esri-ui-manual-container",L="esri-ui-corner-container",b="esri-ui-top-left",x="esri-ui-top-right",k="esri-ui-bottom-left",T="esri-ui-bottom-right";function A(t){return"object"==typeof t&&!(t instanceof _)&&!("declaredClass"in t)&&("component"in t||"index"in t||"position"in t)?t:null}function N(t,{top:n,bottom:e,left:i,right:o}){t.style.top=n,t.style.bottom=e,t.style.left=i,t.style.right=o}let U=function(n){function e(t){var e;return(e=n.call(this,t)||this)._cornerNameToContainerLookup={},e._positionNameToContainerLookup={},e._components=new Array,e._componentToKey=new Map,e._handles=new l,e.view=null,e._initContainers(),e}t._inheritsLoose(e,n);var i=e.prototype;return i.initialize=function(){this._handles.add([u.init(this,"view.padding, container",this._applyViewPadding.bind(this)),u.init(this,"padding",this._applyUIPadding.bind(this))])},i.destroy=function(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()},i.castPadding=function(t){return"number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...y,...t}},i.add=function(t,n){let e,i;if(Array.isArray(t))return void t.forEach((t=>this.add(t,n)));const o=A(t);o&&({index:e,position:n,component:t,key:i}=o),n&&"object"==typeof n&&({index:e,key:i,position:n}=n),!t||n&&!this._isValidPosition(n)||this._add(t,n,e,i)},i.remove=function(t,n){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,n)));const e=this._find(t);if(e){const i=this._componentToKey;if(i.has(t)&&i.get(t)!==n)return;const o=this._components.indexOf(e);return e.node.parentNode&&e.node.parentNode.removeChild(e.node),this._componentToKey.delete(t),this._components.splice(o,1)[0]}},i.empty=function(t){if(Array.isArray(t))return t.map((t=>this.empty(t))).reduce(((t,n)=>t.concat(n)));if((t=t||g)===g){return Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(v))).map((t=>this.remove(t)))}return this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null},i.move=function(t,n){if(Array.isArray(t)&&t.forEach((t=>this.move(t,n))),!t)return;let e;const i=A(t)||A(n);if(i&&(e=i.index,n=i.position,t=i.component||t),n&&!this._isValidPosition(n))return;const o=this.remove(t);o&&this.add(o,{position:n,index:e})},i.find=function(t){if(!t)return null;const n=this._findById(t);return n&&(n.widget||n.node)},i._add=function(t,n,e,i){t instanceof _||(t=new _({node:t})),this._place({component:t,position:n,index:e}),this._components.push(t),i&&this._componentToKey.set(t,i)},i._find=function(t){return t?t instanceof _?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null},i._getViewPadding=function(){return this.get("view.padding")||m},i._attachContainers=function(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)},i._initContainers=function(){const t=document.createElement("div");t.classList.add(w),t.classList.add(L);const n=document.createElement("div");n.classList.add(w),n.classList.add(P);const e=document.createElement("div");e.classList.add(b),e.classList.add(v),t.appendChild(e);const i=document.createElement("div");i.classList.add(x),i.classList.add(v),t.appendChild(i);const o=document.createElement("div");o.classList.add(k),o.classList.add(v),t.appendChild(o);const s=document.createElement("div");s.classList.add(T),s.classList.add(v),t.appendChild(s),this._innerContainer=t,this._manualContainer=n;const r=f.isRTL();this._cornerNameToContainerLookup={"top-left":e,"top-right":i,"bottom-left":o,"bottom-right":s,"top-leading":r?i:e,"top-trailing":r?e:i,"bottom-leading":r?s:o,"bottom-trailing":r?o:s},this._positionNameToContainerLookup={manual:n,...this._cornerNameToContainerLookup}},i._isValidPosition=function(t){return!!this._positionNameToContainerLookup[t]},i._place=function(t){const n=t.component,e=t.position||g,i=t.index,o=this._positionNameToContainerLookup[e],s=i>-1;let r,a,d;var c;(c=n.widget)&&!c._started&&"function"==typeof c.postMixInProperties&&"function"==typeof c.buildRendering&&"function"==typeof c.postCreate&&"function"==typeof c.startup&&n.widget.startup(),s?(r=Array.prototype.slice.call(o.children),a=0===i,a?o.firstChild?h.insertBefore(n.node,o.firstChild):o.appendChild(n.node):(d=i>=r.length,d?o.appendChild(n.node):h.insertBefore(n.node,r[i]))):o.appendChild(n.node)},i._applyViewPadding=function(){const t=this.container;t&&N(t,this._toPxPosition(this._getViewPadding()))},i._applyUIPadding=function(){const t=this._innerContainer;t&&N(t,this._toPxPosition(this.padding))},i._toPxPosition=function(t){return{top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}},i._toPxUnit=function(t){return 0===t?"0":t+"px"},i._findByComponent=function(t){let n,e=null;return this._components.some((i=>(n=i===t,n&&(e=i),n))),e},i._findById=function(t){let n,e=null;return this._components.some((i=>(n=i.id===t,n&&(e=i),n))),e},i._findByNode=function(t){let n,e=null;return this._components.some((i=>(n=i.node===t,n&&(e=i),n))),e},t._createClass(e,[{key:"container",set:function(t){const n=this._get("container");t!==n&&(t&&(t.classList.add(C),this._attachContainers(t)),n&&(n.classList.remove(C),N(n,{top:"",bottom:"",left:"",right:""}),h.empty(n)),this._set("container",t))}},{key:"height",get:function(){const t=this.get("view.height")||0;if(0===t)return t;const n=this._getViewPadding(),e=n.top+n.bottom;return Math.max(t-e,0)}},{key:"padding",get:function(){return this._get("padding")},set:function(t){t?this._override("padding",t):this._clearOverride("padding")}},{key:"width",get:function(){const t=this.get("view.width")||0;if(0===t)return t;const n=this._getViewPadding(),e=n.left+n.right;return Math.max(t-e,0)}}]),e}(p.EventedAccessor);return n.__decorate([o.property()],U.prototype,"container",null),n.__decorate([o.property({dependsOn:["view.height"]})],U.prototype,"height",null),n.__decorate([o.property({value:y})],U.prototype,"padding",null),n.__decorate([s.cast("padding")],U.prototype,"castPadding",null),n.__decorate([o.property()],U.prototype,"view",void 0),n.__decorate([o.property({dependsOn:["view.width"]})],U.prototype,"width",null),U=n.__decorate([r.subclass("esri.views.ui.UI")],U),U}));
