/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../chunks/_rollupPluginBabelHelpers","../core/Error","../core/promiseUtils","./locale"],(function(e,n,t,r,s){"use strict";const o=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,i={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function u(e){return i[e]??!1}const a=[],l=new Map;function c(e){for(const n of l.keys())y(e.pattern,n)&&l.delete(n)}function d(e){return a.includes(e)||(c(e),a.unshift(e)),{remove(){const n=a.indexOf(e);n>-1&&(a.splice(n,1),c(e))}}}function f(e){return h.apply(this,arguments)}function h(){return(h=n._asyncToGenerator((function*(e){const n=s.getLocale();l.has(e)||l.set(e,_(e,n));const t=l.get(e);return t&&(yield m.add(t)),t}))).apply(this,arguments)}function p(e){if(!o.test(e))return null;const n=o.exec(e);if(null===n)return null;const[,t,r]=n,s=t+(r?"-"+r.toUpperCase():"");return u(s)?s:u(t)?t:null}function _(e,n){return g.apply(this,arguments)}function g(){return(g=n._asyncToGenerator((function*(e,n){const r=[];for(const t of a)if(y(t.pattern,e))try{return yield t.fetchMessageBundle(e,n)}catch(s){r.push(s)}if(r.length)throw new t("intl:message-bundle-error",`Errors occurred while loading "${e}"`,{errors:r});throw new t("intl:no-message-bundle-loader",`No loader found for message bundle "${e}"`)}))).apply(this,arguments)}function y(e,n){return"string"==typeof e?n.startsWith(e):e.test(n)}s.beforeLocaleChange((()=>{l.clear()}));const m=new(function(){function e(){this._numLoading=0,this._dfd=null}var t=e.prototype;return t.waitForAll=function(){var e=n._asyncToGenerator((function*(){this._dfd&&(yield this._dfd.promise)}));function t(){return e.apply(this,arguments)}return t}(),t.add=function(e){return this._increase(),e.then((()=>this._decrease()),(()=>this._decrease())),this.waitForAll()},t._increase=function(){this._numLoading++,this._dfd||(this._dfd=r.createDeferred())},t._decrease=function(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)},e}()),b={cache:l,loaders:a};e.fetchMessageBundle=f,e.normalizeMessageBundleLocale=p,e.registerMessageBundleLoader=d,e.test=b,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
