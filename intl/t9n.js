/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../chunks/_rollupPluginBabelHelpers","../request","../core/Error","../core/global","../core/maybe","./messages"],(function(e,n,t,r,o,s,i){"use strict";function l(e,n,t,r){return c.apply(this,arguments)}function c(){return(c=n._asyncToGenerator((function*(e,n,t,o){const s=n.exec(t);if(!s)throw new r("esri-intl:invalid-bundle",`Bundle id "${t}" is not compatible with the pattern "${n}"`);const l=s[1]?`${s[1]}/`:"",c=s[2],u=i.normalizeMessageBundleLocale(o),d=`${l}${c}.json`,h=u?`${l}${c}_${u}.json`:d;let f;try{f=yield a(e(h))}catch(p){if(h===d)throw new r("intl:unknown-bundle",`Bundle "${t}" cannot be loaded`,{error:p});try{f=yield a(e(d))}catch(p){throw new r("intl:unknown-bundle",`Bundle "${t}" cannot be loaded`,{error:p})}}return f}))).apply(this,arguments)}function a(e){return u.apply(this,arguments)}function u(){return(u=n._asyncToGenerator((function*(e){if(s.isSome(f.fetchBundleAsset))return f.fetchBundleAsset(e);const n=yield t(e,{responseType:"text"});return JSON.parse(n.data)}))).apply(this,arguments)}let d=function(){function e({base:e="",pattern:n,location:t=new URL(window.location.href)}){let r;r="string"==typeof t?e=>new URL(e,new URL(t,o.location)).href:t instanceof URL?e=>new URL(e,t).href:t,this.pattern="string"==typeof n?new RegExp(`^${n}`):n,this.getAssetUrl=r,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)/)?(.*)$`)}return e.prototype.fetchMessageBundle=function(e,n){return l(this.getAssetUrl,this.matcher,e,n)},e}();function h(e){return new d(e)}const f={};e.JSONLoader=d,e.createJSONLoader=h,e.test=f,Object.defineProperty(e,"__esModule",{value:!0})}));
