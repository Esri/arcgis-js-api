/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../chunks/_rollupPluginBabelHelpers","../TimeExtent","../core/maybe","../core/promiseUtils","../core/timeUtils"],(function(e,t,n,i,o,r){"use strict";function s(e){return"feature"===(null==e?void 0:e.type)}function u(e){return"map-image"===(null==e?void 0:e.type)}function f(e){return void 0!==e.timeInfo}function a(e,t){return l.apply(this,arguments)}function l(){return l=t._asyncToGenerator((function*(e,r){if(0===e.length)return n.allTime;const a=e.filter(f);yield Promise.all(a.map((e=>e.load({signal:r}))));const l=[],m=[];for(const t of a)(s(t)||u(t))&&t.timeInfo.hasLiveData?l.push(t):m.push(t);const c=e=>i.isNone(e)||e.isAllTime,p=m.map((e=>e.timeInfo.fullTimeExtent));if(p.some(c))return n.allTime;const T=l.map(function(){var e=t._asyncToGenerator((function*(e){const{timeExtent:t}=yield e.fetchRecomputedExtents({signal:r});return t||i.unwrap(e.timeInfo.fullTimeExtent)}));return function(t){return e.apply(this,arguments)}}()),d=(yield o.eachAlways(T)).map((e=>e.value));if(d.some(c))return n.allTime;return d.concat(p).reduce(((e,t)=>e.union(t)))})),l.apply(this,arguments)}function m(e){if(!e)return e;const{start:t,end:o}=e;return new n({start:i.isSome(t)?r.offsetDate(t,-t.getTimezoneOffset(),"minutes"):t,end:i.isSome(o)?r.offsetDate(o,-o.getTimezoneOffset(),"minutes"):o})}function c(e){if(!e)return e;const{start:t,end:o}=e;return new n({start:i.isSome(t)?r.offsetDate(t,t.getTimezoneOffset(),"minutes"):t,end:i.isSome(o)?r.offsetDate(o,o.getTimezoneOffset(),"minutes"):o})}e.getTimeExtentFromLayers=a,e.toLocalTimeExtent=c,e.toUTCTimeExtent=m,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
