/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/has","../core/Logger","../core/accessorSupport/ensureType","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/subclass","../core/urlUtils","../core/uuid","../portal/support/resourceExtension","../core/promiseUtils","../core/Collection","../core/collectionUtils","../layers/Layer"],(function(e,r,t,o,s,n,i,a,l,c,d,y,u,p,f){"use strict";function h(e){return e&&"group"===e.type}function m(e,r,t){let o,s;if(e)for(let n=0,i=e.length;n<i;n++){if(o=e.getItemAt(n),o[r]===t)return o;if(h(o)&&(s=m(o.layers,r,t),s))return s}}const v=s.getLogger("esri.support.LayersMixin"),g=e=>{let o=function(e){function t(...t){var o;(o=e.call(this,...t)||this).layers=new u;const s=e=>{e.parent&&"remove"in e.parent&&e.parent.remove(e)},n=e=>{e.parent=r._assertThisInitialized(o),o.layerAdded(e),"elevation"!==e.type&&"base-elevation"!==e.type||v.error(`Layer 'title:${e.title}, id:${e.id}' of type '${e.type}' is not supported as an operational layer and will therefore be ignored.`)},i=e=>{e.parent=null,o.layerRemoved(e)};return o.layers.on("before-add",(e=>s(e.item))),o.layers.on("after-add",(e=>n(e.item))),o.layers.on("after-remove",(e=>i(e.item))),o}r._inheritsLoose(t,e);var o=t.prototype;return o.destroy=function(){const e=this.layers.removeAll();for(const r of e)this.layerRemoved(r),r.destroy();this.layers.destroy()},o.add=function(e,r){const t=this.layers;r=t.getNextIndex(r),e instanceof f?e.parent===this?this.reorder(e,r):t.add(e,r):y.isPromiseLike(e)?e.then((e=>{this.destroyed||this.add(e,r)})):v.error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")},o.addMany=function(e,r){const t=this.layers;r=t.getNextIndex(r),e.slice().forEach((e=>{e.parent!==this?(t.add(e,r),r+=1):this.reorder(e,r)}))},o.findLayerById=function(e){return m(this.layers,"id",e)},o.findLayerByUid=function(e){return m(this.layers,"uid",e)},o.remove=function(e){return this.layers.remove(e)},o.removeMany=function(e){return this.layers.removeMany(e)},o.removeAll=function(){return this.layers.removeAll()},o.reorder=function(e,r){return this.layers.reorder(e,r)},o.layerAdded=function(e){},o.layerRemoved=function(e){},r._createClass(t,[{key:"layers",set:function(e){this._set("layers",p.referenceSetter(e,this._get("layers")))}}]),t}(e);return t.__decorate([i.property()],o.prototype,"layers",null),o=t.__decorate([a.subclass("esri.support.LayersMixin")],o),o};e.LayersMixin=g,Object.defineProperty(e,"__esModule",{value:!0})}));
