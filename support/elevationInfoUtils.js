/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],(function(e,t,n){"use strict";function o(e){return e?b:S}function r(e,n){return t.isNone(n)||!n.mode?o(e).mode:n.mode}function i(e,n){return t.isSome(n)?n:o(e)}function s(e,n){return r(!!t.isSome(e)&&e.hasZ,n)}function u(e,n){return i(!!t.isSome(e)&&!!e.hasZ,n)}function a(e){const t=c(e);return s(e.geometry,t)}function l(e){const o=c(e),r=s(e.geometry,o);return{mode:r,offset:t.isSome(o)&&"on-the-ground"!==r?t.unwrapOr(o.offset,0)*n.getMetersPerUnit(t.unwrapOr(o.unit,"meters")):0}}function f(e){if("on-the-ground"===a(e))return!1;const n=c(e),o=t.isSome(n)&&n.featureExpressionInfo?n.featureExpressionInfo.expression:null;return!(!o||"0"===o)}function c(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function v(e,n,o){if(t.isNone(o)||!o.mode)return;const r=e.hasZ?e.z:0,i=t.isSome(o.offset)?o.offset:0;switch(o.mode){case"absolute-height":return r-i;case"on-the-ground":return 0;case"relative-to-ground":return r-(t.unwrapOr(n.elevationProvider.getElevation(e.x,e.y,r,e.spatialReference,"ground"),0)+i);case"relative-to-scene":return r-(t.unwrapOr(n.elevationProvider.getElevation(e.x,e.y,r,e.spatialReference,"scene"),0)+i)}}function d(e,t,n,o=null){return m(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,n,o)}function g(e,t,n,o,r=null){return m(e,t[0],t[1],t.length>2?t[2]:0,n,o,r)}function m(e,n,o,r,i,s,u=null){if(t.isNone(s))return;const a=t.isSome(u)?u.mode:"absolute-height";if("on-the-ground"===a)return 0;const{absoluteZ:l}=h(n,o,r,i,e,s);return E(l,n,o,r,i,e,u,a)}function h(e,n,o,r,i,s){const u=t.isSome(s.offset)?s.offset:0;switch(s.mode){case"absolute-height":return{absoluteZ:o+u,elevation:0};case"on-the-ground":{const o=t.unwrapOr(i.elevationProvider.getElevation(e,n,0,r,"ground"),0);return{absoluteZ:o,elevation:o}}case"relative-to-ground":{const s=t.unwrapOr(i.elevationProvider.getElevation(e,n,o,r,"ground"),0);return{absoluteZ:o+s+u,elevation:s}}case"relative-to-scene":{const s=t.unwrapOr(i.elevationProvider.getElevation(e,n,o,r,"scene"),0);return{absoluteZ:o+s+u,elevation:s}}}}function E(e,n,o,r,i,s,u,a){const l=t.isSome(u)&&t.isSome(u.offset)?u.offset:0;switch(a){case"absolute-height":return e-l;case"relative-to-ground":return e-(t.unwrapOr(s.elevationProvider.getElevation(n,o,r,i,"ground"),0)+l);case"relative-to-scene":return e-(t.unwrapOr(s.elevationProvider.getElevation(n,o,r,i,"scene"),0)+l)}}function p(e,n){if(t.isNone(n))return!1;const{mode:o}=n;return t.isSome(o)&&("scene"===e&&"relative-to-scene"===o||"ground"===e&&"absolute-height"!==o)}const b={mode:"absolute-height",offset:0},S={mode:"on-the-ground",offset:null};function y(e,n){return e===n||t.isSome(e)&&t.isSome(n)&&e.mode===n.mode&&e.offset===n.offset}e.absoluteHeightElevationInfo=b,e.elevationContextAffectsAlignment=p,e.elevationInfoLikeEquals=y,e.getConvertedElevation=d,e.getConvertedElevationFromVector=g,e.getEffectiveElevationInfo=i,e.getEffectiveElevationMode=r,e.getGeometryEffectiveElevationInfo=u,e.getGeometryEffectiveElevationMode=s,e.getGraphicEffectiveElevationInfo=l,e.getGraphicEffectiveElevationMode=a,e.getZForElevationMode=v,e.hasGraphicFeatureExpressionInfo=f,e.onTheGroundElevationInfo=S,e.zValueInAbsoluteHeightMode=h,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
