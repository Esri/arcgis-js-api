/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],(function(e,t,n){"use strict";function o(e,n){return t.isNone(n)||!n.mode?e?"absolute-height":"on-the-ground":n.mode}function r(e,n){return o(!!t.isSome(e)&&e.hasZ,n)}function i(e){const t=a(e);return r(e.geometry,t)}function u(e){const o=a(e),i=r(e.geometry,o);return{mode:i,offset:t.isSome(o)&&"on-the-ground"!==i?t.unwrapOr(o.offset,0)*n.getMetersPerUnit(t.unwrapOr(o.unit,"meters")):0}}function s(e){if("on-the-ground"===i(e))return!1;const n=a(e),o=t.isSome(n)&&n.featureExpressionInfo?n.featureExpressionInfo.expression:null;return!(!o||"0"===o)}function a(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function l(e,n,o){if(t.isNone(o)||!o.mode)return;const r=e.hasZ?e.z:0,i=t.isSome(o.offset)?o.offset:0;switch(o.mode){case"absolute-height":return r-i;case"on-the-ground":return 0;case"relative-to-ground":return r-(t.unwrapOr(n.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"ground"),0)+i);case"relative-to-scene":return r-(t.unwrapOr(n.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"scene"),0)+i)}}function c(e,t,n,o=null){return v(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,n,o)}function f(e,t,n,o,r=null){return v(e,t[0],t[1],t.length>2?t[2]:0,n,o,r)}function v(e,n,o,r,i,u,s=null){if(t.isNone(u))return;const a=t.isSome(s)?s.mode:"absolute-height";if("on-the-ground"===a)return 0;return d(g(n,o,r,i,e,u),n,o,r,i,e,s,a)}function g(e,n,o,r,i,u){const s=t.isSome(u.offset)?u.offset:0;switch(u.mode){case"absolute-height":return o+s;case"on-the-ground":return t.unwrapOr(i.elevationProvider.getElevation(e,n,0,r,"ground"),0);case"relative-to-ground":return o+t.unwrapOr(i.elevationProvider.getElevation(e,n,o,r,"ground"),0)+s;case"relative-to-scene":return o+t.unwrapOr(i.elevationProvider.getElevation(e,n,o,r,"scene"),0)+s}}function d(e,n,o,r,i,u,s,a){const l=t.isSome(s)&&t.isSome(s.offset)?s.offset:0;switch(a){case"absolute-height":return e-l;case"relative-to-ground":return e-(t.unwrapOr(u.elevationProvider.getElevation(n,o,r,i,"ground"),0)+l);case"relative-to-scene":return e-(t.unwrapOr(u.elevationProvider.getElevation(n,o,r,i,"scene"),0)+l)}}e.getConvertedElevation=c,e.getConvertedElevationFromVector=f,e.getEffectiveElevationMode=o,e.getGeometryEffectiveElevationMode=r,e.getGraphicEffectiveElevationInfo=u,e.getGraphicEffectiveElevationMode=i,e.getZForElevationMode=l,e.hasGraphicFeatureExpressionInfo=s,e.zValueInAbsoluteHeightMode=g,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
