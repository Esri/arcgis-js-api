/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],(function(e,t,o){"use strict";function n(e){return e?b:S}function r(e,o){return t.isNone(o)||!o.mode?n(e).mode:o.mode}function i(e,o){return t.isSome(o)?o:n(e)}function s(e,o){return r(!!t.isSome(e)&&e.hasZ,o)}function u(e,o){return i(!!t.isSome(e)&&e.hasZ,o)}function a(e){const t=c(e);return s(e.geometry,t)}function l(e){const n=c(e),r=s(e.geometry,n);return{mode:r,offset:t.isSome(n)&&"on-the-ground"!==r?t.unwrapOr(n.offset,0)*o.getMetersPerUnit(t.unwrapOr(n.unit,"meters")):0}}function f(e){if("on-the-ground"===a(e))return!1;const o=c(e),n=t.isSome(o)&&o.featureExpressionInfo?o.featureExpressionInfo.expression:null;return!(!n||"0"===n)}function c(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function v(e,o,n){if(t.isNone(n)||!n.mode)return;const r=e.hasZ?e.z:0,i=t.isSome(n.offset)?n.offset:0;switch(n.mode){case"absolute-height":return r-i;case"on-the-ground":return 0;case"relative-to-ground":return r-(t.unwrapOr(o.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"ground"),0)+i);case"relative-to-scene":return r-(t.unwrapOr(o.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"scene"),0)+i)}}function d(e,t,o,n=null){return m(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,o,n)}function g(e,t,o,n,r=null){return m(e,t[0],t[1],t.length>2?t[2]:0,o,n,r)}function m(e,o,n,r,i,s,u=null){if(t.isNone(s))return;const a=t.isSome(u)?u.mode:"absolute-height";if("on-the-ground"===a)return 0;const{absoluteZ:l}=h(o,n,r,i,e,s);return E(l,o,n,r,i,e,u,a)}function h(e,o,n,r,i,s){const u=t.isSome(s.offset)?s.offset:0;switch(s.mode){case"absolute-height":return{absoluteZ:n+u,elevation:0};case"on-the-ground":{const n=t.unwrapOr(i.elevationProvider.getElevation(e,o,0,r,"ground"),0);return{absoluteZ:n,elevation:n}}case"relative-to-ground":{const s=t.unwrapOr(i.elevationProvider.getElevation(e,o,n,r,"ground"),0);return{absoluteZ:n+s+u,elevation:s}}case"relative-to-scene":{const s=t.unwrapOr(i.elevationProvider.getElevation(e,o,n,r,"scene"),0);return{absoluteZ:n+s+u,elevation:s}}}}function E(e,o,n,r,i,s,u,a){const l=t.isSome(u)&&t.isSome(u.offset)?u.offset:0;switch(a){case"absolute-height":return e-l;case"relative-to-ground":return e-(t.unwrapOr(s.elevationProvider.getElevation(o,n,r,i,"ground"),0)+l);case"relative-to-scene":return e-(t.unwrapOr(s.elevationProvider.getElevation(o,n,r,i,"scene"),0)+l)}}function p(e,o){if(t.isNone(o))return!1;const{mode:n}=o;return t.isSome(n)&&("scene"===e&&"relative-to-scene"===n||"ground"===e&&"absolute-height"!==n)}const b={mode:"absolute-height",offset:0},S={mode:"on-the-ground",offset:null};function y(e,o){return e===o||t.isSome(e)&&t.isSome(o)&&e.mode===o.mode&&e.offset===o.offset}e.absoluteHeightElevationInfo=b,e.elevationContextAffectsAlignment=p,e.elevationInfoLikeEquals=y,e.getConvertedElevation=d,e.getConvertedElevationFromVector=g,e.getEffectiveElevationInfo=i,e.getEffectiveElevationMode=r,e.getGeometryEffectiveElevationInfo=u,e.getGeometryEffectiveElevationMode=s,e.getGraphicEffectiveElevationInfo=l,e.getGraphicEffectiveElevationMode=a,e.getZForElevationMode=v,e.hasGraphicFeatureExpressionInfo=f,e.onTheGroundElevationInfo=S,e.zValueInAbsoluteHeightMode=h,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
