/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../layers/support/fieldUtils","../popup/content/Content","../popup/content/AttachmentsContent","../popup/content/CustomContent","../popup/support/FieldInfoFormat","../popup/FieldInfo","../popup/content/FieldsContent","../popup/content/MediaContent","../popup/content/TextContent","../PopupTemplate"],(function(e,t,i,n,o,l,a,s,r,d,p){"use strict";const u=["oid","global-id"],c=["oid","global-id","guid"];const f=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],m=(e,{editFieldsInfo:t,objectIdField:i,visibleFieldNames:n})=>n?n.has(e.name):!b(e.name,t)&&((!i||e.name!==i)&&(!(u.indexOf(e.type)>-1)&&!f.some((t=>t.test(e.name)))));function F(e,t){return"oid"===e.type?-1:"oid"===t.type?1:g(e)?-1:g(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function b(e,t){if(!e||!t)return!1;const{creationDateField:i,creatorField:n,editDateField:o,editorField:l}=t;return-1!==[i&&i.toLowerCase(),n&&n.toLowerCase(),o&&o.toLowerCase(),l&&l.toLowerCase()].indexOf(e.toLowerCase())}function w(e,t){return e.editable&&-1===c.indexOf(e.type)&&!b(e.name,t)}function y({editFieldsInfo:e,fields:t,objectIdField:i},n){return function(e,t){const i=e;return t&&(e=e.filter((e=>-1===t.indexOf(e.type)))),e===i&&(e=e.slice()),e.sort(F),e}(t,(null==n?void 0:n.ignoreFieldTypes)||I).map((t=>new a({fieldName:t.name,isEditable:w(t,e),label:t.alias,format:C(t),visible:m(t,{editFieldsInfo:e,objectIdField:i,visibleFieldNames:null==n?void 0:n.visibleFieldNames})})))}function C(e){switch(e.type){case"small-integer":case"integer":case"single":return new l({digitSeparator:!0,places:0});case"double":return new l({digitSeparator:!0,places:2});case"date":return new l({dateFormat:"long-month-day-year"});default:return null}}function g(e){if("name"===(e.name&&e.name.toLowerCase()))return!0;return"name"===(e.alias&&e.alias.toLowerCase())||void 0}const I=["geometry","blob","raster","guid","xml"];e.createFieldInfos=y,e.createFieldsContent=function(e,t){return new s({fieldInfos:y(e,t).filter((e=>e.visible))})},e.createPopupTemplate=function({displayField:e,editFieldsInfo:i,fields:o,objectIdField:l,title:a},r){if(!o)return null;const d=y({editFieldsInfo:i,fields:o,objectIdField:l},r);if(!d.length)return null;const u=function(e){const i=t.getDisplayFieldName(e),{titleBase:n}=e;return i?`${n}: {${i.trim()}}`:n}({titleBase:a,fields:o,displayField:e}),c=[new s,new n];return new p({title:u,content:c,fieldInfos:d})},Object.defineProperty(e,"__esModule",{value:!0})}));
