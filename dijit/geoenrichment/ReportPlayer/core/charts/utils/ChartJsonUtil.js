// COPYRIGHT Â© 201 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.31/esri/copyright.txt for details.

define(["dojo/_base/lang","./ThemeCalculator","./cleanUp/_ChartJsonCleaner","./ChartTypes","./ChartDataLabelsTypes","../legends/ChartLegendPlacements","../legends/ChartLegendTypes","./plots/supportClasses/GaugeLabelPlacements","./plots/supportClasses/WaffleLabelPlacements","./plots/supportClasses/WaffleDirections","../../../dataProvider/supportClasses/data/AreaDataUtil","esri/dijit/geoenrichment/utils/ObjectUtil","dojo/i18n!esri/nls/jsapi"],function(e,i,l,a,o,t,r,n,s,d,g,u,c){c=c.geoenrichment.dijit.ReportPlayer.ChartContainer;var y={};y.getDefaultChartSettings=function(l){l=l||{};var g=e.mixin({},l.font),u=e.mixin({},l.font);return delete u.fontSize,{isChart:!0,type:l.chartType||a.COLUMN,isMultiFeatureChart:!!l.isMultiFeatureChart,seriesItems:l.seriesItems||[],visualProperties:{barBorders:!1,view3D:!1,origin:0,width:l.width||400,height:l.height||300,marginTop:void 0,marginRight:void 0,marginBottom:void 0,marginLeft:void 0,backgroundColor:void 0,backgroundColorOpacity:1,plotAreaOutlineColor:void 0,plotAreaOutlineOpacity:1,plotAreaOutlineThickness:0,plotAreaOutlineStyle:void 0,backgroundImageData:void 0,panelBackgroundColor:void 0,title:{text:"",align:"center",style:e.mixin({},g),verticalShift:0},xAxis:{show:!0,hideLine:!1,showTicks:!0,ticksInside:!1,hideLabels:!1,title:"",titleStyle:e.mixin({},g),style:e.mixin({},g),labelsAngle:0,lineColor:void 0,gridLines:!1,gridLinesCentered:!1,gridLinesColor:void 0,gridLinesOpacity:1,gridLinesThickness:.5,gridLinesStyle:void 0,gridStripes:!1,gridStripesColor:void 0,gridStripesColorAlt:void 0,placement:void 0},yAxis:{show:!0,hideLine:!1,showTicks:!0,ticksInside:!1,hideLabels:!1,title:"",titleStyle:e.mixin({},g),style:e.mixin({},g),labelsAngle:0,lineColor:void 0,gridLines:!1,gridLinesCentered:!1,gridLinesColor:void 0,gridLinesOpacity:1,gridLinesThickness:.5,gridLinesStyle:void 0,gridStripes:!1,gridStripesColor:void 0,gridStripesColorAlt:void 0,hideBaseLine:!1,baseLineColor:void 0,baseLineOpacity:1,baseLineThickness:.5,baseLineStyle:void 0,baseLineValue:0,showPercentSymbol:!1,showCurrencySymbol:!1,showSymbolForAllLabels:!1,showValuesAsWeightsInSeries:!1,placement:void 0,nonZeroInclusive:!1},legend:{type:r.SERIES,series:{placement:t.NONE,placementOffset:10,hasBorder:!0,labelParts:"Label",style:e.mixin({},g),symbol:void 0,hideOthers:!1,showComparison:!1},minMax:{placement:t.NONE,placementOffset:3,titleStyle:e.mixin({},u),minVariableLabelStyle:e.mixin({},u),maxVariableLabelStyle:e.mixin({},u)}},isStacked:!1,showValuesAsWeightInStack:!1,columnThickness:i.DEFAULT_COLUMN_THICKNESS,columnBarGap:void 0,columnBarOpacity:1,renderColumnBarsInOppositeDirections:!1,showColumnBarBackground:!1,columnBarBackgroundColor:void 0,columnBarBackgroundOpacity:1,fillOpacity:1,outlineColor:void 0,outlineOpacity:1,outlineThickness:0,outlineStyle:void 0,lineThickness:i.DEFAULT_LINE_THICKNESS,lineOpacity:1,fillLineMarkers:!1,lineMarkersFillOpacity:1,fillLineArea:!1,lineAreaOpacity:1,donutHolePercent:i.DEFAULT_DONUT_HOLE_PERCENT,donutGap:i.DEFAULT_DONUT_GAP,donutArcPercent:i.DEFAULT_DONUT_ARC_PERCENT,gaugeHolePercent:i.DEFAULT_GAUGE_HOLE_PERCENT,gaugeRangeMin:void 0,gaugeRangeMax:void 0,gaugeGap:i.DEFAULT_GAUGE_GAP,gaugeStartAngle:i.DEFAULT_GAUGE_ANGLE,gaugeArcPercent:i.DEFAULT_GAUGE_ARC_PERCENT,gaugeLabelPlacement:n.INSIDE,gaugeLabelStyle:e.mixin({},u),gaugeShowArrow:!1,gaugeArrowLineColor:void 0,gaugeArrowFillColor:void 0,gaugeConditionalStylingOthers:!1,gaugeConditionalStylingLabel:!1,gaugeShowFromToLabels:!1,gaugeFromLabelStyle:e.mixin({},u),gaugeToLabelStyle:e.mixin({},u),waffleDirection:d.DOWN_RIGHT,waffleFlowStyle:void 0,waffleShowWholePictures:!1,waffleStretchIconsToFill:!1,waffleRangeMin:void 0,waffleRangeMax:void 0,waffleLabelPlacement:s.BOTTOM,waffleLabelOffset:10,waffleHideValue:!1,waffleHideLabel:!1,waffleShowLabelAbove:!1,waffleValueStyle:e.mixin({},u),waffleLabelStyle:e.mixin({},u),waffleColumnSpace:5,waffleRowSpace:5,waffleConditionalStylingOthers:!1,waffleConditionalStylingValue:!1,waffleConditionalStylingLabel:!1,waffleNumIcons:void 0,waffleNumRows:void 0,waffleNumColumns:void 0,ringBackgroundColor:void 0,ringBackgroundOpacity:1,columnBarShowWholePictures:!1,dataLabels:o.NONE,dataLabelsShowLabelUnder:!1,dataLabelsDecimals:0,dataLabelsStyle:e.mixin({},g),dataLabelsLabelStyle:null,dataLabelsAltColor:null,dataLabelsEnableAltColor:!1,dataLabelsInside:!1,dataLabelsStackedInColumns:!1,dataLabelsHorizontalAlign:"center",dataLabelsVerticalAlign:"middle",dataLabelsShowValuePercentSymbol:!1,dataLabelsShowValueCurrencySymbol:!1,dataLabelsAngle:0,dataLabelsMaxWidth:void 0,chartIcons:void 0,floatingIcons:void 0,showAxisIcons:!1,showChartIcons:!1,floatingTexts:void 0,sorting:void 0,filter:void 0,conditionalStyling:void 0},comparisonInfo:void 0}},y.provideDefaultValueForMissing=function(e,i){var l=y.getDefaultChartSettings(i);return u.populateObject(e,l),e},y.cleanUpJson=function(e,i,a){return l.cleanUpJson(e,i,a)},y.supportsVisualProperty=function(e,i,a){return l.supportsVisualProperty(i,e,a)},y.enrichVisualPropertiesWithThemeSettings=function(i,l){var a=e.clone(i);return a.backgroundColor=a.backgroundColor||l.backgroundColor,a.outlineColor=a.outlineColor||l.outlineColor,a.outlineStyle=a.outlineStyle||l.outlineStyle,u.populateObject(a.title.style,l.titleStyle),a.xAxis&&(u.populateObject(a.xAxis.style,l.xAxis.axisStyle),u.populateObject(a.xAxis.titleStyle,l.xAxis.titleStyle),a.xAxis.lineColor=a.xAxis.lineColor||l.xAxis.lineColor,a.xAxis.gridLinesColor=a.xAxis.gridLinesColor||l.xAxis.gridLinesColor,a.xAxis.gridLinesStyle=a.xAxis.gridLinesStyle||l.xAxis.gridLinesStyle,a.xAxis.gridStripesColor=a.xAxis.gridStripesColor||l.xAxis.gridStripesColor,a.xAxis.gridStripesColorAlt=a.xAxis.gridStripesColorAlt||l.xAxis.gridStripesColorAlt,u.populateObject(a.yAxis.style,l.yAxis.axisStyle),u.populateObject(a.yAxis.titleStyle,l.yAxis.titleStyle),a.yAxis.lineColor=a.yAxis.lineColor||l.yAxis.lineColor,a.yAxis.gridLinesColor=a.yAxis.gridLinesColor||l.yAxis.gridLinesColor,a.yAxis.gridLinesStyle=a.yAxis.gridLinesStyle||l.yAxis.gridLinesStyle,a.yAxis.gridStripesColor=a.yAxis.gridStripesColor||l.yAxis.gridStripesColor,a.yAxis.gridStripesColorAlt=a.yAxis.gridStripesColorAlt||l.yAxis.gridStripesColorAlt,a.yAxis.baseLineColor=a.yAxis.baseLineColor||l.yAxis.baseLineColor,a.yAxis.baseLineStyle=a.yAxis.baseLineStyle||l.yAxis.baseLineStyle),a.legend&&(u.populateObject(a.legend.series.style,l.legendStyle),a.legend.minMax&&(u.populateObject(a.legend.minMax.titleStyle,l.minMaxLegend.titleStyle),u.populateObject(a.legend.minMax.minVariableLabelStyle,l.minMaxLegend.minVariableLabelStyle),u.populateObject(a.legend.minMax.maxVariableLabelStyle,l.minMaxLegend.maxVariableLabelStyle))),u.populateObject(a.dataLabelsStyle,l.dataLabelsStyle),u.populateObject(a.dataLabelsLabelStyle,a.dataLabelsStyle),a.dataLabelsAltColor=a.dataLabelsAltColor||l.dataLabelsAltColor,u.populateObject(a.gaugeLabelStyle,l.gauge&&l.gauge.dataLabelStyle),a.gaugeArrowLineColor=a.gaugeArrowLineColor||l.gauge&&l.gauge.arrowIndicator.lineColor,a.gaugeArrowFillColor=a.gaugeArrowFillColor||l.gauge&&l.gauge.arrowIndicator.backgroundColor,u.populateObject(a.waffleValueStyle,l.waffle&&l.waffle.dataValueStyle),u.populateObject(a.waffleLabelStyle,l.waffle&&l.waffle.dataLabelStyle),a.ringBackgroundColor=a.ringBackgroundColor||l.ring&&l.ring.ringBackground&&l.ring.ringBackground.backgroundColor,a.columnBarBackgroundColor=a.columnBarBackgroundColor||l.columnBarBackground&&l.columnBarBackground.backgroundColor,a},y.createChartPoint=function(e,l,a,o,t){var r={color:a||"",label:void 0!==l?l||"":e&&e.alias,fieldInfo:e,iconFieldInfo:o,captionFieldInfo:t};return a&&i.setPointColor(r,a),r},y.getGaugeOthersPoint=function(e){return{label:e&&e.label||c.gaugeOthers,color:e&&e.color}},y.getWaffleOthersPoint=function(e){return{label:e&&e.label||c.waffleOthers,color:e&&e.color,iconFieldInfo:e&&e.iconFieldInfo}};var p=[{headers:{data:{AREA_DESC:c.oneMile}}},{headers:{data:{AREA_DESC:c.threeMiles}}},{headers:{data:{AREA_DESC:c.fiveMiles}}}];return y.getSeriesItemsForMultiFeatureChart=function(i,l,o){if(!l)return l;o=o||p;var t=l[0];return a.isLineLike(i)?o.map(function(i,l){var a=e.clone(t);a.points.forEach(function(e){delete e.color});var o=t.multiFeatureLineStyles&&t.multiFeatureLineStyles[l];return o&&(a.color=o.color,a.lineThickness=o.lineThickness,a.lineStyle=o.lineStyle,a.lineMarker=o.lineMarker,a.lineMarkerColor=o.lineMarkerColor,a.lineMarkerSize=o.lineMarkerSize,a.lineMarkerFillColor=o.lineMarkerFillColor,a.fillColor=o.fillColor),a.label=g.getAreaDataValue({areaDataObject:i,fieldName:"AREA_DESC"})||"",a}):t.points.map(function(e){return{label:e.label,points:o.map(function(i){return y.createChartPoint(e.fieldInfo,g.getAreaDataValue({areaDataObject:i,fieldName:"AREA_DESC"})||"",e.color||t.color)})}})},y.getOriginalPointByMultiFeatureIndexes=function(e,i,l){return e[0].points[i]},y.transposeSeriesItems=function(i){return i.length?i[0].points.map(function(l,a){return{label:l.label,points:i.map(function(i){var l=e.clone(i.points[a]);return l.label=i.label,l})}}):[]},y});