/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["exports","../../core/Error","../../core/object","./parser"],(function(e,t,r,n){"use strict";function s(e,t,r){try{return a(e)}catch(n){r.messages&&r.messages.push(n)}return null}function o(e,t,n,s){try{const s=c(e);s&&r.setDeepValue(n,s,t)}catch(o){s.messages&&s.messages.push(o)}}function c(e){if(!e)return null;if("string"==typeof e)return f(e);const t=[];for(const{scale:r,value:n}of e)t.push({scale:r,value:f(n)});return t}function a(e){if(!e)return null;if(u(e)){const t=[];for(const r of e)t.push({scale:r.scale,value:i(r.value)});return t}return i(e)}function u(e){const t=e[0];return!!t&&"scale"in t}function f(e){if(!e)return null;const t=n.parse(e);if(t.error)throw t.error;return t.effects.map((e=>e.toJSON()))}function i(e){if(!e||!e.length)return null;const t=[];for(const r of e){let e=[];switch(r.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":e=[l(r,"amount")];break;case"blur":e=[l(r,"radius","pt")];break;case"hue-rotate":e=[l(r,"angle","deg")];break;case"drop-shadow":e=[l(r,"xoffset","pt"),l(r,"yoffset","pt"),l(r,"blurRadius","pt"),p(r,"color")];break;case"bloom":e=[l(r,"strength"),l(r,"radius","pt"),l(r,"threshold")]}const s=`${r.type}(${e.filter(Boolean).join(" ")})`,o=n.parse(s);if(o.error)throw o.error;t.push(s)}return t.join(" ")}function l(e,r,n){if(null==e[r])throw new t("effect:missing-parameter",`Missing parameter '${r}' in ${e.type} effect`,{effect:e});return n?e[r]+n:""+e[r]}function p(e,r){if(null==e[r])throw new t("effect:missing-parameter",`Missing parameter '${r}' in ${e.type} effect`,{effect:e});const n=e[r];return`rgba(${n[0]||0} ${n[1]||0} ${n[2]||0} ${n[3]/255||0})`}e.effectFunctionsFromJSON=i,e.effectFunctionsToJSON=f,e.fromJSON=a,e.read=s,e.toJSON=c,e.write=o,Object.defineProperty(e,"__esModule",{value:!0})}));
