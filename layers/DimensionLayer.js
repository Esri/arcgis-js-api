/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../analysis/DimensionAnalysis","../analysis/DimensionSimpleStyle","../analysis/LengthDimension","../core/Collection","../core/maybe","../core/MultiOriginJSONSupport","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/arrayUtils","../core/accessorSupport/ensureType","../core/accessorSupport/decorators/subclass","../core/accessorSupport/decorators/writer","./Layer","./mixins/OperationalLayer"],(function(e,t,r,o,i,n,s,a,c,p,l,y,u,d,m,h){"use strict";let f=function(t){function o(e){var o;if((o=t.call(this,e)||this).type="dimension",o.operationalLayerType="ArcGISDimensionLayer",o.source=new r,o.opacity=1,e){const{source:t,style:r}=e;t&&r&&(t.style=r)}return o}e._inheritsLoose(o,t);var i=o.prototype;return i.initialize=function(){this.addHandles([c.watch((()=>this.source),((e,t)=>{s.isSome(t)&&t.parent===this&&(t.parent=null),s.isSome(e)&&(e.parent=this)}),c.syncAndInitial)])},i.load=function(){var t=e._asyncToGenerator((function*(){return this.addResolvingPromise(this.source.waitComputeExtent()),this}));function r(){return t.apply(this,arguments)}return r}(),i.releaseAnalysis=function(e){this.source===e&&(this.source=new r)},i.writeDimensions=function(e,t,r,o){t.dimensions=e.filter((({startPoint:e,endPoint:t})=>s.isSome(e)&&s.isSome(t))).map((e=>e.toJSON(o))).toJSON()},e._createClass(o,[{key:"spatialReference",get:function(){return s.unwrap(this.source.spatialReference)}},{key:"style",get:function(){return this.source.style},set:function(e){this.source.style=e}},{key:"fullExtent",get:function(){return this.source.extent}},{key:"analysis",get:function(){return this.source},set:function(e){this.source=e}},{key:"dimensions",get:function(){return this.source.dimensions},set:function(e){this.source.dimensions=e}}]),o}(h.OperationalLayer(a.MultiOriginJSONMixin(m)));t.__decorate([p.property({json:{read:!1},readOnly:!0})],f.prototype,"type",void 0),t.__decorate([p.property({type:["ArcGISDimensionLayer"]})],f.prototype,"operationalLayerType",void 0),t.__decorate([p.property({nonNullable:!0})],f.prototype,"source",void 0),t.__decorate([p.property({readOnly:!0})],f.prototype,"spatialReference",null),t.__decorate([p.property({types:{key:"type",base:null,typeMap:{simple:o}},json:{write:{ignoreOrigin:!0}}})],f.prototype,"style",null),t.__decorate([p.property({readOnly:!0})],f.prototype,"fullExtent",null),t.__decorate([p.property({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],f.prototype,"opacity",void 0),t.__decorate([p.property({type:["show","hide"]})],f.prototype,"listMode",void 0),t.__decorate([p.property({type:n.ofType(i),json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{ignoreOrigin:!0}}}}})],f.prototype,"dimensions",null),t.__decorate([d.writer("web-scene","dimensions")],f.prototype,"writeDimensions",null),f=t.__decorate([u.subclass("esri.layers.DimensionLayer")],f);return f}));
