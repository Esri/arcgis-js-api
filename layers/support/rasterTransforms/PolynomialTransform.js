/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../core/has","../../../core/Logger","../../../core/accessorSupport/ensureType","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/decorators/enumeration","../../../core/accessorSupport/decorators/reader","../../../core/accessorSupport/decorators/subclass","../../../core/accessorSupport/decorators/writer","../../../core/urlUtils","../../../core/uuid","../../../portal/support/resourceExtension","../../../core/JSONSupport","../../../geometry/Point","../../../geometry/Extent","../../../geometry"],(function(e,r,o,t,n,i,s,f,c,p,l,a,u,y,h,d,m){"use strict";function x(e,r,o){const{x:t,y:n}=r;if(o<2){return{x:e[0]+t*e[2]+n*e[4],y:e[1]+t*e[3]+n*e[5]}}if(2===o){const r=t*t,o=n*n,i=t*n;return{x:e[0]+t*e[2]+n*e[4]+r*e[6]+i*e[8]+o*e[10],y:e[1]+t*e[3]+n*e[5]+r*e[7]+i*e[9]+o*e[11]}}const i=t*t,s=n*n,f=t*n,c=i*t,p=i*n,l=t*s,a=n*s;return{x:e[0]+t*e[2]+n*e[4]+i*e[6]+f*e[8]+s*e[10]+c*e[12]+p*e[14]+l*e[16]+a*e[18],y:e[1]+t*e[3]+n*e[5]+i*e[7]+f*e[9]+s*e[11]+c*e[13]+p*e[15]+l*e[17]+a*e[19]}}function C(e,r,o){const{xmin:t,ymin:n,xmax:i,ymax:s,spatialReference:f}=r;let c=[];if(o<2)c.push({x:t,y:s}),c.push({x:i,y:s}),c.push({x:t,y:n}),c.push({x:i,y:n});else{let e=10;for(let r=0;r<e;r++)c.push({x:t,y:n+(s-n)*r/(e-1)}),c.push({x:i,y:n+(s-n)*r/(e-1)});e=8;for(let r=1;r<=e;r++)c.push({x:t+(i-t)*r/e,y:n}),c.push({x:t+(i-t)*r/e,y:s})}c=c.map((r=>x(e,r,o)));const p=c.map((e=>e.x)),l=c.map((e=>e.y));return new d({xmin:Math.min.apply(null,p),xmax:Math.max.apply(null,p),ymin:Math.min.apply(null,l),ymax:Math.max.apply(null,l),spatialReference:f})}function v(e){const[r,o,t,n,i,s]=e,f=t*s-i*n,c=i*n-t*s;return[(i*o-r*s)/f,(t*o-r*n)/c,s/f,n/c,-i/f,-t/c]}let _=function(r){function o(){var e;return(e=r.apply(this,arguments)||this).polynomialOrder=1,e.type="polynomial",e}e._inheritsLoose(o,r);var t=o.prototype;return t.readForwardCoefficients=function(e,r){const{coeffX:o,coeffY:t}=r;if(null==o||!o.length||null==t||!t.length||o.length!==t.length)return null;const n=[];for(let i=0;i<o.length;i++)n.push(o[i]),n.push(t[i]);return n},t.writeForwardCoefficients=function(e,r,o){const t=[],n=[];for(let i=0;i<(null==e?void 0:e.length);i++)i%2==0?t.push(e[i]):n.push(e[i]);r.coeffX=t,r.coeffY=n},t.readInverseCoefficients=function(e,r){const{inverseCoeffX:o,inverseCoeffY:t}=r;if(null==o||!o.length||null==t||!t.length||o.length!==t.length)return null;const n=[];for(let i=0;i<o.length;i++)n.push(o[i]),n.push(t[i]);return n},t.writeInverseCoefficients=function(e,r,o){const t=[],n=[];for(let i=0;i<(null==e?void 0:e.length);i++)i%2==0?t.push(e[i]):n.push(e[i]);r.inverseCoeffX=t,r.inverseCoeffY=n},t.forwardTransform=function(e){if("point"===e.type){const r=x(this.forwardCoefficients,e,this.polynomialOrder);return new h({x:r.x,y:r.y,spatialReference:e.spatialReference})}return C(this.forwardCoefficients,e,this.polynomialOrder)},t.inverseTransform=function(e){if("point"===e.type){const r=x(this.inverseCoefficients,e,this.polynomialOrder);return new h({x:r.x,y:r.y,spatialReference:e.spatialReference})}return C(this.inverseCoefficients,e,this.polynomialOrder)},e._createClass(o,[{key:"inverseCoefficients",get:function(){let e=this._get("inverseCoefficients");const r=this._get("forwardCoefficients");return!e&&r&&this.polynomialOrder<2&&(e=v(r)),e},set:function(e){this._set("inverseCoefficients",e)}}]),o}(y.JSONSupport);return r.__decorate([i.property({json:{write:!0}})],_.prototype,"polynomialOrder",void 0),r.__decorate([i.property()],_.prototype,"forwardCoefficients",void 0),r.__decorate([f.reader("forwardCoefficients",["coeffX","coeffY"])],_.prototype,"readForwardCoefficients",null),r.__decorate([p.writer("forwardCoefficients")],_.prototype,"writeForwardCoefficients",null),r.__decorate([i.property({json:{write:!0}})],_.prototype,"inverseCoefficients",null),r.__decorate([f.reader("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],_.prototype,"readInverseCoefficients",null),r.__decorate([p.writer("inverseCoefficients")],_.prototype,"writeInverseCoefficients",null),r.__decorate([i.property({json:{write:!0}})],_.prototype,"spatialReference",void 0),r.__decorate([s.enumeration({PolynomialXform:"polynomial"})],_.prototype,"type",void 0),_=r.__decorate([c.subclass("esri.layers.support.rasterTransforms.PolynomialTransform")],_),_}));
