/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../rasterDatasets/byteStreamUtils","../../../chunks/Jpg","./Lerc","./Lzw","./pixelRangeUtils","./TiffTags","./utils","../../../chunks/Zlib"],(function(e,t,n,a,i,r,s,l,o,f){"use strict";const u=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],c=4294967296,h=new Set([1,5,6,7,8,34712,34887]);function g(e,t){let n="unknown";return 3===e?n=64===t?"f64":"f32":1===e?1===t?n="u1":2===t?n="u2":4===t?n="u4":t<=8?n="u8":t<=16?n="u16":t<=32&&(n="u32"):2===e&&(t<=8?n="s8":t<=16?n="s16":t<=32&&(n="s32")),n}function d(e){let t=null;switch(e?e.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":t=Uint8Array;break;case"u16":t=Uint16Array;break;case"u32":t=Uint32Array;break;case"s8":t=Int8Array;break;case"s16":t=Int16Array;break;case"s32":t=Int32Array;break;case"f64":t=Float64Array;break;default:t=Float32Array}return t}function p(e,t){return{x:t[0]*e.x+t[1]*e.y+t[2],y:t[3]*e.x+t[4]*e.y+t[5]}}function E(e,t){return e.get(t)?.values}function T(e,t){return e.get(t)?.values}function I(e,t){return e.get(t)?.values?.[0]}function w(e,t){return e.get(t)?.values?.[0]}function y(e,t,n,a=0,i=l.TIFF_TAGS,r=4){const s=8===r,o=s?v(new DataView(e,n,8),0,t):new DataView(e,n,2).getUint16(0,t),f=4+2*r,u=s?8:2,c=u+o*f;if(n+c>e.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:c};const h=n+c+4<=e.byteLength?V(new DataView(e,n+c,8===r?8:4),0,t,8===r):null,g=n+u,d=new Map;let p,E,T,I,w,y=0,S=0;for(let m=0;m<o;m++){E=new DataView(e,g+f*m,f),T=E.getUint16(0,t),w=E.getUint16(2,t),I=l.getTagName(T,i);const n=[];2===r?(y=E.getUint16(4,t),S=E.getUint16(6,t)):4===r?(y=E.getUint32(4,t),S=E.getUint32(8,t)):8===r&&(y=V(E,4,t,!0),S=V(E,12,t,!0),n.push(E.getUint32(12,t)),n.push(E.getUint32(16,t))),p={id:T,type:w,valueCount:y,valueOffset:S,valueOffsets:n,values:null},N(e,t,p,a,!1,r),d.set(I,p)}return{success:!0,ifd:d,nextIFD:h,requiredBufferSize:c}}const S=(e,t)=>i.decode(e,{inputOffset:t}).pixels[0];function m(e,t){if(1!==t&&2!==t&&4!==t)return e;const n=new Uint8Array(e),a=8/t,i=new Uint8Array(e.byteLength*a);let r=0;const s=2**t-1;for(let l=0;l<n.length;l++){const e=n[l];for(let n=0;n<a;n++)i[r++]=e<<t*n>>>8-t&s}return i.buffer}function A(e,t,n){const i=new a.JpegImage;i.parse(e),i.colorTransform=6===n?-1:0;const r=i.getData(i.width,i.height,1!==t);return new Uint8Array(r.buffer)}function M(e){const t=new f.Zlib(e).getBytes(),n=new ArrayBuffer(t.length),a=new Uint8Array(n);return a.set(t),a}function P(e,t,n,a,i){return b.apply(this,arguments)}function b(){return(b=t._asyncToGenerator((function*(e,t,n,a,s){const l=o.isPlatformLittleEndian===t,f=w(n,"BITSPERSAMPLE"),u=w(n,"SAMPLESPERPIXEL"),c=w(n,"PHOTOMETRICINTERPRETATION"),h=g(w(n,"SAMPLEFORMAT")??1,f),p=w(n,"COMPRESSION")??1,E=d(h);let T,I,y;if(34887===p)return yield i.load(),S(e,a);if(1===p)T=e.slice(a,a+s),I=new Uint8Array(T);else if(8===p||32946===p)I=new Uint8Array(e,a,s),I=M(I),T=I.buffer;else if(6===p)I=new Uint8Array(e,a,s),I=A(I,u,c),T=I.buffer;else if(7===p){const t=n.get("JPEGTABLES").values,i=t.length-2;I=new Uint8Array(i+s-2);for(let e=0;e<i;e++)I[e]=t[e];const r=new Uint8Array(e,a+2,s-2);for(let e=0;e<r.length;e++)I[i+e]=r[e];I=A(I,u,c),T=I.buffer}else{if(5!==p)throw new Error("tiff-decode: unsupport compression "+p);I=r.decode(e,a,s,t),T=I.buffer}if(T=m(T,f),"u8"===h||"s8"===h||l)y=new E(T);else{T=new ArrayBuffer(I.length);const e=new Uint8Array(T);switch(h){case"u16":case"s16":for(let t=0;t<I.length;t+=2)e[t]=I[t+1],e[t+1]=I[t];break;case"u32":case"s32":case"f32":for(let t=0;t<I.length;t+=4)e[t]=I[t+3],e[t+1]=I[t+2],e[t+2]=I[t+1],e[t+3]=I[t]}y=new E(T)}return y}))).apply(this,arguments)}function O(e,t,n){return x.apply(this,arguments)}function x(){return(x=t._asyncToGenerator((function*(e,t,n){const a=T(n,"TILEOFFSETS");if(void 0===a)return null;const i=T(n,"TILEBYTECOUNTS"),{width:r,height:s,pixelType:l,tileWidth:o,tileHeight:f}=U([n]),u=k(n,t),c=w(n,"SAMPLESPERPIXEL")||t.planes,h=r*s,g=w(n,"BITSPERSAMPLE"),p=34887===(w(n,"COMPRESSION")??1),E=d(l),I=[];for(let d=0;d<c;d++)I.push(new E(h));let y,S,m,A,M,b,O,x,L,D,R,N,F;const G=Math.ceil(r/o);if(g%8==0)if(p&&u&&c>1){const l=Math.round(a.length/c);for(y=0;y<l;y++){b=Math.floor(y/G)*f,O=y%G*o,x=b*r+O;for(let l=0;l<c;l++){const u=y*c+l;if(0!==i[u])for(m=yield P(e,t.littleEndian,n,a[u],i[u]),D=0,L=x,N=Math.min(o,r-O),R=Math.min(f,s-b),F=I[l],A=0;A<R;A++)for(L=x+A*r,D=A*o,M=0;M<N;M++,L++,D++)F[L]=m[D]}}}else for(y=0;y<a.length;y++)if(0!==i[y])for(b=Math.floor(y/G)*f,O=y%G*o,x=b*r+O,m=yield P(e,t.littleEndian,n,a[y],i[y]),D=0,L=x,N=Math.min(o,r-O),R=Math.min(f,s-b),S=0;S<c;S++)if(F=I[S],u||p)for(A=0;A<R;A++)for(L=x+A*r,D=o*f*S+A*o,M=0;M<N;M++,L++,D++)F[L]=m[D];else for(A=0;A<R;A++)for(L=x+A*r,D=A*o*c+S,M=0;M<N;M++,L++,D+=c)F[L]=m[D];return{width:r,height:s,pixelType:l,pixels:I}}))).apply(this,arguments)}const L=(e,t,n)=>{const a=o.isPlatformLittleEndian===t.littleEndian,i=T(n,"STRIPOFFSETS");if(void 0===i)return null;const{width:s,height:l,pixelType:f}=U([n]),u=w(n,"SAMPLESPERPIXEL")||t.planes,c=w(n,"PHOTOMETRICINTERPRETATION"),h=s*l,g=w(n,"BITSPERSAMPLE"),p=d(f),E=new p(h*u),I=T(n,"STRIPBYTECOUNTS"),y=w(n,"ROWSPERSTRIP"),S=w(n,"COMPRESSION")??1;let P,b,O,x,L,D,R,N,k,F=y;if(g%8==0)for(P=0;P<i.length;P++){if(L=P*(y*s)*u,F=(P+1)*y>l?l-P*y:y,"u8"===f||"s8"===f||a)8===S||32946===S?(R=new Uint8Array(e,i[P],I[P]),R=M(R),D=R.buffer):6===S?(R=new Uint8Array(e,i[P],I[P]),R=A(R,u,c),D=R.buffer):5===S?(R=r.decode(e,i[P],I[P],t.littleEndian),D=R.buffer):(I[P]!==F*s*u*g/8&&console.log("strip byte counts is different than expected"),D=e.slice(i[P],i[P]+I[P])),D=m(D,g),x=new p(D);else{switch(6===S||8===S||32946===S?(R=new Uint8Array(e,i[P],I[P]),N=M(R),D=N.buffer):(I[P]!==F*s*u*g/8&&console.log("strip byte counts is different than expected"),D=new ArrayBuffer(I[P]),R=new Uint8Array(e,i[P],I[P]),N=new Uint8Array(D)),f){case"u16":case"s16":for(O=0;O<R.length;O+=2)N[O]=R[O+1],N[O+1]=R[O];break;case"u32":case"s32":case"f32":for(O=0;O<R.length;O+=4)N[O]=R[O+3],N[O+1]=R[O+2],N[O+2]=R[O+1],N[O+3]=R[O]}D=m(D,g),x=new p(D)}E.set(x,L)}const G=[];if(1===u)G.push(E);else for(P=0;P<u;P++){for(k=new p(h),b=0;b<h;b++)k[b]=E[b*u+P];G.push(k)}return{width:s,height:l,pixelType:f,pixels:G}},D=(e,t,n)=>{if(!(e&&e.length>0&&t&&n))return null;let a,i,r;const s=e[0].length,l=e.length,o=new Uint8Array(s);for(let f=0;f<l;f++)if(a=e[f],i=t[f],r=n[f],0===f)for(let e=0;e<s;e++)o[e]=a[e]<i||a[e]>r?0:1;else for(let e=0;e<s;e++)o[e]&&(o[e]=a[e]<i||a[e]>r?0:1);return o},R=e=>{if(!e)return null;const t=e.match(/<Item(.*?)Item>/gi);if(!t||0===t.length)return null;const n=new Map;let a,i,r,s,l;for(let T=0;T<t.length;T++)a=t[T],i=a.slice("<Item ".length,a.indexOf(">")),s=a.indexOf("sample="),s>-1&&(l=a.slice(s+'sample="'.length,a.indexOf('"',s+'sample="'.length))),s=a.indexOf("name="),s>-1&&(i=a.slice(s+'name="'.length,a.indexOf('"',s+'name="'.length))),i&&(r=a.slice(a.indexOf(">")+1,a.indexOf("</Item>")).trim(),null!=l?n.has(i)?n.get(i)[l]=r:n.set(i,[r]):n.set(i,r)),l=null;const o=n.get("STATISTICS_MINIMUM"),f=n.get("STATISTICS_MAXIMUM"),u=n.get("STATISTICS_MEAN"),c=n.get("STATISTICS_STDDEV");let h=null;if(o&&f){h=[];for(let e=0;e<o.length;e++)h.push({min:parseFloat(o[e]),max:parseFloat(f[e]),avg:u&&parseFloat(u[e]),stddev:c&&parseFloat(c[e])})}const g=n.get("BandName"),d=n.get("WavelengthMin"),p=n.get("WavelengthMax");let E=null;if(g){E=[];for(let e=0;e<g.length;e++)E.push({BandName:g[e],WavelengthMin:d&&parseFloat(d[e]),WavelengthMax:p&&parseFloat(p[e])})}return{statistics:h,bandProperties:E,dataType:n.get("DataType"),rawMetadata:n}};function N(e,t,n,a=0,i=!1,r=4){if(n.values)return!0;const s=n.type,l=n.valueCount;let o=n.valueOffset,f=[];const h=u[s],g=8*h,d=l*h,p=l*u[s]*8;let E,T;const I=8===r?64:32,w=n.valueOffsets;if(p>I){if(d>(i?e.byteLength:e?e.byteLength-o+a:0))return n.offlineOffsetSize=[o,d],n.values=null,!1}if(p<=I){if(!t)if(I<=32)o>>>=32-p;else{const e=w?.length?w[0]:o>>>0,t=w?.length?w[1]:Math.round((o-e)/c);p<=32?(o=e>>>32-p,w[0]=o):(o=e*2**(32-p)+(t>>>32-p),w[0]=e,w[1]=t>>>32-p)}if(1===l&&g===I)f=[o];else if(64===I){const e=w?.length?w[0]:o>>>0,t=w?.length?w[1]:Math.round((o-e)/c);let n=e,a=32;for(T=1;T<=l;T++){const e=32-g*T%32;if(a<g){const i=n<<e>>>32-a,r=t<<32-a>>>32-a;n=t,f.push(i+r*2**(g-a)),a-=32-(g-a)}else f.push(n<<e>>>32-g),a-=g;0===a&&(a=32,n=t)}}else for(T=1;T<=l;T++){const e=32-g*T;f.push(o<<e>>>32-g)}}else{o-=a,i&&(o=0);for(let n=o;n<o+d;n+=h){switch(s){case 1:case 2:case 7:E=new DataView(e,n,1).getUint8(0);break;case 3:E=new DataView(e,n,2).getUint16(0,t);break;case 4:case 13:E=new DataView(e,n,4).getUint32(0,t);break;case 5:E=new DataView(e,n,4).getUint32(0,t)/new DataView(e,n+4,4).getUint32(0,t);break;case 6:E=new DataView(e,n,1).getInt8(0);break;case 8:E=new DataView(e,n,2).getInt16(0,t);break;case 9:E=new DataView(e,n,4).getInt32(0,t);break;case 10:E=new DataView(e,n,4).getInt32(0,t)/new DataView(e,n+4,4).getInt32(0,t);break;case 11:E=new DataView(e,n,4).getFloat32(0,t);break;case 12:E=new DataView(e,n,8).getFloat64(0,t);break;case 16:case 18:E=v(new DataView(e,n,8),0,t);break;case 17:E=B(new DataView(e,n,8),0,t);break;default:E=null}f.push(E)}}if(2===s){let e="";const t=f;for(f=[],T=0;T<t.length;T++)0===t[T]&&""!==e?(f.push(e),e=""):e+=String.fromCharCode(t[T]);""===e&&0!==f.length||f.push(e)}return n.values=f,!0}function U(e){const t=e[0],n=w(t,"TILEWIDTH"),a=w(t,"TILELENGTH"),i=w(t,"IMAGEWIDTH"),r=w(t,"IMAGELENGTH"),s=w(t,"BITSPERSAMPLE"),l=w(t,"SAMPLESPERPIXEL"),o=w(t,"SAMPLEFORMAT")??1,f=g(o,s),u=k(t),c=E(t,"GDAL_NODATA");let d=null;c?.length&&(d=c.map((e=>parseFloat(e))),d.some((e=>isNaN(e)))&&(d=null));const y=w(t,"COMPRESSION")??1;let S;switch(y){case 1:S="NONE";break;case 2:case 3:case 4:case 32771:S="CCITT";break;case 5:S="LZW";break;case 6:case 7:S="JPEG";break;case 32773:S="PACKBITS";break;case 8:case 32946:S="DEFLATE";break;case 34712:S="JPEG2000";break;case 34887:S="LERC";break;default:S=String(y)}let m=!0,A="";h.has(y)||(m=!1,A+="unsupported tag compression "+y),o>3&&(m=!1,A+="unsupported tag sampleFormat "+o),1!==s&&2!==s&&4!==s&&s%8!=0&&(m=!1,A+="unsupported tag bitsPerSample "+s);const M=I(t,"GEOASCIIPARAMS");let P;if(M){const e=M.split("|").find((e=>e.includes("ESRI PE String = "))),t=e?e.replace("ESRI PE String = ",""):"";P=t.startsWith("COMPD_CS")||t.startsWith("PROJCS")||t.startsWith("GEOGCS")?{wkid:null,wkt:t}:null}const b=T(t,"GEOTIEPOINTS"),O=T(t,"GEOPIXELSCALE"),x=T(t,"GEOTRANSMATRIX"),L=t.has("GEOKEYDIRECTORY")?t.get("GEOKEYDIRECTORY").data:null;let D,N,U=!1,C=!1;if(L){U=2===w(L,"GTRasterTypeGeoKey");const e=w(L,"GTModelTypeGeoKey");if(2===e){const e=w(L,"GeographicTypeGeoKey");e>=1024&&e<=32766&&(P={wkid:e}),P||32767!==e||(C=!0,P={wkid:4326})}else if(1===e){const e=w(L,"ProjectedCSTypeGeoKey");e>=1024&&e<=32766&&(P={wkid:e})}}if(O&&b&&b.length>=6?(D=[O[0],0,b[3]-b[0]*O[0],0,-Math.abs(O[1]),b[4]-b[1]*O[1]],U&&(D[2]-=.5*D[0]+.5*D[1],D[5]-=.5*D[3]+.5*D[4])):x&&16===x.length&&(D=U?[x[0],x[1],x[3]-.5*x[0],x[4],x[5],x[7]-.5*x[5]]:[x[0],x[1],x[3],x[4],x[5],x[7]]),D){const e=[{x:0,y:r},{x:0,y:0},{x:i,y:r},{x:i,y:0}];let t,n=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(let i=0;i<e.length;i++)t=p(e[i],D),n=t.x>n?n:t.x,s=t.x<s?s:t.x,a=t.y>a?a:t.y,l=t.y<l?l:t.y;N={xmin:n,xmax:s,ymin:a,ymax:l,spatialReference:P}}else N={xmin:-.5,ymin:.5-r,xmax:i-.5,ymax:.5,spatialReference:P};C&&(N.xmax-N.xmin>400||Math.max(Math.abs(N.xmin),Math.abs(N.xmax))>361)&&(P=null,N.spatialReference=null);const v=F(e);let B,V,W,H,Y;if(v.length>0){W=Math.round(Math.log(i/w(v[0],"IMAGEWIDTH"))/Math.LN2);const e=v[v.length-1];H=Math.round(Math.log(i/w(e,"IMAGEWIDTH"))/Math.LN2),B=w(e,"TILEWIDTH"),V=w(e,"TILELENGTH")}B=null!=H&&H>0?B||n:null,V=null!=H&&H>0?V||a:null,n&&(Y=[{maxCol:Math.ceil(i/n)-1,maxRow:Math.ceil(r/a)-1,minRow:0,minCol:0}],v.forEach((e=>{Y.push({maxCol:Math.ceil(w(e,"IMAGEWIDTH")/w(e,"TILEWIDTH"))-1,maxRow:Math.ceil(w(e,"IMAGELENGTH")/w(e,"TILELENGTH"))-1,minRow:0,minCol:0})})));const K=I(e[0],"GDAL_METADATA"),X=R(K);A+=" "+_({width:i,height:r,tileWidth:n,tileHeight:a,planes:l,ifds:e});return{width:i,height:r,tileWidth:n,tileHeight:a,planes:l,isBSQ:u,pixelType:f,compression:S,noData:d,hasMaskBand:G(e).length===v.length+1,isSupported:m,message:A,extent:N,isPseudoGeographic:C,affine:O?null:D,firstPyramidLevel:W,maximumPyramidLevel:H,pyramidBlockWidth:B,pyramidBlockHeight:V,tileBoundary:Y,metadata:X}}function k(e,t){const n=E(e,"PLANARCONFIGURATION");return n?2===n[0]:!!t&&t.isBSQ}function F(e){return e.filter((e=>1===w(e,"NEWSUBFILETYPE")))}function G(e){return e.filter((e=>{const t=4==(4&(w(e,"NEWSUBFILETYPE")??0)),n=4===w(e,"PHOTOMETRICINTERPRETATION");return t&&n}))}function C(e){const{littleEndian:t,isBigTiff:n,firstIFDPos:a}=W(e);let i=a;const r=[];do{const a=H(e,t,i,0,l.TIFF_TAGS,n?8:4);if(!a.success)break;r.push(a.ifd),i=a.nextIFD}while(i>0);return{...U(r),littleEndian:t,isBigTiff:n,ifds:r,pyramidIFDs:F(r),maskIFDs:G(r)}}function v(e,t,n){const a=e.getUint32(t,n),i=e.getUint32(t+4,n);return n?i*c+a:a*c+i}function B(e,t,n){let a=n?e.getInt32(t,n):e.getUint32(t,n),i=n?e.getUint32(t+4,n):e.getInt32(t+4,n);const r=(n?a:i)>=0?1:-1;n?a*=r:i*=r;return r*(n?i*c+a:a*c+i)}function V(e,t,n,a){return a?v(e,t,n):e.getUint32(t,n)}function W(e){const t=new DataView(e,0,16),n=t.getUint16(0,!1);let a=null;if(18761===n)a=!0;else{if(19789!==n)throw new Error("unexpected endianess byte");a=!1}const i=t.getUint16(2,a);if(42!==i&&43!==i)throw new Error("unexpected tiff identifier");let r=4;const s=43===i;if(s){const e=t.getUint16(r,a);if(r+=2,8!==e)throw new Error("unsupported bigtiff version");if(0!==t.getUint16(r,a))throw new Error("unsupported bigtiff version");r+=2}return{littleEndian:a,isBigTiff:s,firstIFDPos:V(t,r,a,s)}}function H(e,t,a,i=0,r=l.TIFF_TAGS,s=4){const o=y(e,t,a,i,r,s);let f;const u=o.ifd;if(u){if(l.ifdTags.forEach(((n,a)=>{u.has(a)&&(f=u.get(a),f.data=y(e,t,f.valueOffset-i,i,n).ifd)})),u.has("GEOKEYDIRECTORY")){f=u.get("GEOKEYDIRECTORY");const n=f.values;if(n&&n.length>4){const a=n[0]+"."+n[1]+"."+n[2];f.data=y(e,t,f.valueOffset+6-i,i,l.GEO_KEYS,2).ifd,f.data&&f.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[a]})}}if(u.has("XMP")){f=u.get("XMP");const e=f.values;"number"==typeof e[0]&&7===f.type&&(f.values=[n.bytesToUTF8(new Uint8Array(e))])}}return o}function _(e){const{width:t,height:n,tileHeight:a,tileWidth:i}=e,r=e.planes,s=i?i*a:t*n,l=w(e.ifds[0],"BITSPERSAMPLE");let o="";return s*r>2**30/(l>8?l/8:1)&&(o=i?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported"),o}function Y(e,t){return K.apply(this,arguments)}function K(){return(K=t._asyncToGenerator((function*(e,t){const{headerInfo:n,ifd:a,offsets:i,sizes:r}=t,l=[];for(let s=0;s<i.length;s++){const t=yield P(e,n.littleEndian,a,i[s],r[s]||e.byteLength);l.push(t)}const o=k(a,n),f=w(a,"BITSPERSAMPLE"),u=g(w(a,"SAMPLEFORMAT")??1,f),c=w(a,"SAMPLESPERPIXEL")||n.planes,h=d(u),p=w(a,"TILEWIDTH"),E=w(a,"TILELENGTH"),T=w(a,"COMPRESSION")??1,I=p*E;let y;const S=[];let m=l[0];const A=34887===T;for(let s=0;s<c;s++){if(y=new h(I),o&&A){if(m=l[s],m.length)for(let e=0;e<I;e++)y[e]=m[s][e+s]}else if(m.length)if(o||A&&!o)y=m.slice(I*s,I*(s+1));else for(let e=0;e<I;e++)y[e]=m[e*c+s];S.push(y)}const M=n.noData?n.noData[0]:t.noDataValue,b=n.metadata?n.metadata.statistics:null,O=b?b.map((e=>e.min)):null,x=b?b.map((e=>e.max)):null,L={pixelType:u,width:p,height:E,pixels:S,noDataValue:M};return null!=M?s.convertNoDataToMask(L,M):O&&x&&t.applyMinMaxConstraint&&(L.mask=D(S,O,x)),L}))).apply(this,arguments)}function X(e){return J.apply(this,arguments)}function J(){return(J=t._asyncToGenerator((function*(e,t={}){const n=t.pyramidLevel||0,a=t.headerInfo||C(e),{ifds:i,noData:r}=a;if(0===i.length)throw new Error("no valid image file directory");const l=_(a);if(l)throw l;let o=null;const f=-1===n?i[i.length-1]:i[n],u=r??t.noDataValue;return o=a.tileWidth?yield O(e,a,f):yield L(e,a,f),o?(null!=u&&s.convertNoDataToMask(o,u),o):o}))).apply(this,arguments)}e.decode=X,e.decodeTileOrStrip=Y,e.getImageInfo=U,e.getMaskIFDs=G,e.getPyramidIFDs=F,e.isBSQConfig=k,e.parseFieldValues=N,e.parseHeader=C,e.parseIFD=H,e.parseSignature=W,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
