/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/maybe","../../core/Logger","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/subclass","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../core/JSONSupport","../../request","../../core/Promise","../../core/Loadable"],(function(e,r,t,o,s,i,p,l,a,n,u,c,d,y,m){"use strict";const _=s.getLogger("esri.layers.support.BuildingSummaryStatistics");let g=function(r){function t(){var e;return(e=r.apply(this,arguments)||this).fieldName=null,e.modelName=null,e.label=null,e.min=null,e.max=null,e.mostFrequentValues=null,e.subLayerIds=null,e}return e._inheritsLoose(t,r),t}(c.JSONSupport);r.__decorate([p.property({type:String})],g.prototype,"fieldName",void 0),r.__decorate([p.property({type:String})],g.prototype,"modelName",void 0),r.__decorate([p.property({type:String})],g.prototype,"label",void 0),r.__decorate([p.property({type:Number})],g.prototype,"min",void 0),r.__decorate([p.property({type:Number})],g.prototype,"max",void 0),r.__decorate([p.property({json:{read:e=>Array.isArray(e)&&(e.every((e=>"string"==typeof e))||e.every((e=>"number"==typeof e)))?e.slice():null}})],g.prototype,"mostFrequentValues",void 0),r.__decorate([p.property({type:[Number]})],g.prototype,"subLayerIds",void 0),g=r.__decorate([l.subclass("esri.layers.support.BuildingFieldStatistics")],g);let S=function(r){function t(){var e;return(e=r.apply(this,arguments)||this).url=null,e}e._inheritsLoose(t,r);var s=t.prototype;return s.load=function(e){const r=o.isSome(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(r)),Promise.resolve(this)},s._fetchService=async function(e){const r=(await d(this.url,{query:{f:"json"},responseType:"json",signal:e})).data;this.read(r,{origin:"service"})},e._createClass(t,[{key:"fields",get:function(){return this.loaded||"loading"===this.loadStatus?this._get("fields"):(_.error("building summary statistics are not loaded"),null)}}]),t}(m.LoadableMixin(y.EsriPromiseMixin(c.JSONSupport)));return r.__decorate([p.property({constructOnly:!0,type:String})],S.prototype,"url",void 0),r.__decorate([p.property({readOnly:!0,type:[g],json:{read:{source:"summary"}}})],S.prototype,"fields",null),S=r.__decorate([l.subclass("esri.layers.support.BuildingSummaryStatistics")],S),S}));
