/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["../../../chunks/_rollupPluginBabelHelpers","./byteStreamUtils"],(function(e,t){"use strict";return function(){function n(){}return n.parse=function(e){const n=new DataView(e),r=3&n.getUint8(0);if(3!==r)return{header:{version:r},recordSet:null};const i=n.getUint32(4,!0),s=n.getUint16(8,!0),a=n.getUint16(10,!0),o={version:r,recordCount:i,headerByteCount:s,recordByteCount:a};let l=32;const u=[],p=[];let g;if(3===r){for(;13!==n.getUint8(l);)g=String.fromCharCode(n.getUint8(l+11)).trim(),u.push({name:t.bytesToUTF8(new Uint8Array(e,l,11)),type:g,typeName:["String","Date","Double","Boolean","String","Integer"][["C","D","F","L","M","N"].indexOf(g)],length:n.getUint8(l+16)}),l+=32;if(l+=1,u.length>0)for(;p.length<i&&e.byteLength-l>a;){const r=[];32===n.getUint8(l)?(l+=1,u.forEach((n=>{if("C"===n.type)r.push(t.bytesToUTF8(new Uint8Array(e,l,n.length)).trim());else if("N"===n.type)r.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(e,l,n.length)).trim(),10));else if("F"===n.type)r.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(e,l,n.length)).trim()));else if("D"===n.type){const t=String.fromCharCode.apply(null,new Uint8Array(e,l,n.length)).trim();r.push(new Date(parseInt(t.substring(0,4),10),parseInt(t.substring(4,6),10)-1,parseInt(t.substring(6,8),10)))}l+=n.length})),p.push(r)):l+=a}}const f=function(e){const t=e.fields,n=e.records,r=t.some((e=>"oid"===e.name.toLowerCase()))?"OBJECTID":"OID",i=[{name:r,type:"esriFieldTypeOID",alias:"OID"}].concat(t.map((e=>({name:e.name,type:"esriFieldType"+e.typeName,alias:e.name})))),s=i.map((e=>e.name)),a=[];let o=0,l=0;return n.forEach((e=>{const t={};for(t[r]=o++,l=1;l<s.length;l++)t[s[l]]=e[l-1];a.push({attributes:t})})),{displayFieldName:"",fields:i,features:a}}({fields:u,records:p});return{header:o,fields:u,records:p,recordSet:f}},e._createClass(n,null,[{key:"supportedVersions",get:function(){return[5]}}]),n}()}));
