/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports"],(function(t){"use strict";const n=5e4;function e(t){const n=i(t);if(!n)return{isMultipart:!1,data:null};return{isMultipart:!0,data:n.boundary?r(t.data,n,0):null}}function o(t){const n=new Uint8Array(t,0,2e3),e=String.fromCharCode.apply(null,n),o=e.indexOf('boundary="'),r=-1!==o?e.slice(o+10,e.indexOf('"',o+10)):"";return{boundary:r,offset:-1!==o?o+12+r.length:0}}function r(t,e,o=0){const r="--"+e.boundary,i=[];for(let n=0;n<r.length;n++)i.push(r.charCodeAt(n));const s=[],l="\n--"+e.boundary+"--";for(let n=0;n<l.length;n++)s.push(l.charCodeAt(n));const c=[10],u=[13,10],f=[],d=i.length,h=new Uint8Array(t,o),p=Math.min(n,h.length-d);let g=0,y=0;for(let n=0;n<p;n++){for(y=0;y<d&&h[n+y]===i[y];y++);y===d&&(g&&f.push(a(h.subarray(g,n),e)),n+=d-1,h[n+1]===c[0]?n+=1:h[n+1]===u[0]&&h[n+2]===u[1]&&(n+=2),g=n+1)}const b=s.length;for(let n=h.length-b-10;n<h.length-b;n++){for(y=0;y<b&&h[n+y]===s[y];y++);if(y===b){f.push(a(h.subarray(g,n),e));break}}return f}function i(t){var n,e;const o=null==(n=t.getHeader("Content-Type"))?void 0:n.split(";");if(!(null!=(e=null==o?void 0:o[0].trim())?e:"").startsWith("multipart/"))return null;const r={boundary:"",start:"",type:""};for(let i=1;i<o.length;i++){const t=o[i].split("="),n=t[1].trim();r[t[0].trim()]=n.startsWith('"')?n.slice(1,t[1].length-1):n}return r}function a(t,n){const e=String.fromCharCode.apply(null,t.subarray(0,Math.min(300,t.length))).split("\n"),o=Math.min(e.length,7),r={contentDisposition:"inline"};let i=0;for(let s=0;s<o;s++){var a;if(e[s].length<4)i=i+e[s].length+1;else if("content"===e[s].slice(0,7).toLowerCase()){if(i=i+e[s].length+1,-1===e[s].indexOf(":"))continue;const t=e[s].substring(0,e[s].indexOf(":")).trim(),n=e[s].substring(e[s].indexOf(":")+1).trim();switch(t.toLowerCase()){case"content-type":r.contentType=n;break;case"content-description":r.contentDescription=n;break;case"content-transfer-encoding":r.contentTransferEncoding=n;break;case"content-id":r.contentID=n;break;case"content-disposition":r.contentDisposition=n;break;case"content-location":r.contentLocation=n}}else{if(r.contentDisposition.toLowerCase().indexOf("inline")>-1&&e[s].length>=4&&(null==(a=r.contentType)?void 0:a.toLowerCase().indexOf("image"))>-1){let n=!0;if(r.contentType.toLowerCase().indexOf("tif")>0&&(n=73===t[i]&&73===t[i+1]||77===t[i]&&77===t[i+1]),n){const n=new ArrayBuffer(t.length-i);new Uint8Array(n).set(t.subarray(i,t.length)),r.contentData=n}break}if((""===n.start||r.contentID===n.start)&&r.contentType){if(r.contentType.indexOf("text")>-1||r.contentType.indexOf("xml")>-1){r.contentData=String.fromCharCode.apply(null,t.subarray(i,t.length));break}r.contentData=t.subarray(i,t.length)}}}return r}t.getBoundary=o,t.parse=e,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
