/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../../core/maybe","../PixelBlock"],(function(e,t,i){"use strict";const n=180/Math.PI,r=function(e){return e&&"esri.layers.support.PixelBlock"===e.declaredClass&&e.pixels&&e.pixels.length>0},o=new Map;function a(e,t){return o.get(e)/o.get(t)||1}function l(e){return(450-e)%360}function s(e,t="geographic"){const[i,r]=e,o=Math.sqrt(i*i+r*r);let a=Math.atan2(r,i)*n;return a=(360+a)%360,"geographic"===t&&(a=l(a)),[o,a]}function c(e,t="geographic"){let i=e[1];"geographic"===t&&(i=l(i)),i%=360;const r=e[0];return[r*Math.cos(i/n),r*Math.sin(i/n)]}function h(e,t,n="geographic",o=1){if(!r(e))return e;const{pixels:a,width:l,height:h}=e,u=l*h,p=a[0],x=a[1],m=i.createEmptyBand(e.pixelType,u),d=i.createEmptyBand(e.pixelType,u);let f=0;for(let i=0;i<h;i++)for(let e=0;e<l;e++)"vector-uv"===t?([m[f],d[f]]=s([p[f],x[f]],n),m[f]*=o):([m[f],d[f]]=c([p[f],x[f]],n),m[f]*=o,d[f]*=o),f++;const g=new i({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[m,d]});return g.updateStatistics(),g}function u(e,t,i=1){if(1===i||!r(e))return e;const n=e.clone(),{pixels:o,width:a,height:l}=n,s=o[0],c=o[1];let h=0;for(let r=0;r<l;r++)for(let e=0;e<a;e++)"vector-uv"===t?(s[h]*=i,c[h]*=i):s[h]*=i,h++;return n.updateStatistics(),n}function p(e,i,n,r,o){if(!t.isSome(o)||!o.spatialReference.equals(e.spatialReference))return{extent:e,width:i,height:n,resolution:e.width/i};const a=o.xmin,l=o.ymax;r=Math.max(r||0,30);const s=Math.ceil(i*(1/r)),c=Math.ceil(n*(1/r)),h=((e.xmax-e.xmin)/s+(e.ymax-e.ymin)/c)/2;return e.xmin=a+Math.floor((e.xmin-a)/h)*h,e.xmax=a+Math.ceil((e.xmax-a)/h)*h,e.ymin=l+Math.floor((e.ymin-l)/h)*h,e.ymax=l+Math.ceil((e.ymax-l)/h)*h,{extent:e,width:Math.round(e.width/h),height:Math.round(e.height/h),resolution:h}}o.set("meter-per-second",1),o.set("kilometer-per-hour",.277778),o.set("knots",.514444),o.set("feet-per-second",.3048),o.set("mile-per-hour",.44704),e.convertVectorFieldData=h,e.convertVectorFieldUnit=u,e.getUnitConversionFactor=a,e.isValidPixelBlock=r,e.snapImageToSymbolTile=p,Object.defineProperty(e,"__esModule",{value:!0})}));
