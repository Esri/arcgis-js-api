/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../../core/maybe","../PixelBlock"],(function(e,t,i){"use strict";const n=180/Math.PI,r=function(e){return e&&"esri.layers.support.PixelBlock"===e.declaredClass&&e.pixels&&e.pixels.length>0},a=new Map;function o(e,t){return a.get(e)/a.get(t)||1}function l(e){return(450-e)%360}function c(e,t="geographic"){const[i,r]=e,a=Math.sqrt(i*i+r*r);let o=Math.atan2(r,i)*n;return o=(360+o)%360,"geographic"===t&&(o=l(o)),[a,o]}function s(e,t="geographic"){let i=e[1];"geographic"===t&&(i=l(i)),i%=360;const r=e[0];return[r*Math.cos(i/n),r*Math.sin(i/n)]}function h(e,t,n="geographic",a=1){if(!r(e))return e;const{pixels:o,width:l,height:h}=e,p=l*h,u=o[0],x=o[1],m=i.createEmptyBand(e.pixelType,p),d=i.createEmptyBand(e.pixelType,p);let f=0;for(let i=0;i<h;i++)for(let e=0;e<l;e++)"vector-uv"===t?([m[f],d[f]]=c([u[f],x[f]],n),m[f]*=a):([m[f],d[f]]=s([u[f],x[f]],n),m[f]*=a,d[f]*=a),f++;const g=new i({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[m,d]});return g.updateStatistics(),g}function p(e,t,i=1){if(1===i||!r(e))return e;const n=e.clone(),{pixels:a,width:o,height:l}=n,c=a[0],s=a[1];let h=0;for(let r=0;r<l;r++)for(let e=0;e<o;e++)"vector-uv"===t?(c[h]*=i,s[h]*=i):c[h]*=i,h++;return n.updateStatistics(),n}function u(e,i,n,r,a){if(!t.isSome(a)||!a.spatialReference.equals(e.spatialReference))return{extent:e,width:i,height:n};const o=a.xmin,l=a.ymax;r=Math.max(r||0,30);const c=Math.ceil(i*(1/r)),s=Math.ceil(n*(1/r)),h=((e.xmax-e.xmin)/c+(e.ymax-e.ymin)/s)/2;return e.xmin=o+Math.floor((e.xmin-o)/h)*h,e.xmax=o+Math.ceil((e.xmax-o)/h)*h,e.ymin=l+Math.floor((e.ymin-l)/h)*h,e.ymax=l+Math.ceil((e.ymax-l)/h)*h,{extent:e,width:Math.round(e.width/h),height:Math.round(e.height/h)}}a.set("meter-per-second",1),a.set("kilometer-per-hour",.277778),a.set("knots",.514444),a.set("feet-per-second",.3048),a.set("mile-per-hour",.44704),e.convertVectorFieldData=h,e.convertVectorFieldUnit=p,e.getUnitConversionFactor=o,e.isValidPixelBlock=r,e.snapImageToSymbolTile=u,Object.defineProperty(e,"__esModule",{value:!0})}));
