/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
define(["exports","../../../core/Error","./AspectFunction","./BandArithmeticFunction","./ColormapFunction","./CompositeBandFunction","./ConvolutionFunction","./ExtractBandFunction","./LocalFunction","./MaskFunction","./NDVIFunction","./RemapFunction","./SlopeFunction","./StatisticsHistogramsFunction","./StretchFunction"],(function(t,r,e,s,n,o,a,c,u,i,m,p,d,l,F){"use strict";const g=new Map;function f(t,r,e=["raster"],s=""){g.set(t,{desc:s,ctor:r,rasterArgumentNames:e})}function A(){const t=new Set;return g.forEach(((r,e)=>t.add(e))),t}function N(t,e){if("rasterFunction"in t)return S(t,e??{});throw new r("raster-function-helper","unsupported raster function json.")}function h(t,r){return"rasters"===r[0]&&Array.isArray(t.rasters)?t.rasters:r.map((r=>t[r]))}function S(t,e){const{rasterFunction:s,rasterFunctionArguments:n}=t,o=t.outputPixelType?.toLowerCase();if(null==s||!g.has(s))throw new r("raster-function-helper",`unsupported raster function: ${s}`);const a=g.get(s),c=("function"==typeof a.ctor?a.ctor:a.ctor.default).fromJSON({...t,outputPixelType:o}),{rasterArgumentNames:u}=c,i=[],m=h(n,u),p="rasters"===u[0],d=[];for(let r=0;r<m.length;r++){const t=m[r];let s;null==t||"string"==typeof t&&t.startsWith("$")?i.push(e?.raster):"string"==typeof t?e[t]&&i.push(e[t]):"number"!=typeof t&&"rasterFunction"in t&&(s=S(t,e),p||(c.functionArguments[u[r]]=s),i.push(s)),p&&d.push(s??t)}if(p&&(c.functionArguments.rasters=d),e){c.sourceRasters=i;const t=e.raster?.url;t&&(c.mainPrimaryRasterId=t)}return c}g.set("Aspect",{desc:"Aspect Function",ctor:e,rasterArgumentNames:["raster"]}),g.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:s,rasterArgumentNames:["raster"]}),g.set("Colormap",{desc:"Colormap Function",ctor:n,rasterArgumentNames:["raster"]}),g.set("CompositeBand",{desc:"CompositeBand Function",ctor:o,rasterArgumentNames:["rasters"]}),g.set("Convolution",{desc:"Convolution Function",ctor:a,rasterArgumentNames:["raster"]}),g.set("ExtractBand",{desc:"ExtractBand Function",ctor:c,rasterArgumentNames:["raster"]}),g.set("Local",{desc:"Local Function",ctor:u,rasterArgumentNames:["rasters"]}),g.set("Mask",{desc:"Mask Function",ctor:i,rasterArgumentNames:["raster"]}),g.set("NDVI",{desc:"NDVI Function",ctor:m,rasterArgumentNames:["raster"]}),g.set("Remap",{desc:"Remap Function",ctor:p,rasterArgumentNames:["raster"]}),g.set("Slope",{desc:"Slope Function",ctor:d,rasterArgumentNames:["raster"]}),g.set("StatisticsHistograms",{desc:"Statistics Histograms Function",ctor:l,rasterArgumentNames:["raster"]}),g.set("Stretch",{desc:"Stretch Function",ctor:F,rasterArgumentNames:["raster"]}),t.create=N,t.getRasterValues=h,t.getSupportedFunctions=A,t.register=f,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
