/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../PixelBlock","../rasterFunctionConstants"],(function(e,n,o){"use strict";const t=new Map;function l(e){const n=Math.sqrt(e.length),o=e.slice(0,n),t=[1];for(let l=1;l<n;l++){let o=null;for(let t=0;t<n;t++){const r=e[t+l*n],i=e[t];if(null==o)if(0===i){if(r)return{separable:!1,row:null,col:null}}else o=r/i;else if(r/i!==o)return{separable:!1,row:null,col:null}}if(null==o)return{separable:!1,row:null,col:null};t.push(o)}return{separable:!0,row:o,col:t}}function r(e,n,o,t,l,r,i){const s=new Float32Array(n*o),c=r.length,u=i?0:t,a=i?t:0,h=i?1:n;for(let f=u;f<o-u;f++){const o=f*n;for(let i=a;i<n-a;i++){if(l&&!l[o+i])continue;let n=0;for(let l=0;l<c;l++)n+=e[o+i+(l-t)*h]*r[l];s[o+i]=n}}return s}function i(e,n,o,t,l,r,i){const s=new Float32Array(n*o),c=Math.floor(t/2),u=Math.floor(l/2);for(let a=c;a<o-c;a++){const o=a*n;for(let a=u;a<n-u;a++){if(r&&!r[o+a])continue;let h=0;for(let r=0;r<t;r++)for(let t=0;t<l;t++)h+=e[o+a+(r-c)*n+t-u]*i[r*l+t];s[o+a]=h}}return s}function s(e,o,t=!0){const{pixels:l,width:r,height:s,pixelType:u,mask:a}=e,h=l.length,f=[],{kernel:p,rows:v,cols:g}=o;for(let n=0;n<h;n++){const e=i(l[n],r,s,v,g,a,p);t&&c(e,r,s,v,g),f.push(e)}return new n({width:r,height:s,pixelType:u,pixels:f,mask:a})}function c(e,n,o,t,l){const r=Math.floor(t/2);for(let s=0;s<r;s++)for(let t=0;t<n;t++)e[s*n+t]=e[(l-1-s)*n+t],e[(o-1-s)*n+t]=e[(o-l+s)*n+t];const i=Math.floor(l/2);for(let s=0;s<o;s++){const o=s*n;for(let t=0;t<i;t++)e[o+t]=e[o+l-1-t],e[o+n-t-1]=e[o+n+t-l]}}function u(e,o,t,l=!0){const{pixels:i,width:s,height:u,pixelType:a,mask:h}=e,f=i.length,p=[],v=o.length,g=t.length,K=Math.floor(v/2),x=Math.floor(g/2);for(let n=0;n<f;n++){let e=r(i[n],s,u,K,h,o,!0);e=r(e,s,u,x,h,t,!1),l&&c(e,s,u,v,g),p.push(e)}return new n({width:s,height:u,pixelType:a,pixels:p,mask:h})}function a(e,n){const o=l(n.kernel),t=!1!==n.mirrorEdges,r=o.separable?u(e,o.row,o.col,t):s(e,n,t),{outputPixelType:i}=n;return i&&r.clamp(i),r}t.set(o.convolutionKernel.none,[0,0,0,0,1,0,0,0,0]),t.set(o.convolutionKernel.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]),t.set(o.convolutionKernel.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]),t.set(o.convolutionKernel.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]),t.set(o.convolutionKernel.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]),t.set(o.convolutionKernel.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]),t.set(o.convolutionKernel.gradientWest,[-1,0,1,-2,0,2,-1,0,1]),t.set(o.convolutionKernel.gradientEast,[1,0,-1,2,0,-2,1,0,-1]),t.set(o.convolutionKernel.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]),t.set(o.convolutionKernel.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]),t.set(o.convolutionKernel.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]),t.set(o.convolutionKernel.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]),t.set(o.convolutionKernel.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]),t.set(o.convolutionKernel.smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]),t.set(o.convolutionKernel.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]),t.set(o.convolutionKernel.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]),t.set(o.convolutionKernel.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]),t.set(o.convolutionKernel.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]),t.set(o.convolutionKernel.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]),t.set(o.convolutionKernel.sobelVertical,[-1,0,1,-2,0,2,-1,0,1]),t.set(o.convolutionKernel.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]),t.set(o.convolutionKernel.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]),t.set(o.convolutionKernel.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]),e.convolute=a,e.convoluteSeparable=u,e.convolutionKernels=t,e.separateKernels=l,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
