/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["../../../chunks/_rollupPluginBabelHelpers","../../../chunks/tslib.es6","../../../core/maybe","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/ensureType","../../../core/arrayUtils","../../../core/accessorSupport/decorators/subclass","./bandIndexUtils","./BaseRasterFunction","./NDVIFunctionArguments"],(function(t,e,n,r,s,o,i,u,c,a){"use strict";let p=function(e){function r(){var t;return(t=e.apply(this,arguments)||this).functionName="NDVI",t.functionArguments=null,t.rasterArgumentNames=["raster"],t}t._inheritsLoose(r,e);var s=r.prototype;return s._bindSourceRasters=function(){const{scientificOutput:t}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(t?"f32":"u8");const e=this.sourceRasterInfos[0].clone();e.pixelType=this.outputPixelType,e.colormap=null,e.histograms=null,e.bandCount=1;const[n,r,s,o]=t?[-1,1,0,.1]:[0,200,100,10];return e.statistics=[{min:n,max:r,avg:s,stddev:o}],this.rasterInfo=e,{success:!0,supportsGPU:!0}},s._processPixels=function(t){const e=t.pixelBlocks?.[0];if(n.isNone(e))return null;const{visibleBandID:r,infraredBandID:s,scientificOutput:o}=this.functionArguments;return u.calculateNDVI(e,r,s,!o)},s._getWebGLParameters=function(){const{visibleBandID:t,infraredBandID:e,scientificOutput:n}=this.functionArguments,r=this.isInputBandIdsSwizzled?[0,1,2]:[e,t,0];return{bandIndexMat3:u.getBandMatrix3(r),scaled:!n}},s._getInputBandIds=function(t){const{visibleBandID:e,infraredBandID:n}=this.functionArguments;return[n,e,0].map((e=>t[e]))},r}(c);e.__decorate([r.property({json:{write:!0,name:"rasterFunction"}})],p.prototype,"functionName",void 0),e.__decorate([r.property({type:a,json:{write:!0,name:"rasterFunctionArguments"}})],p.prototype,"functionArguments",void 0),e.__decorate([r.property()],p.prototype,"rasterArgumentNames",void 0),p=e.__decorate([i.subclass("esri.layers.support.rasterFunctions.NDVIFunction")],p);return p}));
