/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../PopupTemplate","../../renderers/ClassBreaksRenderer","../../renderers/DictionaryRenderer","../../renderers/DotDensityRenderer","../../renderers/HeatmapRenderer","../../renderers/Renderer","../../renderers/SimpleRenderer","../../renderers/UniqueValueRenderer","../../renderers/support/jsonUtils","../../renderers/support/types","../../symbols","../../core/HandleOwner","../../core/Identifiable","../../core/Loadable","../../core/Logger","../../core/MultiOriginJSONSupport","../../core/accessorSupport/decorators/property","../../core/arrayUtils","../../core/has","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/reader","../../core/accessorSupport/decorators/subclass","../../core/accessorSupport/extensions/serializableProperty/reader","./commonProperties","./FeatureTemplate","./LabelClass","./labelingInfo","../../support/popupUtils"],(function(e,r,t,o,i,n,a,p,l,d,s,y,u,c,f,b,g,m,_,v,w,I,S,D,T,h,R,P,V,O){"use strict";const x=g.getLogger("esri.layers.FeatureLayer"),C=T.createTypeReader({types:u.symbolTypesRenderer}),L={key:"type",base:p,typeMap:{simple:l,"unique-value":d,"class-breaks":o},errorContext:"renderer"};let j=function(r){function t(e){var t;return(t=r.call(this,e)||this).type="subtype-sublayer",t.labelsVisible=!0,t.labelingInfo=null,t.legendEnabled=!0,t.minScale=0,t.maxScale=0,t.popupEnabled=!0,t.popupTemplate=null,t.subtypeCode=null,t.templates=null,t.title=null,t.visible=!0,t}e._inheritsLoose(t,r);var o=t.prototype;return o.readRenderer=function(e,r,t){const o=(r=r.layerDefinition||r).drawingInfo&&r.drawingInfo.renderer||void 0;if(o){const e=s.read(o,r,t)||void 0;return e||x.error("Failed to create renderer",{rendererDefinition:r.drawingInfo.renderer,layer:this,context:t}),e}if(r.defaultSymbol)return r.types&&r.types.length?new d({defaultSymbol:C(r.defaultSymbol,r,t),field:r.typeIdField,uniqueValueInfos:r.types.map((e=>({id:e.id,symbol:C(e.symbol,e,t)})))}):new l({symbol:C(r.defaultSymbol,r,t)})},o.readTemplates=function(e,r){return e=e&&e.map((e=>R.fromJSON(e)))},o.readVisible=function(e,r){return r.layerDefinition&&null!=r.layerDefinition.defaultVisibility?!!r.layerDefinition.defaultVisibility:null!=r.visibility?!!r.visibility:void 0},o.createPopupTemplate=function(e){const r=this.parent.fields;return O.createPopupTemplate({...this,fields:r},e)},e._createClass(t,[{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",set:function(e){this._set("renderer",e)}}]),t}(c.HandleOwnerMixin(m.MultiOriginJSONMixin(f.IdentifiableMixin(b))));r.__decorate([_.property({json:{read:!1}})],j.prototype,"type",void 0),r.__decorate([_.property(h.labelsVisible)],j.prototype,"labelsVisible",void 0),r.__decorate([_.property({type:[P],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:V.reader},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:V.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],j.prototype,"labelingInfo",void 0),r.__decorate([_.property(h.legendEnabled)],j.prototype,"legendEnabled",void 0),r.__decorate([_.property(h.minScale)],j.prototype,"minScale",void 0),r.__decorate([_.property(h.maxScale)],j.prototype,"maxScale",void 0),r.__decorate([_.property(h.opacityDrawingInfo)],j.prototype,"opacity",void 0),r.__decorate([_.property()],j.prototype,"parent",void 0),r.__decorate([_.property(h.popupEnabled)],j.prototype,"popupEnabled",void 0),r.__decorate([_.property({type:t,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],j.prototype,"popupTemplate",void 0),r.__decorate([_.property({readOnly:!0})],j.prototype,"defaultPopupTemplate",null),r.__decorate([_.property({types:L,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{name:"layerDefinition.drawingInfo.renderer",types:y.webSceneRendererTypes,write:{overridePolicy:(e,r,t)=>({ignoreOrigin:null==t?void 0:t.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(e,r,t)=>({ignoreOrigin:null==t?void 0:t.writeLayerSchema})}}})],j.prototype,"renderer",null),r.__decorate([S.reader("service","renderer",["drawingInfo.renderer","defaultSymbol"]),S.reader("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],j.prototype,"readRenderer",null),r.__decorate([_.property({type:Number,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.subtypeCode"},write:{target:"layerDefinition.subtypeCode"}}})],j.prototype,"subtypeCode",void 0),r.__decorate([_.property({type:[R]})],j.prototype,"templates",void 0),r.__decorate([S.reader("templates",["editFieldsInfo","creatorField","editorField","templates"])],j.prototype,"readTemplates",null),r.__decorate([_.property()],j.prototype,"title",void 0),r.__decorate([_.property({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],j.prototype,"visible",void 0),r.__decorate([S.reader("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],j.prototype,"readVisible",null),j=r.__decorate([D.subclass("esri.layers.support.SubtypeSublayer")],j);return j}));
