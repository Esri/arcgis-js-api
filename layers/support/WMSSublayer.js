/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/Collection","../../core/Handles","../../core/MultiOriginJSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/accessorSupport/decorators/cast","../../core/Logger","../../core/accessorSupport/decorators/reader","../../core/accessorSupport/decorators/subclass","../../core/accessorSupport/ensureType","../../geometry/Extent"],(function(e,t,r,o,n,s,l,i,a,p,u,y,c){"use strict";var d;let h=0,_=d=function(t){function n(e){var r;return(r=t.call(this,e)||this)._sublayersHandles=new o,r.dimensions=null,r.fullExtents=null,r.featureInfoFormat=null,r.featureInfoUrl=null,r.legendUrl=null,r.legendEnabled=!0,r.maxScale=0,r.minScale=0,r.popupEnabled=!1,r.queryable=!1,r.spatialReferences=null,r}e._inheritsLoose(n,t);var s=n.prototype;return s.readExtent=function(e,t){return(e=t.extent)?c.fromJSON(e):null},s.readLegendUrl=function(e,t){return t?t.legendUrl||t.legendURL:null},s.castSublayers=function(e){return y.ensureType(r.ofType(d),e)},s.clone=function(){const e=new d;return this.hasOwnProperty("description")&&(e.description=this.description),this.hasOwnProperty("fullExtent")&&(e.fullExtent=this.fullExtent.clone()),this.hasOwnProperty("fullExtents")&&(e.fullExtents=this.fullExtents.map((e=>e.clone()))),this.hasOwnProperty("featureInfoFormat")&&(e.featureInfoFormat=this.featureInfoFormat),this.hasOwnProperty("featureInfoUrl")&&(e.featureInfoUrl=this.featureInfoUrl),this.hasOwnProperty("legendUrl")&&(e.legendUrl=this.legendUrl),this.hasOwnProperty("legendEnabled")&&(e.legendEnabled=this.legendEnabled),this.hasOwnProperty("layer")&&(e.layer=this.layer),this.hasOwnProperty("name")&&(e.name=this.name),this.hasOwnProperty("parent")&&(e.parent=this.parent),this.hasOwnProperty("queryable")&&(e.queryable=this.queryable),this.hasOwnProperty("sublayers")&&(e.sublayers=this.sublayers&&this.sublayers.map((e=>e.clone()))),this.hasOwnProperty("spatialReferences")&&(e.spatialReferences=this.spatialReferences.map((e=>e))),this.hasOwnProperty("visible")&&(e.visible=this.visible),this.hasOwnProperty("title")&&(e.title=this.title),e},s._setAndNotifyLayer=function(e,t){const r=this.layer;this._get(e)!==t&&(this._set(e,t),r&&r.emit("wms-sublayer-update",{propertyName:e,id:this.id}))},e._createClass(n,[{key:"description",get:function(){return this._get("description")},set:function(e){this._set("description",e)}},{key:"fullExtent",get:function(){return this._get("fullExtent")},set:function(e){this._set("fullExtent",e)}},{key:"id",get:function(){const e=this._get("id");return null==e?h++:e},set:function(e){this._set("id",e)}},{key:"layer",set:function(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach((t=>t.layer=e))}},{key:"name",get:function(){return this._get("name")},set:function(e){this._set("name",e)}},{key:"sublayers",set:function(e){const t=this._get("sublayers");t&&(t.forEach((e=>{e.layer=null})),this._sublayersHandles.removeAll(),this._sublayersHandles=null),e&&(e.forEach((e=>{e.parent=this,e.layer=this.layer})),this._sublayersHandles.add([e.on("after-add",(({item:e})=>{e.parent=this,e.layer=this.layer})),e.on("after-remove",(({item:e})=>{e.parent=null,e.layer=null}))])),this._set("sublayers",e)}},{key:"title",get:function(){return this._get("title")},set:function(e){this._set("title",e)}},{key:"visible",get:function(){return this._get("visible")},set:function(e){this._setAndNotifyLayer("visible",e)}}]),n}(n.MultiOriginJSONSupport);return t.__decorate([s.property()],_.prototype,"description",null),t.__decorate([s.property({readOnly:!0})],_.prototype,"dimensions",void 0),t.__decorate([s.property({value:null})],_.prototype,"fullExtent",null),t.__decorate([p.reader("fullExtent",["extent"])],_.prototype,"readExtent",null),t.__decorate([s.property()],_.prototype,"fullExtents",void 0),t.__decorate([s.property()],_.prototype,"featureInfoFormat",void 0),t.__decorate([s.property()],_.prototype,"featureInfoUrl",void 0),t.__decorate([s.property({type:Number,json:{write:{enabled:!1,overridePolicy:()=>({ignoreOrigin:!0,enabled:!0})}}})],_.prototype,"id",null),t.__decorate([s.property({type:String,json:{origins:{"web-document":{read:{source:["legendUrl","legendURL"]},write:{target:"legendUrl",ignoreOrigin:!0}}},read:{source:"legendURL"},write:{ignoreOrigin:!0}}})],_.prototype,"legendUrl",void 0),t.__decorate([p.reader(["web-document"],"legendUrl")],_.prototype,"readLegendUrl",null),t.__decorate([s.property({value:!0,type:Boolean,json:{read:{source:"showLegend"},write:{target:"showLegend"},origins:{"web-map":{read:!1,write:!1},"web-scene":{read:!1,write:!1}}}})],_.prototype,"legendEnabled",void 0),t.__decorate([s.property({value:null})],_.prototype,"layer",null),t.__decorate([s.property()],_.prototype,"maxScale",void 0),t.__decorate([s.property()],_.prototype,"minScale",void 0),t.__decorate([s.property({type:String,value:null,json:{read:{source:"name"},write:{ignoreOrigin:!0}}})],_.prototype,"name",null),t.__decorate([s.property()],_.prototype,"parent",void 0),t.__decorate([s.property({type:Boolean,json:{read:{source:"showPopup"},write:{ignoreOrigin:!0,target:"showPopup"}}})],_.prototype,"popupEnabled",void 0),t.__decorate([s.property({type:Boolean,json:{write:{ignoreOrigin:!0}}})],_.prototype,"queryable",void 0),t.__decorate([s.property()],_.prototype,"sublayers",null),t.__decorate([i.cast("sublayers")],_.prototype,"castSublayers",null),t.__decorate([s.property({type:[Number],json:{read:{source:"spatialReferences"}}})],_.prototype,"spatialReferences",void 0),t.__decorate([s.property({type:String,value:null,json:{write:{ignoreOrigin:!0}}})],_.prototype,"title",null),t.__decorate([s.property({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"}}})],_.prototype,"visible",null),_=d=t.__decorate([u.subclass("esri.layers.support.WMSSublayer")],_),_}));
