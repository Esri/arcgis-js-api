/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/has","../../core/Logger","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/subclass","../../core/urlUtils","../../core/uuid","../../portal/support/resourceExtension","../../core/Accessor","../../core/HandleOwner"],(function(e,r,t,s,a,o,n,l,i,c,p,y,u){"use strict";const m={visible:"visibleSublayers"};e.ExportWMSImageParameters=function(e){function t(r){var t;return(t=e.call(this,r)||this).scale=0,t}return r._inheritsLoose(t,e),t.prototype.toJSON=function(){const{layer:e,layers:r}=this,{imageFormat:t,imageTransparency:s,version:a}=e;return{format:t,request:"GetMap",service:"WMS",styles:"",transparent:s,version:a,layers:r}},r._createClass(t,[{key:"layer",set:function(e){this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.sublayers.on("change",(()=>this.notifyChange("visibleSublayers"))),e.on("wms-sublayer-update",(e=>this.notifyChange(m[e.propertyName])))],"layer"))}},{key:"layers",get:function(){const{visibleSublayers:e}=this;return e.filter((e=>e.name)).map((e=>e.name)).join(",")}},{key:"version",get:function(){this.commitProperty("layers");const e=this.layer;return e&&e.commitProperty("imageTransparency"),(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){const{layer:e,scale:r}=this,t=null==e?void 0:e.sublayers,s=[],a=e=>{const{minScale:t,maxScale:o,sublayers:n,visible:l}=e;l&&(0===r||(0===t||r<=t)&&(0===o||r>=o))&&(n?n.forEach(a):s.unshift(e))};return null==t||t.forEach(a),s}}]),t}(u.HandleOwnerMixin(y)),t.__decorate([n.property()],e.ExportWMSImageParameters.prototype,"layer",null),t.__decorate([n.property({readOnly:!0})],e.ExportWMSImageParameters.prototype,"layers",null),t.__decorate([n.property({type:Number})],e.ExportWMSImageParameters.prototype,"scale",void 0),t.__decorate([n.property({readOnly:!0})],e.ExportWMSImageParameters.prototype,"version",null),t.__decorate([n.property({readOnly:!0})],e.ExportWMSImageParameters.prototype,"visibleSublayers",null),e.ExportWMSImageParameters=t.__decorate([l.subclass("esri.layers.support.ExportWMSImageParameters")],e.ExportWMSImageParameters),Object.defineProperty(e,"__esModule",{value:!0})}));
