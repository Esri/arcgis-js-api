/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
define(["exports","../../core/maybe","../../core/urlUtils","../../chunks/persistableUrlUtils"],(function(e,r,t,n){"use strict";const i=["MapServer","ImageServer","FeatureServer","SceneServer","StreamServer","VectorTileServer"],s=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${i.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),o=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${i.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i");function l(e){const r=t.urlToObject(e),n=r.path.match(s)||r.path.match(o);if(!n)return null;const[,i,l,a,c]=n,f=l.indexOf("/");return{title:u(-1!==f?l.slice(f+1):l),serverType:a,sublayer:null!=c&&""!==c?parseInt(c,10):null,url:{path:i}}}function u(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}e.cleanTitle=u,e.isArcGISUrl=function(e){return!!s.test(e)},e.isHostedAgolService=function(e){if(!e)return!1;const r=-1!==(e=e.toLowerCase()).indexOf(".arcgis.com/"),t=-1!==e.indexOf("//services")||-1!==e.indexOf("//tiles")||-1!==e.indexOf("//features");return r&&t},e.isHostedSecuredProxyService=function(e,r){return r&&e&&-1!==e.toLowerCase().indexOf(r.toLowerCase())},e.isServerOrServicesAGOLUrl=function(e){if(!e)return!1;const r=new t.Url(t.makeAbsolute(e)).authority.toLowerCase();return"server.arcgisonline.com"===r||"services.arcgisonline.com"===r},e.isWmsServer=function(e){if(!e)return!1;const r=e.toLowerCase(),t=-1!==r.indexOf("/services/"),n=-1!==r.indexOf("/mapserver/wmsserver"),i=-1!==r.indexOf("/imageserver/wmsserver"),s=-1!==r.indexOf("/wmsserver");return t&&(n||i||s)},e.parse=l,e.sanitizeUrl=function(e,r){return e?t.removeTrailingSlash(t.removeQueryParameters(e,r)):e},e.sanitizeUrlWithLayerId=function(e,n,i){if(!n)return{url:n};n=t.removeQueryParameters(n,i);const s=l(t.urlToObject(n).path);let o;return r.isSome(s)&&(null!=s.sublayer&&null==e.layerId&&(o=s.sublayer),n=s.url.path),{url:t.removeTrailingSlash(n),layerId:o}},e.serverTypes=i,e.titleFromUrlAndName=function(e,t){const n=[];if(e){const t=l(e);r.isSome(t)&&t.title&&n.push(t.title)}if(t){const e=u(t);n.push(e)}if(2===n.length){if(-1!==n[0].toLowerCase().indexOf(n[1].toLowerCase()))return n[0];if(-1!==n[1].toLowerCase().indexOf(n[0].toLowerCase()))return n[1]}return n.join(" - ")},e.writeUrlWithLayerId=function(e,r,i,s,o){n.write(r,s,"url",o),s.url&&null!=e.layerId&&(s.url=t.join(s.url,i,e.layerId.toString()))},Object.defineProperty(e,"__esModule",{value:!0})}));
