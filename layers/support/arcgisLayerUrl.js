/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../core/maybe","../../core/urlUtils","../../chunks/persistableUrlUtils"],(function(e,r,t,s){"use strict";const n={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},l=Object.values(n),i=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${l.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),u=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${l.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),o=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function a(e){return!!i.test(e)}function c(e){if(r.isNone(e))return null;const s=t.urlToObject(e),l=s.path.match(i)||s.path.match(u);if(!l)return null;const[,o,a,c,v]=l,m=a.indexOf("/");return{title:d(-1!==m?a.slice(m+1):a),serverType:n[c.toLowerCase()],sublayer:null!=v&&""!==v?parseInt(v,10):null,url:{path:o}}}function v(e){const r=t.urlToObject(e).path.match(o);return r?{serviceUrl:r[1],sublayerId:Number(r[2])}:null}function d(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function m(e,t){const s=[];if(e){const t=c(e);r.isSome(t)&&t.title&&s.push(t.title)}if(t){const e=d(t);s.push(e)}if(2===s.length){if(s[0].toLowerCase().includes(s[1].toLowerCase()))return s[0];if(s[1].toLowerCase().includes(s[0].toLowerCase()))return s[1]}return s.join(" - ")}function f(e){if(!e)return!1;const r=".arcgis.com/",t="//services",s="//tiles",n="//features",l=(e=e.toLowerCase()).includes(r),i=e.includes(t)||e.includes(s)||e.includes(n);return l&&i}function p(e,r){return e?t.removeTrailingSlash(t.removeQueryParameters(e,r)):e}function S(e){let{url:s}=e;if(!s)return{url:s};s=t.removeQueryParameters(s,e.logger);const n=t.urlToObject(s),l=c(n.path);let i;if(r.isSome(l))null!=l.sublayer&&null==e.layer.layerId&&(i=l.sublayer),s=l.url.path;else if(e.nonStandardUrlAllowed){const e=v(n.path);r.isSome(e)&&(s=e.serviceUrl,i=e.sublayerId)}return{url:t.removeTrailingSlash(s),layerId:i}}function y(e,r,n,l,i){s.write(r,l,"url",i),l.url&&null!=e.layerId&&(l.url=t.join(l.url,n,e.layerId.toString()))}function h(e){if(!e)return!1;const r=e.toLowerCase(),t=r.includes("/services/"),s=r.includes("/mapserver/wmsserver"),n=r.includes("/imageserver/wmsserver"),l=r.includes("/wmsserver");return t&&(s||n||l)}function g(e){if(!e)return!1;const r=new t.Url(t.makeAbsolute(e)).authority?.toLowerCase();return"server.arcgisonline.com"===r||"services.arcgisonline.com"===r}e.cleanTitle=d,e.isArcGISUrl=a,e.isHostedAgolService=f,e.isServerOrServicesAGOLUrl=g,e.isWmsServer=h,e.parse=c,e.parseNonStandardSublayerUrl=v,e.sanitizeUrl=p,e.sanitizeUrlWithLayerId=S,e.serverTypes=l,e.titleFromUrlAndName=m,e.writeUrlWithLayerId=y,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
