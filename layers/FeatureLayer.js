/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["require","../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../PopupTemplate","../renderers/ClassBreaksRenderer","../renderers/DictionaryRenderer","../renderers/DotDensityRenderer","../renderers/HeatmapRenderer","../renderers/PieChartRenderer","../renderers/Renderer","../renderers/SimpleRenderer","../renderers/UniqueValueRenderer","../renderers/support/jsonUtils","../renderers/support/types","../request","../symbols","../core/Clonable","../core/Collection","../core/Error","../core/Handles","../core/lang","../core/Logger","../core/maybe","../core/MultiOriginJSONSupport","../core/object","../core/promiseUtils","../core/sql","../core/urlUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/accessorSupport/decorators/reader","../core/accessorSupport/decorators/subclass","../core/accessorSupport/decorators/writer","../core/accessorSupport/extensions/serializableProperty/reader","../form/FormTemplate","../geometry/SpatialReference","./Layer","./graphics/sources/MemorySource","./mixins/APIKeyMixin","./mixins/ArcGISService","./mixins/BlendLayer","./mixins/CustomParametersMixin","./mixins/EditBusLayer","./mixins/FeatureEffectLayer","./mixins/FeatureLayerBase","./mixins/FeatureReductionLayer","./mixins/OperationalLayer","./mixins/OrderedLayer","./mixins/PortalLayer","./mixins/PublishableLayer","./mixins/RefreshableLayer","./mixins/ScaleRangeLayer","./mixins/TemporalLayer","./support/arcgisLayerUrl","./support/commonProperties","./support/featureLayerUtils","./support/FeatureTemplate","./support/FeatureType","./support/fieldProperties","./support/fieldUtils","./support/LabelClass","./support/labelingInfo","./support/serviceCapabilitiesUtils","./support/TimeInfo","./support/versionUtils","./support/source/DataLayerSource","../renderers/support/styleUtils","../rest/support/FeatureSet","../rest/support/Query","../rest/support/TopFeaturesQuery","../support/popupUtils","../webdoc/support/opacityUtils"],(function(e,r,t,i,o,n,a,s,l,u,p,d,c,y,f,h,m,b,_,g,v,w,T,S,F,I,E,L,D,x,P,j,M,q,O,C,R,G,A,U,V,Q,N,k,B,J,$,W,z,K,H,Z,X,Y,ee,re,te,ie,oe,ne,ae,se,le,ue,pe,de,ce,ye,fe,he,me,be){"use strict";const _e=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"})),ge="FeatureLayer",ve="esri.layers.FeatureLayer",we=w.getLogger(ve);function Te(e,r){return new _("layer:unsupported",`Layer (${e.title}, ${e.id}) of type '${e.declaredClass}' ${r}`,{layer:e})}function Se(e){return e&&e instanceof b}const Fe=oe.defineFieldProperties();function Ie(e,r,t){const i=!!t?.writeLayerSchema;return{enabled:i,ignoreOrigin:i}}let Ee=function(t){function i(...e){var r;return(r=t.call(this,...e)||this)._handles=new g,r.charts=null,r.copyright=null,r.displayField=null,r.dynamicDataSource=null,r.fields=null,r.fieldsIndex=null,r.formTemplate=null,r.fullExtent=null,r.geometryType=null,r.hasM=void 0,r.hasZ=void 0,r.infoFor3D=null,r.isTable=!1,r.labelsVisible=!0,r.labelingInfo=null,r.legendEnabled=!0,r.objectIdField=null,r.outFields=null,r.path=null,r.popupEnabled=!0,r.popupTemplate=null,r.screenSizePerspectiveEnabled=!0,r.spatialReference=C.WGS84,r.subtypeCode=null,r.templates=null,r.timeInfo=null,r.title=null,r.sublayerTitleMode="item-title",r.type="feature",r.typeIdField=null,r.types=null,r.visible=!0,r}r._inheritsLoose(i,t);var o=i.prototype;return o.destroy=function(){this.source?.destroy(),this._handles=T.destroyMaybe(this._handles)},o.normalizeCtorArgs=function(e,r){return"string"==typeof e?{url:e,...r}:e},o.load=function(e){var t=this;const i=T.isSome(e)?e.signal:null;if(this.portalItem?.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(i).then((e=>this.initLayerProperties(e)))),Promise.resolve(this);const o=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]},e).catch(I.throwIfAbortError).then(r._asyncToGenerator((function*(){if(t.url&&null==t.layerId&&/FeatureServer|MapServer\/*$/i.test(t.url)){const e=yield t._fetchFirstLayerId(i);null!=e&&(t.layerId=e)}if(!t.url&&!t._hasMemorySource())throw new _("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return t.initLayerProperties(yield t.createGraphicsSource(i))}))).then((()=>this._setUserPrivileges(this.serviceItemId,e))).then((()=>re.ensureLayerCredential(this,e)));return this.addResolvingPromise(o),Promise.resolve(this)},o.readCapabilities=function(e,r){return r=r.layerDefinition||r,le.getFeatureLayerCapabilities(r,this.url)},o.readEditingEnabled=function(e,r){return this._readEditingEnabled(r,!1)},o.readEditingEnabledFromWebMap=function(e,r,t){return this._readEditingEnabled(r,!0,t)},o.writeEditingEnabled=function(e,r){this._writeEditingEnabled(e,r,!1)},o.writeEditingEnabledToWebMap=function(e,r,t,i){this._writeEditingEnabled(e,r,!0,i)},o.readIsTable=function(e,r){return"Table"===(r=r?.layerDefinition??r).type||!r.geometryType},o.writeIsTable=function(e,r,t,i){i?.writeLayerSchema&&F.setDeepValue(t,e?"Table":"Feature Layer",r)},o.readGlobalIdField=function(e,r){return re.readGlobalIdField(r.layerDefinition||r)},o.readObjectIdField=function(e,r){return re.readObjectIdField(r.layerDefinition||r)},o.readRenderer=function(e,r,t){const i=(r=r.layerDefinition||r).drawingInfo?.renderer;if(i){const e=c.read(i,r,t)??void 0;return e||we.error("Failed to create renderer",{rendererDefinition:r.drawingInfo.renderer,layer:this,context:t}),e}if(r.defaultSymbol)return r.types&&r.types.length?new d({defaultSymbol:Le(r.defaultSymbol,r,t),field:r.typeIdField,uniqueValueInfos:r.types.map((e=>({id:e.id,symbol:Le(e.symbol,e,t)})))}):new p({symbol:Le(r.defaultSymbol,r,t)})},o.castSource=function(e){return e?Array.isArray(e)||e instanceof b?new G.MemorySource({layer:this,items:e}):e:null},o.readSource=function(e,r){const t=ye.fromJSON(r.featureSet);return new G.MemorySource({layer:this,items:t?.features??[]})},o.readTemplates=function(e,r){const t=r.editFieldsInfo,i=t&&t.creatorField,o=t&&t.editorField;return e=e&&e.map((e=>te.fromJSON(e))),this._fixTemplates(e,i),this._fixTemplates(e,o),e},o.readTitle=function(e,r){const t=r.layerDefinition?.name??r.name,i=r.title||r.layerDefinition&&r.layerDefinition.title;if(t){const e=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?Y.titleFromUrlAndName(this.url,t):t;let r=t;if(!r&&this.url){const e=Y.parse(this.url);T.isSome(e)&&(r=e.title)}if(!r)return;return"item-title-and-service-name"===this.sublayerTitleMode&&e&&e!==r&&(r=e+" - "+r),Y.cleanTitle(r)}if("item-title"===this.sublayerTitleMode&&i)return i},o.readTitleFromWebMap=function(e,r){return r.title||r.layerDefinition&&r.layerDefinition.name},o.readTypeIdField=function(e,r){let t=(r=r.layerDefinition||r).typeIdField;if(t&&r.fields){t=t.toLowerCase();const e=r.fields.find((e=>e.name.toLowerCase()===t));e&&(t=e.name)}return t},o.readTypes=function(e,r){e=(r=r.layerDefinition||r).types;const t=r.editFieldsInfo,i=t&&t.creatorField,o=t&&t.editorField;return e&&e.map((e=>(e=ie.fromJSON(e),this._fixTemplates(e.templates,i),this._fixTemplates(e.templates,o),e)))},o.readVisible=function(e,r){return r.layerDefinition&&null!=r.layerDefinition.defaultVisibility?!!r.layerDefinition.defaultVisibility:null!=r.visibility?!!r.visibility:void 0},o.addAttachment=function(){var e=r._asyncToGenerator((function*(e,r){return re.addAttachment(this,e,r,ge)}));function t(r,t){return e.apply(this,arguments)}return t}(),o.updateAttachment=function(){var e=r._asyncToGenerator((function*(e,r,t){return re.updateAttachment(this,e,r,t,ge)}));function t(r,t,i){return e.apply(this,arguments)}return t}(),o.applyEdits=function(){var e=r._asyncToGenerator((function*(e,r){return re.applyEdits(this,e,r)}));function t(r,t){return e.apply(this,arguments)}return t}(),o.on=function(e,r){return t.prototype.on.call(this,e,r)},o.createPopupTemplate=function(e){return me.createPopupTemplate(this,e)},o.createGraphicsSource=function(){var t=r._asyncToGenerator((function*(r){if(this._hasMemorySource()&&this.source)return this.source.load({signal:r});const{default:t}=yield I.whenOrAbort(new Promise(((r,t)=>e(["./graphics/sources/FeatureLayerSource"],(e=>r(_e(e))),t))),r);return new t({layer:this}).load({signal:r})}));function i(e){return t.apply(this,arguments)}return i}(),o.createQuery=function(){const e=re.createQuery(this);e.dynamicDataSource=this.dynamicDataSource;const r=T.isSome(this.subtypeCode)?`${this.subtypeField} = ${this.subtypeCode}`:null,t=E.sqlAnd(this.definitionExpression,r);return e.where=t||"1=1",e},o.deleteAttachments=function(){var e=r._asyncToGenerator((function*(e,r){return re.deleteAttachments(this,e,r,ge)}));function t(r,t){return e.apply(this,arguments)}return t}(),o.fetchRecomputedExtents=function(){var e=r._asyncToGenerator((function*(e){return re.fetchRecomputedExtents(this,e,ge)}));function t(r){return e.apply(this,arguments)}return t}(),o.getFeatureType=function(e){const{typeIdField:r,types:t}=this;if(!r||!e)return null;const i=e.attributes?e.attributes[r]:void 0;if(null==i)return null;let o=null;return t?.some((e=>{const{id:r}=e;return null!=r&&(r.toString()===i.toString()&&(o=e),!!o)})),o},o.getFieldDomain=function(e,r){const t=r&&r.feature,i=this.getFeatureType(t);if(i){const r=i.domains&&i.domains[e];if(r&&"inherited"!==r.type)return r}return this._getLayerDomain(e)},o.getField=function(e){return this.fieldsIndex.get(e)},o.queryAttachments=function(){var e=r._asyncToGenerator((function*(e,r){return re.queryAttachments(this,e,r,ge)}));function t(r,t){return e.apply(this,arguments)}return t}(),o.queryFeatures=function(){var e=r._asyncToGenerator((function*(e,r){const t=yield this.load(),i=yield t.source.queryFeatures(fe.from(e)??t.createQuery(),r);if(i?.features)for(const o of i.features)o.layer=o.sourceLayer=t;return i}));function t(r,t){return e.apply(this,arguments)}return t}(),o.queryObjectIds=function(){var e=r._asyncToGenerator((function*(e,r){return re.queryObjectIds(this,e,r,ge)}));function t(r,t){return e.apply(this,arguments)}return t}(),o.queryFeatureCount=function(){var e=r._asyncToGenerator((function*(e,r){return re.queryFeatureCount(this,e,r,ge)}));function t(r,t){return e.apply(this,arguments)}return t}(),o.queryExtent=function(){var e=r._asyncToGenerator((function*(e,r){return re.queryExtent(this,e,r,ge)}));function t(r,t){return e.apply(this,arguments)}return t}(),o.queryRelatedFeatures=function(){var e=r._asyncToGenerator((function*(e,r){return re.queryRelatedFeatures(this,e,r,ge)}));function t(r,t){return e.apply(this,arguments)}return t}(),o.queryRelatedFeaturesCount=function(){var e=r._asyncToGenerator((function*(e,r){return re.queryRelatedFeaturesCount(this,e,r,ge)}));function t(r,t){return e.apply(this,arguments)}return t}(),o.queryTopFeatures=function(){var e=r._asyncToGenerator((function*(e,r){const{source:t,capabilities:i}=yield this.load();if(!t.queryTopFeatures||!i?.query?.supportsTopFeaturesQuery)throw new _(ge,"Layer source does not support queryTopFeatures capability");const o=yield t.queryTopFeatures(he.from(e),r);if(o?.features)for(const n of o.features)n.layer=n.sourceLayer=this;return o}));function t(r,t){return e.apply(this,arguments)}return t}(),o.queryTopObjectIds=function(){var e=r._asyncToGenerator((function*(e,r){const{source:t,capabilities:i}=yield this.load();if(!t.queryTopObjectIds||!i?.query.supportsTopFeaturesQuery)throw new _(ge,"Layer source does not support queryTopObjectIds capability");return t.queryTopObjectIds(he.from(e),r)}));function t(r,t){return e.apply(this,arguments)}return t}(),o.queryTopFeaturesExtent=function(){var e=r._asyncToGenerator((function*(e,r){const{source:t,capabilities:i}=yield this.load();if(!t.queryTopExtents||!i?.query?.supportsTopFeaturesQuery)throw new _(ge,"Layer source does not support queryTopExtents capability");return t.queryTopExtents(he.from(e),r)}));function t(r,t){return e.apply(this,arguments)}return t}(),o.queryTopFeatureCount=function(){var e=r._asyncToGenerator((function*(e,r){const{source:t,capabilities:i}=yield this.load();if(!t.queryTopCount||!i?.query?.supportsTopFeaturesQuery)throw new _(ge,"Layer source does not support queryFeatureCount capability");return t.queryTopCount(he.from(e),r)}));function t(r,t){return e.apply(this,arguments)}return t}(),o.read=function(e,r){const i=e.featureCollection;if(i){const e=i.layers;e&&1===e.length&&(t.prototype.read.call(this,e[0],r),null!=i.showLegend&&t.prototype.read.call(this,{showLegend:i.showLegend},r))}t.prototype.read.call(this,e,r),r&&"service"===r.origin&&(this.revert(["objectIdField","fields","timeInfo"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))},o.write=function(e,r){r={...r,origin:r?.origin??void 0,writeLayerSchema:r?.writeLayerSchema??this._hasMemorySource()};const{origin:i,layerContainerType:o,messages:n}=r;if(this.dynamicDataSource)return n?.push(Te(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if("web-scene"===i||"web-map"===i&&"tables"!==o)return n?.push(Te(this,"using a table source cannot be written to web scenes and web maps")),null;if(this._hasMemorySource())return n?.push(Te(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&"web-map"===i&&"tables"===o)return n?.push(Te(this,"using a non-table source cannot be written to tables in web maps")),null;return t.prototype.write.call(this,e,r)},o.clone=function(){if(this._hasMemorySource())throw new _(ge,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return t.prototype.clone.call(this)},o.serviceSupportsSpatialReference=function(e){return!!this.loaded&&("memory"===this.source?.type||pe.serviceSupportsSpatialReference(this,e))},o.save=function(){var t=r._asyncToGenerator((function*(r){return(yield new Promise(((r,t)=>e(["./save/featureLayerUtils"],r,t)))).save(this,r)}));function i(e){return t.apply(this,arguments)}return i}(),o.saveAs=function(){var t=r._asyncToGenerator((function*(r,t){return(yield new Promise(((r,t)=>e(["./save/featureLayerUtils"],r,t)))).saveAs(this,r,t)}));function i(e,r){return t.apply(this,arguments)}return i}(),o._readEditingEnabled=function(e,r,t){let i=e.layerDefinition?.capabilities;return i?this._hasEditingCapability(i):(i=e.capabilities,r&&"web-map"===t?.origin&&!this._hasMemorySource()&&i?this._hasEditingCapability(i):void 0)},o._hasEditingCapability=function(e){return e.toLowerCase().split(",").map((e=>e.trim())).includes("editing")},o._writeEditingEnabled=function(e,r,t,i){if(!e){const e=this.capabilities?.operations?.supportsSync?"Query,Sync":"Query";F.setDeepValue("layerDefinition.capabilities",e,r),t&&!i?.writeLayerSchema&&(r.capabilities=e)}},o._getLayerDomain=function(e){const r=this.fieldsIndex.get(e);return r?r.domain:null},o._fetchFirstLayerId=function(e){return f(this.url,{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:e}).then((e=>{const r=e.data;if(r)return Array.isArray(r.layers)&&r.layers.length>0?r.layers[0].id:Array.isArray(r.tables)&&r.tables.length>0?r.tables[0].id:void 0}))},o.initLayerProperties=function(){var e=r._asyncToGenerator((function*(e){return this._set("source",e),e.sourceJSON&&(this.sourceJSON=e.sourceJSON,this.read(e.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:this.portalItem?.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),ne.fixRendererFields(this.renderer,this.fieldsIndex),ne.fixTimeInfoFields(this.timeInfo,this.fieldsIndex),ce.loadStyleRenderer(this,{origin:"service"})}));function t(r){return e.apply(this,arguments)}return t}(),o.hasDataChanged=function(){var e=r._asyncToGenerator((function*(){return re.hasDataChanged(this)}));function t(){return e.apply(this,arguments)}return t}(),o.fetchPublishingStatus=function(){var e=r._asyncToGenerator((function*(){const e=this.source;return e?.fetchPublishingStatus?e.fetchPublishingStatus():"unavailable"}));function t(){return e.apply(this,arguments)}return t}(),o._verifyFields=function(){const e=this.parsedUrl?.path??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||-1!==e.search(/\/FeatureServer\//i)||this.fields?.some((e=>"geometry"===e.type))||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")},o._fixTemplates=function(e,r){e&&e.forEach((e=>{const t=e.prototype&&e.prototype.attributes;t&&r&&delete t[r]}))},o._verifySource=function(){if(this._hasMemorySource()){if(this.url)throw new _("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new _("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")},o._initMemorySource=function(e){e.forEach((e=>{e.layer=this,e.sourceLayer=this})),this._handles.add([e.on("after-add",(e=>{e.item.layer=this,e.item.sourceLayer=this})),e.on("after-remove",(e=>{e.item.layer=null,e.item.sourceLayer=null}))],"fl-source")},o._resetMemorySource=function(e){e.forEach((e=>{e.layer=null,e.sourceLayer=null})),this._handles.remove("fl-source")},o._hasMemorySource=function(){return!(this.url||!this.source)},r._createClass(i,[{key:"createQueryVersion",get:function(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}},{key:"editingEnabled",get:function(){return!(this.loaded&&!this.capabilities?.operations.supportsEditing)&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)},set:function(e){this._overrideIfSome("editingEnabled",e)}},{key:"effectiveEditingEnabled",get:function(){return re.computeEffectiveEditingEnabled(this)}},{key:"parsedUrl",get:function(){const e=L.urlToObject(this.url);return null!=e&&(null!=this.dynamicDataSource?e.path=L.join(e.path,"dynamicLayer"):null!=this.layerId&&(e.path=L.join(e.path,this.layerId.toString()))),e}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",set:function(e){ne.fixRendererFields(e,this.fieldsIndex),this._set("renderer",e)}},{key:"source",set:function(e){const r=this._get("source");r!==e&&(Se(r)&&this._resetMemorySource(r),Se(e)&&this._initMemorySource(e),this._set("source",e))}}]),i}(B.FeatureLayerBase(J.FeatureReductionLayer(k.FeatureEffectLayer(K.PublishableLayer(N.EditBusLayer(V.BlendLayer(W.OrderedLayer(X.TemporalLayer(Z.ScaleRangeLayer(H.RefreshableLayer(U.ArcGISService($.OperationalLayer(z.PortalLayer(S.MultiOriginJSONMixin(Q.CustomParametersMixin(A.APIKeyMixin(m.ClonableMixin(R))))))))))))))))));t.__decorate([P.reader("service","capabilities")],Ee.prototype,"readCapabilities",null),t.__decorate([D.property({json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Ee.prototype,"charts",void 0),t.__decorate([D.property({readOnly:!0})],Ee.prototype,"createQueryVersion",null),t.__decorate([D.property({json:{read:{source:"layerDefinition.copyrightText"}}})],Ee.prototype,"copyright",void 0),t.__decorate([D.property({json:{read:{source:"layerDefinition.displayField"}}})],Ee.prototype,"displayField",void 0),t.__decorate([D.property({types:h.symbolTypes,readOnly:!0})],Ee.prototype,"defaultSymbol",void 0),t.__decorate([D.property({type:de.DataLayerSource})],Ee.prototype,"dynamicDataSource",void 0),t.__decorate([D.property({type:Boolean})],Ee.prototype,"editingEnabled",null),t.__decorate([P.reader(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],Ee.prototype,"readEditingEnabled",null),t.__decorate([P.reader("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],Ee.prototype,"readEditingEnabledFromWebMap",null),t.__decorate([M.writer(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],Ee.prototype,"writeEditingEnabled",null),t.__decorate([M.writer("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],Ee.prototype,"writeEditingEnabledToWebMap",null),t.__decorate([D.property({readOnly:!0})],Ee.prototype,"effectiveEditingEnabled",null),t.__decorate([D.property({...Fe.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:Ie}}}}})],Ee.prototype,"fields",void 0),t.__decorate([D.property(Fe.fieldsIndex)],Ee.prototype,"fieldsIndex",void 0),t.__decorate([D.property({type:O,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],Ee.prototype,"formTemplate",void 0),t.__decorate([D.property({json:{read:{source:"layerDefinition.extent"}}})],Ee.prototype,"fullExtent",void 0),t.__decorate([D.property({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:Ie,writer(e,r,t){const i=e?re.geometryTypeKebabDict.toJSON(e):null;i&&F.setDeepValue(t,i,r)}}}},read:{source:"layerDefinition.geometryType",reader:re.geometryTypeKebabDict.read}}})],Ee.prototype,"geometryType",void 0),t.__decorate([D.property({json:{read:{source:"layerDefinition.hasM"}}})],Ee.prototype,"hasM",void 0),t.__decorate([D.property({json:{read:{source:"layerDefinition.hasZ"}}})],Ee.prototype,"hasZ",void 0),t.__decorate([D.property(ee.id)],Ee.prototype,"id",void 0),t.__decorate([D.property({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],Ee.prototype,"infoFor3D",void 0),t.__decorate([D.property({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],Ee.prototype,"isTable",void 0),t.__decorate([P.reader("service","isTable",["type","geometryType"]),P.reader("isTable",["layerDefinition.type","layerDefinition.geometryType"])],Ee.prototype,"readIsTable",null),t.__decorate([M.writer("web-map","isTable")],Ee.prototype,"writeIsTable",null),t.__decorate([D.property(ee.labelsVisible)],Ee.prototype,"labelsVisible",void 0),t.__decorate([D.property({type:[ae],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:se.reader},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:se.reader},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],Ee.prototype,"labelingInfo",void 0),t.__decorate([D.property((()=>{const e=v.clone(ee.opacityDrawingInfo);return e.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(e,r,t){F.setDeepValue(t,be.opacityToTransparency(e),r)}}},e})())],Ee.prototype,"opacity",void 0),t.__decorate([D.property(ee.legendEnabled)],Ee.prototype,"legendEnabled",void 0),t.__decorate([D.property({type:["show","hide"],json:(()=>{const e=v.clone(ee.listMode.json);return e.origins["portal-item"]={read:!1,write:!1},e})()})],Ee.prototype,"listMode",void 0),t.__decorate([P.reader("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],Ee.prototype,"readGlobalIdField",null),t.__decorate([D.property({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:Ie}}}}})],Ee.prototype,"objectIdField",void 0),t.__decorate([P.reader("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],Ee.prototype,"readObjectIdField",null),t.__decorate([D.property({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],Ee.prototype,"operationalLayerType",void 0),t.__decorate([D.property(Fe.outFields)],Ee.prototype,"outFields",void 0),t.__decorate([D.property({readOnly:!0})],Ee.prototype,"parsedUrl",null),t.__decorate([D.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Ee.prototype,"path",void 0),t.__decorate([D.property(ee.popupEnabled)],Ee.prototype,"popupEnabled",void 0),t.__decorate([D.property({type:i,json:{name:"popupInfo",write:!0}})],Ee.prototype,"popupTemplate",void 0),t.__decorate([D.property({readOnly:!0})],Ee.prototype,"defaultPopupTemplate",null),t.__decorate([D.property({types:y.rendererTypes,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:y.webSceneRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:(e,r,t)=>({ignoreOrigin:t?.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(e,r,t)=>({ignoreOrigin:t?.writeLayerSchema})}}})],Ee.prototype,"renderer",null),t.__decorate([P.reader("service","renderer",["drawingInfo.renderer","defaultSymbol"]),P.reader("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],Ee.prototype,"readRenderer",null),t.__decorate([D.property((()=>{const e=v.clone(ee.screenSizePerspectiveEnabled);return e.json.origins["portal-item"]={read:!1,write:!1},e})())],Ee.prototype,"screenSizePerspectiveEnabled",void 0),t.__decorate([D.property({clonable:!1})],Ee.prototype,"source",null),t.__decorate([x.cast("source")],Ee.prototype,"castSource",null),t.__decorate([P.reader("portal-item","source",["featureSet"]),P.reader("web-map","source",["featureSet"])],Ee.prototype,"readSource",null),t.__decorate([D.property({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],Ee.prototype,"spatialReference",void 0),t.__decorate([D.property({type:Number})],Ee.prototype,"subtypeCode",void 0),t.__decorate([D.property({type:[te]})],Ee.prototype,"templates",void 0),t.__decorate([P.reader("templates",["editFieldsInfo","creatorField","editorField","templates"])],Ee.prototype,"readTemplates",null),t.__decorate([D.property({type:ue})],Ee.prototype,"timeInfo",void 0),t.__decorate([D.property()],Ee.prototype,"title",void 0),t.__decorate([P.reader("service","title",["name"]),P.reader("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],Ee.prototype,"readTitle",null),t.__decorate([P.reader("web-map","title",["layerDefinition.name","title"])],Ee.prototype,"readTitleFromWebMap",null),t.__decorate([D.property({type:String})],Ee.prototype,"sublayerTitleMode",void 0),t.__decorate([D.property({json:{read:!1}})],Ee.prototype,"type",void 0),t.__decorate([D.property({type:String})],Ee.prototype,"typeIdField",void 0),t.__decorate([P.reader("service","typeIdField"),P.reader("typeIdField",["layerDefinition.typeIdField"])],Ee.prototype,"readTypeIdField",null),t.__decorate([D.property({type:[ie]})],Ee.prototype,"types",void 0),t.__decorate([P.reader("service","types",["types"]),P.reader("types",["layerDefinition.types"])],Ee.prototype,"readTypes",null),t.__decorate([D.property({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],Ee.prototype,"visible",void 0),t.__decorate([P.reader("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],Ee.prototype,"readVisible",null),Ee=t.__decorate([j.subclass(ve)],Ee);const Le=q.createTypeReader({types:h.symbolTypesRenderer});return Ee}));
