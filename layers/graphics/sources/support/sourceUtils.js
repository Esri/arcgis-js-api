/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.24/esri/copyright.txt for details.
*/
import{isNone as e}from"../../../../core/maybe.js";import{isValid as t}from"../../../../geometry/support/spatialReferenceUtils.js";import{sanitizeNullFieldValue as n,validateFieldValue as i,validationErrorToString as r,isNumericField as s,isStringField as o}from"../../../support/fieldUtils.js";class l{constructor(){this.code=null,this.description=null}}class u{constructor(e){this.error=new l,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=e}}function a(e){return new u(e)}class c{constructor(e){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=e}}function f(e){return new c(e)}const d=new Set;function m(e,t,n,s=!1,o){d.clear();for(const l in n){const u=e.get(l);if(!u)continue;const c=n[l],f=p(u,c);if(f!==c&&o&&o.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:u,originalValue:c,sanitizedValue:f}}),d.add(u.name),u&&(s||u.editable)){const e=i(u,f);if(e)return a(r(e,u,f));t[u.name]=f}}for(const i of e.requiredFields)if(!d.has(i.name))return a(`missing required field "${i.name}"`);return null}function p(e,t){let i=t;return"string"==typeof t&&s(e)?i=parseFloat(t):null!=t&&o(e)&&"string"!=typeof t&&(i=String(t)),n(i)}let h;function g(n,i){if(!n||!t(i))return n;if("rings"in n||"paths"in n){if(e(h))throw new TypeError("geometry engine not loaded");return h.simplify(i,n)}return n}async function y(){return e(h)&&(h=await import("../../../../geometry/geometryEngineJSON.js")),h}async function w(e,n){!t(e)||"esriGeometryPolygon"!==n&&"esriGeometryPolyline"!==n||await y()}export{a as createFeatureEditErrorResult,f as createFeatureEditSuccessResult,y as loadGeometryEngine,w as loadGeometryEngineForSimplify,m as mixAttributes,g as simplify};
