/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["require","exports","../../../../geometry/support/spatialReferenceUtils","../../../support/fieldUtils"],(function(e,t,i,n){"use strict";let r=function(){this.code=null,this.description=null},l=function(e){this.error=new r,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=e};function s(e){return new l(e)}let o=function(e){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=e};function u(e){return new o(e)}const a=new Set;function c(e,t,i,r,l=!1,o){a.clear();for(const u in r){const t=e.get(u);if(!t)continue;const c=r[u],f=d(t,c);if(f!==c&&o&&o.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:t,originalValue:c,sanitizedValue:f}}),a.add(t.name),t&&(l||t.editable)){const e=n.validateFieldValue(t,f);if(e)return s(n.validationErrorToString(e,t,f));i[t.name]=f}}for(const n of t)if(!a.has(n.name))return s(`missing required field "${n.name}"`);return null}function d(e,t){let i=t;return"string"==typeof t&&n.isNumericField(e)?i=parseFloat(t):null!=t&&n.isStringField(e)&&"string"!=typeof t&&(i=String(t)),n.sanitizeNullFieldValue(i)}let f;function m(e,t){if(!e||!i.isValid(t))return e;if("rings"in e||"paths"in e){if(!f)throw new TypeError("geometry engine not loaded");return f.simplify(t,e)}return e}async function g(){return f||(f=await new Promise((function(t,i){e(["../../../../geometry/geometryEngineJSON"],t,i)})),f)}async function y(e,t){!i.isValid(e)||"esriGeometryPolygon"!==t&&"esriGeometryPolyline"!==t||await g()}t.createFeatureEditErrorResult=s,t.createFeatureEditSuccessResult=u,t.loadGeometryEngine=g,t.loadGeometryEngineForSimplify=y,t.mixAttributes=c,t.simplify=m,Object.defineProperty(t,"__esModule",{value:!0})}));
