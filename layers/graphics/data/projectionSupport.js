/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.20/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../geometry/projection","../../../geometry/geometryAdapters/json","../../../geometry/support/spatialReferenceUtils","../../../geometry/support/webMercatorUtils"],(function(n,e,t,s,r,i){"use strict";const o=[0,0];function a(n,e){if(!e)return null;if("x"in e){const t={x:0,y:0};return[t.x,t.y]=n(e.x,e.y,o),null!=e.z&&(t.z=e.z),null!=e.m&&(t.m=e.m),t}if("xmin"in e){const t={xmin:0,ymin:0,xmax:0,ymax:0};return[t.xmin,t.ymin]=n(e.xmin,e.ymin,o),[t.xmax,t.ymax]=n(e.xmax,e.ymax,o),e.hasZ&&(t.zmin=e.zmin,t.zmax=e.zmax,t.hasZ=!0),e.hasM&&(t.mmin=e.mmin,t.mmax=e.mmax,t.hasM=!0),t}return"rings"in e?{rings:u(e.rings,n),hasM:e.hasM,hasZ:e.hasZ}:"paths"in e?{paths:u(e.paths,n),hasM:e.hasM,hasZ:e.hasZ}:"points"in e?{points:c(e.points,n),hasM:e.hasM,hasZ:e.hasZ}:void 0}function u(n,e){const t=[];for(const s of n)t.push(c(s,e));return t}function c(n,e){const t=[];for(const s of n){const n=e(s[0],s[1],[0,0]);t.push(n),s.length>2&&n.push(s[2]),s.length>3&&n.push(s[3])}return t}function l(n,e){return p.apply(this,arguments)}function p(){return(p=e._asyncToGenerator((function*(n,e){if(!e)return;const s=Array.isArray(n)?n.map((n=>{var e;return null==(e=n.geometry)?void 0:e.spatialReference})):[n];yield t.initializeProjection(s.map((n=>({source:n,dest:e}))))}))).apply(this,arguments)}const h=a.bind(null,i.lngLatToXY),m=a.bind(null,i.xyToLngLat);function f(n,e,o){return n?(o||(o=e,e=n.spatialReference),r.isValid(e)&&r.isValid(o)&&!r.equals(e,o)?i.canProject(e,o)?r.isWebMercator(o)?h(n):m(n):t.projectMany(s.jsonAdapter,[n],e,o,null)[0]:n):n}const y=new(function(){function n(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}var o=n.prototype;return o.push=function(){var n=e._asyncToGenerator((function*(n,e,t){if(!n||!n.length||!e||!t||r.equals(e,t))return n;const s={geometries:n,inSpatialReference:e,outSpatialReference:t,resolve:null};return this._jobs.push(s),new Promise((n=>{s.resolve=n,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}));function t(e,t,s){return n.apply(this,arguments)}return t}(),o._process=function(){this._timer=null;const n=this._jobs.shift();if(!n)return;const{geometries:e,inSpatialReference:o,outSpatialReference:a,resolve:u}=n;i.canProject(o,a)?r.isWebMercator(a)?u(e.map(h)):u(e.map(m)):u(t.projectMany(s.jsonAdapter,e,o,a,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))},n}());function x(n,e,t){return y.push(n,e,t)}n.checkProjectionSupport=l,n.project=f,n.projectMany=x,Object.defineProperty(n,"__esModule",{value:!0})}));
