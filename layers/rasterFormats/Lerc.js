// COPYRIGHT Â© 2021 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.40/esri/copyright.txt for details.

var __createBinding=this&&this.__createBinding||(Object.create?function(e,r,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&__createBinding(r,e,t);return __setModuleDefault(r,e),r},__read=this&&this.__read||function(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,a,i=t.call(e),o=[];try{for(;(void 0===r||r-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(a)throw a.error}}return o};define(["require","exports"],(function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getBlobInfo=r.decode=r.isLoaded=r.load=void 0;var t=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,128]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-34027999387901484e22,34027999387901484e22]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-17976931348623157e292,17976931348623157e292]}],n=null,a=!1;r.load=function(){return n||(n=new Promise((function(r,t){e(["./lerc-wasm"],r,t)})).then(__importStar).then((function(r){return(0,r.default)({locateFile:function(r){return e.toUrl("./"+r)}})})).then((function(e){!function(e){var r,n=e._malloc,a=e._free,o=e._lerc_getBlobInfo,l=e._lerc_getDataRanges,u=e._lerc_decode_4D,s=e.asm,f=Object.values(s).find((function(r){return r&&"buffer"in r&&r.buffer===e.HEAPU8.buffer})),c=function(e){var t=e.map((function(e){return 16+(e>>3<<3)})),a=t.reduce((function(e,r){return e+r})),i=n(a);r=new Uint8Array(f.buffer);var o=t[0];t[0]=i;for(var l=1;l<t.length;l++){var u=t[l];t[l]=t[l-1]+o,o=u}return t};i.getBlobInfo=function(e){var t,n,i=new Uint8Array(48),u=new Uint8Array(24),s=__read(c([e.length,i.length,u.length]),3),d=s[0],y=s[1],h=s[2];r.set(e,d),r.set(i,y),r.set(u,h);var p=o(d,e.length,y,h,12,3);if(p)throw a(d),"lerc-getBlobInfo: error code is ".concat(p);r=new Uint8Array(f.buffer),i.set(r.slice(y,y+i.length)),u.set(r.slice(h,h+u.length));var v=new Uint32Array(i.buffer),g=new Float64Array(u.buffer),b=__read(v,11),_=b[0],m=b[1],w=b[2],A=b[3],U=b[4],x=b[5],T=b[6],C=b[7],D=b[8],V=b[10],I={version:_,dimCount:w,width:A,height:U,validPixelCount:T,bandCount:x,blobSize:C,maskCount:D,dataType:m,minValue:g[0],maxValue:g[1],maxZerror:g[2],statistics:[],bandCountWithNoData:V};if(V)return I;if(1===w&&1===x)return a(d),I.statistics.push({minValue:g[0],maxValue:g[1]}),I;var B,O=w*x*8,z=new Uint8Array(O),S=new Uint8Array(O),F=d,M=0,P=!1;if(r.byteLength<d+2*O?(a(d),P=!0,F=(t=__read(c([e.length,O,O]),3))[0],M=t[1],B=t[2],r.set(e,F)):(M=(n=__read(c([O,O]),2))[0],B=n[1]),r.set(z,M),r.set(S,B),p=l(d,e.length,w,x,M,B))throw a(F),P||a(M),"lerc-getDataRanges: error code is ".concat(p);r=new Uint8Array(f.buffer),z.set(r.slice(M,M+O)),S.set(r.slice(B,B+O));for(var j=new Float64Array(z.buffer),k=new Float64Array(S.buffer),L=I.statistics,N=0;N<x;N++)if(w>1){var R=j.slice(N*w,(N+1)*w),W=k.slice(N*w,(N+1)*w),q=Math.min.apply(null,R),E=Math.max.apply(null,W);L.push({minValue:q,maxValue:E,dimStats:{minValues:R,maxValues:W}})}else L.push({minValue:j[N],maxValue:k[N]});return a(F),P||a(M),I},i.decode=function(e,n){var i=n.maskCount,o=n.dimCount,l=n.bandCount,s=n.width,d=n.height,y=n.dataType,h=n.bandCountWithNoData,p=t[y],v=s*d,g=new Uint8Array(v*l),b=v*o*l*p.size,_=new Uint8Array(b),m=new Uint8Array(l),w=8*l,A=new Uint8Array(w),U=__read(c([e.length,g.length,_.length,m.length,A.length]),5),x=U[0],T=U[1],C=U[2],D=U[3],V=U[4];r.set(e,x),r.set(g,T),r.set(_,C),r.set(m,D),r.set(A,V);var I=u(x,e.length,i,T,o,s,d,l,y,C,D,V);if(I)throw a(x),"lerc-decode: error code is ".concat(I);r=new Uint8Array(f.buffer),_.set(r.slice(C,C+b)),g.set(r.slice(T,T+v));var B=null;if(h){m.set(r.slice(D,D+l)),A.set(r.slice(V,V+w)),B=[];for(var O=0;O<m.length;O++)B.push(m[O]?A[O]:null)}return a(x),{data:_,maskData:g,noDataValues:B}}}(e),a=!0})))},r.isLoaded=function(){return a};var i={getBlobInfo:null,decode:null};function o(e,r,t,n,a){if(t<2)return e;var i=new n(r*t);if(a)for(var o=0,l=0;o<r;o++)for(var u=0,s=o;u<t;u++,s+=r)i[s]=e[l++];else for(o=0,l=0;o<r;o++)for(u=0,s=o;u<t;u++,s+=r)i[l++]=e[s];return i}r.decode=function(e,r){var n;void 0===r&&(r={});for(var a=null!==(n=r.inputOffset)&&void 0!==n?n:0,l=e instanceof Uint8Array?e.subarray(a):new Uint8Array(e,a),u=i.getBlobInfo(l),s=i.decode(l,u),f=s.data,c=s.maskData,d=u.width,y=u.height,h=u.bandCount,p=u.dimCount,v=u.dataType,g=u.maskCount,b=u.statistics,_=t[v],m=new _.ctor(f.buffer),w=[],A=[],U=d*y,x=U*p,T=0;T<h;T++){var C=m.subarray(T*x,(T+1)*x);if(r.returnPixelInterleavedDims)w.push(C);else{var D=o(C,U,p,_.ctor,!0);w.push(D)}A.push(c.subarray(T*x,(T+1)*x))}var V=0===g?null:1===g?A[0]:new Uint8Array(U);if(g>1){V.set(A[0]);for(T=1;T<A.length;T++)for(var I=A[T],B=0;B<U;B++)V[B]=V[B]&I[B]}var O=r.noDataValue,z=null!=O&&_.range[0]<=O&&_.range[1]>=O;if(g>0&&z){var S=r.noDataValue;for(T=0;T<h;T++)for(C=w[T],I=A[T]||V,B=0;B<U;B++)0===I[B]&&(C[B]=S)}var F=g===h&&h>1?A:null;return{width:d,height:y,bandCount:h,pixelType:r.pixelType&&0===u.version?r.pixelType:_.pixelType,dimCount:p,statistics:b,pixels:w,mask:V,bandMasks:F}},r.getBlobInfo=function(e,r){var t,n;void 0===r&&(r={});var a=e instanceof Uint8Array?e.subarray(null!==(t=r.inputOffset)&&void 0!==t?t:0):new Uint8Array(e,null!==(n=r.inputOffset)&&void 0!==n?n:0);return i.getBlobInfo(a)}}));