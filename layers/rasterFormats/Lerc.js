// COPYRIGHT Â© 2022 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/3.42/esri/copyright.txt for details.

var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__read=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o};define(["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBlobInfo=t.decode=t.isLoaded=t.load=void 0;var r=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,128]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-34027999387901484e22,34027999387901484e22]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-17976931348623157e292,17976931348623157e292]}],n=null,a=!1;t.load=function(){return n||(n=new Promise((function(t,r){e(["./lerc-wasm"],t,r)})).then(__importStar).then((function(t){return(0,t.default)({locateFile:function(t){return e.toUrl("./"+t)}})})).then((function(e){!function(e){var t,n=e._malloc,a=e._free,o=e._lerc_getBlobInfo,l=e._lerc_getDataRanges,u=e._lerc_decode_4D,s=e.asm,f=Object.values(s).find((function(t){return t&&"buffer"in t&&t.buffer===e.HEAPU8.buffer})),c=function(e){var r=e.map((function(e){return 16+(e>>3<<3)})),a=r.reduce((function(e,t){return e+t})),i=n(a);t=new Uint8Array(f.buffer);var o=r[0];r[0]=i;for(var l=1;l<r.length;l++){var u=r[l];r[l]=r[l-1]+o,o=u}return r};i.getBlobInfo=function(e){var r,n,i=new Uint8Array(48),u=new Uint8Array(24),s=__read(c([e.length,i.length,u.length]),3),d=s[0],y=s[1],h=s[2];t.set(e,d),t.set(i,y),t.set(u,h);var p=o(d,e.length,y,h,12,3);if(p)throw a(d),"lerc-getBlobInfo: error code is ".concat(p);t=new Uint8Array(f.buffer),i.set(t.slice(y,y+i.length)),u.set(t.slice(h,h+u.length));var v=new Uint32Array(i.buffer),g=new Float64Array(u.buffer),b=__read(v,11),_=b[0],m=b[1],w=b[2],A=b[3],U=b[4],x=b[5],T=b[6],C=b[7],D=b[8],V=b[10],I={version:_,dimCount:w,width:A,height:U,validPixelCount:T,bandCount:x,blobSize:C,maskCount:D,dataType:m,minValue:g[0],maxValue:g[1],maxZerror:g[2],statistics:[],bandCountWithNoData:V};if(V)return I;if(1===w&&1===x)return a(d),I.statistics.push({minValue:g[0],maxValue:g[1]}),I;var B,O=w*x*8,z=new Uint8Array(O),S=new Uint8Array(O),F=d,M=0,P=!1;if(t.byteLength<d+2*O?(a(d),P=!0,F=(r=__read(c([e.length,O,O]),3))[0],M=r[1],B=r[2],t.set(e,F)):(M=(n=__read(c([O,O]),2))[0],B=n[1]),t.set(z,M),t.set(S,B),p=l(d,e.length,w,x,M,B))throw a(F),P||a(M),"lerc-getDataRanges: error code is ".concat(p);t=new Uint8Array(f.buffer),z.set(t.slice(M,M+O)),S.set(t.slice(B,B+O));for(var j=new Float64Array(z.buffer),k=new Float64Array(S.buffer),L=I.statistics,N=0;N<x;N++)if(w>1){var R=j.slice(N*w,(N+1)*w),W=k.slice(N*w,(N+1)*w),q=Math.min.apply(null,R),E=Math.max.apply(null,W);L.push({minValue:q,maxValue:E,dimStats:{minValues:R,maxValues:W}})}else L.push({minValue:j[N],maxValue:k[N]});return a(F),P||a(M),I},i.decode=function(e,n){var i=n.maskCount,o=n.dimCount,l=n.bandCount,s=n.width,d=n.height,y=n.dataType,h=n.bandCountWithNoData,p=r[y],v=s*d,g=new Uint8Array(v*l),b=v*o*l*p.size,_=new Uint8Array(b),m=new Uint8Array(l),w=8*l,A=new Uint8Array(w),U=__read(c([e.length,g.length,_.length,m.length,A.length]),5),x=U[0],T=U[1],C=U[2],D=U[3],V=U[4];t.set(e,x),t.set(g,T),t.set(_,C),t.set(m,D),t.set(A,V);var I=u(x,e.length,i,T,o,s,d,l,y,C,D,V);if(I)throw a(x),"lerc-decode: error code is ".concat(I);t=new Uint8Array(f.buffer),_.set(t.slice(C,C+b)),g.set(t.slice(T,T+g.length));var B=null;if(h){m.set(t.slice(D,D+l)),A.set(t.slice(V,V+w)),B=[];for(var O=0;O<m.length;O++)B.push(m[O]?A[O]:null)}return a(x),{data:_,maskData:g,noDataValues:B}}}(e),a=!0})))},t.isLoaded=function(){return a};var i={getBlobInfo:null,decode:null};function o(e,t,r,n,a){if(r<2)return e;var i=new n(t*r);if(a)for(var o=0,l=0;o<t;o++)for(var u=0,s=o;u<r;u++,s+=t)i[s]=e[l++];else for(o=0,l=0;o<t;o++)for(u=0,s=o;u<r;u++,s+=t)i[l++]=e[s];return i}t.decode=function(e,t){var n;void 0===t&&(t={});for(var a=null!==(n=t.inputOffset)&&void 0!==n?n:0,l=e instanceof Uint8Array?e.subarray(a):new Uint8Array(e,a),u=i.getBlobInfo(l),s=i.decode(l,u),f=s.data,c=s.maskData,d=u.width,y=u.height,h=u.bandCount,p=u.dimCount,v=u.dataType,g=u.maskCount,b=u.statistics,_=r[v],m=new _.ctor(f.buffer),w=[],A=[],U=d*y,x=U*p,T=0;T<h;T++){var C=m.subarray(T*x,(T+1)*x);if(t.returnPixelInterleavedDims)w.push(C);else{var D=o(C,U,p,_.ctor,!0);w.push(D)}A.push(c.subarray(T*x,(T+1)*x))}var V=0===g?null:1===g?A[0]:new Uint8Array(U);if(g>1){V.set(A[0]);for(T=1;T<A.length;T++)for(var I=A[T],B=0;B<U;B++)V[B]=V[B]&I[B]}var O=t.noDataValue,z=null!=O&&_.range[0]<=O&&_.range[1]>=O;if(g>0&&z){var S=t.noDataValue;for(T=0;T<h;T++)for(C=w[T],I=A[T]||V,B=0;B<U;B++)0===I[B]&&(C[B]=S)}var F=g===h&&h>1?A:null;return{width:d,height:y,bandCount:h,pixelType:t.pixelType&&0===u.version?t.pixelType:_.pixelType,dimCount:p,statistics:b,pixels:w,mask:V,bandMasks:F}},t.getBlobInfo=function(e,t){var r,n;void 0===t&&(t={});var a=e instanceof Uint8Array?e.subarray(null!==(r=t.inputOffset)&&void 0!==r?r:0):new Uint8Array(e,null!==(n=t.inputOffset)&&void 0!==n?n:0);return i.getBlobInfo(a)}}));