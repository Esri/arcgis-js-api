/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["exports","../../chunks/_rollupPluginBabelHelpers","../../chunks/tslib.es6","../../core/Logger","../../core/promiseUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/subclass","./refresh"],(function(e,r,t,s,o,a,n,i,c,h){"use strict";function u(e){return e&&"object"==typeof e&&"refreshTimestamp"in e&&"refresh"in e}const p=e=>{let n=function(e){function t(...t){var s;return(s=e.call(this,...t)||this).refreshInterval=0,s.refreshTimestamp=0,s._debounceHasDataChanged=o.debounce((()=>s.hasDataChanged())),s.when().then((()=>{h.registerLayer(r._assertThisInitialized(s))}),(()=>{})),s}r._inheritsLoose(t,e);var a=t.prototype;return a.destroy=function(){h.unregisterLayer(this)},a.refresh=function(e=Date.now()){o.ignoreAbortErrors(this._debounceHasDataChanged()).then((r=>{r&&(this._set("refreshTimestamp",e),this.emit("refresh"))}),(e=>{s.getLogger(this.declaredClass).error(e)}))},a.hasDataChanged=function(){var e=r._asyncToGenerator((function*(){return!0}));function t(){return e.apply(this,arguments)}return t}(),r._createClass(t,[{key:"refreshParameters",get:function(){return{_ts:this.refreshTimestamp||null}}}]),t}(e);return t.__decorate([a.property({type:Number,cast:e=>e>=.1?e:e<=0?0:.1,json:{write:!0,origins:{"web-document":{write:!0}}}})],n.prototype,"refreshInterval",void 0),t.__decorate([a.property({readOnly:!0})],n.prototype,"refreshTimestamp",void 0),t.__decorate([a.property()],n.prototype,"refreshParameters",null),n=t.__decorate([c.subclass("esri.layers.mixins.RefreshableLayer")],n),n};e.RefreshableLayer=p,e.isRefreshableLayer=u,Object.defineProperty(e,"__esModule",{value:!0})}));
