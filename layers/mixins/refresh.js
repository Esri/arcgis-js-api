/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
define(["exports","../../core/Collection","../../core/Error","../../core/Logger","../../core/accessorSupport/watch","../../core/accessorSupport/trackingUtils"],(function(e,r,t,n,o,s){"use strict";const c=new r,i=new WeakMap;function a(e){l(e)&&c.push(e)}function f(e){l(e)&&c.includes(e)&&c.remove(e)}function l(e){return e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e}function u(e,r){return Number.isFinite(e)&&Number.isFinite(r)?r<=0?e:u(r,e%r):0}let h=0,v=0;function g(){const e=Date.now();for(const t of c)if(t.refreshInterval){var r;e-(null!=(r=i.get(t))?r:0)+5>=6e4*t.refreshInterval&&(i.set(t,e),t.refresh(e))}}s.autorun((()=>{const e=Date.now();let r=0;for(const t of c)r=u(Math.round(6e4*t.refreshInterval),r),t.refreshInterval?i.get(t)||i.set(t,e):i.delete(t);if(r!==v){if(v=r,clearInterval(h),0===v)return void(h=0);h=setInterval(g,v)}}));const d={get hasRefreshTimer(){return h>0},get tickInterval(){return v},forceRefresh(){g()},hasLayer:e=>l(e)&&c.includes(e),clear(){for(const e of c)i.delete(e);c.removeAll()}};e.registerLayer=a,e.test=d,e.unregisterLayer=f,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
