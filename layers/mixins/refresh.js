/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../core/Collection","../../chunks/_rollupPluginBabelHelpers","../../core/has","../../core/Error","../../core/Logger","../../core/accessorSupport/watch","../../core/accessorSupport/trackingUtils"],(function(e,r,t,n,o,s,c,i){"use strict";const l=new r,a=new WeakMap;function u(e){h(e)&&l.push(e)}function f(e){h(e)&&l.includes(e)&&l.remove(e)}function h(e){return null!=e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e}function g(e,r){return Number.isFinite(e)&&Number.isFinite(r)?r<=0?e:g(r,e%r):0}let v=0,p=0;function d(){const e=Date.now();for(const r of l)if(r.refreshInterval){e-(a.get(r)??0)+5>=6e4*r.refreshInterval&&(a.set(r,e),r.refresh(e))}}i.autorun((()=>{const e=Date.now();let r=0;for(const t of l)r=g(Math.round(6e4*t.refreshInterval),r),t.refreshInterval?a.get(t)||a.set(t,e):a.delete(t);if(r!==p){if(p=r,clearInterval(v),0===p)return void(v=0);v=setInterval(d,p)}}));const I={get hasRefreshTimer(){return v>0},get tickInterval(){return p},forceRefresh(){d()},hasLayer:e=>h(e)&&l.includes(e),clear(){for(const e of l)a.delete(e);l.removeAll()}};e.registerLayer=u,e.test=I,e.unregisterLayer=f,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
