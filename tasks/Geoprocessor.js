/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.19/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../core/has","../core/Logger","../core/accessorSupport/ensureType","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/subclass","../core/urlUtils","../core/uuid","../portal/support/resourceExtension","../geometry/SpatialReference","../geometry/Extent","./Task","../rest/geoprocessor/GPOptions","../rest/geoprocessor/execute","../rest/geoprocessor/submitJob"],(function(e,t,r,o,s,n,u,c,i,p,a,l,h,f,b,_){"use strict";let y=function(t){function r(e){var r;return(r=t.call(this,e)||this)._jobs=new Map,r.outSpatialReference=null,r.processExtent=null,r.processSpatialReference=null,r.returnFeatureCollection=!1,r.returnM=!1,r.returnZ=!1,r}e._inheritsLoose(r,t);var o=r.prototype;return o.destroy=function(){this._jobs.forEach((e=>e.destroy())),this._jobs.clear()},o.cancelJob=function(e,t){const r=this._jobs.get(e),o={...this.requestOptions,...t};return r.cancelJob(o)},o.checkJobStatus=function(e,t){const r=this._jobs.get(e),o={...this.requestOptions,...t};return r.checkJobStatus(o)},o.execute=function(e,t){const r=new f({outSpatialReference:this.outSpatialReference,processExtent:this.processExtent,processSpatialReference:this.processSpatialReference,returnFeatureCollection:this.returnFeatureCollection,returnM:this.returnM,returnZ:this.returnZ}),o={...this.requestOptions,...t};return b.execute(this.url,e,r,o)},o.getResultData=function(e,t,r){const o=this._jobs.get(e),{returnFeatureCollection:s,returnM:n,returnZ:u,outSpatialReference:c}=this,i=new f({returnFeatureCollection:s,returnM:n,returnZ:u,outSpatialReference:c,url:this.url}),p={...this.requestOptions,...r};return o.fetchResultData(t,i,p)},o.getResultImage=function(e,t,r,o){const s=this._jobs.get(e),n={...this.requestOptions,...o};return s.fetchResultImage(t,r,n)},o.getResultMapImageLayer=async function(e){return this._jobs.get(e).fetchResultMapImageLayer()},o.submitJob=function(e,t){const r=new f({outSpatialReference:this.outSpatialReference,processExtent:this.processExtent,processSpatialReference:this.processSpatialReference,returnFeatureCollection:this.returnFeatureCollection,returnM:this.returnM,returnZ:this.returnZ}),o={...this.requestOptions,...t};return _.submitJob(this.url,e,r,o).then((e=>(e.sourceUrl=this.url,this._jobs.set(e.jobId,e),e)))},o.waitForJobCompletion=function(e,t={}){return this._jobs.get(e).waitForJobCompletion(t)},r}(h);return t.__decorate([n.property({type:a})],y.prototype,"outSpatialReference",void 0),t.__decorate([n.property({type:l})],y.prototype,"processExtent",void 0),t.__decorate([n.property({type:a})],y.prototype,"processSpatialReference",void 0),t.__decorate([n.property({nonNullable:!0})],y.prototype,"returnFeatureCollection",void 0),t.__decorate([n.property({nonNullable:!0})],y.prototype,"returnM",void 0),t.__decorate([n.property({nonNullable:!0})],y.prototype,"returnZ",void 0),y=t.__decorate([u.subclass("esri/tasks/Geoprocessor")],y),y}));
