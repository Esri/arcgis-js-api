/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.21/esri/copyright.txt for details.
*/
define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","../Color","../core/lang","../core/accessorSupport/decorators/aliasOf","../core/accessorSupport/ensureType","../core/has","../core/Logger","../core/accessorSupport/decorators/enumeration","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/subclass","../layers/support/fieldUtils","./Renderer","./mixins/VisualVariablesMixin","./support/AttributeColorInfo","./support/DotDensityLegendOptions","../symbols/SimpleFillSymbol","../symbols/SimpleLineSymbol"],(function(e,t,o,r,n,i,s,l,a,u,p,c,d,y,h,b,f,g){"use strict";var S;let _=S=function(t){function n(e){var r;return(r=t.call(this,e)||this).attributes=null,r.backgroundColor=new o([0,0,0,0]),r.blendDots=!0,r.dotBlendingEnabled=!0,r.dotShape="square",r.dotSize=1,r.legendOptions=null,r.outline=new g,r.dotValue=null,r.referenceDotValue=null,r.referenceScale=null,r.seed=1,r.type="dot-density",r}e._inheritsLoose(n,t);var i=n.prototype;return i.calculateDotValue=function(e){if(null==this.referenceScale)return this.dotValue;const t=e/this.referenceScale*this.dotValue;return t<1?1:t},i.getSymbol=function(){return new f({outline:this.outline})},i.getSymbolAsync=function(){var t=e._asyncToGenerator((function*(){return this.getSymbol()}));function o(){return t.apply(this,arguments)}return o}(),i.getSymbols=function(){return[this.getSymbol()]},i.getAttributeHash=function(){return this.attributes&&this.attributes.reduce(((e,t)=>e+t.getAttributeHash()),"")},i.getMeshHash=function(){return JSON.stringify(this.outline)},i.clone=function(){return new S({attributes:r.clone(this.attributes),backgroundColor:r.clone(this.backgroundColor),dotBlendingEnabled:r.clone(this.dotBlendingEnabled),dotShape:r.clone(this.dotShape),dotSize:r.clone(this.dotSize),dotValue:r.clone(this.dotValue),legendOptions:r.clone(this.legendOptions),outline:r.clone(this.outline),referenceScale:r.clone(this.referenceScale),visualVariables:r.clone(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})},i.getControllerHash=function(){return`${this.attributes.map((e=>e.field||e.valueExpression||""))}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`},i.collectRequiredFields=function(){var t=e._asyncToGenerator((function*(e,t){yield this.collectVVRequiredFields(e,t);for(const o of this.attributes)o.valueExpression&&(yield c.collectArcadeFieldNames(e,t,o.valueExpression)),o.field&&e.add(o.field)}));function o(e,o){return t.apply(this,arguments)}return o}(),n}(y.VisualVariablesMixin(d));return t.__decorate([u.property({type:[h],json:{write:!0}})],_.prototype,"attributes",void 0),t.__decorate([u.property({type:o,json:{write:!0}})],_.prototype,"backgroundColor",void 0),t.__decorate([u.property({type:Boolean}),n.aliasOf("dotBlendingEnabled")],_.prototype,"blendDots",void 0),t.__decorate([u.property({type:Boolean,json:{write:!0}})],_.prototype,"dotBlendingEnabled",void 0),t.__decorate([u.property({type:String,json:{write:!1}})],_.prototype,"dotShape",void 0),t.__decorate([u.property({type:Number,json:{write:!1}})],_.prototype,"dotSize",void 0),t.__decorate([u.property({type:b,json:{write:!0}})],_.prototype,"legendOptions",void 0),t.__decorate([u.property({type:g,json:{default:null,write:!0}})],_.prototype,"outline",void 0),t.__decorate([u.property({type:Number,json:{write:!0}})],_.prototype,"dotValue",void 0),t.__decorate([u.property({type:Number}),n.aliasOf("dotValue")],_.prototype,"referenceDotValue",void 0),t.__decorate([u.property({type:Number,json:{write:!0}})],_.prototype,"referenceScale",void 0),t.__decorate([u.property({type:Number,json:{write:!0}})],_.prototype,"seed",void 0),t.__decorate([a.enumeration({dotDensity:"dot-density"})],_.prototype,"type",void 0),_=S=t.__decorate([p.subclass("esri.renderers.DotDensityRenderer")],_),_}));
