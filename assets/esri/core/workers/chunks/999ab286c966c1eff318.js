self.webpackChunkRemoteClient([9,157],{104:function(e,t,r){"use strict";r.d(t,"a",(function(){return Y})),r.d(t,"b",(function(){return U})),r.d(t,"c",(function(){return V})),r.d(t,"d",(function(){return Z})),r.d(t,"e",(function(){return Q})),r.d(t,"f",(function(){return B})),r.d(t,"g",(function(){return $})),r.d(t,"h",(function(){return J})),r.d(t,"i",(function(){return R})),r.d(t,"j",(function(){return _})),r.d(t,"k",(function(){return z})),r.d(t,"l",(function(){return C})),r.d(t,"m",(function(){return oe})),r.d(t,"n",(function(){return K})),r.d(t,"o",(function(){return re})),r.d(t,"p",(function(){return ae})),r.d(t,"q",(function(){return H})),r.d(t,"r",(function(){return W})),r.d(t,"s",(function(){return y})),r.d(t,"t",(function(){return v})),r.d(t,"u",(function(){return se})),r.d(t,"v",(function(){return ne}));var n=r(3),s=r(14),i=r(61),a=r(175),o=r(260),u=r(130);function l(e,t){return e?t?4:3:t?3:2}const c=n.a.getLogger("esri.tasks.support.optimizedFeatureSet"),h={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},f=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i},d=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i,e[r+2]=t[n+2]},p=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i,e[r+2]=t[n+3]},m=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i,e[r+2]=t[n+2],e[r+3]=t[n+3]};function g(e,t,r,n){if(e){if(r)return t&&n?m:d;if(t&&n)return p}else if(t&&n)return d;return f}function y({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function v({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function b({scale:e,translate:t},r){return r*e[0]+t[0]}function x({scale:e,translate:t},r){return t[1]-r*e[1]}function _(e,t,r){return e?t?r?T(e):S(e):r?M(e):w(e):null}function w(e){const t=e.coords;return{x:t[0],y:t[1]}}function I(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function S(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function N(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function M(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function O(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function T(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function F(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function A(e,t){return e&&t?F:e?N:t?O:I}function E(e,t,r,n,s){const i=A(r,n);for(const r of t){const{geometry:t,attributes:n}=r;let o;t&&(o=i(new u.a,t)),e.push(new a.a(o,n,null,n[s]))}return e}function R(e,t,r){if(!e)return null;const n=l(t,r),s=[];for(let t=0;t<e.coords.length;t+=n){const r=[];for(let s=0;s<n;s++)r.push(e.coords[t+s]);s.push(r)}return t?r?{points:s,hasZ:t,hasM:r}:{points:s,hasZ:t}:r?{points:s,hasM:r}:{points:s}}function j(e,t,r,n,s){const i=l(r,n);for(const r of t){const t=r.geometry,n=r.attributes;let o;t&&(o=P(new u.a,t,i)),e.push(new a.a(o,n,null,n[s]))}return e}function P(e,t,r=l(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const n=e.coords;let s=0;for(const e of t.points)for(let t=0;t<r;t++)n[s++]=e[t];return e}function C(e,t,r){if(!e)return null;const n=l(t,r),{coords:s,lengths:i}=e,a=[];let o=0;for(const e of i){const t=[];for(let r=0;r<e;r++){const e=[];for(let t=0;t<n;t++)e.push(s[o++]);t.push(e)}a.push(t)}return t?r?{paths:a,hasZ:t,hasM:r}:{paths:a,hasZ:t}:r?{paths:a,hasM:r}:{paths:a}}function G(e,t,r,n,s){const i=l(r,n);for(const r of t){const t=r.geometry,n=r.attributes;let o;t&&(o=L(new u.a,t,i)),e.push(new a.a(o,n,null,n[s]))}return e}function L(e,t,r=l(t.hasZ,t.hasM)){const{lengths:n,coords:s}=e;let i=0;for(const e of t.paths){for(const t of e)for(let e=0;e<r;e++)s[i++]=t[e];n.push(e.length)}return e}function z(e,t,r){if(!e)return null;const n=l(t,r),{coords:s,lengths:i}=e,a=[];let o=0;for(const e of i){const t=[];for(let r=0;r<e;r++){const e=[];for(let t=0;t<n;t++)e.push(s[o++]);t.push(e)}a.push(t)}return t?r?{rings:a,hasZ:t,hasM:r}:{rings:a,hasZ:t}:r?{rings:a,hasM:r}:{rings:a}}function D(e,t,r,n,s){for(const i of t){const t=i.geometry,o=i.centroid,l=i.attributes;let c;t&&(c=Q(new u.a,t,r,n)),o?e.push(new a.a(c,l,I(new u.a,o),l[s])):e.push(new a.a(c,l,null,l[s]))}return e}function Q(e,t,r=t.hasZ,n=t.hasM){return function(e,t,r,n){const s=l(r,n),{lengths:i,coords:a}=e;let o=0;i.length=a.length=0;for(const e of t){for(const t of e)for(let e=0;e<s;e++)a[o++]=t[e];i.push(e.length)}}(e,t.rings,r,n),e}const q=[],k=[];function Y(e,t,r,n,s){q[0]=e;const[i]=V(k,q,t,r,n,s);return q.length=k.length=0,i}function V(e,t,r,n,i,o){if(e.length=0,!r){for(const r of t){const t=r.attributes[o];e.push(new a.a(null,r.attributes,null,t))}return e}switch(r){case"esriGeometryPoint":return E(e,t,n,i,o);case"esriGeometryMultipoint":return j(e,t,n,i,o);case"esriGeometryPolyline":return G(e,t,n,i,o);case"esriGeometryPolygon":return D(e,t,n,i,o);default:c.error("convertToFeatureSet:unknown-geometry",new s.a(`Unable to parse unknown geometry type '${r}'`)),e.length=0}return e}function B(e,t,r,n){k[0]=e,X(q,k,t,r,n);const s=q[0];return q.length=k.length=0,s}function Z(e,t,r){if(!e)return null;const n=new u.a;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==r&&(r=e.hasM),Object(i.f)(e)?A(null!=t?t:null!=e.z,null!=r?r:null!=e.m)(n,e):Object(i.g)(e)?Q(n,e,t,r):Object(i.h)(e)?L(n,e,l(t,r)):Object(i.e)(e)?P(n,e,l(t,r)):void c.error("convertFromGeometry:unknown-geometry",new s.a(`Unable to parse unknown geometry type '${e}'`))}function J(e,t,r,n){const i=e&&("coords"in e?e:e.geometry);if(!i)return null;switch(t){case"esriGeometryPoint":{let e=w;return r&&n?e=T:r?e=S:n&&(e=M),e(i)}case"esriGeometryMultipoint":return R(i,r,n);case"esriGeometryPolyline":return C(i,r,n);case"esriGeometryPolygon":return z(i,r,n);default:return void c.error("convertToGeometry:unknown-geometry",new s.a(`Unable to parse unknown geometry type '${t}'`))}}function X(e,t,r,n,i){switch(e.length=0,r){case"esriGeometryPoint":return function(e,t,r,n){let s=w;r&&n?s=T:r?s=S:n&&(s=M);for(const r of t){const{geometry:t,attributes:n}=r,i=t?s(t):null;e.push({attributes:n,geometry:i})}return e}(e,t,n,i);case"esriGeometryMultipoint":return function(e,t,r,n){for(const s of t){const{geometry:t,attributes:i}=s;let a;t&&(a=R(t,r,n)),e.push({attributes:i,geometry:a})}return e}(e,t,n,i);case"esriGeometryPolyline":return function(e,t,r,n){for(const s of t){const{geometry:t,attributes:i}=s;let a;t&&(a=C(t,r,n)),e.push({attributes:i,geometry:a})}return e}(e,t,n,i);case"esriGeometryPolygon":return function(e,t,r,n){for(const s of t){const{geometry:t,attributes:i,centroid:a}=s;let o;if(t&&(o=z(t,r,n)),a){const t=w(a);e.push({attributes:i,centroid:t,geometry:o})}else e.push({attributes:i,geometry:o})}return e}(e,t,n,i);default:c.error("convertToFeatureSet:unknown-geometry",new s.a(`Unable to parse unknown geometry type '${r}'`))}return e}function $(e){const{objectIdFieldName:t,spatialReference:r,transform:n,fields:s,hasM:i,hasZ:a,features:o,geometryType:u,exceededTransferLimit:l,uniqueIdField:c,queryGeometry:h,queryGeometryType:f}=e,d={features:X([],o,u,a,i),fields:s,geometryType:u,objectIdFieldName:t,spatialReference:r,uniqueIdField:c,queryGeometry:J(h,f,!1,!1)};return n&&(d.transform=n),l&&(d.exceededTransferLimit=l),i&&(d.hasM=i),a&&(d.hasZ=a),d}function U(e,t){const r=new o.a,{hasM:n,hasZ:i,features:a,objectIdFieldName:u,spatialReference:l,geometryType:h,exceededTransferLimit:f,transform:d,fields:p}=e;return p&&(r.fields=p),r.geometryType=h,r.objectIdFieldName=u||t,r.spatialReference=l,r.objectIdFieldName?(a&&V(r.features,a,h,i,n,r.objectIdFieldName),f&&(r.exceededTransferLimit=f),n&&(r.hasM=n),i&&(r.hasZ=i),d&&(r.transform=d),r):(c.error(new s.a("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r)}function H(e,t){const{geometryType:r,features:n,hasM:s,hasZ:i}=t;if(!e)return t;for(let t=0;t<n.length;t++){const a=n[t],o=a.weakClone();o.geometry=new u.a,W(o.geometry,a.geometry,s,i,r,e),a.centroid&&(o.centroid=new u.a,W(o.centroid,a.centroid,s,i,"esriGeometryPoint",e)),n[t]=o}return t.transform=e,t}function W(e,t,r,n,s,i,a=r,o=n){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const u=h[s],{coords:c,lengths:f}=t,d=l(r,n),p=l(r&&a,n&&o),m=g(r,n,a,o);if(!f.length)return m(e.coords,c,0,0,y(i,c[0]),v(i,c[1])),e.lengths.length&&(e.lengths.length=0),e.coords.length=d,e;let b,x,_,w,I=0,S=0,N=S;for(const t of f){if(t<u)continue;let r=0;S=N,_=b=y(i,c[I]),w=x=v(i,c[I+1]),m(e.coords,c,S,I,_,w),r++,I+=d,S+=p;for(let n=1;n<t;n++,I+=d)_=y(i,c[I]),w=v(i,c[I+1]),_===b&&w===x||(m(e.coords,c,S,I,_-b,w-x),S+=p,r++,b=_,x=w);r>=u&&(e.lengths.push(r),N=S)}return e.coords.length=N,e.coords.length?e:null}function K(e,t,r,n,s,i,a=r,o=n){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const u=h[s],{coords:c,lengths:f}=t,d=l(r,n),p=l(r&&a,n&&o),m=g(r,n,a,o);if(!f.length)return m(e.coords,c,0,0,c[0],c[1]),e.lengths.length&&(e.lengths.length=0),e.coords.length=d,e;let y=0;const v=i*i;for(const t of f){if(t<u){y+=t*d;continue}const r=e.coords.length/p,n=y,s=y+(t-1)*d;m(e.coords,c,e.coords.length,n,c[n],c[n+1]),te(e.coords,c,d,v,m,n,s),m(e.coords,c,e.coords.length,s,c[s],c[s+1]);const i=e.coords.length/p-r;i>=u?e.lengths.push(i):e.coords.length=r*p,y+=t*d}return e.coords.length?e:null}function ee(e,t,r,n){const s=e[t],i=e[t+1],a=e[r],o=e[r+1],u=e[n],l=e[n+1];let c=a,h=o,f=u-c,d=l-h;if(0!==f||0!==d){const e=((s-c)*f+(i-h)*d)/(f*f+d*d);e>1?(c=u,h=l):e>0&&(c+=f*e,h+=d*e)}return f=s-c,d=i-h,f*f+d*d}function te(e,t,r,n,s,i,a){let o,u=n,l=0;for(let e=i+r;e<a;e+=r)o=ee(t,e,i,a),o>u&&(l=e,u=o);u>n&&(l-i>r&&te(e,t,r,n,s,i,l),s(e,t,e.length,l,t[l],t[l+1]),a-l>r&&te(e,t,r,n,s,l,a))}function re(e,t,r,n){if(!t||!t.coords||!t.coords.length)return null;const s=l(r,n);let i=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY;if(t&&t.coords){const e=t.coords;for(let t=0;t<e.length;t+=s){const r=e[t],n=e[t+1];i=Math.min(i,r),o=Math.max(o,r),a=Math.min(a,n),u=Math.max(u,n)}}return e[0]=i,e[1]=a,e[2]=o,e[3]=u,e}function ne(e,t,r,n,s){const{coords:i,lengths:a}=t,o=r?n?m:d:n?d:f,u=l(r,n);if(!i.length)return e!==t&&(e.lengths.length=0,e.coords.length=0),e;if(!a.length)return o(e.coords,i,0,0,b(s,i[0]),x(s,i[1])),e!==t&&(e.lengths.length=0,e.coords.length=u),e;const[c,h]=s.scale;let p=0;for(let t=0;t<a.length;t++){const r=a[t];e.lengths[t]=r;let n=b(s,i[p]),l=x(s,i[p+1]);o(e.coords,i,p,p,n,l),p+=u;for(let t=1;t<r;t++,p+=u)n+=i[p]*c,l-=i[p+1]*h,o(e.coords,i,p,p,n,l)}return e!==t&&(e.lengths.length=a.length,e.coords.length=i.length),e}function se(e,t,r,n,s,i){const a=l(r,n),o=g(r,n,s,i),u=t.coords;e.coords.length=0,e.lengths.length=0,e.lengths.push(...t.lengths);for(let t=0;t<u.length;t+=a)o(e.coords,u,e.coords.length,t,u[t],u[t+1]);return e}function ie(e,t,r,n){let s=0,i=e[n*t],a=e[n*(t+1)];for(let o=1;o<r;o++){const r=i+e[n*(t+o)],u=a+e[n*(t+o)+1],l=(r-i)*(u+a);i=r,a=u,s+=l}return.5*s}function ae(e,t){const{coords:r,lengths:n}=e;let s=0,i=0;for(let e=0;e<n.length;e++)i+=ie(r,s,n[e],t),s+=e;return Math.abs(i)}function oe(e,t){const r=e.clone(),n=e.coords,s=e.lengths;let i=0;for(let e=0;e<s.length;e++){const a=s[e];let o=n[t*i],u=n[t*i+1];for(let e=1;e<a;e++){const s=o+n[t*(i+e)],a=u+n[t*(i+e)+1];r.coords[t*(i+e)]=s,r.coords[t*(i+e)+1]=a,o=s,u=a}i+=a}return r}},130:function(e,t,r){"use strict";class n{constructor(e=[],t=[],r=!1){this.lengths=null!=e?e:[],this.coords=null!=t?t:[],this.hasIndeterminateRingOrder=r}get isPoint(){return 0===this.lengths.length}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let r=0;r<this.lengths.length;r++){const n=this.lengths[r];for(let r=0;r<n;r++)e(this.coords[2*(r+t)],this.coords[2*(r+t)+1]);t+=n}}clone(){return new n(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}t.a=n},138:function(e,t,r){"use strict";r.r(t),r.d(t,"WhereClause",(function(){return _})),r.d(t,"defaultAttributeAdapter",(function(){return G}));var n=r(7);const s={min:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.min.apply(Math,e[0])},max:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.max.apply(Math,e[0])},avg:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:i(e[0])},sum:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:function(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t}(e[0])},stddev:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sqrt(a(e[0]))},count:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].length},var:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:a(e[0])}};function i(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t/e.length}function a(e){const t=i(e),r=e.length;let n=0;for(const r of e)n+=Math.pow(r-t,2);return r>1?n/(r-1):0}var o=r(37);class u{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0}static fixDefaults(e){if(null!==e.precision||null!==e.secondary)throw new Error("Primary and Secondary SqlInterval qualifiers not supported")}static createFromMilliseconds(e){const t=new u;return t.second=e/1e3,t}static createFromValueAndQualifer(e,t,r){let n=null;const s=new u;if(s.op="-"===r?"-":"+","interval-period"===t.type){u.fixDefaults(t);const r=new RegExp("^[0-9]{1,}$");if("year"===t.period||"month"===t.period)throw new Error("Year-Month Intervals not supported");if(!r.test(e))throw new Error("Illegal Interval");s[t.period]=parseFloat(e)}else{if(u.fixDefaults(t.start),u.fixDefaults(t.end),"year"===t.start.period||"month"===t.start.period)throw new Error("Year-Month Intervals not supported");if("year"===t.end.period||"month"===t.end.period)throw new Error("Year-Month Intervals not supported");switch(t.start.period){case"day":switch(t.end.period){case"hour":if(n=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!n.test(e))throw new Error("Illegal Interval");s[t.start.period]=parseFloat(e.split(" ")[0]),s[t.end.period]=parseFloat(e.split(" ")[1]);break;case"minute":if(n=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!n.test(e))throw new Error("Illegal Interval");{s[t.start.period]=parseFloat(e.split(" ")[0]);const r=e.split(" ")[1].split(":");s.hour=parseFloat(r[0]),s.minute=parseFloat(r[1])}break;case"second":if(n=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(e))throw new Error("Illegal Interval");{s[t.start.period]=parseFloat(e.split(" ")[0]);const r=e.split(" ")[1].split(":");s.hour=parseFloat(r[0]),s.minute=parseFloat(r[1]),s.second=parseFloat(r[2])}break;default:throw"Invalid Interval."}break;case"hour":switch(t.end.period){case"minute":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!n.test(e))throw new Error("Illegal Interval");s.hour=parseFloat(e.split(":")[0]),s.minute=parseFloat(e.split(":")[1]);break;case"second":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(e))throw new Error("Illegal Interval");{const t=e.split(":");s.hour=parseFloat(t[0]),s.minute=parseFloat(t[1]),s.second=parseFloat(t[2])}break;default:throw"Invalid Interval."}break;case"minute":switch(t.end.period){case"second":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(e))throw new Error("Illegal Interval");{const t=e.split(":");s.minute=parseFloat(t[0]),s.second=parseFloat(t[1])}break;default:throw"Invalid Interval."}break;default:throw"Invalid Interval."}}return s}valueInMilliseconds(){return("-"===this.op?-1:1)*(1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}function l(e,t){const r=c[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)}const c={extract:{minParams:2,maxParams:2,evaluate:([e,t])=>{if(null==t)return null;if(t instanceof Date)switch(e.toUpperCase()){case"SECOND":return t.getSeconds();case"MINUTE":return t.getMinutes();case"HOUR":return t.getHours();case"DAY":return t.getDate();case"MONTH":return t.getMonth()+1;case"YEAR":return t.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:e=>{if(2===e.length){const[t,r]=e;return null==t||null==r?null:t.toString().substring(r-1)}if(3===e.length){const[t,r,n]=e;return null==t||null==r||null==n?null:n<=0?"":t.toString().substring(r-1,r+n-1)}}},position:{minParams:2,maxParams:2,evaluate:([e,t])=>null==e||null==t?null:t.indexOf(e)+1},trim:{minParams:2,maxParams:3,evaluate:e=>{const t=3===e.length,r=t?e[1]:" ",n=t?e[2]:e[1];if(null==r||null==n)return null;const s=`(${Object(o.a)(r)})`;switch(e[0]){case"BOTH":return n.replace(new RegExp(`^${s}*|${s}*$`,"g"),"");case"LEADING":return n.replace(new RegExp(`^${s}*`,"g"),"");case"TRAILING":return n.replace(new RegExp(s+"*$","g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.abs(e[0])},ceiling:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.ceil(e[0])},floor:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.floor(e[0])},log:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])},log10:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sin(e[0])},cos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cos(e[0])},tan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tan(e[0])},asin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.asin(e[0])},acos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.acos(e[0])},atan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.atan(e[0])},sign:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0]>0?1:e[1]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:Math.pow(e[0],e[1])},mod:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]%e[1]},round:{minParams:1,maxParams:2,evaluate:e=>{const t=e[0],r=2===e.length?Math.pow(10,e[1]):1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:e=>null==e[0]?null:1===e.length?parseInt(e[0].toFixed(0),10):parseFloat(e[0].toFixed(e[1]))},char_length:{minParams:1,maxParams:1,evaluate:e=>"string"==typeof e[0]||e[0]instanceof String?e[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:e=>{let t="";for(let r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toUpperCase()}};var h=r(69),f=Object(h.b)((function(e){e.exports&&(e.exports=function(){function e(t,r,n,s){this.message=t,this.expected=r,this.found=n,this.location=s,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){var r={literal:function(e){return'"'+s(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function s(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){return r[e.type](e)}return"Expected "+function(e){var t,r,n=new Array(e.length);for(t=0;t<e.length;t++)n[t]=a(e[t]);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+function(e){return e?'"'+s(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){r=void 0!==r?r:{};var n,s={},i={start:Be},a=Be,o=function(e,t){var r={type:"expr_list"},n=function(e,t,r){return function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n][3]);return r}(e,t)}(e,t);return r.value=n,r},u=function(e,t){return pr(e,t)},l=Qe("!",!1),c=Qe("=",!1),h=Qe(">=",!1),f=Qe(">",!1),d=Qe("<=",!1),p=Qe("<>",!1),m=Qe("<",!1),g=Qe("!=",!1),y=function(e){return e[0]+" "+e[2]},v=Qe("+",!1),b=Qe("-",!1),x=Qe("*",!1),_=Qe("/",!1),w=function(e,t){return e+t.join("")},I=/^[A-Za-z_\x80-\uFFFF]/,S=qe([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),N=/^[A-Za-z0-9_]/,M=qe([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),O=/^[A-Za-z0-9_.\x80-\uFFFF]/,T=qe([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),F=Qe("@",!1),A=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},E=function(e,t){return{type:"interval-period",period:"second",precision:e,secondary:t}},R=function(e){return parseFloat(e)},j=Qe("'",!1),P=Qe("N'",!1),C=Qe("''",!1),G=/^[^']/,L=qe(["'"],!0,!1),z=function(e,t){return{type:"when_clause",operand:e,value:t}},D=Qe(".",!1),Q=/^[0-9]/,q=qe([["0","9"]],!1,!1),k=/^[eE]/,Y=qe(["e","E"],!1,!1),V=/^[+\-]/,B=qe(["+","-"],!1,!1),Z=Qe("NULL",!0),J=Qe("TRUE",!0),X=Qe("FALSE",!0),$=Qe("IN",!0),U=Qe("IS",!0),H=Qe("LIKE",!0),W=Qe("ESCAPE",!0),K=Qe("NOT",!0),ee=Qe("AND",!0),te=Qe("OR",!0),re=Qe("BETWEEN",!0),ne=Qe("FROM",!0),se=Qe("FOR",!0),ie=Qe("SUBSTRING",!0),ae=Qe("EXTRACT",!0),oe=Qe("TRIM",!0),ue=Qe("POSITION",!0),le=Qe("TIMESTAMP",!0),ce=Qe("DATE",!0),he=Qe("LEADING",!0),fe=Qe("TRAILING",!0),de=Qe("BOTH",!0),pe=Qe("TO",!0),me=Qe("INTERVAL",!0),ge=Qe("YEAR",!0),ye=Qe("MONTH",!0),ve=Qe("DAY",!0),be=Qe("HOUR",!0),xe=Qe("MINUTE",!0),_e=Qe("SECOND",!0),we=Qe("CASE",!0),Ie=Qe("END",!0),Se=Qe("WHEN",!0),Ne=Qe("THEN",!0),Me=Qe("ELSE",!0),Oe=Qe(",",!1),Te=Qe("(",!1),Fe=Qe(")",!1),Ae=/^[ \t\n\r]/,Ee=qe([" ","\t","\n","\r"],!1,!1),Re=Qe("`",!1),je=/^[^`]/,Pe=qe(["`"],!0,!1),Ce=0,Ge=[{line:1,column:1}],Le=0,ze=[],De=0;if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');a=i[r.startRule]}function Qe(e,t){return{type:"literal",text:e,ignoreCase:t}}function qe(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function ke(e){var r,n=Ge[e];if(n)return n;for(r=e-1;!Ge[r];)r--;for(n={line:(n=Ge[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return Ge[e]=n,n}function Ye(e,t){var r=ke(e),n=ke(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function Ve(e){Ce<Le||(Ce>Le&&(Le=Ce,ze=[]),ze.push(e))}function Be(){var e,t;return e=Ce,cr()!==s&&(t=Je())!==s&&cr()!==s?e=t:(Ce=e,e=s),e}function Ze(){var e,t,r,n,i,a,u,l;if(e=Ce,(t=Je())!==s){for(r=[],n=Ce,(i=cr())!==s&&(a=or())!==s&&(u=cr())!==s&&(l=Je())!==s?n=i=[i,a,u,l]:(Ce=n,n=s);n!==s;)r.push(n),n=Ce,(i=cr())!==s&&(a=or())!==s&&(u=cr())!==s&&(l=Je())!==s?n=i=[i,a,u,l]:(Ce=n,n=s);r!==s?e=t=o(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}function Je(){var e,t,r,n,i,a,o,l;if(e=Ce,(t=Xe())!==s){for(r=[],n=Ce,(i=cr())!==s&&(a=Ct())!==s&&(o=cr())!==s&&(l=Xe())!==s?n=i=[i,a,o,l]:(Ce=n,n=s);n!==s;)r.push(n),n=Ce,(i=cr())!==s&&(a=Ct())!==s&&(o=cr())!==s&&(l=Xe())!==s?n=i=[i,a,o,l]:(Ce=n,n=s);r!==s?e=t=u(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}function Xe(){var e,t,r,n,i,a,o,l;if(e=Ce,(t=$e())!==s){for(r=[],n=Ce,(i=cr())!==s&&(a=Pt())!==s&&(o=cr())!==s&&(l=$e())!==s?n=i=[i,a,o,l]:(Ce=n,n=s);n!==s;)r.push(n),n=Ce,(i=cr())!==s&&(a=Pt())!==s&&(o=cr())!==s&&(l=$e())!==s?n=i=[i,a,o,l]:(Ce=n,n=s);r!==s?e=t=u(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}function $e(){var e,r,n,i,a;return e=Ce,(r=jt())===s&&(r=Ce,33===t.charCodeAt(Ce)?(n="!",Ce++):(n=s,0===De&&Ve(l)),n!==s?(i=Ce,De++,61===t.charCodeAt(Ce)?(a="=",Ce++):(a=s,0===De&&Ve(c)),De--,a===s?i=void 0:(Ce=i,i=s),i!==s?r=n=[n,i]:(Ce=r,r=s)):(Ce=r,r=s)),r!==s&&(n=cr())!==s&&(i=$e())!==s?e=r=function(e){return function(e,t){return{type:"unary_expr",operator:e,expr:t}}("NOT",e)}(i):(Ce=e,e=s),e===s&&(e=function(){var e,t,r;return e=Ce,(t=Ke())!==s&&cr()!==s?((r=function(){var e;return(e=function(){var e,t,r,n,i,a;if(e=[],t=Ce,(r=cr())!==s&&(n=Ue())!==s&&(i=cr())!==s&&(a=Ke())!==s?t=r=[r,n,i,a]:(Ce=t,t=s),t!==s)for(;t!==s;)e.push(t),t=Ce,(r=cr())!==s&&(n=Ue())!==s&&(i=cr())!==s&&(a=Ke())!==s?t=r=[r,n,i,a]:(Ce=t,t=s);else e=s;return e!==s&&(e=function(e){return{type:"arithmetic",tail:e}}(e)),e}())===s&&(e=function(){var e,t,r,n;return e=Ce,(t=We())!==s&&cr()!==s&&(r=ur())!==s&&cr()!==s&&(n=Ze())!==s&&cr()!==s&&lr()!==s?e=t=function(e,t){return{op:e,right:t}}(t,n):(Ce=e,e=s),e===s&&(e=Ce,(t=We())!==s&&cr()!==s&&(r=ur())!==s&&cr()!==s&&(n=lr())!==s?e=t=function(e){return{op:e,right:{type:"expr_list",value:[]}}}(t):(Ce=e,e=s),e===s&&(e=Ce,(t=We())!==s&&cr()!==s&&(r=ut())!==s?e=t=function(e,t){return{op:e,right:t}}(t,r):(Ce=e,e=s))),e}())===s&&(e=function(){var e,t,r,n,i,a;return e=Ce,(t=jt())!==s&&cr()!==s&&(r=Gt())!==s&&cr()!==s&&(n=Ke())!==s&&cr()!==s&&(i=Pt())!==s&&cr()!==s&&(a=Ke())!==s?e=t=function(e,t,r){return{op:"NOT"+e,right:{type:"expr_list",value:[t,r]}}}(r,n,a):(Ce=e,e=s),e===s&&(e=Ce,(t=Gt())!==s&&cr()!==s&&(r=Ke())!==s&&cr()!==s&&(n=Pt())!==s&&cr()!==s&&(i=Ke())!==s?e=t=function(e,t,r){return{op:e,right:{type:"expr_list",value:[t,r]}}}(t,r,i):(Ce=e,e=s)),e}())===s&&(e=function(){var e,t,r,n;return e=Ce,(t=At())!==s&&cr()!==s&&(r=jt())!==s&&cr()!==s&&(n=Ke())!==s?e=t=function(e,t){return{op:e+"NOT",right:t}}(t,n):(Ce=e,e=s),e===s&&(e=Ce,(t=At())!==s&&cr()!==s&&(r=Ke())!==s?e=t=function(e,t){return{op:e,right:t}}(t,r):(Ce=e,e=s)),e}())===s&&(e=function(){var e,t,r,n;return e=Ce,(t=He())!==s&&cr()!==s&&(r=mt())!==s&&cr()!==s&&Rt()!==s&&cr()!==s&&(n=gt())!==s?e=t=function(e,t,r){return{op:e,right:t,escape:r.value}}(t,r,n):(Ce=e,e=s),e===s&&(e=Ce,(t=He())!==s&&cr()!==s&&(r=mt())!==s?e=t=function(e,t){return{op:e,right:t,escape:""}}(t,r):(Ce=e,e=s)),e}()),e}())===s&&(r=null),r!==s?e=t=function(e,t){return""==t||null==t||null==t?e:"arithmetic"==t.type?pr(e,t.tail):dr(t.op,e,t.right,t.escape)}(t,r):(Ce=e,e=s)):(Ce=e,e=s),e}()),e}function Ue(){var e;return">="===t.substr(Ce,2)?(e=">=",Ce+=2):(e=s,0===De&&Ve(h)),e===s&&(62===t.charCodeAt(Ce)?(e=">",Ce++):(e=s,0===De&&Ve(f)),e===s&&("<="===t.substr(Ce,2)?(e="<=",Ce+=2):(e=s,0===De&&Ve(d)),e===s&&("<>"===t.substr(Ce,2)?(e="<>",Ce+=2):(e=s,0===De&&Ve(p)),e===s&&(60===t.charCodeAt(Ce)?(e="<",Ce++):(e=s,0===De&&Ve(m)),e===s&&(61===t.charCodeAt(Ce)?(e="=",Ce++):(e=s,0===De&&Ve(c)),e===s&&("!="===t.substr(Ce,2)?(e="!=",Ce+=2):(e=s,0===De&&Ve(g)))))))),e}function He(){var e,t,r,n,i;return e=Ce,t=Ce,(r=jt())!==s&&(n=cr())!==s&&(i=Et())!==s?t=r=[r,n,i]:(Ce=t,t=s),t!==s&&(t=y(t)),(e=t)===s&&(e=Et()),e}function We(){var e,t,r,n,i;return e=Ce,t=Ce,(r=jt())!==s&&(n=cr())!==s&&(i=Ft())!==s?t=r=[r,n,i]:(Ce=t,t=s),t!==s&&(t=y(t)),(e=t)===s&&(e=Ft()),e}function Ke(){var e,t,r,n,i,a,o,l;if(e=Ce,(t=tt())!==s){for(r=[],n=Ce,(i=cr())!==s&&(a=et())!==s&&(o=cr())!==s&&(l=tt())!==s?n=i=[i,a,o,l]:(Ce=n,n=s);n!==s;)r.push(n),n=Ce,(i=cr())!==s&&(a=et())!==s&&(o=cr())!==s&&(l=tt())!==s?n=i=[i,a,o,l]:(Ce=n,n=s);r!==s?e=t=u(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}function et(){var e;return 43===t.charCodeAt(Ce)?(e="+",Ce++):(e=s,0===De&&Ve(v)),e===s&&(45===t.charCodeAt(Ce)?(e="-",Ce++):(e=s,0===De&&Ve(b))),e}function tt(){var e,t,r,n,i,a,o,u;if(e=Ce,(t=nt())!==s){for(r=[],n=Ce,(i=cr())!==s&&(a=rt())!==s&&(o=cr())!==s&&(u=nt())!==s?n=i=[i,a,o,u]:(Ce=n,n=s);n!==s;)r.push(n),n=Ce,(i=cr())!==s&&(a=rt())!==s&&(o=cr())!==s&&(u=nt())!==s?n=i=[i,a,o,u]:(Ce=n,n=s);r!==s?e=t=function(e,t){return pr(e,t)}(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}function rt(){var e;return 42===t.charCodeAt(Ce)?(e="*",Ce++):(e=s,0===De&&Ve(x)),e===s&&(47===t.charCodeAt(Ce)?(e="/",Ce++):(e=s,0===De&&Ve(_))),e}function nt(){var e,t;return(e=function(){var e;return(e=gt())===s&&(e=function(){var e,t,r,n;return e=Ce,(t=function(){var e,t,r,n;return e=Ce,(t=xt())!==s&&(r=_t())!==s&&(n=wt())!==s?e=t=function(e,t,r){return parseFloat(e+t+r)}(t,r,n):(Ce=e,e=s),e===s&&(e=Ce,(t=xt())!==s&&(r=_t())!==s?e=t=function(e,t){return parseFloat(e+t)}(t,r):(Ce=e,e=s),e===s&&(e=Ce,(t=xt())!==s&&(r=wt())!==s?e=t=function(e,t){return parseFloat(e+t)}(t,r):(Ce=e,e=s),e===s&&(e=Ce,(t=xt())!==s&&(t=function(e){return parseFloat(e)}(t)),e=t))),e}())!==s?(r=Ce,De++,n=it(),De--,n===s?r=void 0:(Ce=r,r=s),r!==s?e=t=function(e){return{type:"number",value:e}}(t):(Ce=e,e=s)):(Ce=e,e=s),e}())===s&&(e=function(){var e,t;return e=Ce,(t=Ot())!==s&&(t={type:"bool",value:!0}),(e=t)===s&&(e=Ce,(t=Tt())!==s&&(t={type:"bool",value:!1}),e=t),e}())===s&&(e=function(){var e;return(e=Mt())!==s&&(e={type:"null",value:null}),e}())===s&&(e=function(){var e,t;return e=Ce,Vt()!==s&&cr()!==s&&(t=mt())!==s?e=function(e){return{type:"date",value:e.value}}(t):(Ce=e,e=s),e}())===s&&(e=function(){var e,t;return e=Ce,Yt()!==s&&cr()!==s&&(t=mt())!==s?e=function(e){return{type:"timestamp",value:e.value}}(t):(Ce=e,e=s),e}())===s&&(e=ct()),e}())===s&&(e=function(){var e,t,r;return e=Ce,Qt()!==s&&cr()!==s&&ur()!==s&&cr()!==s&&(t=function(){var e;return(e=Ut())===s&&(e=Ht())===s&&(e=Wt())===s&&(e=Kt())===s&&(e=er())===s&&(e=tr()),e}())!==s&&cr()!==s&&Lt()!==s&&cr()!==s&&(r=Je())!==s&&cr()!==s&&lr()!==s?e=function(e,t){return{type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:e},t]}}}(t,r):(Ce=e,e=s),e}())===s&&(e=function(){var e,t,r,n,i,a,o,u;return e=Ce,Dt()!==s&&cr()!==s&&ur()!==s&&cr()!==s&&(t=Je())!==s&&cr()!==s&&Lt()!==s&&cr()!==s&&(r=Je())!==s&&cr()!==s?(n=Ce,(i=zt())!==s&&(a=cr())!==s&&(o=Je())!==s&&(u=cr())!==s?n=i=[i,a,o,u]:(Ce=n,n=s),n===s&&(n=null),n!==s&&(i=lr())!==s?e=function(e,t,r){return{type:"function",name:"substring",args:{type:"expr_list",value:r?[e,t,r[2]]:[e,t]}}}(t,r,n):(Ce=e,e=s)):(Ce=e,e=s),e}())===s&&(e=function(){var e,t,r,n;return e=Ce,qt()!==s&&cr()!==s&&ur()!==s&&cr()!==s?((t=lt())===s&&(t=null),t!==s&&cr()!==s&&(r=Je())!==s&&cr()!==s&&Lt()!==s&&cr()!==s&&(n=Je())!==s&&cr()!==s&&lr()!==s?e=function(e,t,r){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t,r]}}}(t,r,n):(Ce=e,e=s)):(Ce=e,e=s),e===s&&(e=Ce,qt()!==s&&cr()!==s&&ur()!==s&&cr()!==s?((t=lt())===s&&(t=null),t!==s&&cr()!==s&&(r=Je())!==s&&cr()!==s&&lr()!==s?e=function(e,t){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t]}}}(t,r):(Ce=e,e=s)):(Ce=e,e=s)),e}())===s&&(e=function(){var e,t,r;return e=Ce,kt()!==s&&cr()!==s&&ur()!==s&&cr()!==s&&(t=Je())!==s&&cr()!==s&&Ft()!==s&&cr()!==s&&(r=Je())!==s&&cr()!==s&&lr()!==s?e=function(e,t){return{type:"function",name:"position",args:{type:"expr_list",value:[e,t]}}}(t,r):(Ce=e,e=s),e}())===s&&(e=function(){var e,t,r;return e=Ce,(t=fr())!==s&&cr()!==s&&ur()!==s&&cr()!==s?((r=Ze())===s&&(r=null),r!==s&&cr()!==s&&lr()!==s?e=t=function(e,t){return{type:"function",name:e,args:t||{type:"expr_list",value:[]}}}(t,r):(Ce=e,e=s)):(Ce=e,e=s),e}())===s&&(e=function(){var e;return(e=function(){var e,t,r,n,i;if(e=Ce,rr()!==s)if(cr()!==s)if((t=Je())!==s)if(cr()!==s){for(r=[],n=vt();n!==s;)r.push(n),n=vt();r!==s&&(n=cr())!==s&&(i=nr())!==s?e=function(e,t){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:null}}(t,r):(Ce=e,e=s)}else Ce=e,e=s;else Ce=e,e=s;else Ce=e,e=s;else Ce=e,e=s;if(e===s)if(e=Ce,rr()!==s)if(cr()!==s)if((t=Je())!==s)if(cr()!==s){for(r=[],n=vt();n!==s;)r.push(n),n=vt();r!==s&&(n=cr())!==s&&(i=bt())!==s&&cr()!==s&&nr()!==s?e=function(e,t,r){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:r.value}}(t,r,i):(Ce=e,e=s)}else Ce=e,e=s;else Ce=e,e=s;else Ce=e,e=s;else Ce=e,e=s;return e}())===s&&(e=function(){var e,t,r,n;if(e=Ce,rr()!==s)if(cr()!==s){for(t=[],r=yt();r!==s;)t.push(r),r=yt();t!==s&&(r=cr())!==s&&(n=nr())!==s?e=function(e){return{type:"case_expression",format:"searched",clauses:e,else:null}}(t):(Ce=e,e=s)}else Ce=e,e=s;else Ce=e,e=s;if(e===s)if(e=Ce,rr()!==s)if(cr()!==s){for(t=[],r=yt();r!==s;)t.push(r),r=yt();t!==s&&(r=cr())!==s&&(n=bt())!==s&&cr()!==s&&nr()!==s?e=function(e,t){return{type:"case_expression",format:"searched",clauses:e,else:t.value}}(t,n):(Ce=e,e=s)}else Ce=e,e=s;else Ce=e,e=s;return e}()),e}())===s&&(e=function(){var e;return(e=function(){var e;return(e=function(){var e,t,r,n;if(e=Ce,(t=it())!==s){for(r=[],n=ot();n!==s;)r.push(n),n=ot();r!==s?e=t=w(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}())!==s&&(e=e),e}())!==s&&(e=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:e}}(e)),e}())===s&&(e=ut())===s&&(e=Ce,ur()!==s&&cr()!==s&&(t=Je())!==s&&cr()!==s&&lr()!==s?e=function(e){return e.paren=!0,e}(t):(Ce=e,e=s)),e}function st(){var e,t,r,n;if(e=Ce,(t=it())!==s){for(r=[],n=at();n!==s;)r.push(n),n=at();r!==s?e=t=w(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}function it(){var e;return I.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=s,0===De&&Ve(S)),e}function at(){var e;return N.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=s,0===De&&Ve(M)),e}function ot(){var e;return O.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=s,0===De&&Ve(T)),e}function ut(){var e,r,n;return e=Ce,64===t.charCodeAt(Ce)?(r="@",Ce++):(r=s,0===De&&Ve(F)),r!==s&&(n=st())!==s?e=r=[r,n]:(Ce=e,e=s),e!==s&&(e=function(e){return{type:"param",value:e[1]}}(e)),e}function lt(){var e;return(e=Bt())===s&&(e=Zt())===s&&(e=Jt()),e}function ct(){var e,r,n,i;return e=Ce,$t()!==s&&cr()!==s?(45===t.charCodeAt(Ce)?(r="-",Ce++):(r=s,0===De&&Ve(b)),r===s&&(43===t.charCodeAt(Ce)?(r="+",Ce++):(r=s,0===De&&Ve(v))),r!==s&&cr()!==s&&(n=mt())!==s&&cr()!==s&&(i=ht())!==s?e=function(e,t,r){return{type:"interval",value:t,qualifier:r,op:e}}(r,n,i):(Ce=e,e=s)):(Ce=e,e=s),e===s&&(e=Ce,$t()!==s&&cr()!==s&&(r=mt())!==s&&cr()!==s&&(n=ht())!==s?e=function(e,t){return{type:"interval",value:e,qualifier:t,op:""}}(r,n):(Ce=e,e=s)),e}function ht(){var e,t,r;return e=Ce,(t=function(){var e,t,r;return e=Ce,(t=ft())!==s&&cr()!==s&&ur()!==s&&cr()!==s&&(r=pt())!==s&&cr()!==s&&lr()!==s?e=t=function(e,t){return{type:"interval-period",period:e.value,precision:t,secondary:null}}(t,r):(Ce=e,e=s),e===s&&(e=Ce,(t=ft())!==s&&(t=A(t)),e=t),e}())!==s&&cr()!==s&&Xt()!==s&&cr()!==s&&(r=function(){var e,t,r,n;return e=Ce,(t=ft())!==s&&(t=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}}(t)),(e=t)===s&&(e=Ce,(t=tr())!==s&&cr()!==s&&ur()!==s&&cr()!==s&&(r=pt())!==s&&cr()!==s&&or()!==s&&cr()!==s&&(n=dt())!==s&&cr()!==s&&lr()!==s?e=t=E(r,n):(Ce=e,e=s),e===s&&(e=Ce,(t=tr())!==s&&cr()!==s&&ur()!==s&&cr()!==s&&(r=pt())!==s&&cr()!==s&&lr()!==s?e=t=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}}(r):(Ce=e,e=s),e===s&&(e=Ce,(t=tr())!==s&&(t={type:"interval-period",period:"second",precision:null,secondary:null}),e=t))),e}())!==s?e=t=function(e,t){return{type:"interval-qualifier",start:e,end:t}}(t,r):(Ce=e,e=s),e===s&&(e=function(){var e,t,r,n;return e=Ce,(t=ft())!==s&&cr()!==s&&ur()!==s&&cr()!==s&&(r=dt())!==s&&cr()!==s&&lr()!==s?e=t=function(e,t){return{type:"interval-period",period:e.value,precision:t,secondary:null}}(t,r):(Ce=e,e=s),e===s&&(e=Ce,(t=ft())!==s&&(t=A(t)),(e=t)===s&&(e=Ce,(t=tr())!==s&&cr()!==s&&ur()!==s&&cr()!==s&&(r=pt())!==s&&cr()!==s&&or()!==s&&cr()!==s&&(n=dt())!==s&&cr()!==s&&lr()!==s?e=t=E(r,n):(Ce=e,e=s),e===s&&(e=Ce,(t=tr())!==s&&cr()!==s&&ur()!==s&&cr()!==s&&(r=dt())!==s&&cr()!==s&&lr()!==s?e=t=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}}(r):(Ce=e,e=s),e===s&&(e=Ce,(t=tr())!==s&&(t={type:"interval-period",period:"second",precision:null,secondary:null}),e=t)))),e}()),e}function ft(){var e,t;return e=Ce,(t=Wt())!==s&&(t={type:"string",value:"day"}),(e=t)===s&&(e=Ce,(t=Kt())!==s&&(t={type:"string",value:"hour"}),(e=t)===s&&(e=Ce,(t=er())!==s&&(t={type:"string",value:"minute"}),(e=t)===s&&(e=Ce,(t=Ht())!==s&&(t={type:"string",value:"month"}),(e=t)===s&&(e=Ce,(t=Ut())!==s&&(t={type:"string",value:"year"}),e=t)))),e}function dt(){var e;return(e=It())!==s&&(e=R(e)),e}function pt(){var e;return(e=It())!==s&&(e=R(e)),e}function mt(){var e;return(e=gt())===s&&(e=ut()),e}function gt(){var e,r,n,i,a;if(e=Ce,39===t.charCodeAt(Ce)?(r="'",Ce++):(r=s,0===De&&Ve(j)),r===s&&("N'"===t.substr(Ce,2)?(r="N'",Ce+=2):(r=s,0===De&&Ve(P))),r!==s){for(n=[],i=Ce,"''"===t.substr(Ce,2)?(a="''",Ce+=2):(a=s,0===De&&Ve(C)),a!==s&&(a="'"),(i=a)===s&&(G.test(t.charAt(Ce))?(i=t.charAt(Ce),Ce++):(i=s,0===De&&Ve(L)));i!==s;)n.push(i),i=Ce,"''"===t.substr(Ce,2)?(a="''",Ce+=2):(a=s,0===De&&Ve(C)),a!==s&&(a="'"),(i=a)===s&&(G.test(t.charAt(Ce))?(i=t.charAt(Ce),Ce++):(i=s,0===De&&Ve(L)));n!==s?(39===t.charCodeAt(Ce)?(i="'",Ce++):(i=s,0===De&&Ve(j)),i!==s?e=r=function(e){return{type:"string",value:e.join("")}}(n):(Ce=e,e=s)):(Ce=e,e=s)}else Ce=e,e=s;return e}function yt(){var e,t,r;return e=Ce,sr()!==s&&cr()!==s&&(t=Je())!==s&&cr()!==s&&ir()!==s&&cr()!==s&&(r=Je())!==s?e=z(t,r):(Ce=e,e=s),e}function vt(){var e,t,r;return e=Ce,sr()!==s&&cr()!==s&&(t=Je())!==s&&cr()!==s&&ir()!==s&&cr()!==s&&(r=Je())!==s?e=z(t,r):(Ce=e,e=s),e}function bt(){var e,t;return e=Ce,ar()!==s&&cr()!==s&&(t=Je())!==s?e=function(e){return{type:"else_clause",value:e}}(t):(Ce=e,e=s),e}function xt(){var e,r,n;return(e=It())===s&&(e=Ce,45===t.charCodeAt(Ce)?(r="-",Ce++):(r=s,0===De&&Ve(b)),r===s&&(43===t.charCodeAt(Ce)?(r="+",Ce++):(r=s,0===De&&Ve(v))),r!==s&&(n=It())!==s?e=r=function(e,t){return e[0]+t}(r,n):(Ce=e,e=s)),e}function _t(){var e,r,n;return e=Ce,46===t.charCodeAt(Ce)?(r=".",Ce++):(r=s,0===De&&Ve(D)),r!==s?((n=It())===s&&(n=null),n!==s?e=r=function(e){return"."+(null!=e?e:"")}(n):(Ce=e,e=s)):(Ce=e,e=s),e}function wt(){var e,t,r;return e=Ce,(t=Nt())!==s&&(r=It())!==s?e=t=function(e,t){return e+t}(t,r):(Ce=e,e=s),e}function It(){var e,t;if(e=[],(t=St())!==s)for(;t!==s;)e.push(t),t=St();else e=s;return e!==s&&(e=function(e){return e.join("")}(e)),e}function St(){var e;return Q.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=s,0===De&&Ve(q)),e}function Nt(){var e,r,n;return e=Ce,k.test(t.charAt(Ce))?(r=t.charAt(Ce),Ce++):(r=s,0===De&&Ve(Y)),r!==s?(V.test(t.charAt(Ce))?(n=t.charAt(Ce),Ce++):(n=s,0===De&&Ve(B)),n===s&&(n=null),n!==s?e=r=function(e,t){return"e"+(null===t?"":t)}(0,n):(Ce=e,e=s)):(Ce=e,e=s),e}function Mt(){var e,r,n,i;return e=Ce,"null"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(Z)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r=[r,n]:(Ce=e,e=s)):(Ce=e,e=s),e}function Ot(){var e,r,n,i;return e=Ce,"true"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(J)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r=[r,n]:(Ce=e,e=s)):(Ce=e,e=s),e}function Tt(){var e,r,n,i;return e=Ce,"false"===t.substr(Ce,5).toLowerCase()?(r=t.substr(Ce,5),Ce+=5):(r=s,0===De&&Ve(X)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r=[r,n]:(Ce=e,e=s)):(Ce=e,e=s),e}function Ft(){var e,r,n,i;return e=Ce,"in"===t.substr(Ce,2).toLowerCase()?(r=t.substr(Ce,2),Ce+=2):(r=s,0===De&&Ve($)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="IN":(Ce=e,e=s)):(Ce=e,e=s),e}function At(){var e,r,n,i;return e=Ce,"is"===t.substr(Ce,2).toLowerCase()?(r=t.substr(Ce,2),Ce+=2):(r=s,0===De&&Ve(U)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="IS":(Ce=e,e=s)):(Ce=e,e=s),e}function Et(){var e,r,n,i;return e=Ce,"like"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(H)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="LIKE":(Ce=e,e=s)):(Ce=e,e=s),e}function Rt(){var e,r,n,i;return e=Ce,"escape"===t.substr(Ce,6).toLowerCase()?(r=t.substr(Ce,6),Ce+=6):(r=s,0===De&&Ve(W)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="ESCAPE":(Ce=e,e=s)):(Ce=e,e=s),e}function jt(){var e,r,n,i;return e=Ce,"not"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=s,0===De&&Ve(K)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="NOT":(Ce=e,e=s)):(Ce=e,e=s),e}function Pt(){var e,r,n,i;return e=Ce,"and"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=s,0===De&&Ve(ee)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="AND":(Ce=e,e=s)):(Ce=e,e=s),e}function Ct(){var e,r,n,i;return e=Ce,"or"===t.substr(Ce,2).toLowerCase()?(r=t.substr(Ce,2),Ce+=2):(r=s,0===De&&Ve(te)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="OR":(Ce=e,e=s)):(Ce=e,e=s),e}function Gt(){var e,r,n,i;return e=Ce,"between"===t.substr(Ce,7).toLowerCase()?(r=t.substr(Ce,7),Ce+=7):(r=s,0===De&&Ve(re)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="BETWEEN":(Ce=e,e=s)):(Ce=e,e=s),e}function Lt(){var e,r,n,i;return e=Ce,"from"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(ne)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="FROM":(Ce=e,e=s)):(Ce=e,e=s),e}function zt(){var e,r,n,i;return e=Ce,"for"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=s,0===De&&Ve(se)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="FOR":(Ce=e,e=s)):(Ce=e,e=s),e}function Dt(){var e,r,n,i;return e=Ce,"substring"===t.substr(Ce,9).toLowerCase()?(r=t.substr(Ce,9),Ce+=9):(r=s,0===De&&Ve(ie)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="SUBSTRING":(Ce=e,e=s)):(Ce=e,e=s),e}function Qt(){var e,r,n,i;return e=Ce,"extract"===t.substr(Ce,7).toLowerCase()?(r=t.substr(Ce,7),Ce+=7):(r=s,0===De&&Ve(ae)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="EXTRACT":(Ce=e,e=s)):(Ce=e,e=s),e}function qt(){var e,r,n,i;return e=Ce,"trim"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(oe)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="TRIM":(Ce=e,e=s)):(Ce=e,e=s),e}function kt(){var e,r,n,i;return e=Ce,"position"===t.substr(Ce,8).toLowerCase()?(r=t.substr(Ce,8),Ce+=8):(r=s,0===De&&Ve(ue)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="POSITION":(Ce=e,e=s)):(Ce=e,e=s),e}function Yt(){var e,r,n,i;return e=Ce,"timestamp"===t.substr(Ce,9).toLowerCase()?(r=t.substr(Ce,9),Ce+=9):(r=s,0===De&&Ve(le)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="TIMESTAMP":(Ce=e,e=s)):(Ce=e,e=s),e}function Vt(){var e,r,n,i;return e=Ce,"date"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(ce)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="DATE":(Ce=e,e=s)):(Ce=e,e=s),e}function Bt(){var e,r,n,i;return e=Ce,"leading"===t.substr(Ce,7).toLowerCase()?(r=t.substr(Ce,7),Ce+=7):(r=s,0===De&&Ve(he)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="LEADING":(Ce=e,e=s)):(Ce=e,e=s),e}function Zt(){var e,r,n,i;return e=Ce,"trailing"===t.substr(Ce,8).toLowerCase()?(r=t.substr(Ce,8),Ce+=8):(r=s,0===De&&Ve(fe)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="TRAILING":(Ce=e,e=s)):(Ce=e,e=s),e}function Jt(){var e,r,n,i;return e=Ce,"both"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(de)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="BOTH":(Ce=e,e=s)):(Ce=e,e=s),e}function Xt(){var e,r,n,i;return e=Ce,"to"===t.substr(Ce,2).toLowerCase()?(r=t.substr(Ce,2),Ce+=2):(r=s,0===De&&Ve(pe)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="TO":(Ce=e,e=s)):(Ce=e,e=s),e}function $t(){var e,r,n,i;return e=Ce,"interval"===t.substr(Ce,8).toLowerCase()?(r=t.substr(Ce,8),Ce+=8):(r=s,0===De&&Ve(me)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="INTERVAL":(Ce=e,e=s)):(Ce=e,e=s),e}function Ut(){var e,r,n,i;return e=Ce,"year"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(ge)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="YEAR":(Ce=e,e=s)):(Ce=e,e=s),e}function Ht(){var e,r,n,i;return e=Ce,"month"===t.substr(Ce,5).toLowerCase()?(r=t.substr(Ce,5),Ce+=5):(r=s,0===De&&Ve(ye)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="MONTH":(Ce=e,e=s)):(Ce=e,e=s),e}function Wt(){var e,r,n,i;return e=Ce,"day"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=s,0===De&&Ve(ve)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="DAY":(Ce=e,e=s)):(Ce=e,e=s),e}function Kt(){var e,r,n,i;return e=Ce,"hour"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(be)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="HOUR":(Ce=e,e=s)):(Ce=e,e=s),e}function er(){var e,r,n,i;return e=Ce,"minute"===t.substr(Ce,6).toLowerCase()?(r=t.substr(Ce,6),Ce+=6):(r=s,0===De&&Ve(xe)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="MINUTE":(Ce=e,e=s)):(Ce=e,e=s),e}function tr(){var e,r,n,i;return e=Ce,"second"===t.substr(Ce,6).toLowerCase()?(r=t.substr(Ce,6),Ce+=6):(r=s,0===De&&Ve(_e)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="SECOND":(Ce=e,e=s)):(Ce=e,e=s),e}function rr(){var e,r,n,i;return e=Ce,"case"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(we)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="CASE":(Ce=e,e=s)):(Ce=e,e=s),e}function nr(){var e,r,n,i;return e=Ce,"end"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=s,0===De&&Ve(Ie)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="END":(Ce=e,e=s)):(Ce=e,e=s),e}function sr(){var e,r,n,i;return e=Ce,"when"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(Se)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="WHEN":(Ce=e,e=s)):(Ce=e,e=s),e}function ir(){var e,r,n,i;return e=Ce,"then"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(Ne)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="THEN":(Ce=e,e=s)):(Ce=e,e=s),e}function ar(){var e,r,n,i;return e=Ce,"else"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===De&&Ve(Me)),r!==s?(n=Ce,De++,i=at(),De--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="ELSE":(Ce=e,e=s)):(Ce=e,e=s),e}function or(){var e;return 44===t.charCodeAt(Ce)?(e=",",Ce++):(e=s,0===De&&Ve(Oe)),e}function ur(){var e;return 40===t.charCodeAt(Ce)?(e="(",Ce++):(e=s,0===De&&Ve(Te)),e}function lr(){var e;return 41===t.charCodeAt(Ce)?(e=")",Ce++):(e=s,0===De&&Ve(Fe)),e}function cr(){var e,t;for(e=[],t=hr();t!==s;)e.push(t),t=hr();return e}function hr(){var e;return Ae.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=s,0===De&&Ve(Ee)),e}function fr(){var e,r,n,i;if(e=Ce,(r=st())!==s&&(r=r),(e=r)===s)if(e=Ce,96===t.charCodeAt(Ce)?(r="`",Ce++):(r=s,0===De&&Ve(Re)),r!==s){if(n=[],je.test(t.charAt(Ce))?(i=t.charAt(Ce),Ce++):(i=s,0===De&&Ve(Pe)),i!==s)for(;i!==s;)n.push(i),je.test(t.charAt(Ce))?(i=t.charAt(Ce),Ce++):(i=s,0===De&&Ve(Pe));else n=s;n!==s?(96===t.charCodeAt(Ce)?(i="`",Ce++):(i=s,0===De&&Ve(Re)),i!==s?e=r=function(e){return e.join("")}(n):(Ce=e,e=s)):(Ce=e,e=s)}else Ce=e,e=s;return e}function dr(e,t,r,n){var s={type:"binary_expr",operator:e,left:t,right:r};return void 0!==n&&(s.escape=n),s}function pr(e,t){for(var r=e,n=0;n<t.length;n++)r=dr(t[n][1],r,t[n][3]);return r}if((n=a())!==s&&Ce===t.length)return n;throw n!==s&&Ce<t.length&&Ve({type:"end"}),function(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}(ze,Le<t.length?t.charAt(Le):null,Le<t.length?Ye(Le,Le+1):Ye(Le,Le))}}}())}));const d=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,p=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,m=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,g=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,y=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function v(e,t){return(e+="").length>=t?e:new Array(t-e.length+1).join("0")+e}function b(e,t,r="0",n="0",s="0",i="0",a="",o="0",u="0"){if("+"===a||"-"===a){const l=`${v(parseInt(e,10),4)}-${v(parseInt(t,10),2)}-${v(parseInt(r,10),2)}`;let c="";parseFloat(i)<10&&(c="0");const h=`${v(parseInt(n,10),2)}:${v(parseInt(s,10),2)}:${c+parseFloat(i).toString()}`,f=`${a}${v(parseInt(o,10),2)}:${v(parseInt(u,10),2)}`;return new Date(l+"T"+h+f)}return new Date(parseInt(e,10),parseInt(t,10)-1,parseInt(r,10),parseInt(n,10),parseInt(s,10),parseFloat(i))}class x{static makeBool(e){return S(e)}static featureValue(e,t,r,n){return C(e,t,r,n)}static equalsNull(e){return null===e}static applyLike(e,t,r){return A(e,t,r)}static ensureArray(e){return N(e)}static applyIn(e,t){return F(e,t)}static currentDate(){const e=new Date;return e.setHours(0,0,0,0),e}static makeSqlInterval(e,t,r){return u.createFromValueAndQualifer(e,t,r)}static convertInterval(e){return e instanceof u?e.valueInMilliseconds():e}static currentTimestamp(){return new Date}static compare(e,t,r){return R(e,t,r)}static calculate(e,t,r){return P(e,t,r)}static makeComparable(e){return E(e)}static evaluateFunction(e,t){return l(e,t)}static lookup(e,t){const r=t[e];return void 0===r?null:r}static between(e,t){return null==e||null==t[0]||null==t[1]?null:e>=t[0]&&e<=t[1]}static notbetween(e,t){return null==e||null==t[0]||null==t[1]?null:e<t[0]||e>t[1]}static ternaryNot(e){return M(e)}static ternaryAnd(e,t){return O(e,t)}static ternaryOr(e,t){return T(e,t)}}class _{constructor(e,t){this.fieldsIndex=t,this.datefields={},this.parameters={},this.parseTree=class{static parse(e){return f.parse(e)}}.parse(e);const{isStandardized:r,isAggregate:n,referencedFieldNames:s}=this.extractExpressionInfo(t);this.referencedFieldNames=s,this.isStandardized=r,this.isAggregate=n}static create(e,t){return new _(e,t)}get fieldNames(){return this.referencedFieldNames}testSet(e,t=G){const r={};for(const n of this.fieldNames)r[n]=e.map(e=>t.getAttribute(e,n));return!!this.evaluateNode(this.parseTree,{attributes:r},G)}calculateValue(e,t=G){const r=this.evaluateNode(this.parseTree,e,t);return r instanceof u?r.valueInMilliseconds()/864e5:r}calculateValueCompiled(e,t=G){return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(e,this.parameters,t,this.datefields):Object(n.a)("csp-restrictions")?this.calculateValue(e,t):(this.compileMe(),this.parseTree._compiledVersion(e,this.parameters,t,this.datefields))}testFeature(e,t=G){return!!this.evaluateNode(this.parseTree,e,t)}testFeatureCompiled(e,t=G){return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(e,this.parameters,t,this.datefields):Object(n.a)("csp-restrictions")?this.testFeature(e,t):(this.compileMe(),!!this.parseTree._compiledVersion(e,this.parameters,t,this.datefields))}getFunctions(){const e=[];return this.visitAll(this.parseTree,t=>{"function"===t.type&&e.push(t.name.toLowerCase())}),j(e)}getExpressions(){const e=new Map;return this.visitAll(this.parseTree,t=>{if("function"===t.type){const r=t.name.toLowerCase(),n=t.args.value[0];if("column_ref"===n.type){const t=n.column,s=`${r}-${t}`;e.has(s)||e.set(s,{aggregateType:r,field:t})}}}),[...e.values()]}getVariables(){const e=[];return this.visitAll(this.parseTree,t=>{"param"===t.type&&e.push(t.value.toLowerCase())}),j(e)}compileMe(){const e="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","datefields",e).bind(x)}extractExpressionInfo(e){const t=[];let r=!0,n=!0;return this.visitAll(this.parseTree,i=>{switch(i.type){case"column_ref":{const r=e.get(i.column),n=r&&r.name;!r||"date"!==r.type&&"esriFieldTypeDate"!==r.type||(this.datefields[r.name]=1),void 0!==n?(t.push(n),i.column=n):t.push(i.column);break}case"function":{const{name:e,args:t}=i,a=t.value.length;r&&(r=function(e,t){const r=c[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}(e,a)),n&&(n=function(e,t){const r=s[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}(e,a));break}}}),{referencedFieldNames:j(t),isStandardized:r,isAggregate:n}}visitAll(e,t){if(null!=e)switch(t(e),e.type){case"when_clause":this.visitAll(e.operand,t),this.visitAll(e.value,t);break;case"case_expression":for(const r of e.clauses)this.visitAll(r,t);"simple"===e.format&&this.visitAll(e.operand,t),null!==e.else&&this.visitAll(e.else,t);break;case"expr_list":for(const r of e.value)this.visitAll(r,t);break;case"unary_expr":this.visitAll(e.expr,t);break;case"binary_expr":this.visitAll(e.left,t),this.visitAll(e.right,t);break;case"function":this.visitAll(e.args,t)}}evaluateNodeToJavaScript(e){switch(e.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(e.value)+", "+JSON.stringify(e.qualifier)+","+JSON.stringify(e.op)+")";case"case_expression":{let t="";if("simple"===e.format){const r="this.makeComparable("+this.evaluateNodeToJavaScript(e.operand)+")";t="( ";for(let n=0;n<e.clauses.length;n++)t+=" ("+r+" === this.makeComparable("+this.evaluateNodeToJavaScript(e.clauses[n].operand)+")) ? ("+this.evaluateNodeToJavaScript(e.clauses[n].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}else{t="( ";for(let r=0;r<e.clauses.length;r++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(e.clauses[r].operand)+")===true ? ("+this.evaluateNodeToJavaScript(e.clauses[r].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}return t}case"param":return"this.lookup("+JSON.stringify(e.value.toLowerCase())+",lookups)";case"expr_list":{let t="[";for(const r of e.value)"["!==t&&(t+=","),t+=this.evaluateNodeToJavaScript(r);return t+="]",t}case"unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(e.expr)+")";case"binary_expr":switch(e.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")";case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"*":case"-":case"+":case"/":return"this.calculate("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")"}throw new Error("Not Supported Operator "+e.operator);case"null":case"bool":case"string":case"number":return JSON.stringify(e.value);case"date":return"(new Date("+I(e.value).getTime().toString()+"))";case"timestamp":return"(new Date("+w(e.value).getTime().toString()+"))";case"current_time":return"date"===e.mode?"this.currentDate()":"this.currentTimestamp()";case"column_ref":return"this.featureValue(feature,"+JSON.stringify(e.column)+",datefields,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(e.name)+","+this.evaluateNodeToJavaScript(e.args)+")"}throw new Error("Unsupported sql syntax "+e.type)}evaluateNode(e,t,r){switch(e.type){case"interval":{const n=this.evaluateNode(e.value,t,r);return u.createFromValueAndQualifer(n,e.qualifier,e.op)}case"case_expression":if("simple"===e.format){const n=E(this.evaluateNode(e.operand,t,r));for(let s=0;s<e.clauses.length;s++)if(n===E(this.evaluateNode(e.clauses[s].operand,t,r)))return this.evaluateNode(e.clauses[s].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}else{for(let n=0;n<e.clauses.length;n++)if(S(this.evaluateNode(e.clauses[n].operand,t,r)))return this.evaluateNode(e.clauses[n].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}return null;case"param":return this.parameters[e.value.toLowerCase()];case"expr_list":{const n=[];for(const s of e.value)n.push(this.evaluateNode(s,t,r));return n}case"unary_expr":return M(this.evaluateNode(e.expr,t,r));case"binary_expr":switch(e.operator){case"AND":return O(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"OR":return T(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null===this.evaluateNode(e.left,t,r);case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null!==this.evaluateNode(e.left,t,r);case"IN":{const n=N(this.evaluateNode(e.right,t,r));return F(this.evaluateNode(e.left,t,r),n)}case"NOT IN":{const n=N(this.evaluateNode(e.right,t,r));return M(F(this.evaluateNode(e.left,t,r),n))}case"BETWEEN":{const n=this.evaluateNode(e.left,t,r),s=this.evaluateNode(e.right,t,r);return null==n||null==s[0]||null==s[1]?null:n>=E(s[0])&&n<=E(s[1])}case"NOTBETWEEN":{const n=this.evaluateNode(e.left,t,r),s=this.evaluateNode(e.right,t,r);return null==n||null==s[0]||null==s[1]?null:n<E(s[0])||n>E(s[1])}case"LIKE":return A(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape);case"NOT LIKE":return M(A(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return R(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"-":case"+":case"*":case"/":return P(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r))}case"null":case"bool":case"string":case"number":return e.value;case"date":return I(e.value);case"timestamp":return w(e.value);case"current_time":{const t=new Date;return"date"===e.mode&&t.setHours(0,0,0,0),t}case"column_ref":return C(t,e.column,this.datefields,r);case"function":{const n=this.evaluateNode(e.args,t,r);return this.isAggregate?function(e,t){const r=s[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)}(e.name,n):l(e.name,n)}}throw new Error("Unsupported sql syntax "+e.type)}}function w(e){let t=p.exec(e);if(null!==t){const[,e,r,n,s,i,a]=t;return b(e,r,n,s,i,a)}if(t=m.exec(e),null!==t){const[,e,r,n,s,i,a,o,u,l]=t;return b(e,r,n,s,i,a,o,u,l)}if(t=g.exec(e),null!==t){const[,e,r,n,s,i,a,o,u]=t;return b(e,r,n,s,i,"0",a,o,u)}if(t=y.exec(e),null!==t){const[,e,r,n,s,i]=t;return b(e,r,n,s,i)}if(t=d.exec(e),null!==t){const[,e,r,n]=t;return b(e,r,n)}throw new Error("SQL Invalid Timestamp")}function I(e){const t=d.exec(e);if(null===t)throw new Error("SQL Invalid Date");const[,r,n,s]=t;return new Date(parseInt(r,10),parseInt(n,10)-1,parseInt(s,10))}function S(e){return!0===e}function N(e){return Array.isArray(e)?e:[e]}function M(e){return null!==e?!0!==e:null}function O(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function T(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function F(e,t){if(null==e)return null;let r=!1;for(const n of t)if(null==n)r=null;else if(e===n){r=!0;break}return r}function A(e,t,r){if(null==e)return null;const n=t,s=r;let i="";const a="-[]/{}()*+?.\\^$|";let o=0;for(let e=0;e<n.length;e++){const t=n.charAt(e);switch(o){case 0:t===s?o=1:a.indexOf(t)>=0?i+="\\"+t:i+="%"===t?".*":"_"===t?".":t;break;case 1:a.indexOf(t)>=0?i+="\\"+t:i+=t,o=0}}return new RegExp("^"+i+"$").test(e)}function E(e){return e instanceof Date?e.valueOf():e}function R(e,t,r){if(null==t||null==r)return null;const n=E(t),s=E(r);switch(e){case"<>":return n!==s;case"=":return n===s;case">":return n>s;case"<":return n<s;case">=":return n>=s;case"<=":return n<=s}}function j(e){const t=[],r={};for(const n of e){const e=n.toLowerCase();void 0===r[e]&&(t.push(n),r[e]=1)}return t}function P(e,t,r){if(t instanceof u)if(r instanceof Date)switch(e){case"+":return new Date(t.valueInMilliseconds()+r.getTime());case"-":return t.valueInMilliseconds()-r.getTime();case"*":return t.valueInMilliseconds()*r.getTime();case"/":return t.valueInMilliseconds()/r.getTime()}else if(r instanceof u)switch(e){case"+":return u.createFromMilliseconds(t.valueInMilliseconds()+r.valueInMilliseconds());case"-":return u.createFromMilliseconds(t.valueInMilliseconds()-r.valueInMilliseconds());case"*":return t.valueInMilliseconds()*r.valueInMilliseconds();case"/":return t.valueInMilliseconds()/r.valueInMilliseconds()}else t=t.valueInMilliseconds();else if(r instanceof u)if(t instanceof Date)switch(e){case"+":return new Date(r.valueInMilliseconds()+t.getTime());case"-":return new Date(t.getTime()-r.valueInMilliseconds());case"*":return t.getTime()*r.valueInMilliseconds();case"/":return t.getTime()/r.valueInMilliseconds()}else r=r.valueInMilliseconds();else if(t instanceof Date&&"number"==typeof r)switch(r=24*r*60*60*1e3,t=t.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}else if(r instanceof Date&&"number"==typeof t)switch(t=24*t*60*60*1e3,r=r.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r}}function C(e,t,r,n){const s=n.getAttribute(e,t);return null!=s&&1===r[t]?new Date(s):s}const G={getAttribute(e,t){var r;return((r=e)&&"object"==typeof r.attributes?e.attributes:e)[t]}}},141:function(e,t,r){"use strict";function n(e){return"date"===e.type||"esriFieldTypeDate"===e.type}function s(e){return e.toLowerCase().trim()}t.a=class{constructor(e){if(this.fields=e,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],!e)return;const t=[];for(const r of e){const e=r&&r.name;if(e){const i=s(e);this._fieldsMap.set(e,r),this._fieldsMap.set(i,r),t.push(i),n(r)&&(this.dateFields.push(r),this._dateFieldsSet.add(r))}}t.sort(),this.uid=t.join(",")}destroy(){this._fieldsMap.clear()}has(e){return null!=this.get(e)}get(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(s(e)):void 0}isDateField(e){return this._dateFieldsSet.has(this.get(e))}normalizeFieldName(e){const t=this.get(e);if(t)return t.name}}},173:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return a}));var n=r(54);function s(e){return"point"===e||"multipoint"===e||"polyline"===e||"polygon"===e}const i=Object(n.b)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),a=Object(n.b)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"})},175:function(e,t,r){"use strict";class n{constructor(e=null,t={},r,n){this.displayId=0,this.geohashIndexed=!1,this.geohashX=0,this.geohashY=0,this.geometry=e,t&&(this.attributes=t),r&&(this.centroid=r),null!=n&&(this.objectId=n)}get hasGeometry(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)}weakClone(){const e=new n(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashIndexed=this.geohashIndexed,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}t.a=n},194:function(e,t,r){"use strict";r.d(t,"a",(function(){return x})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return g})),r.d(t,"d",(function(){return b})),r.d(t,"e",(function(){return a})),r.d(t,"f",(function(){return u})),r.d(t,"g",(function(){return o})),r.d(t,"h",(function(){return y})),r.d(t,"i",(function(){return i})),r.d(t,"j",(function(){return m})),r.d(t,"k",(function(){return p})),r.d(t,"l",(function(){return d})),r.d(t,"m",(function(){return f}));var n=r(1);r(57),r(114);function s(e=_){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function i(e,t,r,n,i,a,o=s()){return o[0]=e,o[1]=t,o[2]=r,o[3]=n,o[4]=i,o[5]=a,o}function a(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function o(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function u(e,t,r){const n=t.length;let s=e[0],i=e[1],a=e[2],o=e[3],u=e[4],l=e[5];if(r)for(let e=0;e<n;e++){const r=t[e];s=Math.min(s,r[0]),i=Math.min(i,r[1]),a=Math.min(a,r[2]),o=Math.max(o,r[0]),u=Math.max(u,r[1]),l=Math.max(l,r[2])}else for(let e=0;e<n;e++){const r=t[e];s=Math.min(s,r[0]),i=Math.min(i,r[1]),o=Math.max(o,r[0]),u=Math.max(u,r[1])}e[0]=s,e[1]=i,e[2]=a,e[3]=o,e[4]=u,e[5]=l}function l(e){return e[0]>=e[3]?0:e[3]-e[0]}function c(e){return e[1]>=e[4]?0:e[4]-e[1]}function h(e){return e[2]>=e[5]?0:e[5]-e[2]}function f(e,t=[0,0,0]){return t[0]=l(e),t[1]=c(e),t[2]=h(e),t}function d(e,t,r=e){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r}function p(e,t,r=e){return r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e}function m(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function g(e){return e?m(e,x):s(x)}function y(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function v(e){return 6===e.length}function b(e,t,r){if(Object(n.f)(e)||Object(n.f)(t))return e===t;if(!v(e)||!v(t))return!1;if(r){for(let n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}const x=[1/0,1/0,1/0,-1/0,-1/0,-1/0],_=[0,0,0,0,0,0];s()},224:function(e,t,r){"use strict";r.d(t,"a",(function(){return N}));var n=r(16),s=r(1),i=r(3),a=r(14),o=r(2),u=r(78),l=r(56),c=r(129),h=r(108),f=r(102),d=r(24),p=r(61),m=(r(59),r(55));const g=i.a.getLogger("esri.geometry.support.normalizeUtils"),y={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new f.a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:l.a.WebMercator}),minus180Line:new f.a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:l.a.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new f.a({paths:[[[180,-180],[180,180]]],spatialReference:l.a.WGS84}),minus180Line:new f.a({paths:[[[-180,-180],[-180,180]]],spatialReference:l.a.WGS84})}};function v(e){return"polygon"===e.type}function b(e){return"polyline"===e[0].type}function x(e){return v(e)?e.rings:e.paths}function _(e,t){return Math.ceil((e-t)/(2*t))}function w(e,t){const r=x(e);for(const e of r)for(const r of e)r[0]+=t;return e}function I(e,t,r){if(t){const t=function(e,t){if(!(e instanceof f.a||e instanceof h.a)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw g.error(e),new a.a(e)}const r=x(e),n=[];for(const e of r){const r=[];n.push(r),r.push([e[0][0],e[0][1]]);for(let n=0;n<e.length-1;n++){const s=e[n][0],i=e[n][1],a=e[n+1][0],o=e[n+1][1],u=Math.sqrt((a-s)*(a-s)+(o-i)*(o-i)),l=(o-i)/u,c=(a-s)/u,h=u/t;if(h>1){for(let e=1;e<=h-1;e++){const n=e*t,a=c*n+s,o=l*n+i;r.push([a,o])}const e=(u+Math.floor(h-1)*t)/2,n=c*e+s,a=l*e+i;r.push([n,a])}r.push([a,o])}}return v(e)?new h.a({rings:n,spatialReference:e.spatialReference}):new f.a({paths:n,spatialReference:e.spatialReference})}(e,1e6);e=Object(c.e)(t,!0)}return r&&(e=w(e,r)),e}function S(e,t,r){if(Array.isArray(e)){const n=e[0];if(n>t){const r=_(n,t);e[0]=n+r*(-2*t)}else if(n<r){const t=_(n,r);e[0]=n+t*(-2*r)}}else{const n=e.x;if(n>t){const r=_(n,t);e=e.clone().offset(r*(-2*t),0)}else if(n<r){const t=_(n,r);e=e.clone().offset(t*(-2*r),0)}}return e}async function N(e,t,r){if(!Array.isArray(e))return N([e],t);const i=t?t.url:n.a.geometryServiceUrl;let a,l,g,v,M,O,T,F,A=0;const E=[],R=[];for(const t of e)if(Object(s.f)(t))R.push(t);else if(a||(a=t.spatialReference,l=Object(u.d)(a),g=a.isWebMercator,O=g?102100:4326,v=y[O].maxX,M=y[O].minX,T=y[O].plus180Line,F=y[O].minus180Line),l)if("mesh"===t.type)R.push(t);else if("point"===t.type)R.push(S(t.clone(),v,M));else if("multipoint"===t.type){const e=t.clone();e.points=e.points.map(e=>S(e,v,M)),R.push(e)}else if("extent"===t.type){const e=t.clone()._normalize(!1,!1,l);R.push(e.rings?new h.a(e):e)}else if(t.extent){const e=t.extent,r=_(e.xmin,M)*(2*v);let n=0===r?t.clone():w(t.clone(),r);e.offset(r,0),e.intersects(T)&&e.xmax!==v?(A=e.xmax>A?e.xmax:A,n=I(n,g),E.push(n),R.push("cut")):e.intersects(F)&&e.xmin!==M?(A=e.xmax*(2*v)>A?e.xmax*(2*v):A,n=I(n,g,360),E.push(n),R.push("cut")):R.push(n)}else R.push(t.clone());else R.push(t);let j=_(A,v),P=-90;const C=j,G=new f.a;for(;j>0;){const e=360*j-180;G.addPath([[e,P],[e,-1*P]]),P*=-1,j--}if(E.length>0&&C>0){const t=function(e,t){let r=-1;for(let n=0;n<t.cutIndexes.length;n++){const s=t.cutIndexes[n],i=t.geometries[n],a=x(i);for(let e=0;e<a.length;e++){const t=a[e];t.some(r=>{if(r[0]<180)return!0;{let r=0;for(let e=0;e<t.length;e++){const n=t[e][0];r=n>r?n:r}r=Number(r.toFixed(9));const n=-360*_(r,180);for(let r=0;r<t.length;r++){const t=i.getPoint(e,r);i.setPoint(e,r,t.clone().offset(n,0))}return!0}})}if(s===r){if("polygon"===e[0].type)for(const t of x(i))e[s]=e[s].addRing(t);else if(b(e))for(const t of x(i))e[s]=e[s].addPath(t)}else r=s,e[s]=i}return e}(E,await async function(e,t,r,n){const s="string"==typeof e?Object(d.I)(e):e,i=t[0].spatialReference,a={...n,query:{...s.query,f:"json",sr:JSON.stringify(i),target:JSON.stringify({geometryType:Object(p.c)(t[0]),geometries:t}),cutter:JSON.stringify(r)}},o=await Object(m.default)(s.path+"/cut",a),{cutIndexes:u,geometries:l=[]}=o.data;return{cutIndexes:u,geometries:l.map(e=>{const t=Object(p.a)(e);return t.spatialReference=i,t})}}(i,E,G,r)),n=[],a=[];for(let r=0;r<R.length;r++){const i=R[r];if("cut"!==i)a.push(i);else{const i=t.shift(),o=e[r];Object(s.g)(o)&&"polygon"===o.type&&o.rings&&o.rings.length>1&&i.rings.length>=o.rings.length?(n.push(i),a.push("simplify")):a.push(g?Object(c.b)(i):i)}}if(!n.length)return a;const o=await async function(e,t,r){const n="string"==typeof e?Object(d.I)(e):e,s=t[0].spatialReference,i=Object(p.c)(t[0]),a={...r,query:{...n.query,f:"json",sr:s.wkid?s.wkid:JSON.stringify(s),geometries:JSON.stringify((o=t,{geometryType:Object(p.c)(o[0]),geometries:o.map(e=>e.toJSON())}))}};var o;return function(e,t,r){const n=Object(p.b)(t);return e.map(e=>{const t=n.fromJSON(e);return t.spatialReference=r,t})}((await Object(m.default)(n.path+"/simplify",a)).data,i,s)}(i,n,r),u=[];for(let e=0;e<a.length;e++){const t=a[e];"simplify"!==t?u.push(t):u.push(g?Object(c.b)(o.shift()):o.shift())}return u}const L=[];for(let e=0;e<R.length;e++){const t=R[e];if("cut"!==t)L.push(t);else{const e=E.shift();L.push(!0===g?Object(c.b)(e):e)}}return Object(o.s)(L)}},259:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return y}));var n=r(2),s=r(78),i=r(129),a=r(308),o=r(313);const u=[0,0];function l(e,t){if(!t)return null;if("x"in t){const r={x:0,y:0};return[r.x,r.y]=e(t.x,t.y,u),null!=t.z&&(r.z=t.z),null!=t.m&&(r.m=t.m),r}if("xmin"in t){const r={xmin:0,ymin:0,xmax:0,ymax:0};return[r.xmin,r.ymin]=e(t.xmin,t.ymin,u),[r.xmax,r.ymax]=e(t.xmax,t.ymax,u),t.hasZ&&(r.zmin=t.zmin,r.zmax=t.zmax,r.hasZ=!0),t.hasM&&(r.mmin=t.mmin,r.mmax=t.mmax,r.hasM=!0),r}return"rings"in t?{rings:c(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:c(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:h(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function c(e,t){const r=[];for(const n of e)r.push(h(n,t));return r}function h(e,t){const r=[];for(const n of e){const e=t(n[0],n[1],[0,0]);r.push(e),n.length>2&&e.push(n[2]),n.length>3&&e.push(n[3])}return r}async function f(e,t){if(!t)return;const r=Array.isArray(e)?e.map(e=>{var t;return null==(t=e.geometry)?void 0:t.spatialReference}):[e];await Object(a.b)(r.map(e=>({source:e,dest:t})))}const d=l.bind(null,i.c),p=l.bind(null,i.f);function m(e,t,r){return e?(r||(r=t,t=e.spatialReference),Object(s.i)(t)&&Object(s.i)(r)&&!Object(s.c)(t,r)?Object(i.a)(t,r)?Object(s.m)(r)?d(e):p(e):Object(a.h)(o.a,[e],t,r,null)[0]:e):e}const g=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,r){!e||!e.length||!t||!r||Object(s.c)(t,r);const i={geometries:e,inSpatialReference:t,outSpatialReference:r,resolve:null};return this._jobs.push(i),Object(n.c)(e=>{i.resolve=e,null===this._timer&&(this._timer=setTimeout(this._process,10))})}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:r,outSpatialReference:n,resolve:u}=e;Object(i.a)(r,n)?Object(s.m)(n)?u(t.map(d)):u(t.map(p)):u(Object(a.h)(o.a,t,r,n,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};async function y(e,t,r){return g.push(e,t,r)}},260:function(e,t,r){"use strict";class n{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new n;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}t.a=n},261:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i}));var n=r(17);class s{constructor(e,t,r){this._namespace=e,this._storage=t,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",r&&(this._storage.registerRemoveFunc(this._namespace,r),this._removeFunc=!0)}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this)}put(e,t,r,n=0){this._storage.put(this._namespace+e,t,r,n)}get(e){const t=this._storage.get(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}pop(e){const t=this._storage.pop(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}updateSize(e,t,r){this._storage.updateSize(this._namespace+e,t,r)}clear(){this._storage.clear(this._namespace)}clearAll(){this._storage.clearAll()}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats()}}class i{constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=[],this._users=new n.a}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,t){this._removeFuncs.push([e,t])}deregisterRemoveFunc(e){this._removeFuncs=this._removeFuncs.filter(t=>t[0]!==e)}get size(){return this._size}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,0),this._checkSizeLimit()}put(e,t,r,n){const s=this._db.get(e);if(s&&(this._size-=s.size,this._db.delete(e),s.entry!==t&&this._notifyRemoved(e,s.entry)),r>this._maxSize)return void this._notifyRemoved(e,t);if(void 0===t)return void console.warn("Refusing to cache undefined entry ");if(!r||r<0)return void console.warn("Refusing to cache entry with invalid size "+r);const i=1+Math.max(n,-3)- -3;this._db.set(e,{entry:t,size:r,lifetime:i,lives:i}),this._size+=r,this._checkSizeLimit()}updateSize(e,t,r){const n=this._db.get(e);n&&n.entry===t&&(this._size-=n.size,r>this._maxSize?this._notifyRemoved(e,t):(n.size=r,this._size+=r,this._checkSizeLimit()))}pop(e){const t=this._db.get(e);if(t)return this._size-=t.size,this._db.delete(e),++this._hit,t.entry;++this._miss}get(e){const t=this._db.get(e);if(void 0!==t)return this._db.delete(e),t.lives=t.lifetime,this._db.set(e,t),++this._hit,t.entry;++this._miss}getStats(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},r=new Array;this._db.forEach((e,n)=>{const s=e.lifetime;r[s]=(r[s]||0)+e.size,this._users.forAll(r=>{const s=r.namespace;if(n.startsWith(s)){const r=t[s]||0;t[s]=r+e.size}})});const n={};this._users.forAll(e=>{const r=e.namespace;if(!isNaN(e.hitRate)&&e.hitRate>0){const s=t[r]||0;t[r]=s,n[r]=Math.round(100*e.hitRate)+"%"}else n[r]="0%"});const s=Object.keys(t);s.forEach(e=>t[e]=t[e]/this._size*100),s.sort((e,r)=>t[r]-t[e]),s.forEach(r=>e[r]=Math.round(t[r])+"% / "+n[r]);for(let t=r.length-1;t>=0;--t){const n=r[t];n&&(e["Priority "+(t+-3-1)]=Math.round(n/this.size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll(e=>e.resetHitRate())}clear(e){this._db.forEach((t,r)=>{r.startsWith(e)&&(this._size-=t.size,this._db.delete(r),this._notifyRemoved(r,t.entry))})}clearAll(){this._db.forEach((e,t)=>this._notifyRemoved(t,e.entry)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemoved(e,t){this._removeFuncs.forEach(r=>{e.startsWith(r[0])&&r[1](t)})}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(const[e,t]of this._db)if(this._db.delete(e),t.lives<=1?(this._size-=t.size,this._notifyRemoved(e,t.entry)):(--t.lives,this._db.set(e,t)),this._size<=.9*this.maxSize)return}}},313:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,r){const n=new s(e.getPointX(t),e.getPointY(t),r),i=e.hasZ(t),a=e.hasM(t);return i&&(n.z=e.getPointZ(t)),a&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,r){return new i(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new a(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new o(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){const n=e.hasZ(t),s=e.hasM(t),i=new u(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(n){const r=e.getZExtent(t);i.zmin=r.vmin,i.zmax=r.vmax}if(s){const r=e.getMExtent(t);i.mmin=r.vmin,i.mmax=r.vmax}return i}};class s{constructor(e,t,r){this.x=e,this.y=t,this.spatialReference=r,this.z=void 0,this.m=void 0}}class i{constructor(e,t,r,n){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}class a{constructor(e,t,r,n){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}class o{constructor(e,t,r,n){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}class u{constructor(e,t,r,n,s){this.xmin=e,this.ymin=t,this.xmax=r,this.ymax=n,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},315:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(446);function s(e,t){if(!(this instanceof s))return new s(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this.toBBox=t:this._initFormat(t)),this.clear()}function i(e,t,r){if(!r)return t.indexOf(e);for(var n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}function a(e,t){o(e,0,e.children.length,t,e)}function o(e,t,r,n,s){s||(s=m(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var i,a=t;a<r;a++)i=e.children[a],u(s,e.leaf?n(i):i);return s}function u(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function l(e,t){return e.minX-t.minX}function c(e,t){return e.minY-t.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function d(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function p(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function m(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,t,r,s,i){for(var a,o=[t,r];o.length;)(r=o.pop())-(t=o.pop())<=s||(a=t+Math.ceil((r-t)/s/2)*s,Object(n.a)(e,a,t,r,i),o.push(t,a,a,r))}s.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,r=[],n=this.toBBox;if(!p(e,t))return r;for(var s,i,a,o,u=[];t;){for(s=0,i=t.children.length;s<i;s++)a=t.children[s],p(e,o=t.leaf?n(a):a)&&(t.leaf?r.push(a):d(e,o)?this._all(a,r):u.push(a));t=u.pop()}return r},collides:function(e){var t=this.data,r=this.toBBox;if(!p(e,t))return!1;for(var n,s,i,a,o=[];t;){for(n=0,s=t.children.length;n<s;n++)if(i=t.children[n],p(e,a=t.leaf?r(i):i)){if(t.leaf||d(e,a))return!0;o.push(i)}t=o.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var s=this.data;this.data=n,n=s}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(e,t){if(!e)return this;for(var r,n,s,a,o=this.data,u=this.toBBox(e),l=[],c=[];o||l.length;){if(o||(o=l.pop(),n=l[l.length-1],r=c.pop(),a=!0),o.leaf&&-1!==(s=i(e,o.children,t)))return o.children.splice(s,1),l.push(o),this._condense(l),this;a||o.leaf||!d(o,u)?n?(r++,o=n.children[r],a=!1):o=null:(l.push(o),c.push(r),r=0,n=o,o=o.children[0])}return this},toBBox:function(e){return e},compareMinX:l,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},_build:function(e,t,r,n){var s,i=r-t+1,o=this._maxEntries;if(i<=o)return a(s=m(e.slice(t,r+1)),this.toBBox),s;n||(n=Math.ceil(Math.log(i)/Math.log(o)),o=Math.ceil(i/Math.pow(o,n-1))),(s=m([])).leaf=!1,s.height=n;var u,l,c,h,f=Math.ceil(i/o),d=f*Math.ceil(Math.sqrt(o));for(g(e,t,r,d,this.compareMinX),u=t;u<=r;u+=d)for(g(e,u,c=Math.min(u+d-1,r),f,this.compareMinY),l=u;l<=c;l+=f)h=Math.min(l+f-1,c),s.children.push(this._build(e,l,h,n-1));return a(s,this.toBBox),s},_chooseSubtree:function(e,t,r,n){for(var s,i,a,o,u,l,c,f,d,p;n.push(t),!t.leaf&&n.length-1!==r;){for(c=f=1/0,s=0,i=t.children.length;s<i;s++)u=h(a=t.children[s]),d=e,p=a,(l=(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-u)<f?(f=l,c=u<c?u:c,o=a):l===f&&u<c&&(c=u,o=a);t=o||t.children[0]}return t},_insert:function(e,t,r){var n=this.toBBox,s=r?e:n(e),i=[],a=this._chooseSubtree(s,this.data,t,i);for(a.children.push(e),u(a,s);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(s,i,t)},_split:function(e,t){var r=e[t],n=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,n);var i=this._chooseSplitIndex(r,s,n),o=m(r.children.splice(i,r.children.length-i));o.height=r.height,o.leaf=r.leaf,a(r,this.toBBox),a(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)},_splitRoot:function(e,t){this.data=m([e,t]),this.data.height=e.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,r){var n,s,i,a,u,l,c,f,d,p,m,g,y,v;for(l=c=1/0,n=t;n<=r-t;n++)d=s=o(e,0,n,this.toBBox),p=i=o(e,n,r,this.toBBox),void 0,void 0,void 0,void 0,m=Math.max(d.minX,p.minX),g=Math.max(d.minY,p.minY),y=Math.min(d.maxX,p.maxX),v=Math.min(d.maxY,p.maxY),a=Math.max(0,y-m)*Math.max(0,v-g),u=h(s)+h(i),a<l?(l=a,f=n,c=u<c?u:c):a===l&&u<c&&(c=u,f=n);return f},_chooseSplitAxis:function(e,t,r){var n=e.leaf?this.compareMinX:l,s=e.leaf?this.compareMinY:c;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,s)&&e.children.sort(n)},_allDistMargin:function(e,t,r,n){e.children.sort(n);var s,i,a=this.toBBox,l=o(e,0,t,a),c=o(e,r-t,r,a),h=f(l)+f(c);for(s=t;s<r-t;s++)i=e.children[s],u(l,e.leaf?a(i):i),h+=f(l);for(s=r-t-1;s>=t;s--)i=e.children[s],u(c,e.leaf?a(i):i),h+=f(c);return h},_adjustParentBBoxes:function(e,t,r){for(var n=r;n>=0;n--)u(t[n],e)},_condense:function(e){for(var t,r=e.length-1;r>=0;r--)0===e[r].children.length?r>0?(t=e[r-1].children).splice(t.indexOf(e[r]),1):this.clear():a(e[r],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},316:function(e,t,r){"use strict";function n(e,t){return e?t?4:3:t?3:2}function s(e,t,r,s,o){if(!t||!t.lengths.length)return null;const u="upperLeft"===(null==o?void 0:o.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const l=e.coords,c=[],h=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:d}=t,p=n(r,s);let m=0;for(const e of f){const t=i(h,d,m,e,r,s,u);t&&c.push(t),m+=e*p}if(c.sort((e,t)=>{let n=u*e[2]-u*t[2];return 0===n&&r&&(n=e[4]-t[4]),n}),c.length){let e=6*c[0][2];l[0]=c[0][0]/e,l[1]=c[0][1]/e,r&&(e=6*c[0][4],l[2]=0!==e?c[0][3]/e:0),(l[0]<h[0]||l[0]>h[1]||l[1]<h[2]||l[1]>h[3]||r&&(l[2]<h[4]||l[2]>h[5]))&&(l.length=0)}if(!l.length){const e=t.lengths[0]?a(d,0,f[0],r,s):null;if(!e)return null;l[0]=e[0],l[1]=e[1],r&&e.length>2&&(l[2]=e[2])}return e}function i(e,t,r,s,i,a,o=1){const u=n(i,a);let l=r,c=r+u,h=0,f=0,d=0,p=0,m=0;for(let r=0,n=s-1;r<n;r++,l+=u,c+=u){const r=t[l],n=t[l+1],s=t[l+2],a=t[c],o=t[c+1],u=t[c+2];let g=r*o-a*n;p+=g,h+=(r+a)*g,f+=(n+o)*g,i&&(g=r*u-a*s,d+=(s+u)*g,m+=g),r<e[0]&&(e[0]=r),r>e[1]&&(e[1]=r),n<e[2]&&(e[2]=n),n>e[3]&&(e[3]=n),i&&(s<e[4]&&(e[4]=s),s>e[5]&&(e[5]=s))}if(p*o>0&&(p*=-1),m*o>0&&(m*=-1),!p)return null;const g=[h,f,.5*p];return i&&(g[3]=d,g[4]=.5*m),g}function a(e,t,r,s,i){const a=n(s,i);let h=t,f=t+a,d=0,p=0,m=0,g=0;for(let t=0,n=r-1;t<n;t++,h+=a,f+=a){const t=e[h],r=e[h+1],n=e[h+2],i=e[f],a=e[f+1],y=e[f+2],v=s?u(t,r,n,i,a,y):o(t,r,i,a);if(v)if(d+=v,s){const e=c(t,r,n,i,a,y);p+=v*e[0],m+=v*e[1],g+=v*e[2]}else{const e=l(t,r,i,a);p+=v*e[0],m+=v*e[1]}}return d>0?s?[p/d,m/d,g/d]:[p/d,m/d]:r>0?s?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function o(e,t,r,n){const s=r-e,i=n-t;return Math.sqrt(s*s+i*i)}function u(e,t,r,n,s,i){const a=n-e,o=s-t,u=i-r;return Math.sqrt(a*a+o*o+u*u)}function l(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function c(e,t,r,n,s,i){return[e+.5*(n-e),t+.5*(s-t),r+.5*(i-r)]}r.d(t,"a",(function(){return s}))},339:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return a}));var n=r(7),s=r(5),i=r(445);function a(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?i.a:"esriGeometryPolyline"===e?i.c:i.b}}}function o(e,t){if(Object(n.a)("csp-restrictions"))return()=>({[t]:null,...e});try{let r=`this.${t} = null;`;for(const t in e)r+=`this${t.indexOf(".")?`["${t}"]`:"."+t} = ${JSON.stringify(e[t])};`;const n=new Function(r);return()=>new n}catch(r){return()=>({[t]:null,...e})}}function u(e={}){return[{name:"New Feature",description:"",prototype:{attributes:Object(s.a)(e)}}]}},381:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return p}));r(61);const n=(e,t,r)=>[t,r],s=(e,t,r)=>[t,r,e[2]],i=(e,t,r)=>[t,r,e[2],e[3]];function a(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:[e.tolerance,e.tolerance],translate:[e.extent.xmin,e.extent.ymax]}:null}function o({scale:e,translate:t},r){return r*e[0]+t[0]}function u({scale:e,translate:t},r){return t[1]-r*e[1]}function l(e,t,r){const n=new Array(r.length);if(!r.length)return n;const[s,i]=e.scale;let a=o(e,r[0][0]),l=u(e,r[0][1]);n[0]=t(r[0],a,l);for(let e=1;e<r.length;e++){const o=r[e];a+=o[0]*s,l-=o[1]*i,n[e]=t(o,a,l)}return n}function c(e,t,r){const n=new Array(r.length);for(let s=0;s<r.length;s++)n[s]=l(e,t,r[s]);return n}function h(e,t,r,a,o){return t.points=function(e,t,r,a){return l(e,r?a?i:s:a?s:n,t)}(e,r.points,a,o),t}function f(e,t,r,n,s){return t.x=o(e,r.x),t.y=u(e,r.y),t!==r&&(n&&(t.z=r.z),s&&(t.m=r.m)),t}function d(e,t,r,a,o){return t.rings=function(e,t,r,a){return c(e,r?a?i:s:a?s:n,t)}(e,r.rings,a,o),t}function p(e,t,r,a,o){return t.paths=function(e,t,r,a){return c(e,r?a?i:s:a?s:n,t)}(e,r.paths,a,o),t}},423:function(e,t,r){"use strict";var n=r(5),s=r(1),i=r(14),a=r(2),o=r(78),u=r(258),l=r(61),c=r(67),h=r(114),f=r(261),d=r(45),p=r(141),m=r(493),g=r(194),y=r(259),v=r(447),b=r(138);const x=new class{constructor(e,t){this._cache=new v.a(e),this._invalidCache=new v.a(t)}get(e,t){const r=`${t.uid}:${e}`,n=this._cache.get(r);if(n)return n;if(void 0!==this._invalidCache.get(r))return null;try{const n=b.WhereClause.create(e,t);return this._cache.put(r,n),n}catch{return this._invalidCache.put(r,null),null}}}(50,500),_="feature-store:unsupported-query",w=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function I(e,t){return e?x.get(e,t):null}function S(e,t,r,n=!0){const s=[];for(const r of t)if("*"!==r&&!e.has(r))if(n){const t=N(r);try{const r=I(t,e);if(!r)throw new i.a(_,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new i.a(_,"expression is not standard",{clause:r});S(e,r.fieldNames,"expression contains missing fields")}catch(e){const t=e&&e.details;if(t&&(t.clause||t.where))throw e;t&&t.missingFields?s.push(...t.missingFields):s.push(r)}}else s.push(r);if(s.length)throw new i.a(_,r,{missingFields:s})}function N(e){return e.split(" as ")[0]}function M(e,t){const r=t.get(e);return!!r&&!w.has(r.type)}var O=r(485),T=r(448),F=r(104),A=r(381),E=class{constructor(e,t,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=r,this.featureAdapter=t;const n=e.outFields;if(n&&-1===n.indexOf("*")){this.outFields=n;let e=0;for(const t of n){const n=N(t),s=this.fieldsIndex.get(n),i=s?null:I(n,r),a=s?s.name:t.split(" as ")[1]||"FIELD_EXP_"+e++;this._fieldDataCache.set(t,{alias:a,clause:i})}}}countDistinctValues(e){return this.returnDistinctValues?(e.forEach(e=>this.getAttributes(e)),this._returnDistinctMap.size):e.length}getAttributes(e){const t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}getFieldValue(e,t,r){const n=r?r.name:t;let s=null;return this._fieldDataCache.has(n)?s=this._fieldDataCache.get(n).clause:r||(s=I(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:s})),r?this.featureAdapter.getAttribute(e,n):s.calculateValue(e,this.featureAdapter)}validateItem(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:I(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}validateItems(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:I(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}_processAttributesForOutFields(e){const t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);const r={};for(const n of t){const{alias:t,clause:s}=this._fieldDataCache.get(n);r[t]=s?s.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,t)}return r}_processAttributesForDistinctValues(e){if(Object(s.f)(e)||!this.returnDistinctValues)return e;const t=this.outFields,r=[];if(t)for(const n of t){const{alias:t}=this._fieldDataCache.get(n);r.push(e[t])}else for(const t in e)r.push(e[t]);const n=`${(t||["*"]).join(",")}=${r.join(",")}`;let i=this._returnDistinctMap.get(n)||0;return this._returnDistinctMap.set(n,++i),i>1?null:e}};function R(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function j(e,t,r){return(r?e>t:e<t)?-1:(r?e<t:e>t)?1:0}function P(e,t,r){return r?t-e:e-t}function C(e,t,r,n){if(r&&"esriFieldTypeDate"===r.type){const r=new Date(e).getTime(),s=new Date(t).getTime();if(!isNaN(r)&&!isNaN(s))return P(r,s,n)}if("number"==typeof e&&"number"==typeof t)return P(e,t,n);if("string"==typeof e&&"string"==typeof t){const s=e.toUpperCase(),i=t.toUpperCase();return!r||"esriFieldTypeGUID"!==r.type&&"esriFieldTypeGlobalID"!==r.type?j(s,i,n):j(R(s),R(i),n)}return n?1:-1}class G{constructor(e,t,r){this.items=e,this.queryGeometry=t,this.definitionExpression=r.definitionExpression,this.geometryType=r.geometryType,this.hasM=r.hasM,this.hasZ=r.hasZ,this.objectIdField=r.objectIdField,this.spatialReference=r.spatialReference,this.fieldsIndex=r.fieldsIndex,this.timeInfo=r.timeInfo,this.featureAdapter=r.featureAdapter,this.aggregateAdapter=r.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(e){const t=new E(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);const{groupByFieldsForStatistics:r,having:n}=e;if(!(null==r?void 0:r.length))return 1;const s=new Map,i=new Map,a=new Set,o=e.outStatistics;for(const e of o){const{statisticType:o}=e,u="exceedslimit"!==o?e.onStatisticField:void 0;if(!i.has(u)){const e=[];for(const n of r){const r=this._getAttributeValues(t,n,s);e.push(r)}i.set(u,this._calculateUniqueValues(e))}const l=i.get(u);for(const e in l){const{data:r,items:s}=l[e],i=r.join(",");n&&!t.validateItems(s,n)||a.add(i)}}return a.size}createQueryResponse(e){let t;return t=e.outStatistics?e.outStatistics.some(e=>"exceedslimit"===e.statisticType)?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(Object(o.i)(e.outSR)&&!Object(o.c)(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=Object(O.d)({spatialReference:e.outSR,...Object(y.b)(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR)}):t.queryGeometry=Object(O.d)({spatialReference:e.outSR,...this.queryGeometry})),t}executeAttributesQuery(e){const t=I(e.where,this.fieldsIndex);if(!t)return Object(a.s)(this);if(t.isStandardized){let r=0;const n=[];for(const e of this.items)t.testFeature(e,this.featureAdapter)&&(n[r++]=e);const s=new G(n,this.queryGeometry,this);return s.definitionExpression=e.where,Object(a.s)(s)}return Object(a.r)(new TypeError("Where clause is not standardized"))}executeAggregateIdsQuery(e){if(!e.aggregateIds||!e.aggregateIds.length||Object(s.f)(this.aggregateAdapter))return Object(a.s)(this);const t=new Set;for(const r of e.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(r).forEach(e=>t.add(e));const r=this.featureAdapter.getObjectId;return Object(a.s)(new G(this.items.filter(e=>t.has(r(e))),this.queryGeometry,this))}executeObjectIdsQuery(e){if(!e.objectIds||!e.objectIds.length)return Object(a.s)(this);const t=new Set(e.objectIds),r=this.featureAdapter.getObjectId;return Object(a.s)(new G(this.items.filter(e=>t.has(r(e))),this.queryGeometry,this))}executeTimeQuery(e){const t=Object(T.b)(this.timeInfo,e.timeExtent,this.featureAdapter);if(!Object(s.g)(t))return Object(a.s)(this);const r=this.items.filter(t);return Object(a.s)(new G(r,this.queryGeometry,this))}filterLatest(){const{trackIdField:e,startTimeField:t,endTimeField:r}=this.timeInfo,n=r||t,s=new Map,i=this.featureAdapter.getAttribute;for(const t of this.items){const r=i(t,e),a=i(t,n),o=s.get(r);(!o||a>i(o,n))&&s.set(r,t)}const o=Array.from(s.values());return Object(a.s)(new G(o,this.queryGeometry,this))}async project(e){if(!e||Object(o.c)(this.spatialReference,e))return this;const t=this.featureAdapter,r=(await Object(y.c)(this.items.map(e=>Object(O.f)(this.geometryType,this.hasZ,this.hasM,t.getGeometry(e))),this.spatialReference,e)).map((e,r)=>t.cloneWithGeometry(this.items[r],Object(F.d)(e,this.hasZ,this.hasM)));return new G(r,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:e,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})}_sortFeatures(e,t,r){if(e.length>1&&t&&t.length)for(const n of t.reverse()){const t=n.split(" "),s=t[0],i=this.fieldsIndex.get(s),a=t[1]&&"desc"===t[1].toLowerCase();e.sort((e,t)=>C(r(e,s,i),r(t,s,i),i,a))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:r,hasM:n,hasZ:s,objectIdField:i,spatialReference:a}=this,{outFields:o,outSR:u,quantizationParameters:l,resultRecordCount:c,resultOffset:h,returnZ:f,returnM:d}=e,p=null!=c&&t.length>(h||0)+c,m=o&&(o.indexOf("*")>-1?[...this.fieldsIndex.fields]:o.map(e=>this.fieldsIndex.get(e)));return{exceededTransferLimit:p,features:this._createFeatures(e,t),fields:m,geometryType:r,hasM:n&&d,hasZ:s&&f,objectIdFieldName:i,spatialReference:Object(O.d)(u||a),transform:l&&Object(A.a)(l)||null}}_createFeatures(e,t){const r=new E(e,this.featureAdapter,this.fieldsIndex),{hasM:n,hasZ:s}=this,{orderByFields:i,quantizationParameters:a,returnGeometry:o,returnCentroid:u,maxAllowableOffset:l,resultOffset:c,resultRecordCount:h,returnZ:f=!1,returnM:d=!1}=e,p=s&&f,m=n&&d;let g=[],y=0;const v=[...t];if(this._sortFeatures(v,i,(e,t,n)=>r.getFieldValue(e,t,n)),o||u){const e=Object(A.a)(a);if(o&&!u)for(const t of v)g[y++]={attributes:r.getAttributes(t),geometry:Object(O.f)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),l,e,p,m)};else if(!o&&u)for(const t of v)g[y++]={attributes:r.getAttributes(t),centroid:Object(O.i)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of v)g[y++]={attributes:r.getAttributes(t),centroid:Object(O.i)(this,this.featureAdapter.getCentroid(t,this),e),geometry:Object(O.f)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),l,e,p,m)}}else for(const e of v){const t=r.getAttributes(e);t&&(g[y++]={attributes:t})}const b=c||0;if(null!=h){const e=b+h;g=g.slice(b,Math.min(g.length,e))}return g}_createExceedsLimitQueryResponse(e){let t=!1,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(const t of e.outStatistics)if("exceedslimit"===t.statisticType){r=null!=t.maxPointCount?t.maxPointCount:Number.POSITIVE_INFINITY,n=null!=t.maxRecordCount?t.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=t.maxVertexCount?t.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>r;else if(this.items.length>n)t=!0;else{const e=this.hasZ?this.hasM?4:3:this.hasM?3:2,r=this.featureAdapter;t=this.items.reduce((e,t)=>{const n=r.getGeometry(t);return e+(n&&n.coords.length||0)},0)/e>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}_createStatisticsQueryResponse(e){const t={attributes:{}},r=[],n=new Map,s=new Map,i=new Map,a=new Map,o=new E(e,this.featureAdapter,this.fieldsIndex),u=e.outStatistics,{groupByFieldsForStatistics:l,having:c,orderByFields:h}=e,f=l&&l.length,d=!!f,p=d&&l[0],m=d&&!this.fieldsIndex.get(p);for(const e of u){const{outStatisticFieldName:u,statisticType:h}=e,g=e,y="exceedslimit"!==h?e.onStatisticField:void 0,v="percentile_disc"===h||"percentile_cont"===h,b=d&&1===f&&(y===p||m)&&"count"===h;if(d){if(!i.has(y)){const e=[];for(const t of l){const r=this._getAttributeValues(o,t,n);e.push(r)}i.set(y,this._calculateUniqueValues(e))}const e=i.get(y);for(const t in e){const{count:r,data:s,items:i,itemPositions:h}=e[t],f=s.join(",");if(!c||o.validateItems(i,c)){const e=a.get(f)||{attributes:{}};let t=null;if(b)t=r;else{const e=this._getAttributeValues(o,y,n),r=h.map(t=>e[t]);t=v&&"statisticParameters"in g?this._getPercentileValue(g,r):this._getStatisticValue(g,r)}e.attributes[u]=t,l.forEach((t,r)=>e.attributes[this.fieldsIndex.get(t)?t:"EXPR_"+(r+1)]=s[r]),a.set(f,e)}}}else{const e=this._getAttributeValues(o,y,n);t.attributes[u]=v&&"statisticParameters"in g?this._getPercentileValue(g,e):this._getStatisticValue(g,e,s)}r.push({name:u,alias:u,type:"esriFieldTypeDouble"})}const g=d?Array.from(a.values()):[t];return this._sortFeatures(g,h,(e,t)=>e.attributes[t]),{fields:r,features:g}}_getStatisticValue(e,t,r){const{onStatisticField:n,statisticType:s}=e,i=r&&r.has(n)?r.get(n):this._calculateStatistics(t);return r&&r.set(n,i),i["var"===s?"variance":s]}_getPercentileValue(e,t){const{onStatisticField:r,statisticParameters:n,statisticType:s}=e,{value:i,orderBy:a}=n,o="desc"===a,u=this.fieldsIndex.get(r),l=[...t].filter(e=>null!=e).sort((e,t)=>C(e,t,u,o));return this._calculatePercentile(l,i,"percentile_disc"===s)}_getAttributeValues(e,t,r){if(r.has(t))return r.get(t);const n=this.fieldsIndex.get(t),s=this.items.map(r=>e.getFieldValue(r,t,n));return r.set(t,s),s}_calculateStatistics(e){let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=null,s=null,i=null,a=null;const o=[];let u=0;for(const s of e)"string"==typeof s?u++:null==s||isNaN(s)||(n+=s,t=Math.min(t,s),r=Math.max(r,s),o.push(s),u++);if(u){s=n/u;let e=0;for(const t of o)e+=Math.pow(t-s,2);a=u>1?e/(u-1):0,i=Math.sqrt(a)}else t=null,r=null;return{avg:s,count:u,max:r,min:t,stddev:i,sum:n,variance:a}}_calculateUniqueValues(e){const t={},r=this.items,n=r.length;for(let s=0;s<n;s++){const n=r[s],i=[];for(const t of e)i.push(t[s]);const a=i.join(",");null==t[a]?t[a]={count:1,data:i,items:[n],itemPositions:[s]}:(t[a].count++,t[a].items.push(n),t[a].itemPositions.push(s))}return t}_calculatePercentile(e,t,r){if(0===e.length)return null;if(t<=0)return e[0];if(t>=1)return e[e.length-1];const n=(e.length-1)*t,s=Math.floor(n),i=s+1,a=n%1,o=e[s],u=e[i];return i>=e.length||r||"string"==typeof o||"string"==typeof u?o:o*(1-a)+u*a}}var L=G;const z=new Set,D=new f.b(2e6);let Q=0;const q=Object(g.b)(),k=Object(g.b)();t.a=class{constructor(e){this.capabilities={query:m.a},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new f.a(Q+++"$$",D)),this.fieldsIndex=new p.a(e.fields),e.scheduler&&e.task&&(this._frameQueue=new d.a,this._frameTask=e.scheduler.registerTask(e.task,e=>this._update(e),()=>this._frameQueue.length>0))}destroy(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:Object(O.d)(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=Object(T.a)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}async executeQuery(e={},t){let r,s=Object(n.a)(e);try{s=await this._schedule(()=>Object(O.b)(s,this.definitionExpression,this.spatialReference),t),s=await this._reschedule(()=>this._checkQuerySupport(s),t),r=await this._reschedule(()=>this._executeGeometryQuery(s,t),t),r=await this._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=await this._reschedule(()=>r.executeObjectIdsQuery(s),t),r=await this._reschedule(()=>r.executeTimeQuery(s),t),r=await this._reschedule(()=>r.executeAttributesQuery(s),t)}catch(e){if(e!==O.a)throw e;r=new L([],null,this)}return r.createQueryResponse(s)}async executeQueryForCount(e={},t){let r,s=Object(n.a)(e);s.returnGeometry=!1,s.returnCentroid=!1,s.outSR=null;try{s=await this._schedule(()=>Object(O.b)(s,this.definitionExpression,this.spatialReference),t),s=await this._reschedule(()=>this._checkQuerySupport(s),t),r=await this._reschedule(()=>this._executeGeometryQuery(s,t),t),r=await this._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=await this._reschedule(()=>r.executeObjectIdsQuery(s),t),r=await this._reschedule(()=>r.executeTimeQuery(s),t),r=await this._reschedule(()=>r.executeAttributesQuery(s),t)}catch(e){if(e!==O.a)throw e;return 0}return r.createQueryResponseForCount(s)}async executeQueryForExtent(e={},t){let r,s=Object(n.a)(e);const i=s.outSR;try{s=await this._schedule(()=>Object(O.b)(s,this.definitionExpression,this.spatialReference),t),s=await this._reschedule(()=>this._checkQuerySupport(s),t),s.returnGeometry=!0,s.returnCentroid=!1,s.outSR=null,r=await this._reschedule(()=>this._executeGeometryQuery(s,t),t),r=await this._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=await this._reschedule(()=>r.executeObjectIdsQuery(s),t),r=await this._reschedule(()=>r.executeTimeQuery(s),t),r=await this._reschedule(()=>r.executeAttributesQuery(s),t);const e=r.size;if(!e)return{count:e,extent:null};Object(g.j)(k,g.a),this.featureStore.forEachBounds(r.items,e=>Object(g.e)(k,e),q);const n={xmin:k[0],ymin:k[1],xmax:k[3],ymax:k[4],spatialReference:Object(O.d)(this.spatialReference)};this.hasZ&&isFinite(k[2])&&isFinite(k[5])&&(n.zmin=k[2],n.zmax=k[5]);const a=Object(y.b)(n,r.spatialReference,i);if(a.spatialReference=Object(O.d)(i||this.spatialReference),a.xmax-a.xmin==0){const e=Object(c.b)(a.spatialReference);a.xmin-=e,a.xmax+=e}if(a.ymax-a.ymin==0){const e=Object(c.b)(a.spatialReference);a.ymin-=e,a.ymax+=e}if(this.hasZ&&null!=a.zmin&&null!=a.zmax&&a.zmax-a.zmin==0){const e=Object(c.b)(a.spatialReference);a.zmin-=e,a.zmax+=e}return{count:e,extent:a}}catch(e){if(e===O.a)return{count:0,extent:null};throw e}}async executeQueryForIds(e={},t){return this.executeQueryForIdSet(e,t).then(e=>Array.from(e))}async executeQueryForIdSet(e={},t){let r,s=Object(n.a)(e);s.returnGeometry=!1,s.returnCentroid=!1,s.outSR=null;try{s=await this._schedule(()=>Object(O.b)(s,this.definitionExpression,this.spatialReference),t),s=await this._reschedule(()=>this._checkQuerySupport(s),t),r=await this._reschedule(()=>this._executeGeometryQuery(s,t),t),r=await this._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=await this._reschedule(()=>r.executeObjectIdsQuery(s),t),r=await this._reschedule(()=>r.executeTimeQuery(s),t),r=await this._reschedule(()=>r.executeAttributesQuery(s),t);const e=r.items,n=new Set;return await this._reschedule(()=>{for(const t of e)n.add(r.featureAdapter.getObjectId(t))},t),n}catch(e){if(e===O.a)return new Set;throw e}}async executeQueryForLatestObservations(e={},t){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new i.a("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:this.timeInfo});let r,s=Object(n.a)(e);try{s=await this._schedule(()=>Object(O.b)(s,this.definitionExpression,this.spatialReference),t),s=await this._reschedule(()=>this._checkQuerySupport(s),t),r=await this._reschedule(()=>this._executeGeometryQuery(s,t),t),r=await this._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=await this._reschedule(()=>r.executeObjectIdsQuery(s),t),r=await this._reschedule(()=>r.executeTimeQuery(s),t),r=await this._reschedule(()=>r.executeAttributesQuery(s),t),r=await this._reschedule(()=>r.filterLatest(),t)}catch(e){if(e!==O.a)throw e;r=new L([],null,this)}return r.createQueryResponse(s)}async _schedule(e,t){return this._frameQueue?this._frameQueue.push(e,t):e()}async _reschedule(e,t){return this._frameQueue?this._frameQueue.unshift(e,t):e()}_update(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null}_getAll(){if(!this._allItems){const e=[];this.featureStore.forEach(t=>e.push(t)),this._allItems=new L(e,null,this)}return this._allItems}async _executeGeometryQuery(e,t){const{geometry:r,outSR:n,spatialRel:i}=e,a=Object(o.i)(n)&&!Object(o.c)(this.spatialReference,n),u=this._geometryQueryCache?a?JSON.stringify({geometry:r,spatialRelationship:i,outSpatialReference:n}):JSON.stringify({geometry:r,spatialRelationship:i}):null;if(u){const e=this._geometryQueryCache.get(u);if(!Object(s.h)(e))return e}const l=async t=>{if(a&&(e.returnGeometry||e.returnCentroid)){const e=await t.project(n);return u&&this._geometryQueryCache.put(u,e,e.size||1),e}return u&&this._geometryQueryCache.put(u,t,t.size||1),t};if(!r)return l(this._getAll());const c=this.featureAdapter;if("esriSpatialRelDisjoint"===i){const e=this._searchFeatures(this._getQueryBBoxes(r));if(!e.length)return l(this._getAll());let n,s;const a=new Set;for(const t of e)a.add(c.getObjectId(t));return await this._reschedule(()=>{let e=0;n=new Array(a.size),this.featureStore.forEach(t=>n[e++]=t),s=a},t),l(await this._reschedule(async()=>{const e=await Object(O.g)(i,r,this.geometryType,this.hasZ,this.hasM);return new L(await this._runSpatialFilter(n,t=>!s.has(c.getObjectId(t))||e(c.getGeometry(t)),t),r,this)},t))}const h=this._searchFeatures(this._getQueryBBoxes(r));if(!h.length){const e=new L([],r,this);return u&&this._geometryQueryCache.put(u,e,e.size||1),e}if(this._canExecuteSoloPass(r,e))return l(new L(h,r,this));const f=await Object(O.g)(i,r,this.geometryType,this.hasZ,this.hasM),d=await this._runSpatialFilter(h,e=>f(c.getGeometry(e)),t);return l(new L(d,r,this))}async _runSpatialFilter(e,t,r){if(!t)return e;if(!this._budget)return e.filter(e=>t(e));let n=0;const s=new Array,i=async()=>{for(;n<e.length;){const a=e[n];t(a)&&s.push(a),this._budget.done&&await this._reschedule(()=>i(),r),++n}};return this._reschedule(()=>i(),r).then(()=>s)}_canExecuteSoloPass(e,t){const{geometryType:r}=this,{spatialRel:n}=t;return Object(O.c)(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))}_getQueryBBoxes(e){if(Object(O.c)(e)){if(Object(l.d)(e))return[Object(h.h)(e.xmin,e.ymin,e.xmax,e.ymax)];if(Object(l.g)(e))return e.rings.map(e=>Object(h.h)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1])))}return[Object(u.a)(Object(h.c)(),e)]}_searchFeatures(e){for(const t of e)this.featureStore.forEachInBounds(t,e=>{z.add(e)});const t=new Array(z.size);let r=0;return z.forEach(e=>t[r++]=e),z.clear(),t}async _checkQuerySupport(e){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new i.a("feature-store:unsupported-query","Unsupported query options",{query:e});return Object(a.b)([this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),Object(O.e)(e,this.geometryType,this.spatialReference),Object(y.a)(this.spatialReference,e.outSR)]).then(()=>e)}_checkAttributesQuerySupport(e){const{outFields:t,orderByFields:r,returnDistinctValues:n,outStatistics:s}=e,a=s?s.map(e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()):[];if(r&&r.length>0){const e=" asc",t=" desc",n=r.map(r=>{const n=r.toLowerCase();return n.indexOf(e)>-1?n.split(e)[0]:n.indexOf(t)>-1?n.split(t)[0]:r}).filter(e=>-1===a.indexOf(e));S(this.fieldsIndex,n,"orderByFields contains missing fields")}if(t&&t.length>0)S(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new i.a("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:e});!function(e,t){if(!t)return!0;const r=x.get(t,e);if(!r)throw new i.a(_,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new i.a(_,"where clause is not standard",{where:t});S(e,r.fieldNames,"where clause contains missing fields")}(this.fieldsIndex,e.where)}async _checkStatisticsQuerySupport(e){const{outStatistics:t,groupByFieldsForStatistics:r,having:n}=e,s=r&&r.length,a=t&&t.length;if(n){if(!s||!a)throw new i.a("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});!function(e,t,r){if(!t)return!0;const n=x.get(t,e);if(!n)throw new i.a(_,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new i.a(_,"having does not contain a valid aggregate function",{having:t});const s=n.fieldNames;if(S(e,s,"having contains missing fields"),!n.getExpressions().every(t=>{const{aggregateType:n,field:s}=t,i=e.has(s)&&e.get(s).name;return r.some(t=>{const{onStatisticField:r,statisticType:s}=t;return(e.has(r)&&e.get(r).name)===i&&s.toLowerCase().trim()===n})}))throw new i.a(_,"expressions in having should also exist in outStatistics",{having:t})}(this.fieldsIndex,n,t)}if(a){if(!function(e){return e.every(e=>"exceedslimit"!==e.statisticType)}(t))return;const n=t.map(e=>e.onStatisticField);S(this.fieldsIndex,n,"onStatisticFields contains missing fields"),s&&S(this.fieldsIndex,r,"groupByFieldsForStatistics contains missing fields");for(const r of t){const{onStatisticField:t,statisticType:n}=r;if("percentile_disc"!==n&&"percentile_cont"!==n||!("statisticParameters"in r)){if("count"!==n&&t&&M(t,this.fieldsIndex))throw new i.a("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:r,query:e})}else{const{statisticParameters:t}=r;if(!t)throw new i.a("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:r,query:e})}}}}}},445:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l}));const n=[252,146,31,255],s={type:"esriSMS",style:"esriSMSCircle",size:6,color:n,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},i={type:"esriSLS",style:"esriSLSSolid",width:.75,color:n},a={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},o={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},u={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},l={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},c={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},446:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(69),s=Object(n.b)((function(e){var t;void 0!==(t=function(){function e(r,n,s,i,a){for(;i>s;){if(i-s>600){var o=i-s+1,u=n-s+1,l=Math.log(o),c=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*c*(o-c)/o)*(u-o/2<0?-1:1);e(r,n,Math.max(s,Math.floor(n-u*c/o+h)),Math.min(i,Math.floor(n+(o-u)*c/o+h)),a)}var f=r[n],d=s,p=i;for(t(r,s,n),a(r[i],f)>0&&t(r,s,i);d<p;){for(t(r,d,p),d++,p--;a(r[d],f)<0;)d++;for(;a(r[p],f)>0;)p--}0===a(r[s],f)?t(r,s,p):t(r,++p,i),p<=n&&(s=p+1),n<=p&&(i=p-1)}}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t){return e<t?-1:e>t?1:0}return function(t,n,s,i,a){e(t,n,s||0,i||t.length-1,a||r)}}())&&(e.exports=t)}))},447:function(e,t,r){"use strict";var n=r(261);t.a=class{constructor(e,t){this._storage=new n.b,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}put(e,t){this._storage.put(e,t,1,1)}pop(e){return this._storage.pop(e)}get(e){return this._storage.get(e)}clear(){this._storage.clearAll()}destroy(){this._storage.clearAll()}}},448:function(e,t,r){"use strict";function n(e,t){if(!e)return null;const r=t.featureAdapter,{startTimeField:n,endTimeField:s}=e;let i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;if(n&&s)t.forEach(e=>{const t=r.getAttribute(e,n),o=r.getAttribute(e,s);null==t||isNaN(t)||(i=Math.min(i,t)),null==o||isNaN(o)||(a=Math.max(a,o))});else{const e=n||s;t.forEach(t=>{const n=r.getAttribute(t,e);null==n||isNaN(n)||(i=Math.min(i,n),a=Math.max(a,n))})}return{start:i,end:a}}function s(e,t,r){if(!t||!e)return null;const{startTimeField:n,endTimeField:s}=e;if(!n&&!s)return null;const{start:i,end:a}=t;return null===i&&null===a?null:void 0===i&&void 0===a?()=>!1:n&&s?function(e,t,r,n,s){return null!=n&&null!=s?i=>{const a=e.getAttribute(i,t),o=e.getAttribute(i,r);return(null==a||a<=s)&&(null==o||o>=n)}:null!=n?t=>{const s=e.getAttribute(t,r);return null==s||s>=n}:null!=s?r=>{const n=e.getAttribute(r,t);return null==n||n<=s}:void 0}(r,n,s,i,a):function(e,t,r,n){return null!=r&&null!=n&&r===n?n=>e.getAttribute(n,t)===r:null!=r&&null!=n?s=>{const i=e.getAttribute(s,t);return i>=r&&i<=n}:null!=r?n=>e.getAttribute(n,t)>=r:null!=n?r=>e.getAttribute(r,t)<=n:void 0}(r,n||s,i,a)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s}))},485:function(e,t,r){"use strict";r.d(t,"a",(function(){return _})),r.d(t,"b",(function(){return T})),r.d(t,"c",(function(){return Q})),r.d(t,"d",(function(){return A})),r.d(t,"e",(function(){return D})),r.d(t,"f",(function(){return O})),r.d(t,"g",(function(){return z})),r.d(t,"h",(function(){return F})),r.d(t,"i",(function(){return M}));var n=r(1),s=r(54),i=r(14),a=r(2),o=r(78),u=r(314),l=r(377),c=r(444),h=r(61),f=r(67),d=r(224),p=r(130),m=r(104),g=(r(316),r(259));function y(e,t){return e?t?4:3:t?3:2}function v(e,t,r,n,s){if(!e)return!1;const i=y(t,r),{coords:a,lengths:o}=e;let u=!1,l=0;for(const e of o)u=b(u,a,i,l,e,n,s),l+=e*i;return u}function b(e,t,r,n,s,i,a){let o=e,u=n;for(let e=n,l=n+s*r;e<l;e+=r){u=e+r,u===l&&(u=n);const s=t[e],c=t[e+1],h=t[u],f=t[u+1];(c<a&&f>=a||f<a&&c>=a)&&s+(a-c)/(f-c)*(h-s)<i&&(o=!o)}return o}const x=new s.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),_=Object.freeze({}),w=new p.a,I=new p.a,S=new p.a,N={esriGeometryPoint:m.j,esriGeometryPolyline:m.l,esriGeometryPolygon:m.k,esriGeometryMultipoint:m.i};function M(e,t,r,n=e.hasZ,s=e.hasM){const i=e.hasZ&&n,a=e.hasM&&s;if(r){const o=Object(m.r)(S,t,e.hasZ,e.hasM,"esriGeometryPoint",r,n,s);return Object(m.j)(o,i,a)}return Object(m.j)(t,i,a)}function O(e,t,r,n,s,i,a=t,o=r){const u=t&&a,l=r&&o,c=n?"coords"in n?n:n.geometry:null;if(!c)return null;if(s){let n=Object(m.n)(I,c,t,r,e,s,a,o);return i&&(n=Object(m.r)(S,n,u,l,e,i)),N[e](n,u,l)}if(i){const n=Object(m.r)(S,c,t,r,e,i,a,o);return N[e](n,u,l)}return Object(m.u)(w,c,t,r,a,o),N[e](w,u,l)}async function T(e,t,r){const{outFields:n,orderByFields:s,groupByFieldsForStatistics:i,outStatistics:a}=e;if(n)for(let e=0;e<n.length;e++)n[e]=n[e].trim();if(s)for(let e=0;e<s.length;e++)s[e]=s[e].trim();if(i)for(let e=0;e<i.length;e++)i[e]=i[e].trim();if(a)for(let e=0;e<a.length;e++)a[e].onStatisticField&&(a[e].onStatisticField=a[e].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),F(e,t,r)}async function F(e,t,r){if(!e)return null;let{where:s}=e;if(e.where=s=s&&s.trim(),(!s||/^1 *= *1$/.test(s)||t&&t===s)&&(e.where=null),!e.geometry)return e;let i=await async function(e){const{geometry:t,distance:r,units:n}=e;if(null==r||"vertexAttributes"in t)return t;const s=t.spatialReference,i=n?x.fromJSON(n):Object(f.d)(s),a=s&&(Object(o.f)(s)||Object(o.m)(s))?t:await Object(g.a)(s,o.a).then(()=>Object(g.b)(t,o.a));return(await L().then(e=>e.geodesicBuffer))(a.spatialReference,a,r,i)}(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;i=Object(c.a)(i),i.spatialReference=t}e.geometry=i,await Object(g.a)(i.spatialReference,r);const a=(await Object(d.a)(Object(h.a)(i)))[0];if(Object(n.f)(a))throw _;const u=a.toJSON(),l=await Object(g.b)(u,u.spatialReference,r);if(!l)throw _;return l.spatialReference=r,e.geometry=l,e}function A(e){return e&&E in e?JSON.parse(JSON.stringify(e,R)):e}const E="_geVersion",R=(e,t)=>e!==E?t:void 0,j={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},P={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},C={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},G={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function L(){return Promise.all([r.e(7),r.e(22)]).then(r.bind(null,509))}function z(e,t,r,n,s){if(Object(h.g)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=Object(m.e)(new p.a,t,!1,!1);return Object(a.s)(t=>function(e,t,r,n){return v(e,t,r,n.coords[0],n.coords[1])}(e,!1,!1,t))}if(Object(h.g)(t)&&"esriGeometryMultipoint"===r){const r=Object(m.e)(new p.a,t,!1,!1);if("esriSpatialRelContains"===e)return Object(a.s)(e=>function(e,t,r,n,s,i){const a=y(s,i),{coords:o,lengths:u}=n;if(!u)return!1;for(let n=0,s=0;n<u.length;n++,s+=a)if(!v(e,t,r,o[s],o[s+1]))return!1;return!0}(r,!1,!1,e,n,s))}if(Object(h.d)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Object(a.s)(e=>Object(u.e)(t,O(r,n,s,e)));if(Object(h.d)(t)&&"esriGeometryMultipoint"===r&&"esriSpatialRelContains"===e)return Object(a.s)(e=>Object(u.d)(t,O(r,n,s,e)));if(Object(h.d)(t)&&"esriSpatialRelIntersects"===e){const e=Object(l.a)(r);return Object(a.s)(i=>e(t,O(r,n,s,i)))}return L().then(i=>{const a=i[j[e]].bind(null,t.spatialReference,t);return e=>a(O(r,n,s,e))})}async function D(e,t,r){const{spatialRel:n,geometry:s}=e;if(s){if(!0!==P[n])throw new i.a("feature-store:unsupported-query","Unsupported query spatial relationship",{query:e});if(Object(o.i)(s.spatialReference)&&Object(o.i)(r)){if(!function(e){return!0===C[Object(h.c)(e)]}(s))throw new i.a("feature-store:unsupported-query","Unsupported query geometry type",{query:e});if(!function(e){return!0===G[e]}(t))throw new i.a("feature-store:unsupported-query","Unsupported layer geometry type",{query:e});if(e.outSR)return Object(g.a)(e.geometry&&e.geometry.spatialReference,e.outSR)}}}function Q(e){if(Object(h.d)(e))return!0;if(Object(h.g)(e)){for(const t of e.rings){if(5!==t.length)return!1;if(t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return!1}return!0}return!1}},493:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},59:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(4),s=(r(56),r(112)),i=r(64),a=r(57),o=r(140),u=r(108),l=r(102);r(173),r(61);const c={base:s.a,key:"type",typeMap:{extent:a.a,multipoint:o.a,point:i.a,polyline:l.a,polygon:u.a}};Object(n.k)(c)},61:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return h})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return f}));var n=r(112),s=r(64),i=r(57),a=r(140),o=r(108),u=r(102);function l(e){return void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax}function c(e){return void 0!==e.points}function h(e){return void 0!==e.x&&void 0!==e.y}function f(e){return void 0!==e.paths}function d(e){return void 0!==e.rings}function p(e){return e?e instanceof n.a?e:h(e)?s.a.fromJSON(e):f(e)?u.a.fromJSON(e):d(e)?o.a.fromJSON(e):c(e)?a.a.fromJSON(e):l(e)?i.a.fromJSON(e):null:null}function m(e){return e?h(e)?"esriGeometryPoint":f(e)?"esriGeometryPolyline":d(e)?"esriGeometryPolygon":l(e)?"esriGeometryEnvelope":c(e)?"esriGeometryMultipoint":null:null}const g={esriGeometryPoint:s.a,esriGeometryPolyline:u.a,esriGeometryPolygon:o.a,esriGeometryEnvelope:i.a,esriGeometryMultipoint:a.a};function y(e){return e&&g[e]||null}},69:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return n}));"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e||"undefined"!=typeof self&&self;function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function s(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return i(null==t&&r.path)}},r.exports),r.exports}function i(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}}).call(this,r(47))},88:function(e,t,r){"use strict";var n=r(18),s=r(41),i=r(19),a=r(25);class o{constructor(){this._emitter=new o.EventEmitter(this)}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}}!function(e){class t{constructor(e=null){this.target=e,this._listenersMap=null}clear(){this._listenersMap&&this._listenersMap.clear()}emit(e,t){const r=this._listenersMap&&this._listenersMap.get(e);if(!r)return!1;const n=this.target||this;return[...r].forEach(e=>{e.call(n,t)}),r.length>0}on(e,t){if(Array.isArray(e)){const r=e.map(e=>this.on(e,t));return Object(s.a)(r)}if(e.indexOf(",")>-1)throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const r=this._listenersMap.get(e)||[];return r.push(t),this._listenersMap.set(e,r),{remove:()=>{const r=this._listenersMap&&this._listenersMap.get(e)||[],n=r.indexOf(t);n>=0&&r.splice(n,1)}}}once(e,t){let r;return r=this.on(e,e=>{r.remove(),t.call(null,e)}),r}hasEventListener(e){const t=this._listenersMap&&this._listenersMap.get(e);return null!=t&&t.length>0}}e.EventEmitter=t,e.EventedMixin=e=>{let r=class extends e{constructor(){super(...arguments),this._emitter=new t}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}};return r=Object(n.a)([Object(i.a)("esri.core.Evented")],r),r};let r=class extends a.a{constructor(){super(...arguments),this._emitter=new o.EventEmitter(this)}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}};r=Object(n.a)([Object(i.a)("esri.core.Evented")],r),e.EventedAccessor=r}(o||(o={}));var u=o;t.a=u}});