"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[2785],{46851:(t,e,n)=>{n.d(e,{E:()=>a,R:()=>i});const a=1e-6,i=Math.random,o=Math.PI/180,s=180/Math.PI;Object.freeze({__proto__:null,EPSILON:a,RANDOM:i,toRadian:function(t){return t*o},toDegree:function(t){return t*s},equals:function(t,e){return Math.abs(t-e)<=a*Math.max(1,Math.abs(t),Math.abs(e))}})},52138:(t,e,n)=>{n.d(e,{a:()=>r,b:()=>l,e:()=>f,f:()=>h,i:()=>s,k:()=>v,m:()=>c,n:()=>x,p:()=>y,s:()=>o,t:()=>u,u:()=>m});var a=n(65617),i=n(46851);function o(t,e,n,a,i,o,s,r,l,c,u,h,f,m,p,d,M){return t[0]=e,t[1]=n,t[2]=a,t[3]=i,t[4]=o,t[5]=s,t[6]=r,t[7]=l,t[8]=c,t[9]=u,t[10]=h,t[11]=f,t[12]=m,t[13]=p,t[14]=d,t[15]=M,t}function s(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function r(t,e){if(t===e){const n=e[1],a=e[2],i=e[3],o=e[6],s=e[7],r=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=a,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=r}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function l(t,e){const n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],r=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],m=e[11],p=e[12],d=e[13],M=e[14],y=e[15],x=n*r-a*s,v=n*l-i*s,g=n*c-o*s,T=a*l-i*r,b=a*c-o*r,w=i*c-o*l,R=u*d-h*p,_=u*M-f*p,E=u*y-m*p,q=h*M-f*d,I=h*y-m*d,A=f*y-m*M;let D=x*A-v*I+g*q+T*E-b*_+w*R;return D?(D=1/D,t[0]=(r*A-l*I+c*q)*D,t[1]=(i*I-a*A-o*q)*D,t[2]=(d*w-M*b+y*T)*D,t[3]=(f*b-h*w-m*T)*D,t[4]=(l*E-s*A-c*_)*D,t[5]=(n*A-i*E+o*_)*D,t[6]=(M*g-p*w-y*v)*D,t[7]=(u*w-f*g+m*v)*D,t[8]=(s*I-r*E+c*R)*D,t[9]=(a*E-n*I-o*R)*D,t[10]=(p*b-d*g+y*x)*D,t[11]=(h*g-u*b-m*x)*D,t[12]=(r*_-s*q-l*R)*D,t[13]=(n*q-a*_+i*R)*D,t[14]=(d*v-p*T-M*x)*D,t[15]=(u*T-h*v+f*x)*D,t):null}function c(t,e,n){const a=e[0],i=e[1],o=e[2],s=e[3],r=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],m=e[10],p=e[11],d=e[12],M=e[13],y=e[14],x=e[15];let v=n[0],g=n[1],T=n[2],b=n[3];return t[0]=v*a+g*r+T*h+b*d,t[1]=v*i+g*l+T*f+b*M,t[2]=v*o+g*c+T*m+b*y,t[3]=v*s+g*u+T*p+b*x,v=n[4],g=n[5],T=n[6],b=n[7],t[4]=v*a+g*r+T*h+b*d,t[5]=v*i+g*l+T*f+b*M,t[6]=v*o+g*c+T*m+b*y,t[7]=v*s+g*u+T*p+b*x,v=n[8],g=n[9],T=n[10],b=n[11],t[8]=v*a+g*r+T*h+b*d,t[9]=v*i+g*l+T*f+b*M,t[10]=v*o+g*c+T*m+b*y,t[11]=v*s+g*u+T*p+b*x,v=n[12],g=n[13],T=n[14],b=n[15],t[12]=v*a+g*r+T*h+b*d,t[13]=v*i+g*l+T*f+b*M,t[14]=v*o+g*c+T*m+b*y,t[15]=v*s+g*u+T*p+b*x,t}function u(t,e,n){const a=n[0],i=n[1],o=n[2];let s,r,l,c,u,h,f,m,p,d,M,y;return e===t?(t[12]=e[0]*a+e[4]*i+e[8]*o+e[12],t[13]=e[1]*a+e[5]*i+e[9]*o+e[13],t[14]=e[2]*a+e[6]*i+e[10]*o+e[14],t[15]=e[3]*a+e[7]*i+e[11]*o+e[15]):(s=e[0],r=e[1],l=e[2],c=e[3],u=e[4],h=e[5],f=e[6],m=e[7],p=e[8],d=e[9],M=e[10],y=e[11],t[0]=s,t[1]=r,t[2]=l,t[3]=c,t[4]=u,t[5]=h,t[6]=f,t[7]=m,t[8]=p,t[9]=d,t[10]=M,t[11]=y,t[12]=s*a+u*i+p*o+e[12],t[13]=r*a+h*i+d*o+e[13],t[14]=l*a+f*i+M*o+e[14],t[15]=c*a+m*i+y*o+e[15]),t}function h(t,e,n){const a=n[0],i=n[1],o=n[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function f(t,e,n,a){let o,s,r,l,c,u,h,f,m,p,d,M,y,x,v,g,T,b,w,R,_,E,q,I,A=a[0],D=a[1],z=a[2],C=Math.sqrt(A*A+D*D+z*z);return C<i.E?null:(C=1/C,A*=C,D*=C,z*=C,o=Math.sin(n),s=Math.cos(n),r=1-s,l=e[0],c=e[1],u=e[2],h=e[3],f=e[4],m=e[5],p=e[6],d=e[7],M=e[8],y=e[9],x=e[10],v=e[11],g=A*A*r+s,T=D*A*r+z*o,b=z*A*r-D*o,w=A*D*r-z*o,R=D*D*r+s,_=z*D*r+A*o,E=A*z*r+D*o,q=D*z*r-A*o,I=z*z*r+s,t[0]=l*g+f*T+M*b,t[1]=c*g+m*T+y*b,t[2]=u*g+p*T+x*b,t[3]=h*g+d*T+v*b,t[4]=l*w+f*R+M*_,t[5]=c*w+m*R+y*_,t[6]=u*w+p*R+x*_,t[7]=h*w+d*R+v*_,t[8]=l*E+f*q+M*I,t[9]=c*E+m*q+y*I,t[10]=u*E+p*q+x*I,t[11]=h*E+d*q+v*I,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function m(t,e){const n=Math.sin(e),a=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function p(t,e,n){const a=e[0],i=e[1],o=e[2],s=e[3],r=a+a,l=i+i,c=o+o,u=a*r,h=a*l,f=a*c,m=i*l,p=i*c,d=o*c,M=s*r,y=s*l,x=s*c;return t[0]=1-(m+d),t[1]=h+x,t[2]=f-y,t[3]=0,t[4]=h-x,t[5]=1-(u+d),t[6]=p+M,t[7]=0,t[8]=f+y,t[9]=p-M,t[10]=1-(u+m),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}const d=(0,a.c)();function M(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function y(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function x(t,e){if(t===e)return!0;const n=t[0],a=t[1],o=t[2],s=t[3],r=t[4],l=t[5],c=t[6],u=t[7],h=t[8],f=t[9],m=t[10],p=t[11],d=t[12],M=t[13],y=t[14],x=t[15],v=e[0],g=e[1],T=e[2],b=e[3],w=e[4],R=e[5],_=e[6],E=e[7],q=e[8],I=e[9],A=e[10],D=e[11],z=e[12],C=e[13],Z=e[14],S=e[15];return Math.abs(n-v)<=i.E*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(a-g)<=i.E*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(o-T)<=i.E*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(s-b)<=i.E*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(r-w)<=i.E*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(l-R)<=i.E*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(c-_)<=i.E*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(u-E)<=i.E*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(h-q)<=i.E*Math.max(1,Math.abs(h),Math.abs(q))&&Math.abs(f-I)<=i.E*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(m-A)<=i.E*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(p-D)<=i.E*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(d-z)<=i.E*Math.max(1,Math.abs(d),Math.abs(z))&&Math.abs(M-C)<=i.E*Math.max(1,Math.abs(M),Math.abs(C))&&Math.abs(y-Z)<=i.E*Math.max(1,Math.abs(y),Math.abs(Z))&&Math.abs(x-S)<=i.E*Math.max(1,Math.abs(x),Math.abs(S))}function v(t){const e=i.E,n=t[0],a=t[1],o=t[2],s=t[4],r=t[5],l=t[6],c=t[8],u=t[9],h=t[10];return Math.abs(1-(n*n+s*s+c*c))<=e&&Math.abs(1-(a*a+r*r+u*u))<=e&&Math.abs(1-(o*o+l*l+h*h))<=e}const g=c,T=M;Object.freeze({__proto__:null,copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},set:o,identity:s,transpose:r,invert:l,adjoint:function(t,e){const n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],r=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],m=e[11],p=e[12],d=e[13],M=e[14],y=e[15];return t[0]=r*(f*y-m*M)-h*(l*y-c*M)+d*(l*m-c*f),t[1]=-(a*(f*y-m*M)-h*(i*y-o*M)+d*(i*m-o*f)),t[2]=a*(l*y-c*M)-r*(i*y-o*M)+d*(i*c-o*l),t[3]=-(a*(l*m-c*f)-r*(i*m-o*f)+h*(i*c-o*l)),t[4]=-(s*(f*y-m*M)-u*(l*y-c*M)+p*(l*m-c*f)),t[5]=n*(f*y-m*M)-u*(i*y-o*M)+p*(i*m-o*f),t[6]=-(n*(l*y-c*M)-s*(i*y-o*M)+p*(i*c-o*l)),t[7]=n*(l*m-c*f)-s*(i*m-o*f)+u*(i*c-o*l),t[8]=s*(h*y-m*d)-u*(r*y-c*d)+p*(r*m-c*h),t[9]=-(n*(h*y-m*d)-u*(a*y-o*d)+p*(a*m-o*h)),t[10]=n*(r*y-c*d)-s*(a*y-o*d)+p*(a*c-o*r),t[11]=-(n*(r*m-c*h)-s*(a*m-o*h)+u*(a*c-o*r)),t[12]=-(s*(h*M-f*d)-u*(r*M-l*d)+p*(r*f-l*h)),t[13]=n*(h*M-f*d)-u*(a*M-i*d)+p*(a*f-i*h),t[14]=-(n*(r*M-l*d)-s*(a*M-i*d)+p*(a*l-i*r)),t[15]=n*(r*f-l*h)-s*(a*f-i*h)+u*(a*l-i*r),t},determinant:function(t){const e=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],r=t[6],l=t[7],c=t[8],u=t[9],h=t[10],f=t[11],m=t[12],p=t[13],d=t[14],M=t[15];return(e*s-n*o)*(h*M-f*d)-(e*r-a*o)*(u*M-f*p)+(e*l-i*o)*(u*d-h*p)+(n*r-a*s)*(c*M-f*m)-(n*l-i*s)*(c*d-h*m)+(a*l-i*r)*(c*p-u*m)},multiply:c,translate:u,scale:h,rotate:f,rotateX:function(t,e,n){const a=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],r=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*a,t[5]=s*i+u*a,t[6]=r*i+h*a,t[7]=l*i+f*a,t[8]=c*i-o*a,t[9]=u*i-s*a,t[10]=h*i-r*a,t[11]=f*i-l*a,t},rotateY:function(t,e,n){const a=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],r=e[2],l=e[3],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*a,t[1]=s*i-u*a,t[2]=r*i-h*a,t[3]=l*i-f*a,t[8]=o*a+c*i,t[9]=s*a+u*i,t[10]=r*a+h*i,t[11]=l*a+f*i,t},rotateZ:function(t,e,n){const a=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],r=e[2],l=e[3],c=e[4],u=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*a,t[1]=s*i+u*a,t[2]=r*i+h*a,t[3]=l*i+f*a,t[4]=c*i-o*a,t[5]=u*i-s*a,t[6]=h*i-r*a,t[7]=f*i-l*a,t},fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},fromScaling:function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotation:function(t,e,n){let a,o,s,r=n[0],l=n[1],c=n[2],u=Math.sqrt(r*r+l*l+c*c);return u<i.E?null:(u=1/u,r*=u,l*=u,c*=u,a=Math.sin(e),o=Math.cos(e),s=1-o,t[0]=r*r*s+o,t[1]=l*r*s+c*a,t[2]=c*r*s-l*a,t[3]=0,t[4]=r*l*s-c*a,t[5]=l*l*s+o,t[6]=c*l*s+r*a,t[7]=0,t[8]=r*c*s+l*a,t[9]=l*c*s-r*a,t[10]=c*c*s+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},fromXRotation:m,fromYRotation:function(t,e){const n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromZRotation:function(t,e){const n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotationTranslation:p,fromQuat2:function(t,e){const n=d,a=-e[0],i=-e[1],o=-e[2],s=e[3],r=e[4],l=e[5],c=e[6],u=e[7],h=a*a+i*i+o*o+s*s;return h>0?(n[0]=2*(r*s+u*a+l*o-c*i)/h,n[1]=2*(l*s+u*i+c*a-r*o)/h,n[2]=2*(c*s+u*o+r*i-l*a)/h):(n[0]=2*(r*s+u*a+l*o-c*i),n[1]=2*(l*s+u*i+c*a-r*o),n[2]=2*(c*s+u*o+r*i-l*a)),p(t,e,n),t},getTranslation:function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},getScaling:function(t,e){const n=e[0],a=e[1],i=e[2],o=e[4],s=e[5],r=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.sqrt(n*n+a*a+i*i),t[1]=Math.sqrt(o*o+s*s+r*r),t[2]=Math.sqrt(l*l+c*c+u*u),t},getRotation:function(t,e){const n=e[0]+e[5]+e[10];let a=0;return n>0?(a=2*Math.sqrt(n+1),t[3]=.25*a,t[0]=(e[6]-e[9])/a,t[1]=(e[8]-e[2])/a,t[2]=(e[1]-e[4])/a):e[0]>e[5]&&e[0]>e[10]?(a=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/a,t[0]=.25*a,t[1]=(e[1]+e[4])/a,t[2]=(e[8]+e[2])/a):e[5]>e[10]?(a=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/a,t[0]=(e[1]+e[4])/a,t[1]=.25*a,t[2]=(e[6]+e[9])/a):(a=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/a,t[0]=(e[8]+e[2])/a,t[1]=(e[6]+e[9])/a,t[2]=.25*a),t},fromRotationTranslationScale:function(t,e,n,a){const i=e[0],o=e[1],s=e[2],r=e[3],l=i+i,c=o+o,u=s+s,h=i*l,f=i*c,m=i*u,p=o*c,d=o*u,M=s*u,y=r*l,x=r*c,v=r*u,g=a[0],T=a[1],b=a[2];return t[0]=(1-(p+M))*g,t[1]=(f+v)*g,t[2]=(m-x)*g,t[3]=0,t[4]=(f-v)*T,t[5]=(1-(h+M))*T,t[6]=(d+y)*T,t[7]=0,t[8]=(m+x)*b,t[9]=(d-y)*b,t[10]=(1-(h+p))*b,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},fromRotationTranslationScaleOrigin:function(t,e,n,a,i){const o=e[0],s=e[1],r=e[2],l=e[3],c=o+o,u=s+s,h=r+r,f=o*c,m=o*u,p=o*h,d=s*u,M=s*h,y=r*h,x=l*c,v=l*u,g=l*h,T=a[0],b=a[1],w=a[2],R=i[0],_=i[1],E=i[2],q=(1-(d+y))*T,I=(m+g)*T,A=(p-v)*T,D=(m-g)*b,z=(1-(f+y))*b,C=(M+x)*b,Z=(p+v)*w,S=(M-x)*w,F=(1-(f+d))*w;return t[0]=q,t[1]=I,t[2]=A,t[3]=0,t[4]=D,t[5]=z,t[6]=C,t[7]=0,t[8]=Z,t[9]=S,t[10]=F,t[11]=0,t[12]=n[0]+R-(q*R+D*_+Z*E),t[13]=n[1]+_-(I*R+z*_+S*E),t[14]=n[2]+E-(A*R+C*_+F*E),t[15]=1,t},fromQuat:function(t,e){const n=e[0],a=e[1],i=e[2],o=e[3],s=n+n,r=a+a,l=i+i,c=n*s,u=a*s,h=a*r,f=i*s,m=i*r,p=i*l,d=o*s,M=o*r,y=o*l;return t[0]=1-h-p,t[1]=u+y,t[2]=f-M,t[3]=0,t[4]=u-y,t[5]=1-c-p,t[6]=m+d,t[7]=0,t[8]=f+M,t[9]=m-d,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},frustum:function(t,e,n,a,i,o,s){const r=1/(n-e),l=1/(i-a),c=1/(o-s);return t[0]=2*o*r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*r,t[9]=(i+a)*l,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0,t},perspective:function(t,e,n,a,i){const o=1/Math.tan(e/2);let s;return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(s=1/(a-i),t[10]=(i+a)*s,t[14]=2*i*a*s):(t[10]=-1,t[14]=-2*a),t},perspectiveFromFieldOfView:function(t,e,n,a){const i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),r=Math.tan(e.rightDegrees*Math.PI/180),l=2/(s+r),c=2/(i+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(s-r)*l*.5,t[9]=(i-o)*c*.5,t[10]=a/(n-a),t[11]=-1,t[12]=0,t[13]=0,t[14]=a*n/(n-a),t[15]=0,t},ortho:function(t,e,n,a,i,o,s){const r=1/(e-n),l=1/(a-i),c=1/(o-s);return t[0]=-2*r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*r,t[13]=(i+a)*l,t[14]=(s+o)*c,t[15]=1,t},lookAt:function(t,e,n,a){let o,r,l,c,u,h,f,m,p,d;const M=e[0],y=e[1],x=e[2],v=a[0],g=a[1],T=a[2],b=n[0],w=n[1],R=n[2];return Math.abs(M-b)<i.E&&Math.abs(y-w)<i.E&&Math.abs(x-R)<i.E?s(t):(f=M-b,m=y-w,p=x-R,d=1/Math.sqrt(f*f+m*m+p*p),f*=d,m*=d,p*=d,o=g*p-T*m,r=T*f-v*p,l=v*m-g*f,d=Math.sqrt(o*o+r*r+l*l),d?(d=1/d,o*=d,r*=d,l*=d):(o=0,r=0,l=0),c=m*l-p*r,u=p*o-f*l,h=f*r-m*o,d=Math.sqrt(c*c+u*u+h*h),d?(d=1/d,c*=d,u*=d,h*=d):(c=0,u=0,h=0),t[0]=o,t[1]=c,t[2]=f,t[3]=0,t[4]=r,t[5]=u,t[6]=m,t[7]=0,t[8]=l,t[9]=h,t[10]=p,t[11]=0,t[12]=-(o*M+r*y+l*x),t[13]=-(c*M+u*y+h*x),t[14]=-(f*M+m*y+p*x),t[15]=1,t)},targetTo:function(t,e,n,a){const i=e[0],o=e[1],s=e[2],r=a[0],l=a[1],c=a[2];let u=i-n[0],h=o-n[1],f=s-n[2],m=u*u+h*h+f*f;m>0&&(m=1/Math.sqrt(m),u*=m,h*=m,f*=m);let p=l*f-c*h,d=c*u-r*f,M=r*h-l*u;return m=p*p+d*d+M*M,m>0&&(m=1/Math.sqrt(m),p*=m,d*=m,M*=m),t[0]=p,t[1]=d,t[2]=M,t[3]=0,t[4]=h*M-f*d,t[5]=f*p-u*M,t[6]=u*d-h*p,t[7]=0,t[8]=u,t[9]=h,t[10]=f,t[11]=0,t[12]=i,t[13]=o,t[14]=s,t[15]=1,t},str:function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},frob:function(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},subtract:M,multiplyScalar:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},multiplyScalarAndAdd:function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t[6]=e[6]+n[6]*a,t[7]=e[7]+n[7]*a,t[8]=e[8]+n[8]*a,t[9]=e[9]+n[9]*a,t[10]=e[10]+n[10]*a,t[11]=e[11]+n[11]*a,t[12]=e[12]+n[12]*a,t[13]=e[13]+n[13]*a,t[14]=e[14]+n[14]*a,t[15]=e[15]+n[15]*a,t},exactEquals:y,equals:x,isOrthoNormal:v,mul:g,sub:T})},17896:(t,e,n)=>{n.d(e,{E:()=>h,a:()=>f,b:()=>l,c:()=>x,d:()=>y,e:()=>v,f:()=>c,g:()=>s,h:()=>p,i:()=>m,k:()=>_,l:()=>o,m:()=>g,n:()=>M,p:()=>d,q:()=>b,r:()=>E,s:()=>r,t:()=>T,u:()=>C});var a=n(65617),i=n(46851);function o(t){const e=t[0],n=t[1],a=t[2];return Math.sqrt(e*e+n*n+a*a)}function s(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function r(t,e,n,a){return t[0]=e,t[1]=n,t[2]=a,t}function l(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function c(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function u(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function h(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function f(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function m(t,e){const n=e[0]-t[0],a=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+a*a+i*i)}function p(t,e){const n=e[0]-t[0],a=e[1]-t[1],i=e[2]-t[2];return n*n+a*a+i*i}function d(t){const e=t[0],n=t[1],a=t[2];return e*e+n*n+a*a}function M(t,e){const n=e[0],a=e[1],i=e[2];let o=n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function y(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function x(t,e,n){const a=e[0],i=e[1],o=e[2],s=n[0],r=n[1],l=n[2];return t[0]=i*l-o*r,t[1]=o*s-a*l,t[2]=a*r-i*s,t}function v(t,e,n,a){const i=e[0],o=e[1],s=e[2];return t[0]=i+a*(n[0]-i),t[1]=o+a*(n[1]-o),t[2]=s+a*(n[2]-s),t}function g(t,e,n){const a=e[0],i=e[1],o=e[2];return t[0]=n[0]*a+n[4]*i+n[8]*o+n[12],t[1]=n[1]*a+n[5]*i+n[9]*o+n[13],t[2]=n[2]*a+n[6]*i+n[10]*o+n[14],t}function T(t,e,n){const a=e[0],i=e[1],o=e[2];return t[0]=a*n[0]+i*n[3]+o*n[6],t[1]=a*n[1]+i*n[4]+o*n[7],t[2]=a*n[2]+i*n[5]+o*n[8],t}function b(t,e,n){const a=n[0],i=n[1],o=n[2],s=n[3],r=e[0],l=e[1],c=e[2];let u=i*c-o*l,h=o*r-a*c,f=a*l-i*r,m=i*f-o*h,p=o*u-a*f,d=a*h-i*u;const M=2*s;return u*=M,h*=M,f*=M,m*=2,p*=2,d*=2,t[0]=r+u+m,t[1]=l+h+p,t[2]=c+f+d,t}const w=(0,a.c)(),R=(0,a.c)();function _(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function E(t,e,n){const a=n[0]-e[0],i=n[1]-e[1],o=n[2]-e[2];let s=a*a+i*i+o*o;return s>0?(s=1/Math.sqrt(s),t[0]=a*s,t[1]=i*s,t[2]=o*s,t):(t[0]=0,t[1]=0,t[2]=0,t)}const q=c,I=u,A=h,D=m,z=p,C=o,Z=d;Object.freeze({__proto__:null,length:o,copy:s,set:r,add:l,subtract:c,multiply:u,divide:h,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},min:function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},max:function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},scale:f,scaleAndAdd:function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t},distance:m,squaredDistance:p,squaredLength:d,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},normalize:M,dot:y,cross:x,lerp:v,hermite:function(t,e,n,a,i,o){const s=o*o,r=s*(2*o-3)+1,l=s*(o-2)+o,c=s*(o-1),u=s*(3-2*o);return t[0]=e[0]*r+n[0]*l+a[0]*c+i[0]*u,t[1]=e[1]*r+n[1]*l+a[1]*c+i[1]*u,t[2]=e[2]*r+n[2]*l+a[2]*c+i[2]*u,t},bezier:function(t,e,n,a,i,o){const s=1-o,r=s*s,l=o*o,c=r*s,u=3*o*r,h=3*l*s,f=l*o;return t[0]=e[0]*c+n[0]*u+a[0]*h+i[0]*f,t[1]=e[1]*c+n[1]*u+a[1]*h+i[1]*f,t[2]=e[2]*c+n[2]*u+a[2]*h+i[2]*f,t},random:function(t,e){e=e||1;const n=2*(0,i.R)()*Math.PI,a=2*(0,i.R)()-1,o=Math.sqrt(1-a*a)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=a*e,t},transformMat4:g,transformMat3:T,transformQuat:b,rotateX:function(t,e,n,a){const i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(a)-i[2]*Math.sin(a),o[2]=i[1]*Math.sin(a)+i[2]*Math.cos(a),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},rotateY:function(t,e,n,a){const i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(a)+i[0]*Math.cos(a),o[1]=i[1],o[2]=i[2]*Math.cos(a)-i[0]*Math.sin(a),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},rotateZ:function(t,e,n,a){const i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(a)-i[1]*Math.sin(a),o[1]=i[0]*Math.sin(a)+i[1]*Math.cos(a),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},angle:function(t,e){s(w,t),s(R,e),M(w,w),M(R,R);const n=y(w,R);return n>1?0:n<-1?Math.PI:Math.acos(n)},str:function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},exactEquals:_,equals:function(t,e){if(t===e)return!0;const n=t[0],a=t[1],o=t[2],s=e[0],r=e[1],l=e[2];return Math.abs(n-s)<=i.E*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-r)<=i.E*Math.max(1,Math.abs(a),Math.abs(r))&&Math.abs(o-l)<=i.E*Math.max(1,Math.abs(o),Math.abs(l))},direction:E,sub:q,mul:I,div:A,dist:D,sqrDist:z,len:C,sqrLen:Z})},65617:(t,e,n)=>{function a(){return[0,0,0]}function i(t){return[t[0],t[1],t[2]]}function o(t,e,n){return[t,e,n]}function s(t){const e=[0,0,0],n=Math.min(3,t.length);for(let a=0;a<n;++a)e[a]=t[a];return e}function r(t,e){return new Float64Array(t,e,3)}function l(){return o(1,1,1)}function c(){return o(1,0,0)}function u(){return o(0,1,0)}function h(){return o(0,0,1)}n.d(e,{O:()=>m,Z:()=>f,a:()=>i,b:()=>r,c:()=>a,d:()=>s,f:()=>o});const f=[0,0,0],m=l(),p=c(),d=u(),M=h();Object.freeze({__proto__:null,create:a,clone:i,fromValues:o,fromArray:s,createView:r,zeros:function(){return[0,0,0]},ones:l,unitX:c,unitY:u,unitZ:h,ZEROS:f,ONES:m,UNIT_X:p,UNIT_Y:d,UNIT_Z:M})},98766:(t,e,n)=>{n.d(e,{a:()=>s,b:()=>u,c:()=>i,d:()=>M,e:()=>m,f:()=>p,g:()=>x,h:()=>v,l:()=>y,n:()=>d,s:()=>o});var a=n(46851);function i(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function o(t,e,n,a,i){return t[0]=e,t[1]=n,t[2]=a,t[3]=i,t}function s(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function r(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function l(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function c(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function u(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function h(t,e){const n=e[0]-t[0],a=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+a*a+i*i+o*o)}function f(t,e){const n=e[0]-t[0],a=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+a*a+i*i+o*o}function m(t){const e=t[0],n=t[1],a=t[2],i=t[3];return Math.sqrt(e*e+n*n+a*a+i*i)}function p(t){const e=t[0],n=t[1],a=t[2],i=t[3];return e*e+n*n+a*a+i*i}function d(t,e){const n=e[0],a=e[1],i=e[2],o=e[3];let s=n*n+a*a+i*i+o*o;return s>0&&(s=1/Math.sqrt(s),t[0]=n*s,t[1]=a*s,t[2]=i*s,t[3]=o*s),t}function M(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function y(t,e,n,a){const i=e[0],o=e[1],s=e[2],r=e[3];return t[0]=i+a*(n[0]-i),t[1]=o+a*(n[1]-o),t[2]=s+a*(n[2]-s),t[3]=r+a*(n[3]-r),t}function x(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function v(t,e){const n=t[0],i=t[1],o=t[2],s=t[3],r=e[0],l=e[1],c=e[2],u=e[3];return Math.abs(n-r)<=a.E*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(i-l)<=a.E*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-c)<=a.E*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-u)<=a.E*Math.max(1,Math.abs(s),Math.abs(u))}const g=r,T=l,b=c,w=h,R=f,_=m,E=p;Object.freeze({__proto__:null,copy:i,set:o,add:s,subtract:r,multiply:l,divide:c,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},min:function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},max:function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},scale:u,scaleAndAdd:function(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t},distance:h,squaredDistance:f,length:m,squaredLength:p,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},normalize:d,dot:M,lerp:y,random:function(t,e){let n,i,o,s,r,l;e=e||1;do{n=2*(0,a.R)()-1,i=2*(0,a.R)()-1,r=n*n+i*i}while(r>=1);do{o=2*(0,a.R)()-1,s=2*(0,a.R)()-1,l=o*o+s*s}while(l>=1);const c=Math.sqrt((1-r)/l);return t[0]=e*n,t[1]=e*i,t[2]=e*o*c,t[3]=e*s*c,t},transformMat4:function(t,e,n){const a=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*a+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*a+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*a+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*a+n[7]*i+n[11]*o+n[15]*s,t},transformQuat:function(t,e,n){const a=e[0],i=e[1],o=e[2],s=n[0],r=n[1],l=n[2],c=n[3],u=c*a+r*o-l*i,h=c*i+l*a-s*o,f=c*o+s*i-r*a,m=-s*a-r*i-l*o;return t[0]=u*c+m*-s+h*-l-f*-r,t[1]=h*c+m*-r+f*-s-u*-l,t[2]=f*c+m*-l+u*-r-h*-s,t[3]=e[3],t},str:function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},exactEquals:x,equals:v,sub:g,mul:T,div:b,dist:w,sqrDist:R,len:_,sqrLen:E})},22021:(t,e,n)=>{n.d(e,{ZF:()=>f,Kt:()=>m,jE:()=>M,uZ:()=>s,oK:()=>p,Vl:()=>u,wt:()=>r,t7:()=>c,Sf:()=>o,fp:()=>l,BV:()=>h});var a=n(17896);n(98766);const i=new Float32Array(1);function o(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function s(t,e,n){return Math.min(Math.max(t,e),n)}function r(t){return 0==(t&t-1)}function l(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function c(t,e,n){return t+(e-t)*n}function u(t){return t*Math.PI/180}function h(t){return 180*t/Math.PI}function f(t){return Math.acos(s(t,-1,1))}function m(t){return Math.asin(s(t,-1,1))}function p(t){return d(Math.max(-y,Math.min(t,y)))}function d(t){return i[0]=t,i[0]}function M(t,e){const n=(0,a.l)(t),i=m(t[2]/n),o=Math.atan2(t[1]/n,t[0]/n);return(0,a.s)(e,n,i,o),e}const y=d(34028234663852886e22)},69285:(t,e,n)=>{n.d(e,{k:()=>s});var a=n(70586),i=n(67900),o=n(8744);function s(t,e,n){if((0,a.Wi)(e)||(0,a.Wi)(n)||n.vcsWkid||(0,o.fS)(e,n))return null;const s=(0,i._R)(e)/(0,i._R)(n);if(1===s)return null;switch(t){case"point":case"esriGeometryPoint":return t=>function(t,e){t&&null!=t.z&&(t.z*=e)}(t,s);case"polyline":case"esriGeometryPolyline":return t=>function(t,e){if(t)for(const n of t.paths)for(const t of n)t.length>2&&(t[2]*=e)}(t,s);case"polygon":case"esriGeometryPolygon":return t=>function(t,e){if(t)for(const n of t.rings)for(const t of n)t.length>2&&(t[2]*=e)}(t,s);case"multipoint":case"esriGeometryMultipoint":return t=>function(t,e){if(t)for(const n of t.points)n.length>2&&(n[2]*=e)}(t,s);case"extent":case"esriGeometryExtent":return t=>function(t,e){t&&null!=t.zmin&&null!=t.zmax&&(t.zmin*=e,t.zmax*=e)}(t,s);default:return null}}},33127:(t,e,n)=>{n.r(e),n.d(e,{ElevationQuery:()=>_,GeometryDescriptor:()=>E,default:()=>_,getFinestLodIndex:()=>D});var a=n(66643),i=n(20102),o=n(70586),s=n(95330),r=n(67900),l=n(65091),c=n(13473),u=n(58901),h=n(90411),f=n(24470),m=(n(66577),n(80442),n(92604)),p=n(54102),d=n(40488);const M=m.Z.getLogger("esri.layers.support.ElevationSampler");class y{queryElevation(t){return function(t,e){const n=g(t,e.spatialReference);if(!n)return null;switch(t.type){case"point":!function(t,e,n){t.z=(0,o.Pt)(n.elevationAt(e),0)}(t,n,e);break;case"polyline":!function(t,e,n){T.spatialReference=e.spatialReference;const a=t.hasM&&!t.hasZ;for(let i=0;i<t.paths.length;i++){const s=t.paths[i],r=e.paths[i];for(let t=0;t<s.length;t++){const e=s[t],i=r[t];T.x=i[0],T.y=i[1],a&&(e[3]=e[2]),e[2]=(0,o.Pt)(n.elevationAt(T),0)}}t.hasZ=!0}(t,n,e);break;case"multipoint":!function(t,e,n){T.spatialReference=e.spatialReference;const a=t.hasM&&!t.hasZ;for(let i=0;i<t.points.length;i++){const s=t.points[i],r=e.points[i];T.x=r[0],T.y=r[1],a&&(s[3]=s[2]),s[2]=(0,o.Pt)(n.elevationAt(T),0)}t.hasZ=!0}(t,n,e)}return t}(t.clone(),this)}on(){return b}projectIfRequired(t,e){return g(t,e)}}class x extends y{constructor(t,e,n){super(),this.tile=t,this.noDataValue=n,this.extent=(0,f.HH)(t.tile.extent,e.spatialReference);const a=(0,r.c9)(e.spatialReference),i=e.lodAt(t.tile.level).resolution*a;this.demResolution={min:i,max:i}}get spatialReference(){return this.extent.spatialReference}contains(t){const e=this.projectIfRequired(t,this.spatialReference);return(0,p.aV)(this.extent,e)}elevationAt(t){const e=this.projectIfRequired(t,this.spatialReference);if((0,o.Wi)(e))return null;if(!this.contains(t)){const e=this.extent,n=`${e.xmin}, ${e.ymin}, ${e.xmax}, ${e.ymax}`;return M.warn("#elevationAt()",`Point used to sample elevation (${t.x}, ${t.y}) is outside of the sampler extent (${n})`),this.noDataValue}return this.tile.sample(e.x,e.y)}}class v extends y{constructor(t,e,n){let a;super(),"number"==typeof e?(this.noDataValue=e,a=null):(a=e,this.noDataValue=n),this.samplers=a?t.map((t=>new x(t,a,this.noDataValue))):t;const i=this.samplers[0];if(i){this.extent=i.extent.clone();const{min:t,max:e}=i.demResolution;this.demResolution={min:t,max:e};for(let t=1;t<this.samplers.length;t++){const e=this.samplers[t];this.extent.union(e.extent),this.demResolution.min=Math.min(this.demResolution.min,e.demResolution.min),this.demResolution.max=Math.max(this.demResolution.max,e.demResolution.max)}}else this.extent=(0,f.HH)((0,f.Ue)(),a.spatialReference),this.demResolution={min:0,max:0}}get spatialReference(){return this.extent.spatialReference}elevationAt(t){const e=this.projectIfRequired(t,this.spatialReference);if(!e)return null;for(const t of this.samplers)if(t.contains(e))return t.elevationAt(e);return M.warn("#elevationAt()",`Point used to sample elevation (${t.x}, ${t.y}) is outside of the sampler`),this.noDataValue}}function g(t,e){if((0,o.Wi)(t))return null;const n=t.spatialReference;if(n.equals(e))return t;const a=(0,d.iV)(t,e);return a||M.error(`Cannot project geometry spatial reference (wkid:${n.wkid}) to elevation sampler spatial reference (wkid:${e.wkid})`),a}const T=new c.Z,b={remove(){}};class w{constructor(t,e=null){if(this.tile=t,(0,o.pC)(e)){const n=t.extent;this.samplerData={pixelData:e.values,width:e.width,height:e.height,safeWidth:.99999999*(e.width-1),noDataValue:e.noDataValue,dx:(e.width-1)/(n[2]-n[0]),dy:(e.width-1)/(n[3]-n[1]),x0:n[0],y1:n[3]}}}sample(t,e){if((0,o.Wi)(this.samplerData))return;const{safeWidth:n,width:a,pixelData:i,noDataValue:s,dx:r,dy:l,y1:c,x0:u}=this.samplerData,h=R(l*(c-e),0,n),f=R(r*(t-u),0,n),m=Math.floor(h),p=Math.floor(f),d=m*a+p,M=d+a,y=i[d],x=i[M],v=i[d+1],g=i[M+1];if(y!==s&&x!==s&&v!==s&&g!==s){const t=f-p,e=y+(v-y)*t;return e+(x+(g-x)*t-e)*(h-m)}}}function R(t,e,n){return t<e?e:t>n?n:t}class _{async queryAll(t,e,n){if(!(t=n&&n.ignoreInvisibleLayers?t.filter((t=>t.visible)):t.slice()).length)throw new i.Z("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");const a=E.fromGeometry(e);let o=!1;n&&n.returnSampleInfo||(o=!0);const s={...z,...n,returnSampleInfo:!0},r=await this.query(t[t.length-1],a,s),l=await this._queryAllContinue(t,r,s);return l.geometry=l.geometry.export(),o&&delete l.sampleInfo,l}async query(t,e,n){if(!t)throw new i.Z("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!e||!(e instanceof E)&&"point"!==e.type&&"multipoint"!==e.type&&"polyline"!==e.type)throw new i.Z("elevation-query:invalid-geometry","Only point, polyline and multipoint geometries can be used to query elevation");const a={...z,...n},o=new I(t,e.spatialReference,a),s=a.signal;return await t.load({signal:s}),await this._createGeometryDescriptor(o,e,s),await this._selectTiles(o,s),await this._populateElevationTiles(o,s),this._sampleGeometryWithElevation(o),this._createQueryResult(o,s)}async createSampler(t,e,n){if(!t)throw new i.Z("elevation-query:invalid-layer","Elevation queries require an elevation layer to fetch tiles from");if(!e||"extent"!==e.type)throw new i.Z("elevation-query:invalid-extent","Invalid or undefined extent");const a={...z,...n};return this._createSampler(t,e,a)}async createSamplerAll(t,e,n){if(!(t=n&&n.ignoreInvisibleLayers?t.filter((t=>t.visible)):t.slice()).length)throw new i.Z("elevation-query:invalid-layer","Elevation queries require at least one elevation layer to fetch tiles from");if(!e||"extent"!==e.type)throw new i.Z("elevation-query:invalid-extent","Invalid or undefined extent");const a={...z,...n,returnSampleInfo:!0},o=await this._createSampler(t[t.length-1],e,a);return this._createSamplerAllContinue(t,e,o,a)}async _createSampler(t,e,n,a){const i=n.signal;await t.load({signal:i});const o=e.spatialReference,s=t.tileInfo.spatialReference;o.equals(s)||(await(0,h.iQ)([{source:o,dest:s}],{signal:i}),e=(0,h.iV)(e,s));const r=new A(t,e,n,a);return await this._selectTiles(r,i),await this._populateElevationTiles(r,i),new v(r.elevationTiles,r.layer.tileInfo,r.options.noDataValue)}async _createSamplerAllContinue(t,e,n,a){if(t.pop(),!t.length)return n;const i=n.samplers.map((t=>(0,f.oJ)(t.extent))),o=await this._createSampler(t[t.length-1],e,a,i);if(0===o.samplers.length)return n;const s=n.samplers.concat(o.samplers),r=new v(s,a.noDataValue);return this._createSamplerAllContinue(t,e,r,a)}async _queryAllContinue(t,e,n){const a=t.pop(),i=e.geometry.coordinates,o=[],s=[];for(let n=0;n<i.length;n++){const r=e.sampleInfo[n];r.demResolution>=0?r.source||(r.source=a):t.length&&(o.push(i[n]),s.push(n))}if(!t.length||0===o.length)return e;const r=e.geometry.clone(o),l=await this.query(t[t.length-1],r,n);return s.forEach(((t,n)=>{i[t].z=l.geometry.coordinates[n].z,e.sampleInfo[t].demResolution=l.sampleInfo[n].demResolution})),this._queryAllContinue(t,e,n)}async _createQueryResult(t,e){const n={geometry:(await t.geometry.project(t.outSpatialReference,e)).export(),noDataValue:t.options.noDataValue};return t.options.returnSampleInfo&&(n.sampleInfo=this._extractSampleInfo(t)),t.geometry.coordinates.forEach((t=>{t.tile=null,t.elevationTile=null})),n}async _createGeometryDescriptor(t,e,n){let a;const o=t.layer.tileInfo.spatialReference;if(e instanceof E?a=await e.project(o,n):(await(0,h.iQ)([{source:e.spatialReference,dest:o}],{signal:n}),a=(0,h.iV)(e,o)),!a)throw new i.Z("elevation-query:spatial-reference-mismatch",`Cannot query elevation in '${e.spatialReference.wkid}' on an elevation service in '${o.wkid}'`);t.geometry=E.fromGeometry(a)}async _selectTiles(t,e){const n=t.options.demResolution;if("geometry"===t.type&&this._preselectOutsideLayerExtent(t),"number"==typeof n)this._selectTilesClosestResolution(t);else if("finest-contiguous"===n)await this._selectTilesFinestContiguous(t,e);else{if("auto"!==n)throw new i.Z("elevation-query:invalid-dem-resolution",`Invalid dem resolution value '${n}', expected a number, "finest-contiguous" or "auto"`);await this._selectTilesAuto(t,e)}}_preselectOutsideLayerExtent(t){if((0,o.Wi)(t.layer.fullExtent))return;const e=new w(null);e.sample=()=>t.options.noDataValue,t.outsideExtentTile=e;const n=t.layer.fullExtent;t.geometry.coordinates.forEach((t=>{const a=t.x,i=t.y;(a<n.xmin||a>n.xmax||i<n.ymin||i>n.ymax)&&(t.elevationTile=e)}))}_selectTilesClosestResolution(t){const e=t.layer.tileInfo,n=this._findNearestDemResolutionLODIndex(e,t.options.demResolution);t.selectTilesAtLOD(n)}_findNearestDemResolutionLODIndex(t,e){const n=e/(0,r.c9)(t.spatialReference);let a=t.lods[0],i=0;for(let e=1;e<t.lods.length;e++){const o=t.lods[e];Math.abs(o.resolution-n)<Math.abs(a.resolution-n)&&(a=o,i=e)}return i}async _selectTilesFinestContiguous(t,e){const n=D(t.layer.tileInfo,t.options.minDemResolution);await this._selectTilesFinestContiguousAt(t,n,e)}async _selectTilesFinestContiguousAt(t,e,n){const a=t.layer;if(t.selectTilesAtLOD(e),e<0)return;const o=a.tilemapCache,r=t.getTilesToFetch();try{if(o)await(0,s.Hl)(Promise.all(r.map((t=>o.fetchAvailability(t.level,t.row,t.col,{signal:n})))),n);else if(await this._populateElevationTiles(t,n),!t.allElevationTilesFetched())throw t.clearElevationTiles(),new i.Z("elevation-query:has-unavailable-tiles")}catch(a){(0,s.r9)(a),await this._selectTilesFinestContiguousAt(t,e-1,n)}}async _populateElevationTiles(t,e){const n=t.getTilesToFetch(),a={},i=t.options.cache,r=t.options.noDataValue,l=n.map((async n=>{const s=`${t.layer.uid}:${n.id}:${r}`,l=(0,o.pC)(i)?i.get(s):null,c=(0,o.pC)(l)?l:await t.layer.fetchTile(n.level,n.row,n.col,{noDataValue:r,signal:e});(0,o.pC)(i)&&i.put(s,c),a[n.id]=new w(n,c)}));await(0,s.Hl)((0,s.as)(l),e),t.populateElevationTiles(a)}async _selectTilesAuto(t,e){this._selectTilesAutoFinest(t),this._reduceTilesForMaximumRequests(t);const n=t.layer.tilemapCache;if(!n)return this._selectTilesAutoPrefetchUpsample(t,e);const i=t.getTilesToFetch(),o={},r=i.map((async t=>{const i={id:null,level:0,row:0,col:0,extent:(0,f.Ue)()},r=await(0,a.q6)(n.fetchAvailabilityUpsample(t.level,t.row,t.col,i,{signal:e}));!1===r.ok?(0,s.r9)(r.error):o[t.id]=i}));await(0,s.Hl)(Promise.all(r),e),t.remapTiles(o)}_reduceTilesForMaximumRequests(t){const e=t.layer.tileInfo;let n=0;const a={},i=t=>{t.id in a?a[t.id]++:(a[t.id]=1,n++)},o=t=>{const e=a[t.id];1===e?(delete a[t.id],n--):a[t.id]=e-1};t.forEachTileToFetch(i,o);let s=!0;for(;s&&(s=!1,t.forEachTileToFetch((a=>{n<=t.options.maximumAutoTileRequests||(o(a),e.upsampleTile(a)&&(s=!0),i(a))}),o),s););}_selectTilesAutoFinest(t){const e=D(t.layer.tileInfo,t.options.minDemResolution);t.selectTilesAtLOD(e,t.options.maximumAutoTileRequests)}async _selectTilesAutoPrefetchUpsample(t,e){const n=t.layer.tileInfo;await this._populateElevationTiles(t,e);let a=!1;t.forEachTileToFetch(((t,e)=>{n.upsampleTile(t)?a=!0:e()})),a&&await this._selectTilesAutoPrefetchUpsample(t,e)}_sampleGeometryWithElevation(t){t.geometry.coordinates.forEach((e=>{const n=e.elevationTile;let a=t.options.noDataValue;if(n){const t=n.sample(e.x,e.y);(0,o.pC)(t)?a=t:e.elevationTile=null}e.z=a}))}_extractSampleInfo(t){const e=t.layer.tileInfo,n=(0,r.c9)(e.spatialReference);return t.geometry.coordinates.map((a=>{let i=-1;return a.elevationTile&&a.elevationTile!==t.outsideExtentTile&&(i=e.lodAt(a.elevationTile.tile.level).resolution*n),{demResolution:i}}))}}class E{export(){return this._exporter(this.coordinates,this.spatialReference)}clone(t){const e=new E;return e.geometry=this.geometry,e.spatialReference=this.spatialReference,e.coordinates=t||this.coordinates.map((t=>this._cloneCoordinate(t))),e._exporter=this._exporter,e}async project(t,e){if(this.spatialReference.equals(t))return this.clone();await(0,h.iQ)([{source:this.spatialReference,dest:t}],{signal:e});const n=new l.Z({spatialReference:this.spatialReference,points:this.coordinates.map((t=>[t.x,t.y]))}),a=(0,h.iV)(n,t);if(!a)return null;const i=this.coordinates.map(((t,e)=>{const n=this._cloneCoordinate(t),i=a.points[e];return n.x=i[0],n.y=i[1],n})),o=this.clone(i);return o.spatialReference=t,o}_cloneCoordinate(t){return{x:t.x,y:t.y,z:t.z,m:t.m,tile:null,elevationTile:null}}static fromGeometry(t){const e=new E;if(e.geometry=t,e.spatialReference=t.spatialReference,t instanceof E)e.coordinates=t.coordinates.map((t=>e._cloneCoordinate(t))),e._exporter=(e,n)=>{const a=t.clone(e);return a.spatialReference=n,a};else switch(t.type){case"point":{const n=t,{hasZ:a,hasM:i}=n;e.coordinates=a&&i?[{x:n.x,y:n.y,z:n.z,m:n.m}]:a?[{x:n.x,y:n.y,z:n.z}]:i?[{x:n.x,y:n.y,m:n.m}]:[{x:n.x,y:n.y}],e._exporter=(e,n)=>t.hasM?new c.Z(e[0].x,e[0].y,e[0].z,e[0].m,n):new c.Z(e[0].x,e[0].y,e[0].z,n);break}case"multipoint":{const n=t,{hasZ:a,hasM:i}=n;e.coordinates=a&&i?n.points.map((t=>({x:t[0],y:t[1],z:t[2],m:t[3]}))):a?n.points.map((t=>({x:t[0],y:t[1],z:t[2]}))):i?n.points.map((t=>({x:t[0],y:t[1],m:t[2]}))):n.points.map((t=>({x:t[0],y:t[1]}))),e._exporter=(e,n)=>t.hasM?new l.Z({points:e.map((t=>[t.x,t.y,t.z,t.m])),hasZ:!0,hasM:!0,spatiaReference:n}):new l.Z(e.map((t=>[t.x,t.y,t.z])),n);break}case"polyline":{const n=t,a=[],i=[],{hasZ:o,hasM:s}=t;let r=0;for(const t of n.paths)if(i.push([r,r+t.length]),r+=t.length,o&&s)for(const e of t)a.push({x:e[0],y:e[1],z:e[2],m:e[3]});else if(o)for(const e of t)a.push({x:e[0],y:e[1],z:e[2]});else if(s)for(const e of t)a.push({x:e[0],y:e[1],m:e[2]});else for(const e of t)a.push({x:e[0],y:e[1]});e.coordinates=a,e._exporter=(e,n)=>{const a=t.hasM?e.map((t=>[t.x,t.y,t.z,t.m])):e.map((t=>[t.x,t.y,t.z])),o=i.map((t=>a.slice(t[0],t[1])));return new u.Z({paths:o,hasM:t.hasM,hasZ:!0,spatialReference:n})};break}}return e}}class q{constructor(t,e){this.layer=t,this.options=e}}class I extends q{constructor(t,e,n){super(t,n),this.outSpatialReference=e,this.type="geometry"}selectTilesAtLOD(t){if(t<0)this.geometry.coordinates.forEach((t=>t.tile=null));else{const e=this.layer.tileInfo,n=e.lods[t].level;this.geometry.coordinates.forEach((t=>{t.tile=e.tileAt(n,t.x,t.y)}))}}allElevationTilesFetched(){return!this.geometry.coordinates.some((t=>!t.elevationTile))}clearElevationTiles(){for(const t of this.geometry.coordinates)t.elevationTile!==this.outsideExtentTile&&(t.elevationTile=null)}populateElevationTiles(t){for(const e of this.geometry.coordinates)!e.elevationTile&&e.tile&&(e.elevationTile=t[e.tile.id])}remapTiles(t){for(const e of this.geometry.coordinates)e.tile=t[e.tile.id]}getTilesToFetch(){const t={},e=[];for(const n of this.geometry.coordinates){const a=n.tile;n.elevationTile||!n.tile||t[a.id]||(t[a.id]=a,e.push(a))}return e}forEachTileToFetch(t){for(const e of this.geometry.coordinates)e.tile&&!e.elevationTile&&t(e.tile,(()=>e.tile=null))}}class A extends q{constructor(t,e,n,a){super(t,n),this.type="extent",this.elevationTiles=[],this.candidateTiles=[],this.fetchedCandidates=new Set,this.extent=e.intersection(t.fullExtent),this.maskExtents=a}selectTilesAtLOD(t,e){const n=this._maximumLodForRequests(e),a=Math.min(n,t);a<0?this.candidateTiles.length=0:this._selectCandidateTilesCoveringExtentAt(a)}_maximumLodForRequests(t){const e=this.layer.tileInfo;if(!t)return e.lods.length-1;const n=this.extent;if((0,o.Wi)(n))return-1;for(let a=e.lods.length-1;a>=0;a--){const i=e.lods[a],o=i.resolution*e.size[0],s=i.resolution*e.size[1];if(Math.ceil(n.width/o)*Math.ceil(n.height/s)<=t)return a}return-1}allElevationTilesFetched(){return this.candidateTiles.length===this.elevationTiles.length}clearElevationTiles(){this.elevationTiles.length=0,this.fetchedCandidates.clear()}populateElevationTiles(t){for(const e of this.candidateTiles){const n=t[e.id];n&&(this.fetchedCandidates.add(e),this.elevationTiles.push(n))}}remapTiles(t){this.candidateTiles=this._uniqueNonOverlappingTiles(this.candidateTiles.map((e=>t[e.id])))}getTilesToFetch(){return this.candidateTiles}forEachTileToFetch(t,e){const n=this.candidateTiles;this.candidateTiles=[],n.forEach((n=>{if(this.fetchedCandidates.has(n))return void(e&&e(n));let a=!1;t(n,(()=>a=!0)),a?e&&e(n):this.candidateTiles.push(n)})),this.candidateTiles=this._uniqueNonOverlappingTiles(this.candidateTiles,e)}_uniqueNonOverlappingTiles(t,e){const n={},a=[];for(const i of t)n[i.id]?e&&e(i):(n[i.id]=i,a.push(i));const i=a.sort(((t,e)=>t.level-e.level));return i.filter(((t,n)=>{for(let a=0;a<n;a++)if((0,f.r3)(i[a].extent,t.extent))return e&&e(t),!1;return!0}))}_selectCandidateTilesCoveringExtentAt(t){this.candidateTiles.length=0;const e=this.extent;if((0,o.Wi)(e))return;const n=this.layer.tileInfo,a=n.lods[t],i=n.tileAt(a.level,e.xmin,e.ymin),s=a.resolution*n.size[0],r=a.resolution*n.size[1],l=Math.ceil((e.xmax-i.extent[0])/s),c=Math.ceil((e.ymax-i.extent[1])/r);for(let t=0;t<c;t++)for(let e=0;e<l;e++){const a={id:null,level:i.level,row:i.row-t,col:i.col+e};n.updateTileInfo(a),this._tileIsMasked(a)||this.candidateTiles.push(a)}}_tileIsMasked(t){return!!this.maskExtents&&this.maskExtents.some((e=>(0,f.r3)(e,t.extent)))}}function D(t,e){let n=t.lods.length-1;if(e>0){const a=t.lods.findIndex((t=>t.resolution<e));0===a?n=0:a>0&&(n=a-1)}return n}const z={maximumAutoTileRequests:20,noDataValue:0,returnSampleInfo:!1,demResolution:"auto",minDemResolution:0}}}]);