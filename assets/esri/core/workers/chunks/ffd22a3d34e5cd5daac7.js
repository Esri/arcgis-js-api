self.webpackChunkRemoteClient([7,157],{105:function(e,t,r){"use strict";r.d(t,"a",(function(){return V})),r.d(t,"b",(function(){return H})),r.d(t,"c",(function(){return Z})),r.d(t,"d",(function(){return U})),r.d(t,"e",(function(){return D})),r.d(t,"f",(function(){return J})),r.d(t,"g",(function(){return Y})),r.d(t,"h",(function(){return $})),r.d(t,"i",(function(){return j})),r.d(t,"j",(function(){return _})),r.d(t,"k",(function(){return L})),r.d(t,"l",(function(){return C})),r.d(t,"m",(function(){return ue})),r.d(t,"n",(function(){return ee})),r.d(t,"o",(function(){return ne})),r.d(t,"p",(function(){return oe})),r.d(t,"q",(function(){return X})),r.d(t,"r",(function(){return K})),r.d(t,"s",(function(){return y})),r.d(t,"t",(function(){return v})),r.d(t,"u",(function(){return ie})),r.d(t,"v",(function(){return W})),r.d(t,"w",(function(){return se}));var n=r(2),s=r(16),i=r(64),a=r(193),o=r(292),u=r(140);function c(e,t){return e?t?4:3:t?3:2}const l=n.a.getLogger("esri.tasks.support.optimizedFeatureSet"),h={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},f=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i},d=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i,e[r+2]=t[n+2]},p=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i,e[r+2]=t[n+3]},m=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i,e[r+2]=t[n+2],e[r+3]=t[n+3]};function g(e,t,r,n){if(e){if(r)return t&&n?m:d;if(t&&n)return p}else if(t&&n)return d;return f}function y({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function v({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function b({scale:e,translate:t},r){return r*e[0]+t[0]}function x({scale:e,translate:t},r){return t[1]-r*e[1]}function _(e,t,r){return e?t?r?M(e):S(e):r?O(e):w(e):null}function w(e){const t=e.coords;return{x:t[0],y:t[1]}}function I(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function S(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function N(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function O(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function T(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function M(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function F(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function A(e,t){return e&&t?F:e?N:t?T:I}function R(e,t,r,n,s){const i=A(r,n);for(const r of t){const{geometry:t,attributes:n}=r;let o;t&&(o=i(new u.a,t)),e.push(new a.a(o,n,null,n[s]))}return e}function j(e,t,r){if(!e)return null;const n=c(t,r),s=[];for(let t=0;t<e.coords.length;t+=n){const r=[];for(let s=0;s<n;s++)r.push(e.coords[t+s]);s.push(r)}return t?r?{points:s,hasZ:t,hasM:r}:{points:s,hasZ:t}:r?{points:s,hasM:r}:{points:s}}function E(e,t,r,n,s){const i=c(r,n);for(const r of t){const t=r.geometry,n=r.attributes;let o;t&&(o=P(new u.a,t,i)),e.push(new a.a(o,n,null,n[s]))}return e}function P(e,t,r=c(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const n=e.coords;let s=0;for(const e of t.points)for(let t=0;t<r;t++)n[s++]=e[t];return e}function C(e,t,r){if(!e)return null;const n=c(t,r),{coords:s,lengths:i}=e,a=[];let o=0;for(const e of i){const t=[];for(let r=0;r<e;r++){const e=[];for(let t=0;t<n;t++)e.push(s[o++]);t.push(e)}a.push(t)}return t?r?{paths:a,hasZ:t,hasM:r}:{paths:a,hasZ:t}:r?{paths:a,hasM:r}:{paths:a}}function G(e,t,r,n,s){const i=c(r,n);for(const r of t){const t=r.geometry,n=r.attributes;let o;t&&(o=z(new u.a,t,i)),e.push(new a.a(o,n,null,n[s]))}return e}function z(e,t,r=c(t.hasZ,t.hasM)){const{lengths:n,coords:s}=e;let i=0;for(const e of t.paths){for(const t of e)for(let e=0;e<r;e++)s[i++]=t[e];n.push(e.length)}return e}function L(e,t,r){if(!e)return null;const n=c(t,r),{coords:s,lengths:i}=e,a=[];let o=0;for(const e of i){const t=[];for(let r=0;r<e;r++){const e=[];for(let t=0;t<n;t++)e.push(s[o++]);t.push(e)}a.push(t)}return t?r?{rings:a,hasZ:t,hasM:r}:{rings:a,hasZ:t}:r?{rings:a,hasM:r}:{rings:a}}function Q(e,t,r,n,s){for(const i of t){const t=i.geometry,o=i.centroid,c=i.attributes;let l;t&&(l=D(new u.a,t,r,n)),o?e.push(new a.a(l,c,I(new u.a,o),c[s])):e.push(new a.a(l,c,null,c[s]))}return e}function D(e,t,r=t.hasZ,n=t.hasM){return function(e,t,r,n){const s=c(r,n),{lengths:i,coords:a}=e;let o=0;i.length=a.length=0;for(const e of t){for(const t of e)for(let e=0;e<s;e++)a[o++]=t[e];i.push(e.length)}}(e,t.rings,r,n),e}const k=[],q=[];function V(e,t,r,n,s){k[0]=e;const[i]=Z(q,k,t,r,n,s);return k.length=q.length=0,i}function Z(e,t,r,n,i,o){if(e.length=0,!r){for(const r of t){const t=r.attributes[o];e.push(new a.a(null,r.attributes,null,t))}return e}switch(r){case"esriGeometryPoint":return R(e,t,n,i,o);case"esriGeometryMultipoint":return E(e,t,n,i,o);case"esriGeometryPolyline":return G(e,t,n,i,o);case"esriGeometryPolygon":return Q(e,t,n,i,o);default:l.error("convertToFeatureSet:unknown-geometry",new s.a(`Unable to parse unknown geometry type '${r}'`)),e.length=0}return e}function J(e,t,r,n){q[0]=e,B(k,q,t,r,n);const s=k[0];return k.length=q.length=0,s}function U(e,t,r){if(!e)return null;const n=new u.a;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==r&&(r=e.hasM),Object(i.f)(e)?A(null!=t?t:null!=e.z,null!=r?r:null!=e.m)(n,e):Object(i.g)(e)?D(n,e,t,r):Object(i.h)(e)?z(n,e,c(t,r)):Object(i.e)(e)?P(n,e,c(t,r)):void l.error("convertFromGeometry:unknown-geometry",new s.a(`Unable to parse unknown geometry type '${e}'`))}function $(e,t,r,n){const i=e&&("coords"in e?e:e.geometry);if(!i)return null;switch(t){case"esriGeometryPoint":{let e=w;return r&&n?e=M:r?e=S:n&&(e=O),e(i)}case"esriGeometryMultipoint":return j(i,r,n);case"esriGeometryPolyline":return C(i,r,n);case"esriGeometryPolygon":return L(i,r,n);default:return void l.error("convertToGeometry:unknown-geometry",new s.a(`Unable to parse unknown geometry type '${t}'`))}}function B(e,t,r,n,i){switch(e.length=0,r){case"esriGeometryPoint":return function(e,t,r,n){let s=w;r&&n?s=M:r?s=S:n&&(s=O);for(const r of t){const{geometry:t,attributes:n}=r,i=t?s(t):null;e.push({attributes:n,geometry:i})}return e}(e,t,n,i);case"esriGeometryMultipoint":return function(e,t,r,n){for(const s of t){const{geometry:t,attributes:i}=s;let a;t&&(a=j(t,r,n)),e.push({attributes:i,geometry:a})}return e}(e,t,n,i);case"esriGeometryPolyline":return function(e,t,r,n){for(const s of t){const{geometry:t,attributes:i}=s;let a;t&&(a=C(t,r,n)),e.push({attributes:i,geometry:a})}return e}(e,t,n,i);case"esriGeometryPolygon":return function(e,t,r,n){for(const s of t){const{geometry:t,attributes:i,centroid:a}=s;let o;if(t&&(o=L(t,r,n)),a){const t=w(a);e.push({attributes:i,centroid:t,geometry:o})}else e.push({attributes:i,geometry:o})}return e}(e,t,n,i);default:l.error("convertToFeatureSet:unknown-geometry",new s.a(`Unable to parse unknown geometry type '${r}'`))}return e}function Y(e){const{objectIdFieldName:t,spatialReference:r,transform:n,fields:s,hasM:i,hasZ:a,features:o,geometryType:u,exceededTransferLimit:c,uniqueIdField:l,queryGeometry:h,queryGeometryType:f}=e,d={features:B([],o,u,a,i),fields:s,geometryType:u,objectIdFieldName:t,spatialReference:r,uniqueIdField:l,queryGeometry:$(h,f,!1,!1)};return n&&(d.transform=n),c&&(d.exceededTransferLimit=c),i&&(d.hasM=i),a&&(d.hasZ=a),d}function H(e,t){const r=new o.a,{hasM:n,hasZ:i,features:a,objectIdFieldName:u,spatialReference:c,geometryType:h,exceededTransferLimit:f,transform:d,fields:p}=e;return p&&(r.fields=p),r.geometryType=h,r.objectIdFieldName=u||t,r.spatialReference=c,r.objectIdFieldName?(a&&Z(r.features,a,h,i,n,r.objectIdFieldName),f&&(r.exceededTransferLimit=f),n&&(r.hasM=n),i&&(r.hasZ=i),d&&(r.transform=d),r):(l.error(new s.a("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r)}function W(e){const{transform:t,features:r,hasM:n,hasZ:s}=e;if(!t)return e;for(const e of r)e.geometry&&se(e.geometry,e.geometry,n,s,t),e.centroid&&se(e.centroid,e.centroid,n,s,t);return e.transform=null,e}function X(e,t){const{geometryType:r,features:n,hasM:s,hasZ:i}=t;if(!e)return t;for(let t=0;t<n.length;t++){const a=n[t],o=a.weakClone();o.geometry=new u.a,K(o.geometry,a.geometry,s,i,r,e),a.centroid&&(o.centroid=new u.a,K(o.centroid,a.centroid,s,i,"esriGeometryPoint",e)),n[t]=o}return t.transform=e,t}function K(e,t,r,n,s,i,a=r,o=n){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const u=h[s],{coords:l,lengths:f}=t,d=c(r,n),p=c(r&&a,n&&o),m=g(r,n,a,o);if(!f.length)return m(e.coords,l,0,0,y(i,l[0]),v(i,l[1])),e.lengths.length&&(e.lengths.length=0),e.coords.length=d,e;let b,x,_,w,I=0,S=0,N=S;for(const t of f){if(t<u)continue;let r=0;S=N,_=b=y(i,l[I]),w=x=v(i,l[I+1]),m(e.coords,l,S,I,_,w),r++,I+=d,S+=p;for(let n=1;n<t;n++,I+=d)_=y(i,l[I]),w=v(i,l[I+1]),_===b&&w===x||(m(e.coords,l,S,I,_-b,w-x),S+=p,r++,b=_,x=w);r>=u&&(e.lengths.push(r),N=S)}return e.coords.length=N,e.coords.length?e:null}function ee(e,t,r,n,s,i,a=r,o=n){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const u=h[s],{coords:l,lengths:f}=t,d=c(r,n),p=c(r&&a,n&&o),m=g(r,n,a,o);if(!f.length)return m(e.coords,l,0,0,l[0],l[1]),e.lengths.length&&(e.lengths.length=0),e.coords.length=d,e;let y=0;const v=i*i;for(const t of f){if(t<u){y+=t*d;continue}const r=e.coords.length/p,n=y,s=y+(t-1)*d;m(e.coords,l,e.coords.length,n,l[n],l[n+1]),re(e.coords,l,d,v,m,n,s),m(e.coords,l,e.coords.length,s,l[s],l[s+1]);const i=e.coords.length/p-r;i>=u?e.lengths.push(i):e.coords.length=r*p,y+=t*d}return e.coords.length?e:null}function te(e,t,r,n){const s=e[t],i=e[t+1],a=e[r],o=e[r+1],u=e[n],c=e[n+1];let l=a,h=o,f=u-l,d=c-h;if(0!==f||0!==d){const e=((s-l)*f+(i-h)*d)/(f*f+d*d);e>1?(l=u,h=c):e>0&&(l+=f*e,h+=d*e)}return f=s-l,d=i-h,f*f+d*d}function re(e,t,r,n,s,i,a){let o,u=n,c=0;for(let e=i+r;e<a;e+=r)o=te(t,e,i,a),o>u&&(c=e,u=o);u>n&&(c-i>r&&re(e,t,r,n,s,i,c),s(e,t,e.length,c,t[c],t[c+1]),a-c>r&&re(e,t,r,n,s,c,a))}function ne(e,t,r,n){if(!t||!t.coords||!t.coords.length)return null;const s=c(r,n);let i=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY;if(t&&t.coords){const e=t.coords;for(let t=0;t<e.length;t+=s){const r=e[t],n=e[t+1];i=Math.min(i,r),o=Math.max(o,r),a=Math.min(a,n),u=Math.max(u,n)}}return e[0]=i,e[1]=a,e[2]=o,e[3]=u,e}function se(e,t,r,n,s){const{coords:i,lengths:a}=t,o=r?n?m:d:n?d:f,u=c(r,n);if(!i.length)return e!==t&&(e.lengths.length=0,e.coords.length=0),e;if(!a.length)return o(e.coords,i,0,0,b(s,i[0]),x(s,i[1])),e!==t&&(e.lengths.length=0,e.coords.length=u),e;const[l,h]=s.scale;let p=0;for(let t=0;t<a.length;t++){const r=a[t];e.lengths[t]=r;let n=b(s,i[p]),c=x(s,i[p+1]);o(e.coords,i,p,p,n,c),p+=u;for(let t=1;t<r;t++,p+=u)n+=i[p]*l,c-=i[p+1]*h,o(e.coords,i,p,p,n,c)}return e!==t&&(e.lengths.length=a.length,e.coords.length=i.length),e}function ie(e,t,r,n,s,i){const a=c(r,n),o=g(r,n,s,i),u=t.coords;e.coords.length=0,e.lengths.length=0,e.lengths.push(...t.lengths);for(let t=0;t<u.length;t+=a)o(e.coords,u,e.coords.length,t,u[t],u[t+1]);return e}function ae(e,t,r,n){let s=0,i=e[n*t],a=e[n*(t+1)];for(let o=1;o<r;o++){const r=i+e[n*(t+o)],u=a+e[n*(t+o)+1],c=(r-i)*(u+a);i=r,a=u,s+=c}return.5*s}function oe(e,t){const{coords:r,lengths:n}=e;let s=0,i=0;for(let e=0;e<n.length;e++)i+=ae(r,s,n[e],t),s+=e;return Math.abs(i)}function ue(e,t){const r=e.clone(),n=e.coords,s=e.lengths;let i=0;for(let e=0;e<s.length;e++){const a=s[e];let o=n[t*i],u=n[t*i+1];for(let e=1;e<a;e++){const s=o+n[t*(i+e)],a=u+n[t*(i+e)+1];r.coords[t*(i+e)]=s,r.coords[t*(i+e)+1]=a,o=s,u=a}i+=a}return r}},111:function(e,t,r){"use strict";var n=r(13),s=r(43),i=r(18),a=r(25);class o{constructor(){this._emitter=new o.EventEmitter(this)}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}}!function(e){class t{constructor(e=null){this.target=e,this._listenersMap=null}clear(){this._listenersMap&&this._listenersMap.clear()}emit(e,t){const r=this._listenersMap&&this._listenersMap.get(e);if(!r)return!1;const n=this.target||this;return[...r].forEach(e=>{e.call(n,t)}),r.length>0}on(e,t){if(Array.isArray(e)){const r=e.map(e=>this.on(e,t));return Object(s.a)(r)}if(e.indexOf(",")>-1)throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const r=this._listenersMap.get(e)||[];return r.push(t),this._listenersMap.set(e,r),{remove:()=>{const r=this._listenersMap&&this._listenersMap.get(e)||[],n=r.indexOf(t);n>=0&&r.splice(n,1)}}}once(e,t){const r=this.on(e,e=>{r.remove(),t.call(null,e)});return r}hasEventListener(e){const t=this._listenersMap&&this._listenersMap.get(e);return null!=t&&t.length>0}}e.EventEmitter=t,e.EventedMixin=e=>{let r=class extends e{constructor(){super(...arguments),this._emitter=new t}destroy(){this._emitter.clear()}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}};return r=Object(n.a)([Object(i.a)("esri.core.Evented")],r),r};let r=class extends a.a{constructor(){super(...arguments),this._emitter=new o.EventEmitter(this)}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}};r=Object(n.a)([Object(i.a)("esri.core.Evented")],r),e.EventedAccessor=r}(o||(o={}));var u=o;t.a=u},137:function(e,t,r){"use strict";r.r(t),r.d(t,"WhereClause",(function(){return _})),r.d(t,"defaultAttributeAdapter",(function(){return G}));var n=r(3);const s={min:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.min.apply(Math,e[0])},max:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.max.apply(Math,e[0])},avg:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:i(e[0])},sum:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:function(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t}(e[0])},stddev:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sqrt(a(e[0]))},count:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].length},var:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:a(e[0])}};function i(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t/e.length}function a(e){const t=i(e),r=e.length;let n=0;for(const r of e)n+=(r-t)**2;return r>1?n/(r-1):0}var o=r(39);class u{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0}static fixDefaults(e){if(null!==e.precision||null!==e.secondary)throw new Error("Primary and Secondary SqlInterval qualifiers not supported")}static createFromMilliseconds(e){const t=new u;return t.second=e/1e3,t}static createFromValueAndQualifer(e,t,r){let n=null;const s=new u;if(s.op="-"===r?"-":"+","interval-period"===t.type){u.fixDefaults(t);const r=new RegExp("^[0-9]{1,}$");if("year"===t.period||"month"===t.period)throw new Error("Year-Month Intervals not supported");if(!r.test(e))throw new Error("Illegal Interval");s[t.period]=parseFloat(e)}else{if(u.fixDefaults(t.start),u.fixDefaults(t.end),"year"===t.start.period||"month"===t.start.period)throw new Error("Year-Month Intervals not supported");if("year"===t.end.period||"month"===t.end.period)throw new Error("Year-Month Intervals not supported");switch(t.start.period){case"day":switch(t.end.period){case"hour":if(n=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!n.test(e))throw new Error("Illegal Interval");s[t.start.period]=parseFloat(e.split(" ")[0]),s[t.end.period]=parseFloat(e.split(" ")[1]);break;case"minute":if(n=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!n.test(e))throw new Error("Illegal Interval");{s[t.start.period]=parseFloat(e.split(" ")[0]);const r=e.split(" ")[1].split(":");s.hour=parseFloat(r[0]),s.minute=parseFloat(r[1])}break;case"second":if(n=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(e))throw new Error("Illegal Interval");{s[t.start.period]=parseFloat(e.split(" ")[0]);const r=e.split(" ")[1].split(":");s.hour=parseFloat(r[0]),s.minute=parseFloat(r[1]),s.second=parseFloat(r[2])}break;default:throw"Invalid Interval."}break;case"hour":switch(t.end.period){case"minute":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!n.test(e))throw new Error("Illegal Interval");s.hour=parseFloat(e.split(":")[0]),s.minute=parseFloat(e.split(":")[1]);break;case"second":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(e))throw new Error("Illegal Interval");{const t=e.split(":");s.hour=parseFloat(t[0]),s.minute=parseFloat(t[1]),s.second=parseFloat(t[2])}break;default:throw"Invalid Interval."}break;case"minute":switch(t.end.period){case"second":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(e))throw new Error("Illegal Interval");{const t=e.split(":");s.minute=parseFloat(t[0]),s.second=parseFloat(t[1])}break;default:throw"Invalid Interval."}break;default:throw"Invalid Interval."}}return s}valueInMilliseconds(){return("-"===this.op?-1:1)*(1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}function c(e,t){const r=l[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)}const l={extract:{minParams:2,maxParams:2,evaluate:([e,t])=>{if(null==t)return null;if(t instanceof Date)switch(e.toUpperCase()){case"SECOND":return t.getSeconds();case"MINUTE":return t.getMinutes();case"HOUR":return t.getHours();case"DAY":return t.getDate();case"MONTH":return t.getMonth()+1;case"YEAR":return t.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:e=>{if(2===e.length){const[t,r]=e;return null==t||null==r?null:t.toString().substring(r-1)}if(3===e.length){const[t,r,n]=e;return null==t||null==r||null==n?null:n<=0?"":t.toString().substring(r-1,r+n-1)}}},position:{minParams:2,maxParams:2,evaluate:([e,t])=>null==e||null==t?null:t.indexOf(e)+1},trim:{minParams:2,maxParams:3,evaluate:e=>{const t=3===e.length,r=t?e[1]:" ",n=t?e[2]:e[1];if(null==r||null==n)return null;const s=`(${Object(o.a)(r)})`;switch(e[0]){case"BOTH":return n.replace(new RegExp(`^${s}*|${s}*$`,"g"),"");case"LEADING":return n.replace(new RegExp(`^${s}*`,"g"),"");case"TRAILING":return n.replace(new RegExp(s+"*$","g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.abs(e[0])},ceiling:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.ceil(e[0])},floor:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.floor(e[0])},log:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])},log10:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sin(e[0])},cos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cos(e[0])},tan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tan(e[0])},asin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.asin(e[0])},acos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.acos(e[0])},atan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.atan(e[0])},sign:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0]>0?1:e[1]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]**e[1]},mod:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]%e[1]},round:{minParams:1,maxParams:2,evaluate:e=>{const t=e[0],r=2===e.length?10**e[1]:1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:e=>null==e[0]?null:1===e.length?parseInt(e[0].toFixed(0),10):parseFloat(e[0].toFixed(e[1]))},char_length:{minParams:1,maxParams:1,evaluate:e=>"string"==typeof e[0]||e[0]instanceof String?e[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:e=>{let t="";for(let r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toUpperCase()}};var h=r(138),f=Object(h.b)((function(e){var t;t=function(){function e(t,r,n,s){this.message=t,this.expected=r,this.found=n,this.location=s,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){var r={literal:function(e){return'"'+s(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function s(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){return r[e.type](e)}return"Expected "+function(e){var t,r,n=new Array(e.length);for(t=0;t<e.length;t++)n[t]=a(e[t]);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+function(e){return e?'"'+s(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){r=void 0!==r?r:{};var n,s={},i={start:Je},a=Je,o=function(e,t){var r={type:"expr_list"},n=function(e,t,r){return function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n][3]);return r}(e,t)}(e,t);return r.value=n,r},u=function(e,t){return pr(e,t)},c=De("!",!1),l=De("=",!1),h=De(">=",!1),f=De(">",!1),d=De("<=",!1),p=De("<>",!1),m=De("<",!1),g=De("!=",!1),y=function(e){return e[0]+" "+e[2]},v=De("+",!1),b=De("-",!1),x=De("*",!1),_=De("/",!1),w=function(e,t){return e+t.join("")},I=/^[A-Za-z_\x80-\uFFFF]/,S=ke([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),N=/^[A-Za-z0-9_]/,O=ke([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),T=/^[A-Za-z0-9_.\x80-\uFFFF]/,M=ke([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),F=De("@",!1),A=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},R=function(e,t){return{type:"interval-period",period:"second",precision:e,secondary:t}},j=function(e){return parseFloat(e)},E=De("'",!1),P=De("N'",!1),C=De("''",!1),G=/^[^']/,z=ke(["'"],!0,!1),L=function(e,t){return{type:"when_clause",operand:e,value:t}},Q=De(".",!1),D=/^[0-9]/,k=ke([["0","9"]],!1,!1),q=/^[eE]/,V=ke(["e","E"],!1,!1),Z=/^[+\-]/,J=ke(["+","-"],!1,!1),U=De("NULL",!0),$=De("TRUE",!0),B=De("FALSE",!0),Y=De("IN",!0),H=De("IS",!0),W=De("LIKE",!0),X=De("ESCAPE",!0),K=De("NOT",!0),ee=De("AND",!0),te=De("OR",!0),re=De("BETWEEN",!0),ne=De("FROM",!0),se=De("FOR",!0),ie=De("SUBSTRING",!0),ae=De("EXTRACT",!0),oe=De("TRIM",!0),ue=De("POSITION",!0),ce=De("TIMESTAMP",!0),le=De("DATE",!0),he=De("LEADING",!0),fe=De("TRAILING",!0),de=De("BOTH",!0),pe=De("TO",!0),me=De("INTERVAL",!0),ge=De("YEAR",!0),ye=De("MONTH",!0),ve=De("DAY",!0),be=De("HOUR",!0),xe=De("MINUTE",!0),_e=De("SECOND",!0),we=De("CASE",!0),Ie=De("END",!0),Se=De("WHEN",!0),Ne=De("THEN",!0),Oe=De("ELSE",!0),Te=De(",",!1),Me=De("(",!1),Fe=De(")",!1),Ae=/^[ \t\n\r]/,Re=ke([" ","\t","\n","\r"],!1,!1),je=De("`",!1),Ee=/^[^`]/,Pe=ke(["`"],!0,!1),Ce=0,Ge=[{line:1,column:1}],ze=0,Le=[],Qe=0;if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');a=i[r.startRule]}function De(e,t){return{type:"literal",text:e,ignoreCase:t}}function ke(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function qe(e){var r,n=Ge[e];if(n)return n;for(r=e-1;!Ge[r];)r--;for(n={line:(n=Ge[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return Ge[e]=n,n}function Ve(e,t){var r=qe(e),n=qe(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function Ze(e){Ce<ze||(Ce>ze&&(ze=Ce,Le=[]),Le.push(e))}function Je(){var e,t;return e=Ce,lr()!==s&&(t=$e())!==s&&lr()!==s?e=t:(Ce=e,e=s),e}function Ue(){var e,t,r,n,i,a,u,c;if(e=Ce,(t=$e())!==s){for(r=[],n=Ce,(i=lr())!==s&&(a=or())!==s&&(u=lr())!==s&&(c=$e())!==s?n=i=[i,a,u,c]:(Ce=n,n=s);n!==s;)r.push(n),n=Ce,(i=lr())!==s&&(a=or())!==s&&(u=lr())!==s&&(c=$e())!==s?n=i=[i,a,u,c]:(Ce=n,n=s);r!==s?e=t=o(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}function $e(){var e,t,r,n,i,a,o,c;if(e=Ce,(t=Be())!==s){for(r=[],n=Ce,(i=lr())!==s&&(a=Ct())!==s&&(o=lr())!==s&&(c=Be())!==s?n=i=[i,a,o,c]:(Ce=n,n=s);n!==s;)r.push(n),n=Ce,(i=lr())!==s&&(a=Ct())!==s&&(o=lr())!==s&&(c=Be())!==s?n=i=[i,a,o,c]:(Ce=n,n=s);r!==s?e=t=u(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}function Be(){var e,t,r,n,i,a,o,c;if(e=Ce,(t=Ye())!==s){for(r=[],n=Ce,(i=lr())!==s&&(a=Pt())!==s&&(o=lr())!==s&&(c=Ye())!==s?n=i=[i,a,o,c]:(Ce=n,n=s);n!==s;)r.push(n),n=Ce,(i=lr())!==s&&(a=Pt())!==s&&(o=lr())!==s&&(c=Ye())!==s?n=i=[i,a,o,c]:(Ce=n,n=s);r!==s?e=t=u(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}function Ye(){var e,r,n,i,a;return e=Ce,(r=Et())===s&&(r=Ce,33===t.charCodeAt(Ce)?(n="!",Ce++):(n=s,0===Qe&&Ze(c)),n!==s?(i=Ce,Qe++,61===t.charCodeAt(Ce)?(a="=",Ce++):(a=s,0===Qe&&Ze(l)),Qe--,a===s?i=void 0:(Ce=i,i=s),i!==s?r=n=[n,i]:(Ce=r,r=s)):(Ce=r,r=s)),r!==s&&(n=lr())!==s&&(i=Ye())!==s?e=r=function(e){return function(e,t){return{type:"unary_expr",operator:e,expr:t}}("NOT",e)}(i):(Ce=e,e=s),e===s&&(e=function(){var e,t,r;return e=Ce,(t=Ke())!==s&&lr()!==s?((r=function(){var e;return(e=function(){var e,t,r,n,i,a;if(e=[],t=Ce,(r=lr())!==s&&(n=He())!==s&&(i=lr())!==s&&(a=Ke())!==s?t=r=[r,n,i,a]:(Ce=t,t=s),t!==s)for(;t!==s;)e.push(t),t=Ce,(r=lr())!==s&&(n=He())!==s&&(i=lr())!==s&&(a=Ke())!==s?t=r=[r,n,i,a]:(Ce=t,t=s);else e=s;return e!==s&&(e=function(e){return{type:"arithmetic",tail:e}}(e)),e}())===s&&(e=function(){var e,t,r,n;return e=Ce,(t=Xe())!==s&&lr()!==s&&(r=ur())!==s&&lr()!==s&&(n=Ue())!==s&&lr()!==s&&cr()!==s?e=t=function(e,t){return{op:e,right:t}}(t,n):(Ce=e,e=s),e===s&&(e=Ce,(t=Xe())!==s&&lr()!==s&&(r=ur())!==s&&lr()!==s&&(n=cr())!==s?e=t=function(e){return{op:e,right:{type:"expr_list",value:[]}}}(t):(Ce=e,e=s),e===s&&(e=Ce,(t=Xe())!==s&&lr()!==s&&(r=ut())!==s?e=t=function(e,t){return{op:e,right:t}}(t,r):(Ce=e,e=s))),e}())===s&&(e=function(){var e,t,r,n,i,a;return e=Ce,(t=Et())!==s&&lr()!==s&&(r=Gt())!==s&&lr()!==s&&(n=Ke())!==s&&lr()!==s&&(i=Pt())!==s&&lr()!==s&&(a=Ke())!==s?e=t=function(e,t,r){return{op:"NOT"+e,right:{type:"expr_list",value:[t,r]}}}(r,n,a):(Ce=e,e=s),e===s&&(e=Ce,(t=Gt())!==s&&lr()!==s&&(r=Ke())!==s&&lr()!==s&&(n=Pt())!==s&&lr()!==s&&(i=Ke())!==s?e=t=function(e,t,r){return{op:e,right:{type:"expr_list",value:[t,r]}}}(t,r,i):(Ce=e,e=s)),e}())===s&&(e=function(){var e,t,r,n;return e=Ce,(t=At())!==s&&lr()!==s&&(r=Et())!==s&&lr()!==s&&(n=Ke())!==s?e=t=function(e,t){return{op:e+"NOT",right:t}}(t,n):(Ce=e,e=s),e===s&&(e=Ce,(t=At())!==s&&lr()!==s&&(r=Ke())!==s?e=t=function(e,t){return{op:e,right:t}}(t,r):(Ce=e,e=s)),e}())===s&&(e=function(){var e,t,r,n;return e=Ce,(t=We())!==s&&lr()!==s&&(r=mt())!==s&&lr()!==s&&jt()!==s&&lr()!==s&&(n=gt())!==s?e=t=function(e,t,r){return{op:e,right:t,escape:r.value}}(t,r,n):(Ce=e,e=s),e===s&&(e=Ce,(t=We())!==s&&lr()!==s&&(r=mt())!==s?e=t=function(e,t){return{op:e,right:t,escape:""}}(t,r):(Ce=e,e=s)),e}()),e}())===s&&(r=null),r!==s?e=t=function(e,t){return""==t||null==t||null==t?e:"arithmetic"==t.type?pr(e,t.tail):dr(t.op,e,t.right,t.escape)}(t,r):(Ce=e,e=s)):(Ce=e,e=s),e}()),e}function He(){var e;return">="===t.substr(Ce,2)?(e=">=",Ce+=2):(e=s,0===Qe&&Ze(h)),e===s&&(62===t.charCodeAt(Ce)?(e=">",Ce++):(e=s,0===Qe&&Ze(f)),e===s&&("<="===t.substr(Ce,2)?(e="<=",Ce+=2):(e=s,0===Qe&&Ze(d)),e===s&&("<>"===t.substr(Ce,2)?(e="<>",Ce+=2):(e=s,0===Qe&&Ze(p)),e===s&&(60===t.charCodeAt(Ce)?(e="<",Ce++):(e=s,0===Qe&&Ze(m)),e===s&&(61===t.charCodeAt(Ce)?(e="=",Ce++):(e=s,0===Qe&&Ze(l)),e===s&&("!="===t.substr(Ce,2)?(e="!=",Ce+=2):(e=s,0===Qe&&Ze(g)))))))),e}function We(){var e,t,r,n,i;return e=Ce,t=Ce,(r=Et())!==s&&(n=lr())!==s&&(i=Rt())!==s?t=r=[r,n,i]:(Ce=t,t=s),t!==s&&(t=y(t)),(e=t)===s&&(e=Rt()),e}function Xe(){var e,t,r,n,i;return e=Ce,t=Ce,(r=Et())!==s&&(n=lr())!==s&&(i=Ft())!==s?t=r=[r,n,i]:(Ce=t,t=s),t!==s&&(t=y(t)),(e=t)===s&&(e=Ft()),e}function Ke(){var e,t,r,n,i,a,o,c;if(e=Ce,(t=tt())!==s){for(r=[],n=Ce,(i=lr())!==s&&(a=et())!==s&&(o=lr())!==s&&(c=tt())!==s?n=i=[i,a,o,c]:(Ce=n,n=s);n!==s;)r.push(n),n=Ce,(i=lr())!==s&&(a=et())!==s&&(o=lr())!==s&&(c=tt())!==s?n=i=[i,a,o,c]:(Ce=n,n=s);r!==s?e=t=u(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}function et(){var e;return 43===t.charCodeAt(Ce)?(e="+",Ce++):(e=s,0===Qe&&Ze(v)),e===s&&(45===t.charCodeAt(Ce)?(e="-",Ce++):(e=s,0===Qe&&Ze(b))),e}function tt(){var e,t,r,n,i,a,o,u;if(e=Ce,(t=nt())!==s){for(r=[],n=Ce,(i=lr())!==s&&(a=rt())!==s&&(o=lr())!==s&&(u=nt())!==s?n=i=[i,a,o,u]:(Ce=n,n=s);n!==s;)r.push(n),n=Ce,(i=lr())!==s&&(a=rt())!==s&&(o=lr())!==s&&(u=nt())!==s?n=i=[i,a,o,u]:(Ce=n,n=s);r!==s?e=t=function(e,t){return pr(e,t)}(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}function rt(){var e;return 42===t.charCodeAt(Ce)?(e="*",Ce++):(e=s,0===Qe&&Ze(x)),e===s&&(47===t.charCodeAt(Ce)?(e="/",Ce++):(e=s,0===Qe&&Ze(_))),e}function nt(){var e,t;return(e=function(){var e;return(e=gt())===s&&(e=function(){var e,t,r,n;return e=Ce,(t=function(){var e,t,r,n;return e=Ce,(t=xt())!==s&&(r=_t())!==s&&(n=wt())!==s?e=t=function(e,t,r){return parseFloat(e+t+r)}(t,r,n):(Ce=e,e=s),e===s&&(e=Ce,(t=xt())!==s&&(r=_t())!==s?e=t=function(e,t){return parseFloat(e+t)}(t,r):(Ce=e,e=s),e===s&&(e=Ce,(t=xt())!==s&&(r=wt())!==s?e=t=function(e,t){return parseFloat(e+t)}(t,r):(Ce=e,e=s),e===s&&(e=Ce,(t=xt())!==s&&(t=function(e){return parseFloat(e)}(t)),e=t))),e}())!==s?(r=Ce,Qe++,n=it(),Qe--,n===s?r=void 0:(Ce=r,r=s),r!==s?e=t=function(e){return{type:"number",value:e}}(t):(Ce=e,e=s)):(Ce=e,e=s),e}())===s&&(e=function(){var e,t;return e=Ce,(t=Tt())!==s&&(t={type:"bool",value:!0}),(e=t)===s&&(e=Ce,(t=Mt())!==s&&(t={type:"bool",value:!1}),e=t),e}())===s&&(e=function(){var e;return(e=Ot())!==s&&(e={type:"null",value:null}),e}())===s&&(e=function(){var e,t;return e=Ce,Zt()!==s&&lr()!==s&&(t=mt())!==s?e=function(e){return{type:"date",value:e.value}}(t):(Ce=e,e=s),e}())===s&&(e=function(){var e,t;return e=Ce,Vt()!==s&&lr()!==s&&(t=mt())!==s?e=function(e){return{type:"timestamp",value:e.value}}(t):(Ce=e,e=s),e}())===s&&(e=lt()),e}())===s&&(e=function(){var e,t,r;return e=Ce,Dt()!==s&&lr()!==s&&ur()!==s&&lr()!==s&&(t=function(){var e;return(e=Ht())===s&&(e=Wt())===s&&(e=Xt())===s&&(e=Kt())===s&&(e=er())===s&&(e=tr()),e}())!==s&&lr()!==s&&zt()!==s&&lr()!==s&&(r=$e())!==s&&lr()!==s&&cr()!==s?e=function(e,t){return{type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:e},t]}}}(t,r):(Ce=e,e=s),e}())===s&&(e=function(){var e,t,r,n,i,a,o,u;return e=Ce,Qt()!==s&&lr()!==s&&ur()!==s&&lr()!==s&&(t=$e())!==s&&lr()!==s&&zt()!==s&&lr()!==s&&(r=$e())!==s&&lr()!==s?(n=Ce,(i=Lt())!==s&&(a=lr())!==s&&(o=$e())!==s&&(u=lr())!==s?n=i=[i,a,o,u]:(Ce=n,n=s),n===s&&(n=null),n!==s&&(i=cr())!==s?e=function(e,t,r){return{type:"function",name:"substring",args:{type:"expr_list",value:r?[e,t,r[2]]:[e,t]}}}(t,r,n):(Ce=e,e=s)):(Ce=e,e=s),e}())===s&&(e=function(){var e,t,r,n;return e=Ce,kt()!==s&&lr()!==s&&ur()!==s&&lr()!==s?((t=ct())===s&&(t=null),t!==s&&lr()!==s&&(r=$e())!==s&&lr()!==s&&zt()!==s&&lr()!==s&&(n=$e())!==s&&lr()!==s&&cr()!==s?e=function(e,t,r){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t,r]}}}(t,r,n):(Ce=e,e=s)):(Ce=e,e=s),e===s&&(e=Ce,kt()!==s&&lr()!==s&&ur()!==s&&lr()!==s?((t=ct())===s&&(t=null),t!==s&&lr()!==s&&(r=$e())!==s&&lr()!==s&&cr()!==s?e=function(e,t){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t]}}}(t,r):(Ce=e,e=s)):(Ce=e,e=s)),e}())===s&&(e=function(){var e,t,r;return e=Ce,qt()!==s&&lr()!==s&&ur()!==s&&lr()!==s&&(t=$e())!==s&&lr()!==s&&Ft()!==s&&lr()!==s&&(r=$e())!==s&&lr()!==s&&cr()!==s?e=function(e,t){return{type:"function",name:"position",args:{type:"expr_list",value:[e,t]}}}(t,r):(Ce=e,e=s),e}())===s&&(e=function(){var e,t,r;return e=Ce,(t=fr())!==s&&lr()!==s&&ur()!==s&&lr()!==s?((r=Ue())===s&&(r=null),r!==s&&lr()!==s&&cr()!==s?e=t=function(e,t){return{type:"function",name:e,args:t||{type:"expr_list",value:[]}}}(t,r):(Ce=e,e=s)):(Ce=e,e=s),e}())===s&&(e=function(){var e;return(e=function(){var e,t,r,n,i;if(e=Ce,rr()!==s)if(lr()!==s)if((t=$e())!==s)if(lr()!==s){for(r=[],n=vt();n!==s;)r.push(n),n=vt();r!==s&&(n=lr())!==s&&(i=nr())!==s?e=function(e,t){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:null}}(t,r):(Ce=e,e=s)}else Ce=e,e=s;else Ce=e,e=s;else Ce=e,e=s;else Ce=e,e=s;if(e===s)if(e=Ce,rr()!==s)if(lr()!==s)if((t=$e())!==s)if(lr()!==s){for(r=[],n=vt();n!==s;)r.push(n),n=vt();r!==s&&(n=lr())!==s&&(i=bt())!==s&&lr()!==s&&nr()!==s?e=function(e,t,r){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:r.value}}(t,r,i):(Ce=e,e=s)}else Ce=e,e=s;else Ce=e,e=s;else Ce=e,e=s;else Ce=e,e=s;return e}())===s&&(e=function(){var e,t,r,n;if(e=Ce,rr()!==s)if(lr()!==s){for(t=[],r=yt();r!==s;)t.push(r),r=yt();t!==s&&(r=lr())!==s&&(n=nr())!==s?e=function(e){return{type:"case_expression",format:"searched",clauses:e,else:null}}(t):(Ce=e,e=s)}else Ce=e,e=s;else Ce=e,e=s;if(e===s)if(e=Ce,rr()!==s)if(lr()!==s){for(t=[],r=yt();r!==s;)t.push(r),r=yt();t!==s&&(r=lr())!==s&&(n=bt())!==s&&lr()!==s&&nr()!==s?e=function(e,t){return{type:"case_expression",format:"searched",clauses:e,else:t.value}}(t,n):(Ce=e,e=s)}else Ce=e,e=s;else Ce=e,e=s;return e}()),e}())===s&&(e=function(){var e;return(e=function(){var e;return(e=function(){var e,t,r,n;if(e=Ce,(t=it())!==s){for(r=[],n=ot();n!==s;)r.push(n),n=ot();r!==s?e=t=w(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}())!==s&&(e=e),e}())!==s&&(e=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:e}}(e)),e}())===s&&(e=ut())===s&&(e=Ce,ur()!==s&&lr()!==s&&(t=$e())!==s&&lr()!==s&&cr()!==s?e=function(e){return e.paren=!0,e}(t):(Ce=e,e=s)),e}function st(){var e,t,r,n;if(e=Ce,(t=it())!==s){for(r=[],n=at();n!==s;)r.push(n),n=at();r!==s?e=t=w(t,r):(Ce=e,e=s)}else Ce=e,e=s;return e}function it(){var e;return I.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=s,0===Qe&&Ze(S)),e}function at(){var e;return N.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=s,0===Qe&&Ze(O)),e}function ot(){var e;return T.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=s,0===Qe&&Ze(M)),e}function ut(){var e,r,n;return e=Ce,64===t.charCodeAt(Ce)?(r="@",Ce++):(r=s,0===Qe&&Ze(F)),r!==s&&(n=st())!==s?e=r=[r,n]:(Ce=e,e=s),e!==s&&(e=function(e){return{type:"param",value:e[1]}}(e)),e}function ct(){var e;return(e=Jt())===s&&(e=Ut())===s&&(e=$t()),e}function lt(){var e,r,n,i;return e=Ce,Yt()!==s&&lr()!==s?(45===t.charCodeAt(Ce)?(r="-",Ce++):(r=s,0===Qe&&Ze(b)),r===s&&(43===t.charCodeAt(Ce)?(r="+",Ce++):(r=s,0===Qe&&Ze(v))),r!==s&&lr()!==s&&(n=mt())!==s&&lr()!==s&&(i=ht())!==s?e=function(e,t,r){return{type:"interval",value:t,qualifier:r,op:e}}(r,n,i):(Ce=e,e=s)):(Ce=e,e=s),e===s&&(e=Ce,Yt()!==s&&lr()!==s&&(r=mt())!==s&&lr()!==s&&(n=ht())!==s?e=function(e,t){return{type:"interval",value:e,qualifier:t,op:""}}(r,n):(Ce=e,e=s)),e}function ht(){var e,t,r;return e=Ce,(t=function(){var e,t,r;return e=Ce,(t=ft())!==s&&lr()!==s&&ur()!==s&&lr()!==s&&(r=pt())!==s&&lr()!==s&&cr()!==s?e=t=function(e,t){return{type:"interval-period",period:e.value,precision:t,secondary:null}}(t,r):(Ce=e,e=s),e===s&&(e=Ce,(t=ft())!==s&&(t=A(t)),e=t),e}())!==s&&lr()!==s&&Bt()!==s&&lr()!==s&&(r=function(){var e,t,r,n;return e=Ce,(t=ft())!==s&&(t=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}}(t)),(e=t)===s&&(e=Ce,(t=tr())!==s&&lr()!==s&&ur()!==s&&lr()!==s&&(r=pt())!==s&&lr()!==s&&or()!==s&&lr()!==s&&(n=dt())!==s&&lr()!==s&&cr()!==s?e=t=R(r,n):(Ce=e,e=s),e===s&&(e=Ce,(t=tr())!==s&&lr()!==s&&ur()!==s&&lr()!==s&&(r=pt())!==s&&lr()!==s&&cr()!==s?e=t=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}}(r):(Ce=e,e=s),e===s&&(e=Ce,(t=tr())!==s&&(t={type:"interval-period",period:"second",precision:null,secondary:null}),e=t))),e}())!==s?e=t=function(e,t){return{type:"interval-qualifier",start:e,end:t}}(t,r):(Ce=e,e=s),e===s&&(e=function(){var e,t,r,n;return e=Ce,(t=ft())!==s&&lr()!==s&&ur()!==s&&lr()!==s&&(r=dt())!==s&&lr()!==s&&cr()!==s?e=t=function(e,t){return{type:"interval-period",period:e.value,precision:t,secondary:null}}(t,r):(Ce=e,e=s),e===s&&(e=Ce,(t=ft())!==s&&(t=A(t)),(e=t)===s&&(e=Ce,(t=tr())!==s&&lr()!==s&&ur()!==s&&lr()!==s&&(r=pt())!==s&&lr()!==s&&or()!==s&&lr()!==s&&(n=dt())!==s&&lr()!==s&&cr()!==s?e=t=R(r,n):(Ce=e,e=s),e===s&&(e=Ce,(t=tr())!==s&&lr()!==s&&ur()!==s&&lr()!==s&&(r=dt())!==s&&lr()!==s&&cr()!==s?e=t=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}}(r):(Ce=e,e=s),e===s&&(e=Ce,(t=tr())!==s&&(t={type:"interval-period",period:"second",precision:null,secondary:null}),e=t)))),e}()),e}function ft(){var e,t;return e=Ce,(t=Xt())!==s&&(t={type:"string",value:"day"}),(e=t)===s&&(e=Ce,(t=Kt())!==s&&(t={type:"string",value:"hour"}),(e=t)===s&&(e=Ce,(t=er())!==s&&(t={type:"string",value:"minute"}),(e=t)===s&&(e=Ce,(t=Wt())!==s&&(t={type:"string",value:"month"}),(e=t)===s&&(e=Ce,(t=Ht())!==s&&(t={type:"string",value:"year"}),e=t)))),e}function dt(){var e;return(e=It())!==s&&(e=j(e)),e}function pt(){var e;return(e=It())!==s&&(e=j(e)),e}function mt(){var e;return(e=gt())===s&&(e=ut()),e}function gt(){var e,r,n,i,a;if(e=Ce,39===t.charCodeAt(Ce)?(r="'",Ce++):(r=s,0===Qe&&Ze(E)),r===s&&("N'"===t.substr(Ce,2)?(r="N'",Ce+=2):(r=s,0===Qe&&Ze(P))),r!==s){for(n=[],i=Ce,"''"===t.substr(Ce,2)?(a="''",Ce+=2):(a=s,0===Qe&&Ze(C)),a!==s&&(a="'"),(i=a)===s&&(G.test(t.charAt(Ce))?(i=t.charAt(Ce),Ce++):(i=s,0===Qe&&Ze(z)));i!==s;)n.push(i),i=Ce,"''"===t.substr(Ce,2)?(a="''",Ce+=2):(a=s,0===Qe&&Ze(C)),a!==s&&(a="'"),(i=a)===s&&(G.test(t.charAt(Ce))?(i=t.charAt(Ce),Ce++):(i=s,0===Qe&&Ze(z)));n!==s?(39===t.charCodeAt(Ce)?(i="'",Ce++):(i=s,0===Qe&&Ze(E)),i!==s?e=r=function(e){return{type:"string",value:e.join("")}}(n):(Ce=e,e=s)):(Ce=e,e=s)}else Ce=e,e=s;return e}function yt(){var e,t,r;return e=Ce,sr()!==s&&lr()!==s&&(t=$e())!==s&&lr()!==s&&ir()!==s&&lr()!==s&&(r=$e())!==s?e=L(t,r):(Ce=e,e=s),e}function vt(){var e,t,r;return e=Ce,sr()!==s&&lr()!==s&&(t=$e())!==s&&lr()!==s&&ir()!==s&&lr()!==s&&(r=$e())!==s?e=L(t,r):(Ce=e,e=s),e}function bt(){var e,t;return e=Ce,ar()!==s&&lr()!==s&&(t=$e())!==s?e=function(e){return{type:"else_clause",value:e}}(t):(Ce=e,e=s),e}function xt(){var e,r,n;return(e=It())===s&&(e=Ce,45===t.charCodeAt(Ce)?(r="-",Ce++):(r=s,0===Qe&&Ze(b)),r===s&&(43===t.charCodeAt(Ce)?(r="+",Ce++):(r=s,0===Qe&&Ze(v))),r!==s&&(n=It())!==s?e=r=function(e,t){return e[0]+t}(r,n):(Ce=e,e=s)),e}function _t(){var e,r,n;return e=Ce,46===t.charCodeAt(Ce)?(r=".",Ce++):(r=s,0===Qe&&Ze(Q)),r!==s?((n=It())===s&&(n=null),n!==s?e=r=function(e){return"."+(null!=e?e:"")}(n):(Ce=e,e=s)):(Ce=e,e=s),e}function wt(){var e,t,r;return e=Ce,(t=Nt())!==s&&(r=It())!==s?e=t=function(e,t){return e+t}(t,r):(Ce=e,e=s),e}function It(){var e,t;if(e=[],(t=St())!==s)for(;t!==s;)e.push(t),t=St();else e=s;return e!==s&&(e=function(e){return e.join("")}(e)),e}function St(){var e;return D.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=s,0===Qe&&Ze(k)),e}function Nt(){var e,r,n;return e=Ce,q.test(t.charAt(Ce))?(r=t.charAt(Ce),Ce++):(r=s,0===Qe&&Ze(V)),r!==s?(Z.test(t.charAt(Ce))?(n=t.charAt(Ce),Ce++):(n=s,0===Qe&&Ze(J)),n===s&&(n=null),n!==s?e=r=function(e,t){return"e"+(null===t?"":t)}(0,n):(Ce=e,e=s)):(Ce=e,e=s),e}function Ot(){var e,r,n,i;return e=Ce,"null"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze(U)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r=[r,n]:(Ce=e,e=s)):(Ce=e,e=s),e}function Tt(){var e,r,n,i;return e=Ce,"true"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze($)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r=[r,n]:(Ce=e,e=s)):(Ce=e,e=s),e}function Mt(){var e,r,n,i;return e=Ce,"false"===t.substr(Ce,5).toLowerCase()?(r=t.substr(Ce,5),Ce+=5):(r=s,0===Qe&&Ze(B)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r=[r,n]:(Ce=e,e=s)):(Ce=e,e=s),e}function Ft(){var e,r,n,i;return e=Ce,"in"===t.substr(Ce,2).toLowerCase()?(r=t.substr(Ce,2),Ce+=2):(r=s,0===Qe&&Ze(Y)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="IN":(Ce=e,e=s)):(Ce=e,e=s),e}function At(){var e,r,n,i;return e=Ce,"is"===t.substr(Ce,2).toLowerCase()?(r=t.substr(Ce,2),Ce+=2):(r=s,0===Qe&&Ze(H)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="IS":(Ce=e,e=s)):(Ce=e,e=s),e}function Rt(){var e,r,n,i;return e=Ce,"like"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze(W)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="LIKE":(Ce=e,e=s)):(Ce=e,e=s),e}function jt(){var e,r,n,i;return e=Ce,"escape"===t.substr(Ce,6).toLowerCase()?(r=t.substr(Ce,6),Ce+=6):(r=s,0===Qe&&Ze(X)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="ESCAPE":(Ce=e,e=s)):(Ce=e,e=s),e}function Et(){var e,r,n,i;return e=Ce,"not"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=s,0===Qe&&Ze(K)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="NOT":(Ce=e,e=s)):(Ce=e,e=s),e}function Pt(){var e,r,n,i;return e=Ce,"and"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=s,0===Qe&&Ze(ee)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="AND":(Ce=e,e=s)):(Ce=e,e=s),e}function Ct(){var e,r,n,i;return e=Ce,"or"===t.substr(Ce,2).toLowerCase()?(r=t.substr(Ce,2),Ce+=2):(r=s,0===Qe&&Ze(te)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="OR":(Ce=e,e=s)):(Ce=e,e=s),e}function Gt(){var e,r,n,i;return e=Ce,"between"===t.substr(Ce,7).toLowerCase()?(r=t.substr(Ce,7),Ce+=7):(r=s,0===Qe&&Ze(re)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="BETWEEN":(Ce=e,e=s)):(Ce=e,e=s),e}function zt(){var e,r,n,i;return e=Ce,"from"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze(ne)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="FROM":(Ce=e,e=s)):(Ce=e,e=s),e}function Lt(){var e,r,n,i;return e=Ce,"for"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=s,0===Qe&&Ze(se)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="FOR":(Ce=e,e=s)):(Ce=e,e=s),e}function Qt(){var e,r,n,i;return e=Ce,"substring"===t.substr(Ce,9).toLowerCase()?(r=t.substr(Ce,9),Ce+=9):(r=s,0===Qe&&Ze(ie)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="SUBSTRING":(Ce=e,e=s)):(Ce=e,e=s),e}function Dt(){var e,r,n,i;return e=Ce,"extract"===t.substr(Ce,7).toLowerCase()?(r=t.substr(Ce,7),Ce+=7):(r=s,0===Qe&&Ze(ae)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="EXTRACT":(Ce=e,e=s)):(Ce=e,e=s),e}function kt(){var e,r,n,i;return e=Ce,"trim"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze(oe)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="TRIM":(Ce=e,e=s)):(Ce=e,e=s),e}function qt(){var e,r,n,i;return e=Ce,"position"===t.substr(Ce,8).toLowerCase()?(r=t.substr(Ce,8),Ce+=8):(r=s,0===Qe&&Ze(ue)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="POSITION":(Ce=e,e=s)):(Ce=e,e=s),e}function Vt(){var e,r,n,i;return e=Ce,"timestamp"===t.substr(Ce,9).toLowerCase()?(r=t.substr(Ce,9),Ce+=9):(r=s,0===Qe&&Ze(ce)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="TIMESTAMP":(Ce=e,e=s)):(Ce=e,e=s),e}function Zt(){var e,r,n,i;return e=Ce,"date"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze(le)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="DATE":(Ce=e,e=s)):(Ce=e,e=s),e}function Jt(){var e,r,n,i;return e=Ce,"leading"===t.substr(Ce,7).toLowerCase()?(r=t.substr(Ce,7),Ce+=7):(r=s,0===Qe&&Ze(he)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="LEADING":(Ce=e,e=s)):(Ce=e,e=s),e}function Ut(){var e,r,n,i;return e=Ce,"trailing"===t.substr(Ce,8).toLowerCase()?(r=t.substr(Ce,8),Ce+=8):(r=s,0===Qe&&Ze(fe)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="TRAILING":(Ce=e,e=s)):(Ce=e,e=s),e}function $t(){var e,r,n,i;return e=Ce,"both"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze(de)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="BOTH":(Ce=e,e=s)):(Ce=e,e=s),e}function Bt(){var e,r,n,i;return e=Ce,"to"===t.substr(Ce,2).toLowerCase()?(r=t.substr(Ce,2),Ce+=2):(r=s,0===Qe&&Ze(pe)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="TO":(Ce=e,e=s)):(Ce=e,e=s),e}function Yt(){var e,r,n,i;return e=Ce,"interval"===t.substr(Ce,8).toLowerCase()?(r=t.substr(Ce,8),Ce+=8):(r=s,0===Qe&&Ze(me)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="INTERVAL":(Ce=e,e=s)):(Ce=e,e=s),e}function Ht(){var e,r,n,i;return e=Ce,"year"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze(ge)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="YEAR":(Ce=e,e=s)):(Ce=e,e=s),e}function Wt(){var e,r,n,i;return e=Ce,"month"===t.substr(Ce,5).toLowerCase()?(r=t.substr(Ce,5),Ce+=5):(r=s,0===Qe&&Ze(ye)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="MONTH":(Ce=e,e=s)):(Ce=e,e=s),e}function Xt(){var e,r,n,i;return e=Ce,"day"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=s,0===Qe&&Ze(ve)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="DAY":(Ce=e,e=s)):(Ce=e,e=s),e}function Kt(){var e,r,n,i;return e=Ce,"hour"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze(be)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="HOUR":(Ce=e,e=s)):(Ce=e,e=s),e}function er(){var e,r,n,i;return e=Ce,"minute"===t.substr(Ce,6).toLowerCase()?(r=t.substr(Ce,6),Ce+=6):(r=s,0===Qe&&Ze(xe)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="MINUTE":(Ce=e,e=s)):(Ce=e,e=s),e}function tr(){var e,r,n,i;return e=Ce,"second"===t.substr(Ce,6).toLowerCase()?(r=t.substr(Ce,6),Ce+=6):(r=s,0===Qe&&Ze(_e)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="SECOND":(Ce=e,e=s)):(Ce=e,e=s),e}function rr(){var e,r,n,i;return e=Ce,"case"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze(we)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="CASE":(Ce=e,e=s)):(Ce=e,e=s),e}function nr(){var e,r,n,i;return e=Ce,"end"===t.substr(Ce,3).toLowerCase()?(r=t.substr(Ce,3),Ce+=3):(r=s,0===Qe&&Ze(Ie)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="END":(Ce=e,e=s)):(Ce=e,e=s),e}function sr(){var e,r,n,i;return e=Ce,"when"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze(Se)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="WHEN":(Ce=e,e=s)):(Ce=e,e=s),e}function ir(){var e,r,n,i;return e=Ce,"then"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze(Ne)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="THEN":(Ce=e,e=s)):(Ce=e,e=s),e}function ar(){var e,r,n,i;return e=Ce,"else"===t.substr(Ce,4).toLowerCase()?(r=t.substr(Ce,4),Ce+=4):(r=s,0===Qe&&Ze(Oe)),r!==s?(n=Ce,Qe++,i=at(),Qe--,i===s?n=void 0:(Ce=n,n=s),n!==s?e=r="ELSE":(Ce=e,e=s)):(Ce=e,e=s),e}function or(){var e;return 44===t.charCodeAt(Ce)?(e=",",Ce++):(e=s,0===Qe&&Ze(Te)),e}function ur(){var e;return 40===t.charCodeAt(Ce)?(e="(",Ce++):(e=s,0===Qe&&Ze(Me)),e}function cr(){var e;return 41===t.charCodeAt(Ce)?(e=")",Ce++):(e=s,0===Qe&&Ze(Fe)),e}function lr(){var e,t;for(e=[],t=hr();t!==s;)e.push(t),t=hr();return e}function hr(){var e;return Ae.test(t.charAt(Ce))?(e=t.charAt(Ce),Ce++):(e=s,0===Qe&&Ze(Re)),e}function fr(){var e,r,n,i;if(e=Ce,(r=st())!==s&&(r=r),(e=r)===s)if(e=Ce,96===t.charCodeAt(Ce)?(r="`",Ce++):(r=s,0===Qe&&Ze(je)),r!==s){if(n=[],Ee.test(t.charAt(Ce))?(i=t.charAt(Ce),Ce++):(i=s,0===Qe&&Ze(Pe)),i!==s)for(;i!==s;)n.push(i),Ee.test(t.charAt(Ce))?(i=t.charAt(Ce),Ce++):(i=s,0===Qe&&Ze(Pe));else n=s;n!==s?(96===t.charCodeAt(Ce)?(i="`",Ce++):(i=s,0===Qe&&Ze(je)),i!==s?e=r=function(e){return e.join("")}(n):(Ce=e,e=s)):(Ce=e,e=s)}else Ce=e,e=s;return e}function dr(e,t,r,n){var s={type:"binary_expr",operator:e,left:t,right:r};return void 0!==n&&(s.escape=n),s}function pr(e,t){for(var r=e,n=0;n<t.length;n++)r=dr(t[n][1],r,t[n][3]);return r}if((n=a())!==s&&Ce===t.length)return n;throw n!==s&&Ce<t.length&&Ze({type:"end"}),function(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}(Le,ze<t.length?t.charAt(ze):null,ze<t.length?Ve(ze,ze+1):Ve(ze,ze))}}},e.exports&&(e.exports=t())}));const d=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,p=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,m=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,g=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,y=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function v(e,t){return(e+="").length>=t?e:new Array(t-e.length+1).join("0")+e}function b(e,t,r="0",n="0",s="0",i="0",a="",o="0",u="0"){if("+"===a||"-"===a){const c=`${v(parseInt(e,10),4)}-${v(parseInt(t,10),2)}-${v(parseInt(r,10),2)}`;let l="";parseFloat(i)<10&&(l="0");const h=`${v(parseInt(n,10),2)}:${v(parseInt(s,10),2)}:${l+parseFloat(i).toString()}`,f=`${a}${v(parseInt(o,10),2)}:${v(parseInt(u,10),2)}`;return new Date(c+"T"+h+f)}return new Date(parseInt(e,10),parseInt(t,10)-1,parseInt(r,10),parseInt(n,10),parseInt(s,10),parseFloat(i))}class x{static makeBool(e){return S(e)}static featureValue(e,t,r,n){return C(e,t,r,n)}static equalsNull(e){return null===e}static applyLike(e,t,r){return A(e,t,r)}static ensureArray(e){return N(e)}static applyIn(e,t){return F(e,t)}static currentDate(){const e=new Date;return e.setHours(0,0,0,0),e}static makeSqlInterval(e,t,r){return u.createFromValueAndQualifer(e,t,r)}static convertInterval(e){return e instanceof u?e.valueInMilliseconds():e}static currentTimestamp(){return new Date}static compare(e,t,r){return j(e,t,r)}static calculate(e,t,r){return P(e,t,r)}static makeComparable(e){return R(e)}static evaluateFunction(e,t){return c(e,t)}static lookup(e,t){const r=t[e];return void 0===r?null:r}static between(e,t){return null==e||null==t[0]||null==t[1]?null:e>=t[0]&&e<=t[1]}static notbetween(e,t){return null==e||null==t[0]||null==t[1]?null:e<t[0]||e>t[1]}static ternaryNot(e){return O(e)}static ternaryAnd(e,t){return T(e,t)}static ternaryOr(e,t){return M(e,t)}}class _{constructor(e,t){this.fieldsIndex=t,this.datefields={},this.parameters={},this.parseTree=class{static parse(e){return f.parse(e)}}.parse(e);const{isStandardized:r,isAggregate:n,referencedFieldNames:s}=this.extractExpressionInfo(t);this.referencedFieldNames=s,this.isStandardized=r,this.isAggregate=n}static create(e,t){return new _(e,t)}get fieldNames(){return this.referencedFieldNames}testSet(e,t=G){const r={};for(const n of this.fieldNames)r[n]=e.map(e=>t.getAttribute(e,n));return!!this.evaluateNode(this.parseTree,{attributes:r},G)}calculateValue(e,t=G){const r=this.evaluateNode(this.parseTree,e,t);return r instanceof u?r.valueInMilliseconds()/864e5:r}calculateValueCompiled(e,t=G){return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(e,this.parameters,t,this.datefields):Object(n.a)("csp-restrictions")?this.calculateValue(e,t):(this.compileMe(),this.parseTree._compiledVersion(e,this.parameters,t,this.datefields))}testFeature(e,t=G){return!!this.evaluateNode(this.parseTree,e,t)}testFeatureCompiled(e,t=G){return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(e,this.parameters,t,this.datefields):Object(n.a)("csp-restrictions")?this.testFeature(e,t):(this.compileMe(),!!this.parseTree._compiledVersion(e,this.parameters,t,this.datefields))}getFunctions(){const e=[];return this.visitAll(this.parseTree,t=>{"function"===t.type&&e.push(t.name.toLowerCase())}),E(e)}getExpressions(){const e=new Map;return this.visitAll(this.parseTree,t=>{if("function"===t.type){const r=t.name.toLowerCase(),n=t.args.value[0];if("column_ref"===n.type){const t=n.column,s=`${r}-${t}`;e.has(s)||e.set(s,{aggregateType:r,field:t})}}}),[...e.values()]}getVariables(){const e=[];return this.visitAll(this.parseTree,t=>{"param"===t.type&&e.push(t.value.toLowerCase())}),E(e)}compileMe(){const e="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","datefields",e).bind(x)}extractExpressionInfo(e){const t=[];let r=!0,n=!0;return this.visitAll(this.parseTree,i=>{switch(i.type){case"column_ref":{const r=e.get(i.column),n=r&&r.name;!r||"date"!==r.type&&"esriFieldTypeDate"!==r.type||(this.datefields[r.name]=1),void 0!==n?(t.push(n),i.column=n):t.push(i.column);break}case"function":{const{name:e,args:t}=i,a=t.value.length;r&&(r=function(e,t){const r=l[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}(e,a)),n&&(n=function(e,t){const r=s[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}(e,a));break}}}),{referencedFieldNames:E(t),isStandardized:r,isAggregate:n}}visitAll(e,t){if(null!=e)switch(t(e),e.type){case"when_clause":this.visitAll(e.operand,t),this.visitAll(e.value,t);break;case"case_expression":for(const r of e.clauses)this.visitAll(r,t);"simple"===e.format&&this.visitAll(e.operand,t),null!==e.else&&this.visitAll(e.else,t);break;case"expr_list":for(const r of e.value)this.visitAll(r,t);break;case"unary_expr":this.visitAll(e.expr,t);break;case"binary_expr":this.visitAll(e.left,t),this.visitAll(e.right,t);break;case"function":this.visitAll(e.args,t)}}evaluateNodeToJavaScript(e){switch(e.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(e.value)+", "+JSON.stringify(e.qualifier)+","+JSON.stringify(e.op)+")";case"case_expression":{let t="";if("simple"===e.format){const r="this.makeComparable("+this.evaluateNodeToJavaScript(e.operand)+")";t="( ";for(let n=0;n<e.clauses.length;n++)t+=" ("+r+" === this.makeComparable("+this.evaluateNodeToJavaScript(e.clauses[n].operand)+")) ? ("+this.evaluateNodeToJavaScript(e.clauses[n].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}else{t="( ";for(let r=0;r<e.clauses.length;r++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(e.clauses[r].operand)+")===true ? ("+this.evaluateNodeToJavaScript(e.clauses[r].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}return t}case"param":return"this.lookup("+JSON.stringify(e.value.toLowerCase())+",lookups)";case"expr_list":{let t="[";for(const r of e.value)"["!==t&&(t+=","),t+=this.evaluateNodeToJavaScript(r);return t+="]",t}case"unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(e.expr)+")";case"binary_expr":switch(e.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")";case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"*":case"-":case"+":case"/":return"this.calculate("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")"}throw new Error("Not Supported Operator "+e.operator);case"null":case"bool":case"string":case"number":return JSON.stringify(e.value);case"date":return"(new Date("+I(e.value).getTime().toString()+"))";case"timestamp":return"(new Date("+w(e.value).getTime().toString()+"))";case"current_time":return"date"===e.mode?"this.currentDate()":"this.currentTimestamp()";case"column_ref":return"this.featureValue(feature,"+JSON.stringify(e.column)+",datefields,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(e.name)+","+this.evaluateNodeToJavaScript(e.args)+")"}throw new Error("Unsupported sql syntax "+e.type)}evaluateNode(e,t,r){switch(e.type){case"interval":{const n=this.evaluateNode(e.value,t,r);return u.createFromValueAndQualifer(n,e.qualifier,e.op)}case"case_expression":if("simple"===e.format){const n=R(this.evaluateNode(e.operand,t,r));for(let s=0;s<e.clauses.length;s++)if(n===R(this.evaluateNode(e.clauses[s].operand,t,r)))return this.evaluateNode(e.clauses[s].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}else{for(let n=0;n<e.clauses.length;n++)if(S(this.evaluateNode(e.clauses[n].operand,t,r)))return this.evaluateNode(e.clauses[n].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}return null;case"param":return this.parameters[e.value.toLowerCase()];case"expr_list":{const n=[];for(const s of e.value)n.push(this.evaluateNode(s,t,r));return n}case"unary_expr":return O(this.evaluateNode(e.expr,t,r));case"binary_expr":switch(e.operator){case"AND":return T(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"OR":return M(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null===this.evaluateNode(e.left,t,r);case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null!==this.evaluateNode(e.left,t,r);case"IN":{const n=N(this.evaluateNode(e.right,t,r));return F(this.evaluateNode(e.left,t,r),n)}case"NOT IN":{const n=N(this.evaluateNode(e.right,t,r));return O(F(this.evaluateNode(e.left,t,r),n))}case"BETWEEN":{const n=this.evaluateNode(e.left,t,r),s=this.evaluateNode(e.right,t,r);return null==n||null==s[0]||null==s[1]?null:n>=R(s[0])&&n<=R(s[1])}case"NOTBETWEEN":{const n=this.evaluateNode(e.left,t,r),s=this.evaluateNode(e.right,t,r);return null==n||null==s[0]||null==s[1]?null:n<R(s[0])||n>R(s[1])}case"LIKE":return A(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape);case"NOT LIKE":return O(A(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return j(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"-":case"+":case"*":case"/":return P(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r))}case"null":case"bool":case"string":case"number":return e.value;case"date":return I(e.value);case"timestamp":return w(e.value);case"current_time":{const t=new Date;return"date"===e.mode&&t.setHours(0,0,0,0),t}case"column_ref":return C(t,e.column,this.datefields,r);case"function":{const n=this.evaluateNode(e.args,t,r);return this.isAggregate?function(e,t){const r=s[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)}(e.name,n):c(e.name,n)}}throw new Error("Unsupported sql syntax "+e.type)}}function w(e){let t=p.exec(e);if(null!==t){const[,e,r,n,s,i,a]=t;return b(e,r,n,s,i,a)}if(t=m.exec(e),null!==t){const[,e,r,n,s,i,a,o,u,c]=t;return b(e,r,n,s,i,a,o,u,c)}if(t=g.exec(e),null!==t){const[,e,r,n,s,i,a,o,u]=t;return b(e,r,n,s,i,"0",a,o,u)}if(t=y.exec(e),null!==t){const[,e,r,n,s,i]=t;return b(e,r,n,s,i)}if(t=d.exec(e),null!==t){const[,e,r,n]=t;return b(e,r,n)}throw new Error("SQL Invalid Timestamp")}function I(e){const t=d.exec(e);if(null===t)throw new Error("SQL Invalid Date");const[,r,n,s]=t;return new Date(parseInt(r,10),parseInt(n,10)-1,parseInt(s,10))}function S(e){return!0===e}function N(e){return Array.isArray(e)?e:[e]}function O(e){return null!==e?!0!==e:null}function T(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function M(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function F(e,t){if(null==e)return null;let r=!1;for(const n of t)if(null==n)r=null;else if(e===n){r=!0;break}return r}function A(e,t,r){if(null==e)return null;const n=t,s=r;let i="";const a="-[]/{}()*+?.\\^$|";let o=0;for(let e=0;e<n.length;e++){const t=n.charAt(e);switch(o){case 0:t===s?o=1:a.indexOf(t)>=0?i+="\\"+t:i+="%"===t?".*":"_"===t?".":t;break;case 1:a.indexOf(t)>=0?i+="\\"+t:i+=t,o=0}}return new RegExp("^"+i+"$").test(e)}function R(e){return e instanceof Date?e.valueOf():e}function j(e,t,r){if(null==t||null==r)return null;const n=R(t),s=R(r);switch(e){case"<>":return n!==s;case"=":return n===s;case">":return n>s;case"<":return n<s;case">=":return n>=s;case"<=":return n<=s}}function E(e){const t=[],r={};for(const n of e){const e=n.toLowerCase();void 0===r[e]&&(t.push(n),r[e]=1)}return t}function P(e,t,r){if(t instanceof u)if(r instanceof Date)switch(e){case"+":return new Date(t.valueInMilliseconds()+r.getTime());case"-":return t.valueInMilliseconds()-r.getTime();case"*":return t.valueInMilliseconds()*r.getTime();case"/":return t.valueInMilliseconds()/r.getTime()}else if(r instanceof u)switch(e){case"+":return u.createFromMilliseconds(t.valueInMilliseconds()+r.valueInMilliseconds());case"-":return u.createFromMilliseconds(t.valueInMilliseconds()-r.valueInMilliseconds());case"*":return t.valueInMilliseconds()*r.valueInMilliseconds();case"/":return t.valueInMilliseconds()/r.valueInMilliseconds()}else t=t.valueInMilliseconds();else if(r instanceof u)if(t instanceof Date)switch(e){case"+":return new Date(r.valueInMilliseconds()+t.getTime());case"-":return new Date(t.getTime()-r.valueInMilliseconds());case"*":return t.getTime()*r.valueInMilliseconds();case"/":return t.getTime()/r.valueInMilliseconds()}else r=r.valueInMilliseconds();else if(t instanceof Date&&"number"==typeof r)switch(r=24*r*60*60*1e3,t=t.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}else if(r instanceof Date&&"number"==typeof t)switch(t=24*t*60*60*1e3,r=r.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r}}function C(e,t,r,n){const s=n.getAttribute(e,t);return null!=s&&1===r[t]?new Date(s):s}const G={getAttribute:(e,t)=>(function(e){return e&&"object"==typeof e.attributes}(e)?e.attributes:e)[t]}},138:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return n}));"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e||"undefined"!=typeof self&&self;function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function s(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return i(null==t&&r.path)}},r.exports),r.exports}function i(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}}).call(this,r(51))},140:function(e,t,r){"use strict";class n{constructor(e=[],t=[],r=!1){this.lengths=null!=e?e:[],this.coords=null!=t?t:[],this.hasIndeterminateRingOrder=r}get isPoint(){return 0===this.lengths.length}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let r=0;r<this.lengths.length;r++){const n=this.lengths[r];for(let r=0;r<n;r++)e(this.coords[2*(r+t)],this.coords[2*(r+t)+1]);t+=n}}clone(){return new n(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}t.a=n},144:function(e,t,r){"use strict";function n(e){return"date"===e.type||"esriFieldTypeDate"===e.type}function s(e){return e.toLowerCase().trim()}t.a=class{constructor(e){if(this.fields=e,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],!e)return;const t=[];for(const r of e){const e=r&&r.name;if(e){const i=s(e);this._fieldsMap.set(e,r),this._fieldsMap.set(i,r),t.push(i),n(r)&&(this.dateFields.push(r),this._dateFieldsSet.add(r))}}t.sort(),this.uid=t.join(",")}destroy(){this._fieldsMap.clear()}has(e){return null!=this.get(e)}get(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(s(e)):void 0}isDateField(e){return this._dateFieldsSet.has(this.get(e))}normalizeFieldName(e){const t=this.get(e);if(t)return t.name}}},192:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return a}));var n=r(59);function s(e){return"point"===e||"multipoint"===e||"polyline"===e||"polygon"===e}const i=Object(n.b)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),a=Object(n.b)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"})},193:function(e,t,r){"use strict";class n{constructor(e=null,t={},r,n){this.displayId=0,this.geohashX=0,this.geohashY=0,this.geometry=e,t&&(this.attributes=t),r&&(this.centroid=r),null!=n&&(this.objectId=n)}get hasGeometry(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)}weakClone(){const e=new n(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}t.a=n},194:function(e,t,r){"use strict";r.d(t,"a",(function(){return x})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return g})),r.d(t,"d",(function(){return b})),r.d(t,"e",(function(){return a})),r.d(t,"f",(function(){return u})),r.d(t,"g",(function(){return o})),r.d(t,"h",(function(){return y})),r.d(t,"i",(function(){return i})),r.d(t,"j",(function(){return m})),r.d(t,"k",(function(){return p})),r.d(t,"l",(function(){return d})),r.d(t,"m",(function(){return f}));var n=r(0);r(61),r(110);function s(e=_){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function i(e,t,r,n,i,a,o=s()){return o[0]=e,o[1]=t,o[2]=r,o[3]=n,o[4]=i,o[5]=a,o}function a(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function o(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function u(e,t,r){const n=t.length;let s=e[0],i=e[1],a=e[2],o=e[3],u=e[4],c=e[5];if(r)for(let e=0;e<n;e++){const r=t[e];s=Math.min(s,r[0]),i=Math.min(i,r[1]),a=Math.min(a,r[2]),o=Math.max(o,r[0]),u=Math.max(u,r[1]),c=Math.max(c,r[2])}else for(let e=0;e<n;e++){const r=t[e];s=Math.min(s,r[0]),i=Math.min(i,r[1]),o=Math.max(o,r[0]),u=Math.max(u,r[1])}e[0]=s,e[1]=i,e[2]=a,e[3]=o,e[4]=u,e[5]=c}function c(e){return e[0]>=e[3]?0:e[3]-e[0]}function l(e){return e[1]>=e[4]?0:e[4]-e[1]}function h(e){return e[2]>=e[5]?0:e[5]-e[2]}function f(e,t=[0,0,0]){return t[0]=c(e),t[1]=l(e),t[2]=h(e),t}function d(e,t,r=e){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r}function p(e,t,r=e){return r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e}function m(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function g(e){return e?m(e,x):s(x)}function y(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function v(e){return 6===e.length}function b(e,t,r){if(Object(n.g)(e)||Object(n.g)(t))return e===t;if(!v(e)||!v(t))return!1;if(r){for(let n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}const x=[1/0,1/0,1/0,-1/0,-1/0,-1/0],_=[0,0,0,0,0,0];s()},209:function(e,t,r){"use strict";r.d(t,"a",(function(){return _})),r.d(t,"b",(function(){return w}));var n=r(19),s=r(0),i=r(2),a=r(16),o=r(83),u=r(143),c=r(115),l=r(104),h=r(490),f=r(21),d=r(64),p=(r(63),r(54));async function m(e,t,r){const n="string"==typeof e?Object(f.I)(e):e,s=t[0].spatialReference,i=Object(d.c)(t[0]),a={...r,query:{...n.query,f:"json",sr:s.wkid?s.wkid:JSON.stringify(s),geometries:JSON.stringify((o=t,{geometryType:Object(d.c)(o[0]),geometries:o.map(e=>e.toJSON())}))}};var o;return function(e,t,r){const n=Object(d.b)(t);return e.map(e=>{const t=n.fromJSON(e);return t.spatialReference=r,t})}((await Object(p.default)(n.path+"/simplify",a)).data,i,s)}const g=i.a.getLogger("esri.geometry.support.normalizeUtils");function y(e){return"polygon"===e[0].type}function v(e){return"polyline"===e[0].type}function b(e,t,r){if(t){const t=function(e,t){if(!(e instanceof l.a||e instanceof c.a)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw g.error(e),new a.a(e)}const r=Object(h.b)(e),n=[];for(const e of r){const r=[];n.push(r),r.push([e[0][0],e[0][1]]);for(let n=0;n<e.length-1;n++){const s=e[n][0],i=e[n][1],a=e[n+1][0],o=e[n+1][1],u=Math.sqrt((a-s)*(a-s)+(o-i)*(o-i)),c=(o-i)/u,l=(a-s)/u,h=u/t;if(h>1){for(let e=1;e<=h-1;e++){const n=e*t,a=l*n+s,o=c*n+i;r.push([a,o])}const e=(u+Math.floor(h-1)*t)/2,n=l*e+s,a=c*e+i;r.push([n,a])}r.push([a,o])}}return function(e){return"polygon"===e.type}(e)?new c.a({rings:n,spatialReference:e.spatialReference}):new l.a({paths:n,spatialReference:e.spatialReference})}(e,1e6);e=Object(u.e)(t,!0)}return r&&(e=Object(h.e)(e,r)),e}function x(e,t,r){if(Array.isArray(e)){const n=e[0];if(n>t){const r=Object(h.d)(n,t);e[0]=n+r*(-2*t)}else if(n<r){const t=Object(h.d)(n,r);e[0]=n+t*(-2*r)}}else{const n=e.x;if(n>t){const r=Object(h.d)(n,t);e=e.clone().offset(r*(-2*t),0)}else if(n<r){const t=Object(h.d)(n,r);e=e.clone().offset(t*(-2*r),0)}}return e}async function _(e,t,r){if(!Array.isArray(e))return _([e],t);const i=t?t.url:n.a.geometryServiceUrl;let a,g,w,I,S,N,O,T,M=0;const F=[],A=[];for(const t of e)if(Object(s.g)(t))A.push(t);else if(a||(a=t.spatialReference,g=Object(o.d)(a),w=a.isWebMercator,N=w?102100:4326,I=h.a[N].maxX,S=h.a[N].minX,O=h.a[N].plus180Line,T=h.a[N].minus180Line),g)if("mesh"===t.type)A.push(t);else if("point"===t.type)A.push(x(t.clone(),I,S));else if("multipoint"===t.type){const e=t.clone();e.points=e.points.map(e=>x(e,I,S)),A.push(e)}else if("extent"===t.type){const e=t.clone()._normalize(!1,!1,g);A.push(e.rings?new c.a(e):e)}else if(t.extent){const e=t.extent,r=Object(h.d)(e.xmin,S)*(2*I);let n=0===r?t.clone():Object(h.e)(t.clone(),r);e.offset(r,0),e.intersects(O)&&e.xmax!==I?(M=e.xmax>M?e.xmax:M,n=b(n,w),F.push(n),A.push("cut")):e.intersects(T)&&e.xmin!==S?(M=e.xmax*(2*I)>M?e.xmax*(2*I):M,n=b(n,w,360),F.push(n),A.push("cut")):A.push(n)}else A.push(t.clone());else A.push(t);let R=Object(h.d)(M,I),j=-90;const E=R,P=new l.a;for(;R>0;){const e=360*R-180;P.addPath([[e,j],[e,-1*j]]),j*=-1,R--}if(F.length>0&&E>0){const t=function(e,t){let r=-1;for(let n=0;n<t.cutIndexes.length;n++){const s=t.cutIndexes[n],i=t.geometries[n],a=Object(h.b)(i);for(let e=0;e<a.length;e++){const t=a[e];t.some(r=>{if(r[0]<180)return!0;{let r=0;for(let e=0;e<t.length;e++){const n=t[e][0];r=n>r?n:r}r=Number(r.toFixed(9));const n=-360*Object(h.d)(r,180);for(let r=0;r<t.length;r++){const t=i.getPoint(e,r);i.setPoint(e,r,t.clone().offset(n,0))}return!0}})}if(s===r){if(y(e))for(const t of Object(h.b)(i))e[s]=e[s].addRing(t);else if(v(e))for(const t of Object(h.b)(i))e[s]=e[s].addPath(t)}else r=s,e[s]=i}return e}(F,await async function(e,t,r,n){const s="string"==typeof e?Object(f.I)(e):e,i=t[0].spatialReference,a={...n,query:{...s.query,f:"json",sr:JSON.stringify(i),target:JSON.stringify({geometryType:Object(d.c)(t[0]),geometries:t}),cutter:JSON.stringify(r)}},o=await Object(p.default)(s.path+"/cut",a),{cutIndexes:u,geometries:c=[]}=o.data;return{cutIndexes:u,geometries:c.map(e=>{const t=Object(d.a)(e);return t.spatialReference=i,t})}}(i,F,P,r)),n=[],a=[];for(let r=0;r<A.length;r++){const i=A[r];if("cut"!==i)a.push(i);else{const i=t.shift(),o=e[r];Object(s.h)(o)&&"polygon"===o.type&&o.rings&&o.rings.length>1&&i.rings.length>=o.rings.length?(n.push(i),a.push("simplify")):a.push(w?Object(u.b)(i):i)}}if(!n.length)return a;const o=await m(i,n,r),c=[];for(let e=0;e<a.length;e++){const t=a[e];"simplify"!==t?c.push(t):c.push(w?Object(u.b)(o.shift()):o.shift())}return c}const C=[];for(let e=0;e<A.length;e++){const t=A[e];if("cut"!==t)C.push(t);else{const e=F.shift();C.push(!0===w?Object(u.b)(e):e)}}return Promise.resolve(C)}function w(e,t){const r=Object(o.d)(t);if(r){const[t,n]=r.valid,s=n-t;if(e<t)for(;e<t;)e+=s;if(e>n)for(;e>n;)e-=s}return e}},248:function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return g}));var n=r(83),s=r(143),i=r(289),a=r(291);const o=[0,0];function u(e,t){if(!t)return null;if("x"in t){const r={x:0,y:0};return[r.x,r.y]=e(t.x,t.y,o),null!=t.z&&(r.z=t.z),null!=t.m&&(r.m=t.m),r}if("xmin"in t){const r={xmin:0,ymin:0,xmax:0,ymax:0};return[r.xmin,r.ymin]=e(t.xmin,t.ymin,o),[r.xmax,r.ymax]=e(t.xmax,t.ymax,o),t.hasZ&&(r.zmin=t.zmin,r.zmax=t.zmax,r.hasZ=!0),t.hasM&&(r.mmin=t.mmin,r.mmax=t.mmax,r.hasM=!0),r}return"rings"in t?{rings:c(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:c(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:l(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function c(e,t){const r=[];for(const n of e)r.push(l(n,t));return r}function l(e,t){const r=[];for(const n of e){const e=t(n[0],n[1],[0,0]);r.push(e),n.length>2&&e.push(n[2]),n.length>3&&e.push(n[3])}return r}async function h(e,t){if(!t)return;const r=Array.isArray(e)?e.map(e=>{var t;return null==(t=e.geometry)?void 0:t.spatialReference}):[e];await Object(i.c)(r.map(e=>({source:e,dest:t})))}const f=u.bind(null,s.c),d=u.bind(null,s.f);function p(e,t,r){return e?(r||(r=t,t=e.spatialReference),Object(n.i)(t)&&Object(n.i)(r)&&!Object(n.c)(t,r)?Object(s.a)(t,r)?Object(n.m)(r)?f(e):d(e):Object(i.i)(a.a,[e],t,r,null)[0]:e):e}const m=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,r){!e||!e.length||!t||!r||Object(n.c)(t,r);const s={geometries:e,inSpatialReference:t,outSpatialReference:r,resolve:null};return this._jobs.push(s),new Promise(e=>{s.resolve=e,null===this._timer&&(this._timer=setTimeout(this._process,10))})}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:r,outSpatialReference:o,resolve:u}=e;Object(s.a)(r,o)?Object(n.m)(o)?u(t.map(f)):u(t.map(d)):u(Object(i.i)(a.a,t,r,o,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};async function g(e,t,r){return m.push(e,t,r)}},249:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i}));var n=r(20);class s{constructor(e,t,r){this._namespace=e,this._storage=t,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",r&&(this._storage.registerRemoveFunc(this._namespace,r),this._removeFunc=!0)}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this),this._storage=null}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0}put(e,t,r,n=0){this._storage.put(this._namespace+e,t,r,n)}get(e){const t=this._storage.get(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}pop(e){const t=this._storage.pop(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}updateSize(e,t,r){this._storage.updateSize(this._namespace+e,t,r)}clear(){this._storage.clear(this._namespace)}clearAll(){this._storage.clearAll()}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats()}}class i{constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new n.a,this._users=new n.a}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,t){this._removeFuncs.push([e,t])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace(t=>t[0]!==e)}get size(){return this._size}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,0),this._checkSizeLimit()}put(e,t,r,n){const s=this._db.get(e);if(s&&(this._size-=s.size,this._db.delete(e),s.entry!==t&&this._notifyRemoved(e,s.entry)),r>this._maxSize)return void this._notifyRemoved(e,t);if(void 0===t)return void console.warn("Refusing to cache undefined entry ");if(!r||r<0)return void console.warn("Refusing to cache entry with invalid size "+r);const i=1+Math.max(n,-3)- -3;this._db.set(e,{entry:t,size:r,lifetime:i,lives:i}),this._size+=r,this._checkSizeLimit()}updateSize(e,t,r){const n=this._db.get(e);if(n&&n.entry===t){if(this._size-=n.size,r>this._maxSize)return this._db.delete(e),void this._notifyRemoved(e,t);n.size=r,this._size+=r,this._checkSizeLimit()}}pop(e){const t=this._db.get(e);if(t)return this._size-=t.size,this._db.delete(e),++this._hit,t.entry;++this._miss}get(e){const t=this._db.get(e);if(void 0!==t)return this._db.delete(e),t.lives=t.lifetime,this._db.set(e,t),++this._hit,t.entry;++this._miss}getStats(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},r=new Array;this._db.forEach((e,n)=>{const s=e.lifetime;r[s]=(r[s]||0)+e.size,this._users.forAll(r=>{const s=r.namespace;if(n.startsWith(s)){const r=t[s]||0;t[s]=r+e.size}})});const n={};this._users.forAll(e=>{const r=e.namespace;if(!isNaN(e.hitRate)&&e.hitRate>0){const s=t[r]||0;t[r]=s,n[r]=Math.round(100*e.hitRate)+"%"}else n[r]="0%"});const s=Object.keys(t);s.forEach(e=>t[e]=t[e]/this._size*100),s.sort((e,r)=>t[r]-t[e]),s.forEach(r=>e[r]=Math.round(t[r])+"% / "+n[r]);for(let t=r.length-1;t>=0;--t){const n=r[t];n&&(e["Priority "+(t+-3-1)]=Math.round(n/this.size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll(e=>e.resetHitRate())}clear(e){this._db.forEach((t,r)=>{r.startsWith(e)&&(this._size-=t.size,this._db.delete(r),this._notifyRemoved(r,t.entry))})}clearAll(){this._db.forEach((e,t)=>this._notifyRemoved(t,e.entry)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemoved(e,t){this._removeFuncs.forAll(r=>{e.startsWith(r[0])&&r[1](t)})}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(const[e,t]of this._db)if(this._db.delete(e),t.lives<=1?(this._size-=t.size,this._notifyRemoved(e,t.entry)):(--t.lives,this._db.set(e,t)),this._size<=.9*this.maxSize)return}}},291:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,r){const n=new s(e.getPointX(t),e.getPointY(t),r),i=e.hasZ(t),a=e.hasM(t);return i&&(n.z=e.getPointZ(t)),a&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,r){return new i(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new a(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new o(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){const n=e.hasZ(t),s=e.hasM(t),i=new u(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(n){const r=e.getZExtent(t);i.zmin=r.vmin,i.zmax=r.vmax}if(s){const r=e.getMExtent(t);i.mmin=r.vmin,i.mmax=r.vmax}return i}};class s{constructor(e,t,r){this.x=e,this.y=t,this.spatialReference=r,this.z=void 0,this.m=void 0}}class i{constructor(e,t,r,n){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}class a{constructor(e,t,r,n){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}class o{constructor(e,t,r,n){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}class u{constructor(e,t,r,n,s){this.xmin=e,this.ymin=t,this.xmax=r,this.ymax=n,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},292:function(e,t,r){"use strict";class n{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new n;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}t.a=n},294:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(138),s=Object(n.b)((function(e){var t;void 0!==(t=function(){function e(r,n,s,i,a){for(;i>s;){if(i-s>600){var o=i-s+1,u=n-s+1,c=Math.log(o),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(o-l)/o)*(u-o/2<0?-1:1);e(r,n,Math.max(s,Math.floor(n-u*l/o+h)),Math.min(i,Math.floor(n+(o-u)*l/o+h)),a)}var f=r[n],d=s,p=i;for(t(r,s,n),a(r[i],f)>0&&t(r,s,i);d<p;){for(t(r,d,p),d++,p--;a(r[d],f)<0;)d++;for(;a(r[p],f)>0;)p--}0===a(r[s],f)?t(r,s,p):t(r,++p,i),p<=n&&(s=p+1),n<=p&&(i=p-1)}}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t){return e<t?-1:e>t?1:0}return function(t,n,s,i,a){e(t,n,s||0,i||t.length-1,a||r)}}())&&(e.exports=t)}))},295:function(e,t,r){"use strict";function n(e,t){return e?t?4:3:t?3:2}function s(e,t,r,s,o){if(!t||!t.lengths.length)return null;const u="upperLeft"===(null==o?void 0:o.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const c=e.coords,l=[],h=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:d}=t,p=n(r,s);let m=0;for(const e of f){const t=i(h,d,m,e,r,s,u);t&&l.push(t),m+=e*p}if(l.sort((e,t)=>{let n=u*e[2]-u*t[2];return 0===n&&r&&(n=e[4]-t[4]),n}),l.length){let e=6*l[0][2];c[0]=l[0][0]/e,c[1]=l[0][1]/e,r&&(e=6*l[0][4],c[2]=0!==e?l[0][3]/e:0),(c[0]<h[0]||c[0]>h[1]||c[1]<h[2]||c[1]>h[3]||r&&(c[2]<h[4]||c[2]>h[5]))&&(c.length=0)}if(!c.length){const e=t.lengths[0]?a(d,0,f[0],r,s):null;if(!e)return null;c[0]=e[0],c[1]=e[1],r&&e.length>2&&(c[2]=e[2])}return e}function i(e,t,r,s,i,a,o=1){const u=n(i,a);let c=r,l=r+u,h=0,f=0,d=0,p=0,m=0;for(let r=0,n=s-1;r<n;r++,c+=u,l+=u){const r=t[c],n=t[c+1],s=t[c+2],a=t[l],o=t[l+1],u=t[l+2];let g=r*o-a*n;p+=g,h+=(r+a)*g,f+=(n+o)*g,i&&(g=r*u-a*s,d+=(s+u)*g,m+=g),r<e[0]&&(e[0]=r),r>e[1]&&(e[1]=r),n<e[2]&&(e[2]=n),n>e[3]&&(e[3]=n),i&&(s<e[4]&&(e[4]=s),s>e[5]&&(e[5]=s))}if(p*o>0&&(p*=-1),m*o>0&&(m*=-1),!p)return null;const g=[h,f,.5*p];return i&&(g[3]=d,g[4]=.5*m),g}function a(e,t,r,s,i){const a=n(s,i);let h=t,f=t+a,d=0,p=0,m=0,g=0;for(let t=0,n=r-1;t<n;t++,h+=a,f+=a){const t=e[h],r=e[h+1],n=e[h+2],i=e[f],a=e[f+1],y=e[f+2],v=s?u(t,r,n,i,a,y):o(t,r,i,a);if(v)if(d+=v,s){const e=l(t,r,n,i,a,y);p+=v*e[0],m+=v*e[1],g+=v*e[2]}else{const e=c(t,r,i,a);p+=v*e[0],m+=v*e[1]}}return d>0?s?[p/d,m/d,g/d]:[p/d,m/d]:r>0?s?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function o(e,t,r,n){const s=r-e,i=n-t;return Math.sqrt(s*s+i*i)}function u(e,t,r,n,s,i){const a=n-e,o=s-t,u=i-r;return Math.sqrt(a*a+o*o+u*u)}function c(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function l(e,t,r,n,s,i){return[e+.5*(n-e),t+.5*(s-t),r+.5*(i-r)]}r.d(t,"a",(function(){return s}))},354:function(e,t,r){"use strict";var n=r(6),s=r(0),i=r(16),a=r(83),o=r(237),u=r(64),c=r(72),l=r(110),h=r(49),f=r(209),d=r(249),p=r(144),m=r(491),g=r(194),y=r(248),v=r(437),b=r(137);const x=new class{constructor(e,t){this._cache=new v.a(e),this._invalidCache=new v.a(t)}get(e,t){const r=`${t.uid}:${e}`,n=this._cache.get(r);if(n)return n;if(void 0!==this._invalidCache.get(r))return null;try{const n=b.WhereClause.create(e,t);return this._cache.put(r,n),n}catch{return this._invalidCache.put(r,null),null}}}(50,500),_="feature-store:unsupported-query",w=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function I(e,t){return e?x.get(e,t):null}function S(e,t,r,n=!0){const s=[];for(const r of t)if("*"!==r&&!e.has(r))if(n){const t=N(r);try{const r=I(t,e);if(!r)throw new i.a(_,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new i.a(_,"expression is not standard",{clause:r});S(e,r.fieldNames,"expression contains missing fields")}catch(e){const t=e&&e.details;if(t&&(t.clause||t.where))throw e;t&&t.missingFields?s.push(...t.missingFields):s.push(r)}}else s.push(r);if(s.length)throw new i.a(_,r,{missingFields:s})}function N(e){return e.split(" as ")[0]}function O(e,t){const r=t.get(e);return!!r&&!w.has(r.type)}var T=r(368),M=r(534),F=r(438),A=r(105),R=r(369);var j=class{constructor(e,t,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=r,this.featureAdapter=t;const n=e.outFields;if(n&&-1===n.indexOf("*")){this.outFields=n;let e=0;for(const t of n){const n=N(t),s=this.fieldsIndex.get(n),i=s?null:I(n,r),a=s?s.name:t.split(" as ")[1]||"FIELD_EXP_"+e++;this._fieldDataCache.set(t,{alias:a,clause:i})}}}countDistinctValues(e){return this.returnDistinctValues?(e.forEach(e=>this.getAttributes(e)),this._returnDistinctMap.size):e.length}getAttributes(e){const t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}getFieldValue(e,t,r){const n=r?r.name:t;let s=null;return this._fieldDataCache.has(n)?s=this._fieldDataCache.get(n).clause:r||(s=I(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:s})),r?this.featureAdapter.getAttribute(e,n):s.calculateValue(e,this.featureAdapter)}validateItem(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:I(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}validateItems(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:I(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}_processAttributesForOutFields(e){const t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);const r={};for(const n of t){const{alias:t,clause:s}=this._fieldDataCache.get(n);r[t]=s?s.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,t)}return r}_processAttributesForDistinctValues(e){if(Object(s.g)(e)||!this.returnDistinctValues)return e;const t=this.outFields,r=[];if(t)for(const n of t){const{alias:t}=this._fieldDataCache.get(n);r.push(e[t])}else for(const t in e)r.push(e[t]);const n=`${(t||["*"]).join(",")}=${r.join(",")}`;let i=this._returnDistinctMap.get(n)||0;return this._returnDistinctMap.set(n,++i),i>1?null:e}};function E(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function P(e,t,r){return(r?e>t:e<t)?-1:(r?e<t:e>t)?1:0}function C(e,t,r){return r?t-e:e-t}function G(e,t,r,n){if(r&&"esriFieldTypeDate"===r.type){const r=new Date(e).getTime(),s=new Date(t).getTime();if(!isNaN(r)&&!isNaN(s))return C(r,s,n)}if("number"==typeof e&&"number"==typeof t)return C(e,t,n);if("string"==typeof e&&"string"==typeof t){const s=e.toUpperCase(),i=t.toUpperCase();return!r||"esriFieldTypeGUID"!==r.type&&"esriFieldTypeGlobalID"!==r.type?P(s,i,n):P(E(s),E(i),n)}return n?1:-1}class z{constructor(e,t,r){this.items=e,this.queryGeometry=t,this.definitionExpression=r.definitionExpression,this.geometryType=r.geometryType,this.hasM=r.hasM,this.hasZ=r.hasZ,this.objectIdField=r.objectIdField,this.spatialReference=r.spatialReference,this.fieldsIndex=r.fieldsIndex,this.timeInfo=r.timeInfo,this.featureAdapter=r.featureAdapter,this.aggregateAdapter=r.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(e){const t=new j(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);const{groupByFieldsForStatistics:r,having:n}=e;if(!(null==r?void 0:r.length))return 1;const s=new Map,i=new Map,a=new Set,o=e.outStatistics;for(const e of o){const{statisticType:o}=e,u="exceedslimit"!==o?e.onStatisticField:void 0;if(!i.has(u)){const e=[];for(const n of r){const r=this._getAttributeValues(t,n,s);e.push(r)}i.set(u,this._calculateUniqueValues(e))}const c=i.get(u);for(const e in c){const{data:r,items:s}=c[e],i=r.join(",");n&&!t.validateItems(s,n)||a.add(i)}}return a.size}createQueryResponse(e){let t;return t=e.outStatistics?e.outStatistics.some(e=>"exceedslimit"===e.statisticType)?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(Object(a.i)(e.outSR)&&!Object(a.c)(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=Object(T.b)({spatialReference:e.outSR,...Object(y.b)(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR)}):t.queryGeometry=Object(T.b)({spatialReference:e.outSR,...this.queryGeometry})),t}createSnappingResponse(e,t){const r=this.featureAdapter,n=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),{x:s,y:i}=e.point,a="number"==typeof e.distance?e.distance:e.distance.x,o="number"==typeof e.distance?e.distance:e.distance.y,u={candidates:[]},c="esriGeometryPolygon"===this.geometryType,l=this.getPointCreator(e.point,this.spatialReference,t);for(const t of this.items){const h=r.getGeometry(t);if(!h)continue;const{coords:f,lengths:d}=h;if(1&e.types){let e=0;for(let c=0;c<d.length;c++){const h=d[c];for(let c=0;c<h;c++,e+=n){const d=f[e],p=f[e+1];if(c!==h-1){const c=f[e+n],h=f[e+n+1],{x:m,y:g}=L(s,i,d,p,c,h),y=(s-m)/a,v=(i-g)/o,b=y*y+v*v;b<=1&&u.candidates.push({type:"edge",objectId:r.getObjectId(t),distance:Math.sqrt(b),target:l(m,g),start:l(d,p),end:l(c,h)})}}}}if(2&e.types){const e=c?f.length-n:f.length;for(let c=0;c<e;c+=n){const e=f[c],n=f[c+1],h=(s-e)/a,d=(i-n)/o,p=h*h+d*d;p<=1&&u.candidates.push({type:"vertex",objectId:r.getObjectId(t),distance:Math.sqrt(p),target:l(e,n)})}}}return u.candidates.sort((e,t)=>e.distance-t.distance),u}getPointCreator(e,t,r){const n=Object(s.h)(r)&&!Object(a.c)(t,r)?e=>Object(y.b)(e,t,r):e=>e;return null!=e.z&&null!=e.m?(t,r)=>n({x:t,y:r,z:e.z,m:e.m}):null!=e.z?(t,r)=>n({x:t,y:r,z:e.z}):null!=e.m?(t,r)=>n({x:t,y:r,m:e.m}):(e,t)=>n({x:e,y:t})}executeAttributesQuery(e){const t=I(e.where,this.fieldsIndex);if(!t)return Promise.resolve(this);if(t.isStandardized){let r=0;const n=[];for(const e of this.items)t.testFeature(e,this.featureAdapter)&&(n[r++]=e);const s=new z(n,this.queryGeometry,this);return s.definitionExpression=e.where,Promise.resolve(s)}return Promise.reject(new TypeError("Where clause is not standardized"))}executeAggregateIdsQuery(e){if(!e.aggregateIds||!e.aggregateIds.length||Object(s.g)(this.aggregateAdapter))return Promise.resolve(this);const t=new Set;for(const r of e.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(r).forEach(e=>t.add(e));const r=this.featureAdapter.getObjectId;return Promise.resolve(new z(this.items.filter(e=>t.has(r(e))),this.queryGeometry,this))}executeObjectIdsQuery(e){if(!e.objectIds||!e.objectIds.length)return Promise.resolve(this);const t=new Set(e.objectIds),r=this.featureAdapter.getObjectId;return Promise.resolve(new z(this.items.filter(e=>t.has(r(e))),this.queryGeometry,this))}executeTimeQuery(e){const t=Object(F.b)(this.timeInfo,e.timeExtent,this.featureAdapter);if(!Object(s.h)(t))return Promise.resolve(this);const r=this.items.filter(t);return Promise.resolve(new z(r,this.queryGeometry,this))}filterLatest(){const{trackIdField:e,startTimeField:t,endTimeField:r}=this.timeInfo,n=r||t,s=new Map,i=this.featureAdapter.getAttribute;for(const t of this.items){const r=i(t,e),a=i(t,n),o=s.get(r);(!o||a>i(o,n))&&s.set(r,t)}const a=Array.from(s.values());return Promise.resolve(new z(a,this.queryGeometry,this))}async project(e){if(!e||Object(a.c)(this.spatialReference,e))return this;const t=this.featureAdapter,r=(await Object(y.c)(this.items.map(e=>Object(T.c)(this.geometryType,this.hasZ,this.hasM,t.getGeometry(e))),this.spatialReference,e)).map((e,r)=>t.cloneWithGeometry(this.items[r],Object(A.d)(e,this.hasZ,this.hasM)));return new z(r,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:e,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})}_sortFeatures(e,t,r){if(e.length>1&&t&&t.length)for(const n of t.reverse()){const t=n.split(" "),s=t[0],i=this.fieldsIndex.get(s),a=t[1]&&"desc"===t[1].toLowerCase();e.sort((e,t)=>G(r(e,s,i),r(t,s,i),i,a))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:r,hasM:n,hasZ:s,objectIdField:i,spatialReference:a}=this,{outFields:o,outSR:u,quantizationParameters:c,resultRecordCount:l,resultOffset:h,returnZ:f,returnM:d}=e,p=null!=l&&t.length>(h||0)+l,m=o&&(o.indexOf("*")>-1?[...this.fieldsIndex.fields]:o.map(e=>this.fieldsIndex.get(e)));return{exceededTransferLimit:p,features:this._createFeatures(e,t),fields:m,geometryType:r,hasM:n&&d,hasZ:s&&f,objectIdFieldName:i,spatialReference:Object(T.b)(u||a),transform:c&&Object(R.a)(c)||null}}_createFeatures(e,t){const r=new j(e,this.featureAdapter,this.fieldsIndex),{hasM:n,hasZ:s}=this,{orderByFields:i,quantizationParameters:a,returnGeometry:o,returnCentroid:u,maxAllowableOffset:c,resultOffset:l,resultRecordCount:h,returnZ:f=!1,returnM:d=!1}=e,p=s&&f,m=n&&d;let g=[],y=0;const v=[...t];if(this._sortFeatures(v,i,(e,t,n)=>r.getFieldValue(e,t,n)),o||u){const e=Object(R.a)(a);if(o&&!u)for(const t of v)g[y++]={attributes:r.getAttributes(t),geometry:Object(T.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),c,e,p,m)};else if(!o&&u)for(const t of v)g[y++]={attributes:r.getAttributes(t),centroid:Object(T.f)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of v)g[y++]={attributes:r.getAttributes(t),centroid:Object(T.f)(this,this.featureAdapter.getCentroid(t,this),e),geometry:Object(T.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),c,e,p,m)}}else for(const e of v){const t=r.getAttributes(e);t&&(g[y++]={attributes:t})}const b=l||0;if(null!=h){const e=b+h;g=g.slice(b,Math.min(g.length,e))}return g}_createExceedsLimitQueryResponse(e){let t=!1,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(const t of e.outStatistics)if("exceedslimit"===t.statisticType){r=null!=t.maxPointCount?t.maxPointCount:Number.POSITIVE_INFINITY,n=null!=t.maxRecordCount?t.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=t.maxVertexCount?t.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>r;else if(this.items.length>n)t=!0;else{const e=this.hasZ?this.hasM?4:3:this.hasM?3:2,r=this.featureAdapter;t=this.items.reduce((e,t)=>{const n=r.getGeometry(t);return e+(n&&n.coords.length||0)},0)/e>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}_createStatisticsQueryResponse(e){const t={attributes:{}},r=[],n=new Map,s=new Map,i=new Map,a=new Map,o=new j(e,this.featureAdapter,this.fieldsIndex),u=e.outStatistics,{groupByFieldsForStatistics:c,having:l,orderByFields:h}=e,f=c&&c.length,d=!!f,p=d&&c[0],m=d&&!this.fieldsIndex.get(p);for(const e of u){const{outStatisticFieldName:u,statisticType:h}=e,g=e,y="exceedslimit"!==h?e.onStatisticField:void 0,v="percentile_disc"===h||"percentile_cont"===h,b=d&&1===f&&(y===p||m)&&"count"===h;if(d){if(!i.has(y)){const e=[];for(const t of c){const r=this._getAttributeValues(o,t,n);e.push(r)}i.set(y,this._calculateUniqueValues(e,o.returnDistinctValues))}const e=i.get(y);for(const t in e){const{count:r,data:s,items:i,itemPositions:h}=e[t],f=s.join(",");if(!l||o.validateItems(i,l)){const e=a.get(f)||{attributes:{}};let t=null;if(b)t=r;else{const e=this._getAttributeValues(o,y,n),r=h.map(t=>e[t]);t=v&&"statisticParameters"in g?this._getPercentileValue(g,r):this._getStatisticValue(g,r)}e.attributes[u]=t,c.forEach((t,r)=>e.attributes[this.fieldsIndex.get(t)?t:"EXPR_"+(r+1)]=s[r]),a.set(f,e)}}}else{const e=this._getAttributeValues(o,y,n);t.attributes[u]=v&&"statisticParameters"in g?this._getPercentileValue(g,e):this._getStatisticValue(g,e,s)}r.push({name:u,alias:u,type:"esriFieldTypeDouble"})}const g=d?Array.from(a.values()):[t];return this._sortFeatures(g,h,(e,t)=>e.attributes[t]),{fields:r,features:g}}_getStatisticValue(e,t,r){const{onStatisticField:n,statisticType:s}=e,i=r&&r.has(n)?r.get(n):this._calculateStatistics(t);return r&&r.set(n,i),i["var"===s?"variance":s]}_getPercentileValue(e,t){const{onStatisticField:r,statisticParameters:n,statisticType:s}=e,{value:i,orderBy:a}=n,o="desc"===a,u=this.fieldsIndex.get(r),c=[...t].filter(e=>null!=e).sort((e,t)=>G(e,t,u,o));return this._calculatePercentile(c,i,"percentile_disc"===s)}_getAttributeValues(e,t,r){if(r.has(t))return r.get(t);const n=this.fieldsIndex.get(t),s=this.items.map(r=>e.getFieldValue(r,t,n));return r.set(t,s),s}_calculateStatistics(e){let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=null,s=null,i=null,a=null;const o=[];let u=0;for(const s of e)"string"==typeof s?u++:null==s||isNaN(s)||(n+=s,t=Math.min(t,s),r=Math.max(r,s),o.push(s),u++);if(u){s=n/u;let e=0;for(const t of o)e+=(t-s)**2;a=u>1?e/(u-1):0,i=Math.sqrt(a)}else t=null,r=null;return{avg:s,count:u,max:r,min:t,stddev:i,sum:n,variance:a}}_calculateUniqueValues(e,t){const r={},n=this.items,s=n.length;for(let i=0;i<s;i++){const s=n[i],a=[];for(const t of e)a.push(t[i]);const o=a.join(",");t?null==r[o]&&(r[o]={count:1,data:a,items:[s],itemPositions:[i]}):null==r[o]?r[o]={count:1,data:a,items:[s],itemPositions:[i]}:(r[o].count++,r[o].items.push(s),r[o].itemPositions.push(i))}return r}_calculatePercentile(e,t,r){if(0===e.length)return null;if(t<=0)return e[0];if(t>=1)return e[e.length-1];const n=(e.length-1)*t,s=Math.floor(n),i=s+1,a=n%1,o=e[s],u=e[i];return i>=e.length||r||"string"==typeof o||"string"==typeof u?o:o*(1-a)+u*a}}function L(e,t,r,n,s,i){const a=s-r,o=i-n,u=a*a+o*o,c=(e-r)*a+(t-n)*o,l=Math.min(1,Math.max(0,c/u));return{x:r+a*l,y:n+o*l}}var Q=z;const D="feature-store:unsupported-query";const k=new Set,q=new d.b(2e6);let V=0;const Z=Object(g.b)(),J=Object(g.b)();t.a=class{constructor(e){this.capabilities={query:m.a},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new d.a(V+++"$$",q)),this.fieldsIndex=new p.a(e.fields),e.scheduler&&e.task&&(this._frameQueue=new h.a,this._frameTask=e.scheduler.registerTask(e.task,e=>this._update(e),()=>this._frameQueue.length>0))}destroy(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:Object(T.b)(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=Object(F.a)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}async executeQuery(e={},t){let r,s=Object(n.a)(e);try{s=await this._schedule(()=>Object(T.d)(s,this.definitionExpression,this.spatialReference),t),s=await this._reschedule(()=>this._checkQuerySupport(s),t),r=await this._reschedule(()=>this._executeGeometryQuery(s,t),t),r=await this._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=await this._reschedule(()=>r.executeObjectIdsQuery(s),t),r=await this._reschedule(()=>r.executeTimeQuery(s),t),r=await this._reschedule(()=>r.executeAttributesQuery(s),t)}catch(e){if(e!==T.a)throw e;r=new Q([],null,this)}return r.createQueryResponse(s)}async executeQueryForCount(e={},t){let r,s=Object(n.a)(e);s.returnGeometry=!1,s.returnCentroid=!1,s.outSR=null;try{s=await this._schedule(()=>Object(T.d)(s,this.definitionExpression,this.spatialReference),t),s=await this._reschedule(()=>this._checkQuerySupport(s),t),r=await this._reschedule(()=>this._executeGeometryQuery(s,t),t),r=await this._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=await this._reschedule(()=>r.executeObjectIdsQuery(s),t),r=await this._reschedule(()=>r.executeTimeQuery(s),t),r=await this._reschedule(()=>r.executeAttributesQuery(s),t)}catch(e){if(e!==T.a)throw e;return 0}return r.createQueryResponseForCount(s)}async executeQueryForExtent(e={},t){let r,s=Object(n.a)(e);const i=s.outSR;try{s=await this._schedule(()=>Object(T.d)(s,this.definitionExpression,this.spatialReference),t),s=await this._reschedule(()=>this._checkQuerySupport(s),t),s.returnGeometry=!0,s.returnCentroid=!1,s.outSR=null,r=await this._reschedule(()=>this._executeGeometryQuery(s,t),t),r=await this._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=await this._reschedule(()=>r.executeObjectIdsQuery(s),t),r=await this._reschedule(()=>r.executeTimeQuery(s),t),r=await this._reschedule(()=>r.executeAttributesQuery(s),t);const e=r.size;if(!e)return{count:e,extent:null};Object(g.j)(J,g.a),this.featureStore.forEachBounds(r.items,e=>Object(g.e)(J,e),Z);const n={xmin:J[0],ymin:J[1],xmax:J[3],ymax:J[4],spatialReference:Object(T.b)(this.spatialReference)};this.hasZ&&isFinite(J[2])&&isFinite(J[5])&&(n.zmin=J[2],n.zmax=J[5]);const a=Object(y.b)(n,r.spatialReference,i);if(a.spatialReference=Object(T.b)(i||this.spatialReference),a.xmax-a.xmin==0){const e=Object(c.c)(a.spatialReference);a.xmin-=e,a.xmax+=e}if(a.ymax-a.ymin==0){const e=Object(c.c)(a.spatialReference);a.ymin-=e,a.ymax+=e}if(this.hasZ&&null!=a.zmin&&null!=a.zmax&&a.zmax-a.zmin==0){const e=Object(c.c)(a.spatialReference);a.zmin-=e,a.zmax+=e}return{count:e,extent:a}}catch(e){if(e===T.a)return{count:0,extent:null};throw e}}async executeQueryForIds(e={},t){return this.executeQueryForIdSet(e,t).then(e=>Array.from(e))}async executeQueryForIdSet(e={},t){let r,s=Object(n.a)(e);s.returnGeometry=!1,s.returnCentroid=!1,s.outSR=null;try{s=await this._schedule(()=>Object(T.d)(s,this.definitionExpression,this.spatialReference),t),s=await this._reschedule(()=>this._checkQuerySupport(s),t),r=await this._reschedule(()=>this._executeGeometryQuery(s,t),t),r=await this._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=await this._reschedule(()=>r.executeObjectIdsQuery(s),t),r=await this._reschedule(()=>r.executeTimeQuery(s),t),r=await this._reschedule(()=>r.executeAttributesQuery(s),t);const e=r.items,n=new Set;return await this._reschedule(()=>{for(const t of e)n.add(r.featureAdapter.getObjectId(t))},t),n}catch(e){if(e===T.a)return new Set;throw e}}async executeQueryForSnapping(e,t){const{point:r,distance:n,types:i}=e;if(0===i)return{candidates:[]};const o=await this._reschedule(()=>this._checkQuerySupport(e.query),t),c=!Object(a.c)(r.spatialReference,this.spatialReference);c&&await Object(y.a)(r.spatialReference,this.spatialReference);const l="number"==typeof n?n:n.x,h="number"==typeof n?n:n.y,d={xmin:r.x-l,xmax:r.x+l,ymin:r.y-h,ymax:r.y+h,spatialReference:r.spatialReference},p=c?Object(y.b)(d,this.spatialReference):d;if(!p)return{candidates:[]};const m=(await Object(f.a)(Object(u.a)(r),null,{signal:t}))[0],g=(await Object(f.a)(Object(u.a)(p),null,{signal:t}))[0];if(Object(s.g)(m)||Object(s.g)(g))return{candidates:[]};let v=new Q(this._searchFeatures(this._getQueryBBoxes(g.toJSON())),null,this);v=await this._reschedule(()=>v.executeObjectIdsQuery(o),t),v=await this._reschedule(()=>v.executeTimeQuery(o),t),v=await this._reschedule(()=>v.executeAttributesQuery(o),t);const b=m.toJSON(),x=c?Object(y.b)(b,this.spatialReference):b,_=c?Math.max(p.xmax-p.xmin,p.ymax-p.ymin)/2:n;return v.createSnappingResponse({...e,point:x,distance:_},r.spatialReference)}async executeQueryForLatestObservations(e={},t){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new i.a(D,"Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:this.timeInfo});let r,s=Object(n.a)(e);try{s=await this._schedule(()=>Object(T.d)(s,this.definitionExpression,this.spatialReference),t),s=await this._reschedule(()=>this._checkQuerySupport(s),t),r=await this._reschedule(()=>this._executeGeometryQuery(s,t),t),r=await this._reschedule(()=>r.executeAggregateIdsQuery(s),t),r=await this._reschedule(()=>r.executeObjectIdsQuery(s),t),r=await this._reschedule(()=>r.executeTimeQuery(s),t),r=await this._reschedule(()=>r.executeAttributesQuery(s),t),r=await this._reschedule(()=>r.filterLatest(),t)}catch(e){if(e!==T.a)throw e;r=new Q([],null,this)}return r.createQueryResponse(s)}async _schedule(e,t){return this._frameQueue?this._frameQueue.push(e,t):e()}async _reschedule(e,t){return this._frameQueue?this._frameQueue.unshift(e,t):e()}_update(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null}_getAll(){if(!this._allItems){const e=[];this.featureStore.forEach(t=>e.push(t)),this._allItems=new Q(e,null,this)}return this._allItems}async _executeGeometryQuery(e,t){const{geometry:r,outSR:n,spatialRel:i,returnGeometry:o,returnCentroid:u}=e,c=o||u,l=Object(a.i)(n)&&!Object(a.c)(this.spatialReference,n),h=this._geometryQueryCache?l&&c?JSON.stringify({geometry:r,spatialRelationship:i,outSpatialReference:n}):JSON.stringify({geometry:r,spatialRelationship:i}):null;if(h){const e=this._geometryQueryCache.get(h);if(!Object(s.i)(e))return e}const f=async e=>{if(l&&c){const t=await e.project(n);return h&&this._geometryQueryCache.put(h,t,t.size||1),t}return h&&this._geometryQueryCache.put(h,e,e.size||1),e};if(!r)return f(this._getAll());const d=this.featureAdapter;if("esriSpatialRelDisjoint"===i){const e=this._searchFeatures(this._getQueryBBoxes(r));if(!e.length)return f(this._getAll());let n,s;const a=new Set;for(const t of e)a.add(d.getObjectId(t));return await this._reschedule(()=>{let e=0;n=new Array(a.size),this.featureStore.forEach(t=>n[e++]=t),s=a},t),f(await this._reschedule(async()=>{const e=await Object(M.c)(i,r,this.geometryType,this.hasZ,this.hasM);return new Q(await this._runSpatialFilter(n,t=>!s.has(d.getObjectId(t))||e(d.getGeometry(t)),t),r,this)},t))}const p=this._searchFeatures(this._getQueryBBoxes(r));if(!p.length){const e=new Q([],r,this);return h&&this._geometryQueryCache.put(h,e,e.size||1),e}if(this._canExecuteSoloPass(r,e))return f(new Q(p,r,this));const m=await Object(M.c)(i,r,this.geometryType,this.hasZ,this.hasM),g=await this._runSpatialFilter(p,e=>m(d.getGeometry(e)),t);return f(new Q(g,r,this))}async _runSpatialFilter(e,t,r){if(!t)return e;if(!this._budget)return e.filter(e=>t(e));let n=0;const s=new Array,i=async()=>{for(;n<e.length;){const a=e[n];t(a)&&s.push(a),this._budget.done&&await this._reschedule(()=>i(),r),++n}};return this._reschedule(()=>i(),r).then(()=>s)}_canExecuteSoloPass(e,t){const{geometryType:r}=this,{spatialRel:n}=t;return Object(M.a)(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))}_getQueryBBoxes(e){if(Object(M.a)(e)){if(Object(u.d)(e))return[Object(l.i)(e.xmin,e.ymin,e.xmax,e.ymax)];if(Object(u.g)(e))return e.rings.map(e=>Object(l.i)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1])))}return[Object(o.a)(Object(l.d)(),e)]}_searchFeatures(e){for(const t of e)this.featureStore.forEachInBounds(t,e=>{k.add(e)});const t=new Array(k.size);let r=0;return k.forEach(e=>t[r++]=e),k.clear(),t}async _checkQuerySupport(e){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new i.a(D,"Unsupported query options",{query:e});return Promise.all([this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),Object(M.b)(e,this.geometryType,this.spatialReference),Object(y.a)(this.spatialReference,e.outSR)]).then(()=>e)}_checkAttributesQuerySupport(e){const{outFields:t,orderByFields:r,returnDistinctValues:n,outStatistics:s}=e,a=s?s.map(e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase()):[];if(r&&r.length>0){const e=" asc",t=" desc",n=r.map(r=>{const n=r.toLowerCase();return n.indexOf(e)>-1?n.split(e)[0]:n.indexOf(t)>-1?n.split(t)[0]:r}).filter(e=>-1===a.indexOf(e));S(this.fieldsIndex,n,"orderByFields contains missing fields")}if(t&&t.length>0)S(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new i.a(D,"outFields should be specified for returnDistinctValues",{query:e});!function(e,t){if(!t)return!0;const r=x.get(t,e);if(!r)throw new i.a(_,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new i.a(_,"where clause is not standard",{where:t});S(e,r.fieldNames,"where clause contains missing fields")}(this.fieldsIndex,e.where)}async _checkStatisticsQuerySupport(e){const{outStatistics:t,groupByFieldsForStatistics:r,having:n}=e,s=r&&r.length,a=t&&t.length;if(n){if(!s||!a)throw new i.a(D,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});!function(e,t,r){if(!t)return!0;const n=x.get(t,e);if(!n)throw new i.a(_,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new i.a(_,"having does not contain a valid aggregate function",{having:t});const s=n.fieldNames;if(S(e,s,"having contains missing fields"),!n.getExpressions().every(t=>{const{aggregateType:n,field:s}=t,i=e.has(s)&&e.get(s).name;return r.some(t=>{const{onStatisticField:r,statisticType:s}=t;return(e.has(r)&&e.get(r).name)===i&&s.toLowerCase().trim()===n})}))throw new i.a(_,"expressions in having should also exist in outStatistics",{having:t})}(this.fieldsIndex,n,t)}if(a){if(!function(e){return e.every(e=>"exceedslimit"!==e.statisticType)}(t))return;const n=t.map(e=>e.onStatisticField);S(this.fieldsIndex,n,"onStatisticFields contains missing fields"),s&&S(this.fieldsIndex,r,"groupByFieldsForStatistics contains missing fields");for(const r of t){const{onStatisticField:t,statisticType:n}=r;if("percentile_disc"!==n&&"percentile_cont"!==n||!("statisticParameters"in r)){if("count"!==n&&t&&O(t,this.fieldsIndex))throw new i.a(D,"outStatistics contains non-numeric fields",{definition:r,query:e})}else{const{statisticParameters:t}=r;if(!t)throw new i.a(D,"statisticParamters should be set for percentile type",{definition:r,query:e})}}}}}},368:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return I})),r.d(t,"c",(function(){return x})),r.d(t,"d",(function(){return _})),r.d(t,"e",(function(){return w})),r.d(t,"f",(function(){return b}));var n=r(0),s=r(59),i=r(83),a=r(436),o=r(64),u=r(72),c=r(209),l=r(140),h=r(105),f=(r(295),r(248));const d=new s.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),p=Object.freeze({}),m=new l.a,g=new l.a,y=new l.a,v={esriGeometryPoint:h.j,esriGeometryPolyline:h.l,esriGeometryPolygon:h.k,esriGeometryMultipoint:h.i};function b(e,t,r,n=e.hasZ,s=e.hasM){const i=e.hasZ&&n,a=e.hasM&&s;if(r){const o=Object(h.r)(y,t,e.hasZ,e.hasM,"esriGeometryPoint",r,n,s);return Object(h.j)(o,i,a)}return Object(h.j)(t,i,a)}function x(e,t,r,n,s,i,a=t,o=r){const u=t&&a,c=r&&o,l=n?"coords"in n?n:n.geometry:null;if(!l)return null;if(s){let n=Object(h.n)(g,l,t,r,e,s,a,o);return i&&(n=Object(h.r)(y,n,u,c,e,i)),v[e](n,u,c)}if(i){const n=Object(h.r)(y,l,t,r,e,i,a,o);return v[e](n,u,c)}return Object(h.u)(m,l,t,r,a,o),v[e](m,u,c)}async function _(e,t,r){const{outFields:n,orderByFields:s,groupByFieldsForStatistics:i,outStatistics:a}=e;if(n)for(let e=0;e<n.length;e++)n[e]=n[e].trim();if(s)for(let e=0;e<s.length;e++)s[e]=s[e].trim();if(i)for(let e=0;e<i.length;e++)i[e]=i[e].trim();if(a)for(let e=0;e<a.length;e++)a[e].onStatisticField&&(a[e].onStatisticField=a[e].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),w(e,t,r)}async function w(e,t,s){if(!e)return null;let{where:l}=e;if(e.where=l=l&&l.trim(),(!l||/^1 *= *1$/.test(l)||t&&t===l)&&(e.where=null),!e.geometry)return e;let h=await async function(e){const{geometry:t,distance:n,units:s}=e;if(null==n||"vertexAttributes"in t)return t;const a=t.spatialReference,o=s?d.fromJSON(s):Object(u.e)(a),c=a&&(Object(i.f)(a)||Object(i.m)(a))?t:await Object(f.a)(a,i.a).then(()=>Object(f.b)(t,i.a));return(await async function(){return(await Promise.all([r.e(6),r.e(13)]).then(r.bind(null,509))).geodesicBuffer}())(c.spatialReference,c,n,o)}(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;h=Object(a.a)(h),h.spatialReference=t}e.geometry=h,await Object(f.a)(h.spatialReference,s);const m=(await Object(c.a)(Object(o.a)(h)))[0];if(Object(n.g)(m))throw p;const g=m.toJSON(),y=await Object(f.b)(g,g.spatialReference,s);if(!y)throw p;return y.spatialReference=s,e.geometry=y,e}function I(e){return e&&S in e?JSON.parse(JSON.stringify(e,N)):e}const S="_geVersion",N=(e,t)=>e!==S?t:void 0},369:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return p}));r(64);const n=(e,t,r)=>[t,r],s=(e,t,r)=>[t,r,e[2]],i=(e,t,r)=>[t,r,e[2],e[3]];function a(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function o({scale:e,translate:t},r){return r*e[0]+t[0]}function u({scale:e,translate:t},r){return t[1]-r*e[1]}function c(e,t,r){const n=new Array(r.length);if(!r.length)return n;const[s,i]=e.scale;let a=o(e,r[0][0]),c=u(e,r[0][1]);n[0]=t(r[0],a,c);for(let e=1;e<r.length;e++){const o=r[e];a+=o[0]*s,c-=o[1]*i,n[e]=t(o,a,c)}return n}function l(e,t,r){const n=new Array(r.length);for(let s=0;s<r.length;s++)n[s]=c(e,t,r[s]);return n}function h(e,t,r,a,o){return t.points=function(e,t,r,a){return c(e,r?a?i:s:a?s:n,t)}(e,r.points,a,o),t}function f(e,t,r,n,s){return t.x=o(e,r.x),t.y=u(e,r.y),t!==r&&(n&&(t.z=r.z),s&&(t.m=r.m)),t}function d(e,t,r,a,o){return t.rings=function(e,t,r,a){return l(e,r?a?i:s:a?s:n,t)}(e,r.rings,a,o),t}function p(e,t,r,a,o){return t.paths=function(e,t,r,a){return l(e,r?a?i:s:a?s:n,t)}(e,r.paths,a,o),t}},437:function(e,t,r){"use strict";var n=r(249);t.a=class{constructor(e,t){this._storage=new n.b,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}put(e,t){this._storage.put(e,t,1,1)}pop(e){return this._storage.pop(e)}get(e){return this._storage.get(e)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}}},438:function(e,t,r){"use strict";function n(e,t){if(!e)return null;const r=t.featureAdapter,{startTimeField:n,endTimeField:s}=e;let i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;if(n&&s)t.forEach(e=>{const t=r.getAttribute(e,n),o=r.getAttribute(e,s);null==t||isNaN(t)||(i=Math.min(i,t)),null==o||isNaN(o)||(a=Math.max(a,o))});else{const e=n||s;t.forEach(t=>{const n=r.getAttribute(t,e);null==n||isNaN(n)||(i=Math.min(i,n),a=Math.max(a,n))})}return{start:i,end:a}}function s(e,t,r){if(!t||!e)return null;const{startTimeField:n,endTimeField:s}=e;if(!n&&!s)return null;const{start:i,end:a}=t;return null===i&&null===a?null:void 0===i&&void 0===a?()=>!1:n&&s?function(e,t,r,n,s){return null!=n&&null!=s?i=>{const a=e.getAttribute(i,t),o=e.getAttribute(i,r);return(null==a||a<=s)&&(null==o||o>=n)}:null!=n?t=>{const s=e.getAttribute(t,r);return null==s||s>=n}:null!=s?r=>{const n=e.getAttribute(r,t);return null==n||n<=s}:void 0}(r,n,s,i,a):function(e,t,r,n){return null!=r&&null!=n&&r===n?n=>e.getAttribute(n,t)===r:null!=r&&null!=n?s=>{const i=e.getAttribute(s,t);return i>=r&&i<=n}:null!=r?n=>e.getAttribute(n,t)>=r:null!=n?r=>e.getAttribute(r,t)<=n:void 0}(r,n||s,i,a)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s}))},490:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return u}));var n=r(60),s=r(104),i=r(64);const a={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new s.a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:n.a.WebMercator}),minus180Line:new s.a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:n.a.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new s.a({paths:[[[180,-180],[180,180]]],spatialReference:n.a.WGS84}),minus180Line:new s.a({paths:[[[-180,-180],[-180,180]]],spatialReference:n.a.WGS84})}};function o(e,t){return Math.ceil((e-t)/(2*t))}function u(e,t){const r=c(e);for(const e of r)for(const r of e)r[0]+=t;return e}function c(e){return Object(i.g)(e)?e.rings:e.paths}function l(e){const t=(null==e?void 0:e.isWebMercator)?102100:4326;return[a[t].minX,a[t].maxX]}},491:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},534:function(e,t,r){"use strict";r.d(t,"a",(function(){return _})),r.d(t,"b",(function(){return x})),r.d(t,"c",(function(){return b}));var n=r(16),s=r(83),i=r(323),a=r(365),o=r(64),u=r(140),c=r(105);function l(e,t){return e?t?4:3:t?3:2}function h(e,t,r,n,s){if(!e)return!1;const i=l(t,r),{coords:a,lengths:o}=e;let u=!1,c=0;for(const e of o)u=f(u,a,i,c,e,n,s),c+=e*i;return u}function f(e,t,r,n,s,i,a){let o=e,u=n;for(let e=n,c=n+s*r;e<c;e+=r){u=e+r,u===c&&(u=n);const s=t[e],l=t[e+1],h=t[u],f=t[u+1];(l<a&&f>=a||f<a&&l>=a)&&s+(a-l)/(f-l)*(h-s)<i&&(o=!o)}return o}var d=r(248),p=r(368);const m={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},g={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},y={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},v={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function b(e,t,n,s,f){if(Object(o.g)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=Object(c.e)(new u.a,t,!1,!1);return Promise.resolve(t=>function(e,t,r,n){return h(e,t,r,n.coords[0],n.coords[1])}(e,!1,!1,t))}if(Object(o.g)(t)&&"esriGeometryMultipoint"===n){const r=Object(c.e)(new u.a,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve(e=>function(e,t,r,n,s,i){const a=l(s,i),{coords:o,lengths:u}=n;if(!u)return!1;for(let n=0,s=0;n<u.length;n++,s+=a)if(!h(e,t,r,o[s],o[s+1]))return!1;return!0}(r,!1,!1,e,s,f))}if(Object(o.d)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve(e=>Object(i.e)(t,Object(p.c)(n,s,f,e)));if(Object(o.d)(t)&&"esriGeometryMultipoint"===n&&"esriSpatialRelContains"===e)return Promise.resolve(e=>Object(i.d)(t,Object(p.c)(n,s,f,e)));if(Object(o.d)(t)&&"esriSpatialRelIntersects"===e){const e=Object(a.a)(n);return Promise.resolve(r=>e(t,Object(p.c)(n,s,f,r)))}return Promise.all([r.e(6),r.e(13)]).then(r.bind(null,509)).then(r=>{const i=r[m[e]].bind(null,t.spatialReference,t);return e=>i(Object(p.c)(n,s,f,e))})}async function x(e,t,r){const{spatialRel:i,geometry:a}=e;if(a){if(!0!==g[i])throw new n.a("feature-store:unsupported-query","Unsupported query spatial relationship",{query:e});if(Object(s.i)(a.spatialReference)&&Object(s.i)(r)){if(!function(e){return!0===y[Object(o.c)(e)]}(a))throw new n.a("feature-store:unsupported-query","Unsupported query geometry type",{query:e});if(!function(e){return!0===v[e]}(t))throw new n.a("feature-store:unsupported-query","Unsupported layer geometry type",{query:e});if(e.outSR)return Object(d.a)(e.geometry&&e.geometry.spatialReference,e.outSR)}}}function _(e){if(Object(o.d)(e))return!0;if(Object(o.g)(e)){for(const t of e.rings){if(5!==t.length)return!1;if(t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return!1}return!0}return!1}},63:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(5),s=(r(60),r(123)),i=r(68),a=r(61),o=r(139),u=r(115),c=r(104);r(192),r(64);const l={base:s.a,key:"type",typeMap:{extent:a.a,multipoint:o.a,point:i.a,polyline:c.a,polygon:u.a}};Object(n.k)(l)},64:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return h})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return f}));var n=r(123),s=r(68),i=r(61),a=r(139),o=r(115),u=r(104);function c(e){return void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax}function l(e){return void 0!==e.points}function h(e){return void 0!==e.x&&void 0!==e.y}function f(e){return void 0!==e.paths}function d(e){return void 0!==e.rings}function p(e){return e?e instanceof n.a?e:h(e)?s.a.fromJSON(e):f(e)?u.a.fromJSON(e):d(e)?o.a.fromJSON(e):l(e)?a.a.fromJSON(e):c(e)?i.a.fromJSON(e):null:null}function m(e){return e?h(e)?"esriGeometryPoint":f(e)?"esriGeometryPolyline":d(e)?"esriGeometryPolygon":c(e)?"esriGeometryEnvelope":l(e)?"esriGeometryMultipoint":null:null}const g={esriGeometryPoint:s.a,esriGeometryPolyline:u.a,esriGeometryPolygon:o.a,esriGeometryEnvelope:i.a,esriGeometryMultipoint:a.a};function y(e){return e&&g[e]||null}}});