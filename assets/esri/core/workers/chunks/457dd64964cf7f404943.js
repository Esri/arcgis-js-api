"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[36],{38171:(e,t,i)=>{i.d(t,{Z:()=>y});var s,r=i(43697),a=i(66577),n=i(51773),o=i(78223),l=i(10736),u=i(22974),c=i(70586),p=i(99001),d=i(5600),h=(i(75215),i(52011)),f=i(33955);let m=s=class extends l.wq{constructor(...e){super(...e),this.isAggregate=!1,this.layer=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:(0,p.D)(),configurable:!0})}normalizeCtorArgs(e,t,i,s){return e&&!e.declaredClass?e:{geometry:e,symbol:t,attributes:i,popupTemplate:s}}set attributes(e){const t=this._get("attributes");t!==e&&(this._set("attributes",e),this._notifyLayer("attributes",t,e))}set geometry(e){const t=this._get("geometry");t!==e&&(this._set("geometry",e),this._notifyLayer("geometry",t,e))}set symbol(e){const t=this._get("symbol");t!==e&&(this._set("symbol",e),this._notifyLayer("symbol",t,e))}set visible(e){const t=this._get("visible");t!==e&&(this._set("visible",e),this._notifyLayer("visible",t,e))}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;for(const t of[this.sourceLayer,this.layer])if(t){if("popupTemplate"in t&&t.popupTemplate)return t.popupTemplate;if(e&&"defaultPopupTemplate"in t&&(0,c.pC)(t.defaultPopupTemplate))return t.defaultPopupTemplate}return null}getAttribute(e){return this.attributes&&this.attributes[e]}setAttribute(e,t){if(this.attributes){const i=this.getAttribute(e);this.attributes[e]=t,this._notifyLayer("attributes",i,t,e)}else this.attributes={[e]:t},this._notifyLayer("attributes",void 0,t,e)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{geometry:(0,c.pC)(this.geometry)?this.geometry.toJSON():null,symbol:(0,c.pC)(this.symbol)?this.symbol.toJSON():null,attributes:{...this.attributes},popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}clone(){return new s(this.cloneProperties())}notifyGeometryChanged(){this._notifyLayer("geometry",this.geometry,this.geometry)}cloneProperties(){return{attributes:(0,u.d9)(this.attributes),geometry:(0,u.d9)(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),sourceLayer:this.sourceLayer,symbol:(0,u.d9)(this.symbol),visible:this.visible}}_notifyLayer(e,t,i,s){if(!this.layer||!("graphicChanged"in this.layer))return;const r={graphic:this,property:e,oldValue:t,newValue:i};"attributes"===e&&(r.attributeName=s),this.layer.graphicChanged(r)}};(0,r._)([(0,d.Cb)({value:null})],m.prototype,"attributes",null),(0,r._)([(0,d.Cb)({value:null,types:a.qM,json:{read:f.im}})],m.prototype,"geometry",null),(0,r._)([(0,d.Cb)({type:Boolean})],m.prototype,"isAggregate",void 0),(0,r._)([(0,d.Cb)()],m.prototype,"layer",void 0),(0,r._)([(0,d.Cb)({type:n.Z})],m.prototype,"popupTemplate",void 0),(0,r._)([(0,d.Cb)()],m.prototype,"sourceLayer",void 0),(0,r._)([(0,d.Cb)({value:null,types:o.LB})],m.prototype,"symbol",null),(0,r._)([(0,d.Cb)({type:Boolean,value:!0})],m.prototype,"visible",null),m=s=(0,r._)([(0,h.j)("esri.Graphic")],m),(m||(m={})).generateUID=p.D;const y=m},74085:(e,t,i)=>{function s(e){}i.d(t,{Bg:()=>s}),i(80442)},12501:(e,t,i)=>{i.r(t),i.d(t,{default:()=>S});var s,r=i(43697),a=i(22303),n=i(3172),o=i(20102),l=i(22974),u=i(92604),c=i(13867),p=i(70586),d=i(95330),h=i(19153),f=i(5600),m=(i(75215),i(52011)),y=i(30556),b=i(35671),g=i(5499),v=i(12571),x=i(59266),V=i(17386);const w=u.Z.getLogger("esri.renderers.DictionaryRenderer"),_={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let C=s=class extends((0,v.W)(g.Z)){constructor(e){super(e),this._ongoingRequests=new Map,this._symbolCache=new c.Z(100),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}writeData(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,t,i,s){null!=s&&s.origin||super.writeVisualVariables(e,t,i,s)}clone(){return new s({config:(0,l.d9)(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:(0,l.d9)(this.fieldMap),url:(0,l.d9)(this.url),visualVariables:(0,l.d9)(this.visualVariables)})}async getSymbolAsync(e,t){let i;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(t));try{i=await this._dictionaryPromise}catch(e){if((0,d.D_)(e))return this._dictionaryPromise=null,null}const s={};if(this.fieldMap)for(const t of this._symbolFields){const i=this.fieldMap[t];if(i&&null!==e.attributes[i]&&void 0!==e.attributes[i]){const r=""+e.attributes[i];s[t]=r}else s[t]=""}const r=i(s,t);if(!r||"string"!=typeof r)return null;const n=(0,h.hP)(r).toString(),o=this._symbolCache.get(n);if(o)return o.catch((()=>{this._symbolCache.pop(n)})),o;const l=r.split(";"),u=[],c=[];for(const e of l)if(e&&0!==e.length)if(-1===e.indexOf("po:"))if(-1!==e.indexOf("|")){for(const t of e.split("|"))if(this._itemNames.has(t)){u.push(t);break}}else this._itemNames.has(e)&&u.push(e);else{const t=e.substr(3).split("|");if(3===t.length){const e=t[0],i=t[1];let s=t[2];if("DashTemplate"===i)s=s.split(" ").map((e=>Number(e)));else if("Color"===i){const e=new a.Z(s).toRgba();s=[e[0],e[1],e[2],255*e[3]]}else s=Number(s);c.push({primitiveName:e,propertyName:i,value:s})}}const f=!(0,p.pC)(e.geometry)||!e.geometry.hasZ&&"point"===e.geometry.type,m=this._cimPartsToCIMSymbol(u,c,f,t);return this._symbolCache.put(n,m,1),m}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t),this.scaleExpression&&await(0,b.io)(e,t,this.scaleExpression);for(const i in this.fieldMap){const s=this.fieldMap[i];t.has(s)&&e.add(s)}}get arcadeRequired(){return!0}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void w.error("no valid URL!");const t=(0,p.pC)(e)?e.abortOptions:null,i=(0,n.default)(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},...t}),[{data:s}]=await Promise.all([i,(0,x.LC)()]);if(!s)throw this._dictionaryPromise=null,new o.Z("esri.renderers.DictionaryRenderer","Bad dictionary data!");const r=s.expression,a=s.authoringInfo;this._refSymbolUrlTemplate=this.url+"/"+s.cimRefTemplateUrl,this._itemNames=new Set(s.itemsNames),this._symbolFields=a.symbol;const l={};if(this.config){const e=this.config;for(const t in e)l[t]=e[t]}if(a.configuration)for(const e of a.configuration)l.hasOwnProperty(e.name)||(l[e.name]=e.value);const u=[];if((0,p.pC)(e)&&e.fields&&this.fieldMap)for(const t of this._symbolFields){const i=this.fieldMap[t],s=e.fields.filter((e=>e.name===i));s.length>0&&u.push({...s[0],name:t})}return this._dictionaryPromise=(0,x.pp)(r,(0,p.pC)(e)?e.spatialReference:null,u,l).then((e=>{const t={scale:0};return(i,s)=>{const r=e.repurposeFeature({geometry:null,attributes:i});return t.scale=(0,p.pC)(s)?s.scale:void 0,e.evaluate({$feature:r,$view:t})}})).catch((e=>(w.error("Creating dictinoary expression failed:",e),null))),this._dictionaryPromise}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._symbolFields}async _getSymbolPart(e,t){if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then((e=>e.data));const i=this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,e),s=(0,n.default)(i,{responseType:"json",query:{f:"json"},...t});this._ongoingRequests.set(e,s);try{return(await s).data}catch(t){return this._ongoingRequests.delete(e),Promise.reject(t)}}_combineSymbolParts(e,t,i){if(!e||0===e.length)return null;const s={...e[0]};if(e.length>1){s.symbolLayers=[];for(const t of e){const e=t;s.symbolLayers.unshift(...e.symbolLayers)}}return i&&(s.callout=_),{type:"CIMSymbolReference",symbol:s,primitiveOverrides:t}}async _cimPartsToCIMSymbol(e,t,i,s){const r=new Array(e.length);for(let t=0;t<e.length;t++)r[t]=this._getSymbolPart(e[t],s);const a=await Promise.all(r);return new V.Z({data:this._combineSymbolParts(a,t,i)})}};(0,r._)([(0,f.Cb)({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],C.prototype,"config",void 0),(0,r._)([(0,f.Cb)({type:Object,json:{write:!0}})],C.prototype,"fieldMap",void 0),(0,r._)([(0,f.Cb)({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],C.prototype,"scaleExpression",void 0),(0,r._)([(0,y.c)("scaleExpression")],C.prototype,"writeData",null),(0,r._)([(0,f.Cb)({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],C.prototype,"scaleExpressionTitle",void 0),(0,r._)([(0,f.Cb)({type:String,json:{write:!0}})],C.prototype,"url",void 0),(0,r._)([(0,y.c)("visualVariables")],C.prototype,"writeVisualVariables",null),C=s=(0,r._)([(0,m.j)("esri.renderers.DictionaryRenderer")],C);const S=C},99282:(e,t,i)=>{i.d(t,{a:()=>a});var s=i(67900),r=i(68441);const a={inches:(0,s.En)(1,"meters","inches"),feet:(0,s.En)(1,"meters","feet"),"us-feet":(0,s.En)(1,"meters","us-feet"),yards:(0,s.En)(1,"meters","yards"),miles:(0,s.En)(1,"meters","miles"),"nautical-miles":(0,s.En)(1,"meters","nautical-miles"),millimeters:(0,s.En)(1,"meters","millimeters"),centimeters:(0,s.En)(1,"meters","centimeters"),decimeters:(0,s.En)(1,"meters","decimeters"),meters:(0,s.En)(1,"meters","meters"),kilometers:(0,s.En)(1,"meters","kilometers"),"decimal-degrees":1/(0,s.ty)(1,"meters",r.sv.radius)}},51706:(e,t,i)=>{function s(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function r(e){return null!=e&&!isNaN(e)&&isFinite(e)}function a(e){return e.valueExpression?"expression":e.field&&"string"==typeof e.field?"field":"unknown"}function n(e,t){const i=t||a(e),s=e.valueUnit||"unknown";return"unknown"===i?"constant":e.stops?"stops":null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?"clamped-linear":"unknown"===s?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?"proportional":"additive":"identity":"real-world-size"}i.d(t,{PS:()=>a,QW:()=>n,iY:()=>s,qh:()=>r})},28101:(e,t,i)=>{i.d(t,{PR:()=>w,Lq:()=>f,Km:()=>m,cM:()=>y,ap:()=>b,V3:()=>x,B3:()=>h});var s=i(22303),r=i(38171),a=i(74085),n=i(92604),o=i(70586),l=i(99282),u=i(51706);const c=n.Z.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),p=new r.Z,d=Math.PI,h=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function f(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"color"===e.type))[0]:e;if(!r)return;if("esri.renderers.visualVariables.ColorVariable"!==r.declaredClass)return void c.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const a="number"==typeof t,n=a?null:t,l=n&&n.attributes;let u=a?t:null;const p=r.field,{ipData:d,hasExpression:h}=r.cache;let f=r.cache.compiledFunc;if(!p&&!h){const e=r.stops;return e&&e[0]&&e[0].color}if("number"!=typeof u)if(h){if(!(0,o.pC)(i)||!(0,o.pC)(i.arcade))return void c.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,s=t.getViewInfo(e),a=t.createExecContext(n,s);if(!f){const e=t.createSyntaxTree(r.valueExpression);f=t.createFunction(e),r.cache.compiledFunc=f}u=t.executeFunction(f,a)}else l&&(u=l[p]);const m=r.normalizationField,y=l?parseFloat(l[m]):void 0;if(null!=u&&(!m||a||!isNaN(y)&&0!==y)){isNaN(y)||a||(u/=y);const e=V(u,d);if(e){const t=e[0],a=e[1],n=t===a?r.stops[t].color:s.Z.blendColors(r.stops[t].color,r.stops[a].color,e[2],(0,o.pC)(i)?i.color:void 0);return new s.Z(n)}}}function m(e,t,i){const s="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"opacity"===e.type))[0]:e;if(!s)return;if("esri.renderers.visualVariables.OpacityVariable"!==s.declaredClass)return void c.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const r="number"==typeof t,a=r?null:t,n=a&&a.attributes;let l=r?t:null;const u=s.field,{ipData:p,hasExpression:d}=s.cache;let h=s.cache.compiledFunc;if(!u&&!d){const e=s.stops;return e&&e[0]&&e[0].opacity}if("number"!=typeof l)if(d){if((0,o.Wi)(i)||(0,o.Wi)(i.arcade))return void c.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,r=t.getViewInfo(e),n=t.createExecContext(a,r);if(!h){const e=t.createSyntaxTree(s.valueExpression);h=t.createFunction(e),s.cache.compiledFunc=h}l=t.executeFunction(h,n)}else n&&(l=n[u]);const f=s.normalizationField,m=n?parseFloat(n[f]):void 0;if(null!=l&&(!f||r||!isNaN(m)&&0!==m)){isNaN(m)||r||(l/=m);const e=V(l,p);if(e){const t=e[0],i=e[1];if(t===i)return s.stops[t].opacity;{const r=s.stops[t].opacity;return r+(s.stops[i].opacity-r)*e[2]}}}}function y(e,t,i){const s="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"rotation"===e.type))[0]:e;if(!s)return;if("esri.renderers.visualVariables.RotationVariable"!==s.declaredClass)return void c.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const r=s.axis||"heading",a="heading"===r&&"arithmetic"===s.rotationType?90:0,n="heading"===r&&"arithmetic"===s.rotationType?-1:1,l="number"==typeof t?null:t,u=l&&l.attributes,p=s.field,{hasExpression:d}=s.cache;let h=s.cache.compiledFunc,f=0;if(!p&&!d)return f;if(d){if((0,o.Wi)(i)||(0,o.Wi)(i.arcade))return void c.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,r=t.getViewInfo(e),a=t.createExecContext(l,r);if(!h){const e=t.createSyntaxTree(s.valueExpression);h=t.createFunction(e),s.cache.compiledFunc=h}f=t.executeFunction(h,a)}else u&&(f=u[p]||0);return f="number"!=typeof f||isNaN(f)?null:a+n*f,f}function b(e,t,i){const s="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"size"===e.type))[0]:e;if(!s)return;if("esri.renderers.visualVariables.SizeVariable"!==s.declaredClass)return void c.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const r=function(e,t,i,s,r){switch(t.transformationType){case"additive":return function(e,t,i,s){return e+(g(t.minSize,i,s)||t.minDataValue)}(e,t,i,s);case"constant":return function(e,t,i){const s=e.stops;let r=s&&s.length&&s[0].size;return null==r&&(r=e.minSize),g(r,t,i)}(t,i,s);case"clamped-linear":return function(e,t,i,s){const r=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),a=g(t.minSize,i,s),n=g(t.maxSize,i,s),l=(0,o.pC)(s)?s.shape:void 0;if(e<=t.minDataValue)return a;if(e>=t.maxDataValue)return n;if("area"===t.scaleBy&&l){const e="circle"===l,t=e?d*(a/2)**2:a*a,i=t+r*((e?d*(n/2)**2:n*n)-t);return e?2*Math.sqrt(i/d):Math.sqrt(i)}return a+r*(n-a)}(e,t,i,s);case"proportional":return function(e,t,i,s){const r=(0,o.pC)(s)?s.shape:void 0,a=e/t.minDataValue,n=g(t.minSize,i,s),l=g(t.maxSize,i,s);let u=null;return u="circle"===r?2*Math.sqrt(a*(n/2)**2):"square"===r||"diamond"===r||"image"===r?Math.sqrt(a*n**2):a*n,v(u,n,l)}(e,t,i,s);case"stops":return function(e,t,i,s,r){const[a,n,o]=V(e,r);if(a===n)return g(t.stops[a].size,i,s);{const e=g(t.stops[a].size,i,s);return e+(g(t.stops[n].size,i,s)-e)*o}}(e,t,i,s,r);case"real-world-size":return function(e,t,i,s){const r=((0,o.pC)(s)&&s.resolution?s.resolution:1)*l.a[t.valueUnit],a=g(t.minSize,i,s),n=g(t.maxSize,i,s),{valueRepresentation:u}=t;let c=null;return c="area"===u?2*Math.sqrt(e/d)/r:"radius"===u||"distance"===u?2*e/r:e/r,v(c,a,n)}(e,t,i,s);case"identity":return e;case"unknown":return null}}(function(e,t,i){const s="number"==typeof t,r=s?null:t,a=r&&r.attributes;let n=s?t:null;const{isScaleDriven:l}=e.cache;let p=e.cache.compiledFunc;if(l){const t=(0,o.pC)(i)?i.scale:void 0,s=(0,o.pC)(i)?i.view:void 0;n=null==t||"3d"===s?function(e){let t=null,i=null;const s=e.stops;return s?(t=s[0].value,i=s[s.length-1].value):(t=e.minDataValue||0,i=e.maxDataValue||0),(t+i)/2}(e):t}else if(!s)switch(e.inputValueType){case"expression":{if((0,o.Wi)(i)||(0,o.Wi)(i.arcade))return void c.error("Use of arcade expressions requires an arcade context");const t={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},s=i.arcade.arcadeUtils,a=s.getViewInfo(t),l=s.createExecContext(r,a);if(!p){const t=s.createSyntaxTree(e.valueExpression);p=s.createFunction(t),e.cache.compiledFunc=p}n=s.executeFunction(p,l);break}case"field":a&&(n=a[e.field]);break;case"unknown":n=null}if(!(0,u.qh)(n))return null;if(s||!e.normalizationField)return n;const d=a?parseFloat(a[e.normalizationField]):null;return(0,u.qh)(d)&&0!==d?n/d:null}(s,t,i),s,t,i,s.cache.ipData);return null==r||isNaN(r)?0:r}function g(e,t,i){return null==e?null:(0,u.iY)(e)?b(e,t,i):(0,u.qh)(e)?e:null}function v(e,t,i){return(0,u.qh)(i)&&e>i?i:(0,u.qh)(t)&&e<t?t:e}function x(e,t,i){const{isScaleDriven:s}=e.cache;if(!(s&&"3d"===i||t))return null;const r={scale:t,view:i};let a=g(e.minSize,p,r),n=g(e.maxSize,p,r);if(null!=a||null!=n){if(a>n){const e=n;n=a,a=e}return{minSize:a,maxSize:n}}}function V(e,t){if(!t)return;let i=0,s=t.length-1;return t.some(((t,r)=>e<t?(s=r,!0):(i=r,!1))),[i,s,(e-t[i])/(t[s]-t[i])]}function w(e,t,i){const s=["proportional","proportional","proportional"];for(const r of e){const e=r.useSymbolValue?"symbol-value":b(r,t,i);switch(r.axis){case"width":s[0]=e;break;case"depth":s[1]=e;break;case"height":s[2]=e;break;case"width-and-depth":s[0]=e,s[1]=e;break;case"all":case void 0:case null:s[0]=e,s[1]=e,s[2]=e;break;default:(0,a.Bg)(r.axis)}}return s}}}]);