"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[934],{46521:(t,e,n)=>{function o(){return[1,0,0,0,1,0,0,0,1]}function r(t,e){return new Float64Array(t,e,9)}n.d(e,{a:()=>r,c:()=>o}),Object.freeze(Object.defineProperty({__proto__:null,create:o,clone:function(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},fromValues:function(t,e,n,o,r,i,s,c,u){return[t,e,n,o,r,i,s,c,u]},createView:r},Symbol.toStringTag,{value:"Module"}))},13598:(t,e,n)=>{function o(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function r(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function i(t,e){return new Float64Array(t,e,16)}n.d(e,{I:()=>s,a:()=>i,b:()=>r,c:()=>o});const s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,create:o,clone:r,fromValues:function(t,e,n,o,r,i,s,c,u,a,d,h,l,f,_,T){return[t,e,n,o,r,i,s,c,u,a,d,h,l,f,_,T]},createView:i,IDENTITY:s},Symbol.toStringTag,{value:"Module"}))},94961:(t,e,n)=>{function o(){return[0,0,0,1]}function r(t){return[t[0],t[1],t[2],t[3]]}function i(t,e){return new Float64Array(t,e,4)}n.d(e,{I:()=>s,a:()=>o,b:()=>r,c:()=>i});const s=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,create:o,clone:r,fromValues:function(t,e,n,o){return[t,e,n,o]},createView:i,IDENTITY:s},Symbol.toStringTag,{value:"Module"}))},29268:(t,e,n)=>{n.d(e,{b:()=>p,c:()=>g,d:()=>O,g:()=>b,i:()=>R,m:()=>j}),n(80442);var o,r,i=n(92604),s=n(22021),c=n(70586),u=n(52138),a=n(17896),d=n(65617),h=n(98766),l=n(88669);(r=o||(o={}))[r.X=0]="X",r[r.Y=1]="Y",r[r.Z=2]="Z";var f=n(78341),_=n(61277),T=n(12981);const m=i.Z.getLogger("esri.geometry.support.sphere");function g(){return(0,l.c)()}function p(t,e=g()){return(0,h.c)(e,t)}function O(t){return t[3]}function b(t){return t}function E(t,e,n){if((0,c.Wi)(e))return!1;const{origin:o,direction:r}=e,i=N;i[0]=o[0]-t[0],i[1]=o[1]-t[1],i[2]=o[2]-t[2];const s=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],u=2*(r[0]*i[0]+r[1]*i[1]+r[2]*i[2]),a=u*u-4*s*(i[0]*i[0]+i[1]*i[1]+i[2]*i[2]-t[3]*t[3]);if(a<0)return!1;const d=Math.sqrt(a);let h=(-u-d)/(2*s);const l=(-u+d)/(2*s);return(h<0||l<h&&l>0)&&(h=l),!(h<0||(n&&(n[0]=o[0]+r[0]*h,n[1]=o[1]+r[1]*h,n[2]=o[2]+r[2]*h),0))}const N=(0,d.c)();function R(t,e){return E(t,e,null)}function M(t,e,n){const o=T.WM.get(),r=T.MP.get();(0,a.f)(o,e.origin,e.direction);const i=O(t);(0,a.f)(n,o,e.origin),(0,a.g)(n,n,1/(0,a.l)(n)*i);const s=F(t,e.origin),c=(0,_.EU)(e.origin,n);return(0,u.d)(r,c+s,o),(0,a.m)(n,n,r),n}function A(t,e,n){const o=(0,a.b)(T.WM.get(),e,t),r=(0,a.g)(T.WM.get(),o,t[3]/(0,a.l)(o));return(0,a.a)(n,r,t)}function F(t,e){const n=(0,a.b)(T.WM.get(),e,t),o=(0,a.l)(n),r=O(t),i=r+Math.abs(r-o);return(0,s.ZF)(r/i)}const I=(0,d.c)();function S(t,e,n,r){const i=(0,a.b)(I,e,t);switch(n){case o.X:{const t=(0,s.jE)(i,I)[2];return(0,a.s)(r,-Math.sin(t),Math.cos(t),0)}case o.Y:{const t=(0,s.jE)(i,I),e=t[1],n=t[2],o=Math.sin(e);return(0,a.s)(r,-o*Math.cos(n),-o*Math.sin(n),Math.cos(e))}case o.Z:return(0,a.n)(r,i);default:return}}function x(t,e){const n=(0,a.b)(y,e,t);return(0,a.l)(n)-t[3]}function j(t,e){const n=(0,a.d)(t,e),o=O(t);return n<=o*o}const y=(0,d.c)(),P=g();Object.freeze(Object.defineProperty({__proto__:null,create:g,copy:p,fromCenterAndRadius:function(t,e){return(0,l.f)(t[0],t[1],t[2],e)},wrap:function(t){return t},clear:function(t){t[0]=t[1]=t[2]=t[3]=0},fromRadius:function(t,e){return t[0]=t[1]=t[2]=0,t[3]=e,t},getRadius:O,getCenter:b,fromValues:function(t,e,n,o){return(0,l.f)(t,e,n,o)},elevate:function(t,e,n){return t!==n&&(0,a.c)(n,t),n[3]=t[3]+e,n},setExtent:function(t,e,n){return m.error("sphere.setExtent is not yet supported"),t===n?n:p(t,n)},intersectRay:E,intersectsRay:R,intersectRayClosestSilhouette:function(t,e,n){if(E(t,e,n))return n;const o=M(t,e,T.WM.get());return(0,a.a)(n,e.origin,(0,a.g)(T.WM.get(),e.direction,(0,a.i)(e.origin,o)/(0,a.l)(e.direction))),n},closestPointOnSilhouette:M,closestPoint:function(t,e,n){return E(t,e,n)?n:((0,f.JI)(e,t,n),A(t,n,n))},projectPoint:A,distanceToSilhouette:function(t,e){const n=(0,a.b)(T.WM.get(),e,t),o=(0,a.p)(n),r=t[3]*t[3];return Math.sqrt(Math.abs(o-r))},angleToSilhouette:F,axisAt:S,altitudeAt:x,setAltitudeAt:function(t,e,n,r){const i=x(t,e),s=S(t,e,o.Z,y),c=(0,a.g)(y,s,n-i);return(0,a.a)(r,e,c)},containsPoint:j,tmpSphere:P},Symbol.toStringTag,{value:"Module"}))},88669:(t,e,n)=>{function o(){return[0,0,0,0]}function r(t,e,n,o){return[t,e,n,o]}function i(t,e){return new Float64Array(t,e,4)}function s(){return r(1,1,1,1)}function c(){return r(1,0,0,0)}function u(){return r(0,1,0,0)}function a(){return r(0,0,1,0)}function d(){return r(0,0,0,1)}n.d(e,{a:()=>i,c:()=>o,f:()=>r});const h=s(),l=c(),f=u(),_=a(),T=d();Object.freeze(Object.defineProperty({__proto__:null,create:o,clone:function(t){return[t[0],t[1],t[2],t[3]]},fromValues:r,fromArray:function(t){const e=[0,0,0,0],n=Math.min(4,t.length);for(let o=0;o<n;++o)e[o]=t[o];return e},createView:i,zeros:function(){return[0,0,0,0]},ones:s,unitX:c,unitY:u,unitZ:a,unitW:d,ZEROS:[0,0,0,0],ONES:h,UNIT_X:l,UNIT_Y:f,UNIT_Z:_,UNIT_W:T},Symbol.toStringTag,{value:"Module"}))},78341:(t,e,n)=>{n.d(e,{JI:()=>u,Ue:()=>s,re:()=>c}),n(67676);var o=n(22807),r=n(17896),i=n(65617);function s(t){return t?{origin:(0,i.a)(t.origin),direction:(0,i.a)(t.direction)}:{origin:(0,i.c)(),direction:(0,i.c)()}}function c(t,e){const n=a.get();return n.origin=t,n.direction=e,n}function u(t,e,n){const o=(0,r.e)(t.direction,(0,r.b)(n,e,t.origin));return(0,r.a)(n,t.origin,(0,r.g)(n,t.direction,o)),n}n(12981);const a=new o.x((function(){return{origin:null,direction:null}}))},61277:(t,e,n)=>{n.d(e,{EU:()=>s});var o=n(22021),r=n(17896),i=n(65617);function s(t,e){const n=(0,r.e)(t,e)/((0,r.l)(t)*(0,r.l)(e));return-(0,o.ZF)(n)}(0,i.c)(),(0,i.c)()},11726:(t,e,n)=>{n.d(e,{hu:()=>r,yK:()=>i}),n(97323),n(98766),(0,n(88669).c)();class o{constructor(t){this.message=t}toString(){return`AssertException: ${this.message}`}}function r(t,e){if(!t)throw e=e||"assert",console.log(new Error(e).stack),new o(e)}function i(t,e,n,o){let r,i=(n[0]-t[0])/e[0],s=(o[0]-t[0])/e[0];i>s&&(r=i,i=s,s=r);let c=(n[1]-t[1])/e[1],u=(o[1]-t[1])/e[1];if(c>u&&(r=c,c=u,u=r),i>u||c>s)return!1;c>i&&(i=c),u<s&&(s=u);let a=(n[2]-t[2])/e[2],d=(o[2]-t[2])/e[2];return a>d&&(r=a,a=d,d=r),!(i>d||a>s||(d<s&&(s=d),s<0))}},40614:(t,e,n)=>{n.r(e),n.d(e,{SceneLayerSnappingSourceWorker:()=>Q,default:()=>tt});var o,r,i,s,c,u,a,d=n(43697),h=n(70586),l=n(95330),f=(n(92604),n(75215),n(67676),n(80442),n(37697),n(52011)),_=n(17896),T=n(65617),m=n(16996),g=n(29268),p=n(98370),O=n(71143),b=n(44553),E=n(22807),N=(n(52138),n(98766),n(88669)),R=n(78341);function M(t,e){for(let n=0;n<u.NUM;n++){const o=t[n];if(o[0]*e[0]+o[1]*e[1]+o[2]*e[2]+o[3]>=e[3])return!1}return!0}n(12981),new E.x((()=>({c0:0,c1:0,ray:null}))),n(22021),n(61277),(0,T.c)(),(0,T.c)(),(0,T.c)(),(0,T.c)(),(0,T.c)(),(0,T.c)(),(0,T.c)(),(0,T.c)(),(0,T.c)(),(0,T.c)(),(r=o||(o={}))[r.NONE=0]="NONE",r[r.CLAMP=1]="CLAMP",r[r.INFINITE_MIN=4]="INFINITE_MIN",r[r.INFINITE_MAX=8]="INFINITE_MAX",o.INFINITE_MIN,o.INFINITE_MAX,o.INFINITE_MAX,(c=i||(i={}))[c.LEFT=0]="LEFT",c[c.RIGHT=1]="RIGHT",c[c.BOTTOM=2]="BOTTOM",c[c.TOP=3]="TOP",c[c.NEAR=4]="NEAR",c[c.FAR=5]="FAR",function(t){t[t.NEAR_BOTTOM_LEFT=0]="NEAR_BOTTOM_LEFT",t[t.NEAR_BOTTOM_RIGHT=1]="NEAR_BOTTOM_RIGHT",t[t.NEAR_TOP_RIGHT=2]="NEAR_TOP_RIGHT",t[t.NEAR_TOP_LEFT=3]="NEAR_TOP_LEFT",t[t.FAR_BOTTOM_LEFT=4]="FAR_BOTTOM_LEFT",t[t.FAR_BOTTOM_RIGHT=5]="FAR_BOTTOM_RIGHT",t[t.FAR_TOP_RIGHT=6]="FAR_TOP_RIGHT",t[t.FAR_TOP_LEFT=7]="FAR_TOP_LEFT"}(s||(s={})),s.FAR_BOTTOM_RIGHT,s.NEAR_BOTTOM_RIGHT,s.NEAR_BOTTOM_LEFT,s.FAR_BOTTOM_LEFT,s.NEAR_BOTTOM_LEFT,s.NEAR_BOTTOM_RIGHT,s.NEAR_TOP_RIGHT,s.NEAR_TOP_LEFT,s.FAR_BOTTOM_RIGHT,s.FAR_BOTTOM_LEFT,s.FAR_TOP_LEFT,s.FAR_TOP_RIGHT,s.NEAR_BOTTOM_RIGHT,s.FAR_BOTTOM_RIGHT,s.FAR_TOP_RIGHT,s.NEAR_TOP_RIGHT,s.FAR_BOTTOM_LEFT,s.NEAR_BOTTOM_LEFT,s.NEAR_TOP_LEFT,s.FAR_TOP_LEFT,s.FAR_TOP_LEFT,s.NEAR_TOP_LEFT,s.NEAR_TOP_RIGHT,s.FAR_TOP_RIGHT,function(t){t[t.NUM=6]="NUM"}(u||(u={})),function(t){t[t.NUM=8]="NUM"}(a||(a={})),(0,N.f)(-1,-1,-1,1),(0,N.f)(1,-1,-1,1),(0,N.f)(1,1,-1,1),(0,N.f)(-1,1,-1,1),(0,N.f)(-1,-1,1,1),(0,N.f)(1,-1,1,1),(0,N.f)(1,1,1,1),(0,N.f)(-1,1,1,1),new E.x((function(t){return t?{ray:(0,R.Ue)(t.ray),c0:t.c0,c1:t.c1}:{ray:(0,R.Ue)(),c0:0,c1:Number.MAX_VALUE}})),(0,T.c)(),(0,T.c)(),(0,T.c)(),(0,T.c)(),(0,T.c)(),(0,T.c)(),(0,T.c)(),(0,T.c)();var A=n(11726);class F{constructor(t,e){this._objectToBoundingSphere=t,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new I,this._objectCount=0,e&&(void 0!==e.maximumObjectsPerNode&&(this._maximumObjectsPerNode=e.maximumObjectsPerNode),void 0!==e.maximumDepth&&(this._maximumDepth=e.maximumDepth))}get bounds(){return this._root.bounds}get halfSize(){return this._root.halfSize}get root(){return this._root.node}get maximumObjectsPerNode(){return this._maximumObjectsPerNode}get maximumDepth(){return this._maximumDepth}get objectCount(){return this._objectCount}destroy(){this._degenerateObjects.clear(),I.clearPool(),z[0]=null,W.prune(),K.prune()}add(t,e=t.length){this._objectCount+=e,this._grow(t,e);const n=I.acquire();for(let o=0;o<e;o++){const e=t[o];this._isDegenerate(e)?this._degenerateObjects.add(e):(n.init(this._root),this._add(e,n))}I.release(n)}remove(t,e=null){this._objectCount-=t.length;const n=I.acquire();for(const o of t){const t=(0,h.pC)(e)?e:(0,g.b)(this._objectToBoundingSphere(o),k);w(t[3])?(n.init(this._root),this._remove(o,t,n)):this._degenerateObjects.delete(o)}I.release(n),this._shrink()}update(t,e){if(!w(e[3])&&this._isDegenerate(t))return;const n=function(t){return z[0]=t,z}(t);this.remove(n,e),this.add(n)}forEachAlongRay(t,e,n){const o=(0,R.re)(t,e);this._forEachNode(this._root,(t=>{if(!this._intersectsNode(o,t))return!1;const e=t.node;return e.terminals.forAll((t=>{this._intersectsObject(o,t)&&n(t)})),null!==e.residents&&e.residents.forAll((t=>{this._intersectsObject(o,t)&&n(t)})),!0}))}forEachAlongRayWithVerticalOffset(t,e,n,o){const r=(0,R.re)(t,e);this._forEachNode(this._root,(t=>{if(!this._intersectsNodeWithOffset(r,t,o))return!1;const e=t.node;return e.terminals.forAll((t=>{this._intersectsObjectWithOffset(r,t,o)&&n(t)})),null!==e.residents&&e.residents.forAll((t=>{this._intersectsObjectWithOffset(r,t,o)&&n(t)})),!0}))}forEach(t){this._forEachNode(this._root,(e=>{const n=e.node;return n.terminals.forAll(t),null!==n.residents&&n.residents.forAll(t),!0})),this._degenerateObjects.forEach(t)}forEachDegenerateObject(t){this._degenerateObjects.forEach(t)}findClosest(t,e,n,o=(()=>!0),r=1/0){let i=1/0,s=1/0,c=null;const u=P(t,e),a=u=>{if(--r,!o(u))return;const a=this._objectToBoundingSphere(u);if(!M(n,a))return;const d=L(t,e,(0,g.g)(a)),h=d-a[3],l=d+a[3];h<i&&(i=h,s=l,c=u)};return this._forEachNodeDepthOrdered(this._root,(o=>{if(r<=0||!M(n,o.bounds))return!1;if((0,_.g)(G,u,o.halfSize),(0,_.a)(G,G,o.bounds),L(t,e,G)>s)return!1;const i=o.node;return i.terminals.forAll((t=>a(t))),null!==i.residents&&i.residents.forAll((t=>a(t))),!0}),t,e),c}forEachInDepthRange(t,e,n,o,r,i,s){let c=-1/0,u=1/0;const a={setRange:t=>{n===F.DepthOrder.FRONT_TO_BACK?(c=Math.max(c,t.near),u=Math.min(u,t.far)):(c=Math.max(c,-t.far),u=Math.min(u,-t.near))}};a.setRange(o);const d=L(e,n,t),h=P(e,n),l=P(e,-n),f=t=>{if(!s(t))return;const o=this._objectToBoundingSphere(t),h=(0,g.g)(o),l=L(e,n,h)-d,f=l-o[3],_=l+o[3];f>u||_<c||!M(i,o)||r(t,a)};this._forEachNodeDepthOrdered(this._root,(t=>{if(!M(i,t.bounds))return!1;if((0,_.g)(G,h,t.halfSize),(0,_.a)(G,G,t.bounds),L(e,n,G)-d>u)return!1;if((0,_.g)(G,l,t.halfSize),(0,_.a)(G,G,t.bounds),L(e,n,G)-d<c)return!1;const o=t.node;return o.terminals.forAll((t=>f(t))),null!==o.residents&&o.residents.forAll((t=>f(t))),!0}),e,n)}forEachNode(t){this._forEachNode(this._root,(e=>t(e.node,e.bounds,e.halfSize)))}forEachNeighbor(t,e){const n=(0,g.d)(e),o=(0,g.g)(e),r=e=>{const r=this._objectToBoundingSphere(e),i=(0,g.d)(r),s=n+i;(0,_.d)((0,g.g)(r),o)-s*s<=0&&t(e)};this._forEachNode(this._root,(t=>{const e=(0,g.d)(t.bounds),i=n+e;if((0,_.d)((0,g.g)(t.bounds),o)-i*i>0)return!1;const s=t.node;return s.terminals.forAll((t=>r(t))),null!==s.residents&&s.residents.forAll((t=>r(t))),!0})),this.forEachDegenerateObject(r)}_intersectsNode(t,e){return j(e.bounds,2*-e.halfSize,H),j(e.bounds,2*e.halfSize,V),(0,A.yK)(t.origin,t.direction,H,V)}_intersectsNodeWithOffset(t,e,n){return j(e.bounds,2*-e.halfSize,H),j(e.bounds,2*e.halfSize,V),n.applyToMinMax(H,V),(0,A.yK)(t.origin,t.direction,H,V)}_intersectsObject(t,e){const n=this._objectToBoundingSphere(e);return!(n[3]>0)||(0,g.i)(n,t)}_intersectsObjectWithOffset(t,e,n){const o=this._objectToBoundingSphere(e);return!(o[3]>0)||(0,g.i)(n.applyToBoundingSphere(o),t)}_forEachNode(t,e){let n=I.acquire().init(t);const o=[n];for(;0!==o.length;){if(n=o.pop(),e(n)&&!n.isLeaf())for(let t=0;t<n.node.children.length;t++)n.node.children[t]&&o.push(I.acquire().init(n).advance(t));I.release(n)}}_forEachNodeDepthOrdered(t,e,n,o=F.DepthOrder.FRONT_TO_BACK){let r=I.acquire().init(t);const i=[r];for(function(t,e,n){if(!K.length)for(let t=0;t<8;++t)K.push({index:0,distance:0});for(let n=0;n<8;++n){const o=C[n];K.data[n].index=n,K.data[n].distance=L(t,e,o)}K.sort(((t,e)=>t.distance-e.distance));for(let t=0;t<8;++t)n[t]=K.data[t].index}(n,o,Y);0!==i.length;){if(r=i.pop(),e(r)&&!r.isLeaf())for(let t=7;t>=0;--t){const e=Y[t];r.node.children[e]&&i.push(I.acquire().init(r).advance(e))}I.release(r)}}_remove(t,e,n){W.clear();const o=n.advanceTo(e,((t,e)=>{W.push(t.node),W.push(e)}))?n.node.terminals:n.node.residents;if(o.removeUnordered(t),0===o.length)for(let t=W.length-2;t>=0;t-=2){const e=W.data[t],n=W.data[t+1];if(!this._purge(e,n))break}}_nodeIsEmpty(t){if(0!==t.terminals.length)return!1;if(null!==t.residents)return 0===t.residents.length;for(let e=0;e<t.children.length;e++)if(t.children[e])return!1;return!0}_purge(t,e){return e>=0&&(t.children[e]=null),!!this._nodeIsEmpty(t)&&(null===t.residents&&(t.residents=new b.Z({shrink:!0})),!0)}_add(t,e){e.advanceTo(this._objectToBoundingSphere(t))?e.node.terminals.push(t):(e.node.residents.push(t),e.node.residents.length>this._maximumObjectsPerNode&&e.depth<this._maximumDepth&&this._split(e))}_split(t){const e=t.node.residents;t.node.residents=null;for(let n=0;n<e.length;n++){const o=I.acquire().init(t);this._add(e.getItemAt(n),o),I.release(o)}}_grow(t,e){if(0!==e&&(y(t,e,(t=>this._objectToBoundingSphere(t)),U),w(U[3])&&!this._fitsInsideTree(U)))if(this._nodeIsEmpty(this._root.node))(0,g.b)(U,this._root.bounds),this._root.halfSize=1.25*U[3];else{const t=this._rootBoundsForRootAsSubNode(U);this._placingRootViolatesMaxDepth(t)?this._rebuildTree(U,t):this._growRootAsSubNode(t),I.release(t)}}_rebuildTree(t,e){(0,_.c)(Z,e.bounds),Z[3]=e.halfSize,y([t,Z],2,(t=>t),q);const n=I.acquire().init(this._root);this._root.initFrom(null,q,1.25*q[3]),this._forEachNode(n,(t=>(this.add(t.node.terminals.data,t.node.terminals.length),null!==t.node.residents&&this.add(t.node.residents.data,t.node.residents.length),!0))),I.release(n)}_placingRootViolatesMaxDepth(t){const e=Math.log(t.halfSize/this._root.halfSize)*Math.LOG2E;let n=0;return this._forEachNode(this._root,(t=>(n=Math.max(n,t.depth),n+e<=this._maximumDepth))),n+e>this._maximumDepth}_rootBoundsForRootAsSubNode(t){const e=t[3],n=t;let o=-1/0;const r=this._root.bounds,i=this._root.halfSize;for(let t=0;t<3;t++){const s=r[t]-i-(n[t]-e),c=n[t]+e-(r[t]+i),u=Math.max(0,Math.ceil(s/(2*i))),a=Math.max(0,Math.ceil(c/(2*i)))+1,d=2**Math.ceil(Math.log(u+a)*Math.LOG2E);o=Math.max(o,d),X[t].min=u,X[t].max=a}for(let t=0;t<3;t++){let e=X[t].min,n=X[t].max;const s=(o-(e+n))/2;e+=Math.ceil(s),n+=Math.floor(s);const c=r[t]-i-e*i*2;D[t]=c+(n+e)*i}return D[3]=o*i*v,I.acquire().initFrom(null,D,o*i,0)}_growRootAsSubNode(t){const e=this._root.node;(0,_.c)(U,this._root.bounds),U[3]=this._root.halfSize,this._root.init(t),t.advanceTo(U,null,!0),t.node.children=e.children,t.node.residents=e.residents,t.node.terminals=e.terminals}_shrink(){for(;;){const t=this._findShrinkIndex();if(-1===t)break;this._root.advance(t),this._root.depth=0}}_findShrinkIndex(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;let t=null;const e=this._root.node.children;let n=0,o=0;for(;o<e.length&&null==t;)n=o++,t=e[n];for(;o<e.length;)if(e[o++])return-1;return n}_isDegenerate(t){return!w(this._objectToBoundingSphere(t)[3])}_fitsInsideTree(t){const e=this._root.bounds,n=this._root.halfSize;return t[3]<=n&&t[0]>=e[0]-n&&t[0]<=e[0]+n&&t[1]>=e[1]-n&&t[1]<=e[1]+n&&t[2]>=e[2]-n&&t[2]<=e[2]+n}}class I{constructor(){this.bounds=(0,g.c)(),this.halfSize=0,this.initFrom(null,null,0,0)}init(t){return this.initFrom(t.node,t.bounds,t.halfSize,t.depth)}initFrom(t,e,n,o=this.depth){return this.node=(0,h.pC)(t)?t:I.createEmptyNode(),(0,h.pC)(e)&&(0,g.b)(e,this.bounds),this.halfSize=n,this.depth=o,this}advance(t){let e=this.node.children[t];e||(e=I.createEmptyNode(),this.node.children[t]=e),this.node=e,this.halfSize/=2,this.depth++;const n=C[t];return this.bounds[0]+=n[0]*this.halfSize,this.bounds[1]+=n[1]*this.halfSize,this.bounds[2]+=n[2]*this.halfSize,this.bounds[3]=this.halfSize*v,this}advanceTo(t,e,n=!1){for(;;){if(this.isTerminalFor(t))return e&&e(this,-1),!0;if(this.isLeaf()){if(!n)return e&&e(this,-1),!1;this.node.residents=null}const o=this._childIndex(t);e&&e(this,o),this.advance(o)}}isLeaf(){return null!=this.node.residents}isTerminalFor(t){return t[3]>this.halfSize/2}_childIndex(t){const e=this.bounds;return(e[0]<t[0]?1:0)+(e[1]<t[1]?2:0)+(e[2]<t[2]?4:0)}static createEmptyNode(){return{children:[null,null,null,null,null,null,null,null],terminals:new b.Z({shrink:!0}),residents:new b.Z({shrink:!0})}}static acquire(){return I._pool.acquire()}static release(t){I._pool.release(t)}static clearPool(){I._pool.prune()}}function S(t,e){t[0]=Math.min(t[0],e[0]-e[3]),t[1]=Math.min(t[1],e[1]-e[3]),t[2]=Math.min(t[2],e[2]-e[3])}function x(t,e){t[0]=Math.max(t[0],e[0]+e[3]),t[1]=Math.max(t[1],e[1]+e[3]),t[2]=Math.max(t[2],e[2]+e[3])}function j(t,e,n){n[0]=t[0]+e,n[1]=t[1]+e,n[2]=t[2]+e}function y(t,e,n,o){if(1===e){const e=n(t[0]);(0,g.b)(e,o)}else{H[0]=1/0,H[1]=1/0,H[2]=1/0,V[0]=-1/0,V[1]=-1/0,V[2]=-1/0;for(let o=0;o<e;o++){const e=n(t[o]);w(e[3])&&(S(H,e),x(V,e))}(0,_.h)(o,H,V,.5),o[3]=Math.max(V[0]-H[0],V[1]-H[1],V[2]-H[2])/2}}function P(t,e){let n=1/0,o=null;for(let r=0;r<8;++r){const i=L(t,e,B[r]);i<n&&(n=i,o=B[r])}return o}function L(t,e,n){return e*(t[0]*n[0]+t[1]*n[1]+t[2]*n[2])}function w(t){return!isNaN(t)&&t!==-1/0&&t!==1/0&&t>0}I._pool=new O.Z(I),function(t){var e;(e=t.DepthOrder||(t.DepthOrder={}))[e.FRONT_TO_BACK=1]="FRONT_TO_BACK",e[e.BACK_TO_FRONT=-1]="BACK_TO_FRONT"}(F||(F={}));const C=[(0,T.f)(-1,-1,-1),(0,T.f)(1,-1,-1),(0,T.f)(-1,1,-1),(0,T.f)(1,1,-1),(0,T.f)(-1,-1,1),(0,T.f)(1,-1,1),(0,T.f)(-1,1,1),(0,T.f)(1,1,1)],B=[(0,T.f)(-1,-1,-1),(0,T.f)(-1,-1,1),(0,T.f)(-1,1,-1),(0,T.f)(-1,1,1),(0,T.f)(1,-1,-1),(0,T.f)(1,-1,1),(0,T.f)(1,1,-1),(0,T.f)(1,1,1)],v=Math.sqrt(3),z=[null],D=(0,g.c)(),G=(0,T.c)(),H=(0,T.c)(),V=(0,T.c)(),W=new b.Z,k=(0,g.c)(),U=(0,g.c)(),Z=(0,g.c)(),q=(0,g.c)(),X=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],K=new b.Z,Y=[0,0,0,0,0,0,0,0],J=F;var $=n(18936);let Q=class{constructor(){this._idToComponent=new Map,this._components=new J((t=>t.bounds)),this._edges=new J((t=>t.bounds)),this._tmpLineSegment=(0,m.Ue)(),this._tmpP1=(0,T.c)(),this._tmpP2=(0,T.c)(),this._tmpP3=(0,T.c)(),this.remoteClient=null}async fetchCandidates(t,e){await Promise.resolve(),(0,l.k_)(e),await this._ensureEdgeLocations(t,e);const n=[];return this._edges.forEachNeighbor((e=>this._addCandidates(t,e,n)),t.bounds),{result:{candidates:n}}}async _ensureEdgeLocations(t,e){const n=[];if(this._components.forEachNeighbor((t=>{if((0,h.Wi)(t.info)){const{id:e,uid:o}=t;n.push({id:e,uid:o})}}),t.bounds),!n.length)return;const o={components:n},r=await this.remoteClient.invoke("fetchAllEdgeLocations",o,(0,h.Pt)(e,{}));for(const t of r.components)this._setFetchEdgeLocations(t)}async add(t){const e=new et(t.id,t.bounds);return this._idToComponent.set(e.id,e),this._components.add([e]),{result:{}}}async remove(t){const e=this._idToComponent.get(t.id);if(e){const t=[];this._edges.forEachNeighbor((n=>{n.component===e&&t.push(n)}),e.bounds),this._edges.remove(t),this._components.remove([e]),this._idToComponent.delete(e.id)}return{result:{}}}_setFetchEdgeLocations(t){const e=this._idToComponent.get(t.id);if((0,h.Wi)(e)||t.uid!==e.uid)return;const n=$.extractComponentsEdgeLocationsLayout.createView(t.locations),o=new Array(n.count),r=(0,T.c)(),i=(0,T.c)();for(let s=0;s<n.count;s++){const c=(0,g.c)(),u=(0,g.g)(c);n.position0.getVec(s,r),n.position1.getVec(s,i),(0,_.C)(u,u,r,.5),(0,_.C)(u,u,i,.5),(0,_.a)(u,u,t.origin),c[3]=(0,_.i)(u,r);const a=new nt(e,s,c);o[s]=a}this._edges.add(o);const{objectIds:s,origin:c}=t;e.info={locations:n,objectIds:s,origin:c}}_addCandidates(t,e,n){const{locations:o,origin:r,objectIds:i}=e.component.info,s=o.position0.getVec(e.index,this._tmpP1),c=o.position1.getVec(e.index,this._tmpP2);(0,_.a)(s,s,r),(0,_.a)(c,c,r);const u=i[o.componentIndex.get(e.index)];this._addEdgeCandidate(t,u,s,c,n),this._addVertexCandidate(t,u,s,n),this._addVertexCandidate(t,u,c,n)}_addEdgeCandidate(t,e,n,o,r){if(!(t.types&p.r.EDGE))return;const i=(0,g.g)(t.bounds),s=(0,m.zk)(n,o,this._tmpLineSegment),c=(0,m.nF)(s,i,this._tmpP3);if(!(0,g.m)(t.bounds,c))return null;r.push({type:"edge",objectId:e,target:(0,T.a)(c),distance:(0,_.i)(i,c),start:(0,T.a)(n),end:(0,T.a)(o)})}_addVertexCandidate(t,e,n,o){if(!(t.types&p.r.VERTEX))return;const r=(0,g.g)(t.bounds);if(!(0,g.m)(t.bounds,n))return null;o.push({type:"vertex",objectId:e,target:(0,T.a)(n),distance:(0,_.i)(r,n)})}};function tt(){return new Q}Q=(0,d._)([(0,f.j)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],Q);class et{constructor(t,e){this.id=t,this.bounds=e,this.info=null,this.uid=++et.uid}}et.uid=0;class nt{constructor(t,e,n){this.component=t,this.index=e,this.bounds=n}}}}]);