/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.26/esri/copyright.txt for details.
*/
define(["exports","../../widgets/support/widgetUtils"],(function(e,t){"use strict";const r="http://www.w3.org/",o=`${r}2000/svg`,i=`${r}1999/xlink`;let n=[],l=(e,t)=>{let r={};return Object.keys(e).forEach((t=>{r[t]=e[t]})),t&&Object.keys(t).forEach((e=>{r[e]=t[e]})),r},s=(e,t)=>e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties),p=e=>{if("string"!=typeof e)throw new Error("Style values must be strings")},d=(e,t,r)=>{if(""!==t.vnodeSelector)for(let o=r;o<e.length;o++)if(s(e[o],t))return o;return-1},a=(e,t,r,o)=>{let i=e[t];if(""===i.vnodeSelector)return;let n=i.properties;if(!(n?void 0===n.key?n.bind:n.key:void 0))for(let l=0;l<e.length;l++)if(l!==t){let t=e[l];if(s(t,i))throw new Error(`${r.vnodeSelector} had a ${i.vnodeSelector} child ${"added"===o?o:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}},c=e=>{if(e.properties){let t=e.properties.enterAnimation;t&&t(e.domNode,e.properties)}},f=[],u=!1,m=e=>{(e.children||[]).forEach(m),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.apply(e.properties.bind||e.properties,[e.domNode])},h=()=>{u=!1,f.forEach(m),f.length=0},v=e=>{f.push(e),u||(u=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(h,{timeout:16}):setTimeout(h,16))},g=e=>{let t=e.domNode;if(e.properties){let r=e.properties.exitAnimation;if(r){t.style.pointerEvents="none";let o=()=>{t.parentNode&&(t.parentNode.removeChild(t),v(e))};return void r(t,o,e.properties)}}t.parentNode&&(t.parentNode.removeChild(t),v(e))},y=(e,r,n)=>{if(!r)return;let l=n.eventHandlerInterceptor,s=Object.keys(r),d=s.length;for(let a=0;a<d;a++){let d=s[a],c=r[d];if("className"===d)throw new Error('Property "className" is not supported, use "class".');if("class"===d)k(e,c,!0);else if("classes"===d){let t=Object.keys(c),r=t.length;for(let o=0;o<r;o++){let r=t[o];c[r]&&e.classList.add(r)}}else if("styles"===d){let t=Object.keys(c),r=t.length;for(let o=0;o<r;o++){let r=t[o],i=c[r];i&&(p(i),n.styleApplyer(e,r,i))}}else if("key"!==d&&null!=c){let s=typeof c;"function"===s?(0===d.lastIndexOf("on",0)&&(l&&(c=l(d,c,e,r)),"oninput"===d&&function(){let e=c;c=function(t){e.apply(this,[t]),t.target["oninput-value"]=t.target.value}}()),e[d]=c):n.namespace===o?"href"===d?e.setAttributeNS(i,d,c):e.setAttribute(d,c):"string"===s&&"value"!==d?"innerHTML"===d?e[d]=t.renderingSanitizer.sanitize(c):b(e)&&d in e?e[d]=c:e.setAttribute(d,c):e[d]=c}}};function b(e){if(!(e instanceof Element&&e.tagName.includes("-")))return!1;const t=window.customElements.get(e.tagName.toLowerCase());return!!t&&e instanceof t}let N,w=(e,t,r)=>{if(t)for(let o of t)S(o,e,void 0,r)},x=(e,t,r)=>{w(e,t.children,r),t.text&&(e.textContent=t.text),y(e,t.properties,r),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.apply(t.properties.bind||t.properties,[e,r,t.vnodeSelector,t.properties,t.children])},S=(e,t,r,i)=>{let n,s=0,p=e.vnodeSelector,d=t.ownerDocument;if(""===p)n=e.domNode=d.createTextNode(e.text),void 0!==r?t.insertBefore(n,r):t.appendChild(n);else{for(let a=0;a<=p.length;++a){let c=p.charAt(a);if(a===p.length||"."===c||"#"===c){let c=p.charAt(s-1),f=p.slice(s,a);"."===c?n.classList.add(f):"#"===c?n.id=f:("svg"===f&&(i=l(i,{namespace:o})),void 0!==i.namespace?n=e.domNode=d.createElementNS(i.namespace,f):(n=e.domNode=e.domNode||d.createElement(f),"input"===f&&e.properties&&void 0!==e.properties.type&&n.setAttribute("type",e.properties.type)),void 0!==r?t.insertBefore(n,r):n.parentNode!==t&&t.appendChild(n)),s=a+1}}x(n,e,i)}},k=(e,t,r)=>{t&&t.split(" ").forEach((t=>{t&&e.classList.toggle(t,r)}))},A=(e,r,n,l)=>{if(!n)return;let s=!1,d=Object.keys(n),a=d.length;for(let c=0;c<a;c++){let a=d[c],f=n[a],u=r[a];if("class"===a)u!==f&&(k(e,u,!1),k(e,f,!0));else if("classes"===a){let t=e.classList,r=Object.keys(f),o=r.length;for(let e=0;e<o;e++){let o=r[e],i=!!f[o];i!==!!u[o]&&(s=!0,i?t.add(o):t.remove(o))}}else if("styles"===a){let t=Object.keys(f),r=t.length;for(let o=0;o<r;o++){let r=t[o],i=f[r];i!==u[r]&&(s=!0,i?(p(i),l.styleApplyer(e,r,i)):l.styleApplyer(e,r,""))}}else if(f||"string"!=typeof u||(f=""),"value"===a){let t=e[a];t!==f&&(e["oninput-value"]?t===e["oninput-value"]:f!==u)&&(e[a]=f,e["oninput-value"]=void 0),f!==u&&(s=!0)}else if(f!==u){let r=typeof f;"function"===r&&l.eventHandlerInterceptor||(l.namespace===o?"href"===a?e.setAttributeNS(i,a,f):e.setAttribute(a,f):"string"===r?"innerHTML"===a?e[a]=t.renderingSanitizer.sanitize(f):"role"===a&&""===f?e.removeAttribute(a):b(e)&&a in e?e[a]=f:e.setAttribute(a,f):e[a]!==f&&(e[a]=f),s=!0)}}return s},C=(e,t,r,o,i)=>{if(r===o)return!1;o=o||n;let l,p=(r=r||n).length,f=o.length,u=0,m=0,h=!1;for(;m<f;){let n=u<p?r[u]:void 0,f=o[m];if(void 0!==n&&s(n,f))h=N(n,f,i)||h,u++;else{let n=d(r,f,u+1);if(n>=0){for(l=u;l<n;l++)g(r[l]),a(r,l,e,"removed");h=N(r[n],f,i)||h,u=n+1}else S(f,t,u<p?r[u].domNode:void 0,i),c(f),a(o,m,e,"added")}m++}if(p>u)for(l=u;l<p;l++)g(r[l]),a(r,l,e,"removed");return h};N=(e,t,r)=>{let i=e.domNode,n=!1;if(e===t)return!1;let s=!1;if(""===t.vnodeSelector){if(t.text!==e.text){let e=i.ownerDocument.createTextNode(t.text);return i.parentNode.replaceChild(e,i),t.domNode=e,n=!0,n}t.domNode=i}else 0===t.vnodeSelector.lastIndexOf("svg",0)&&(r=l(r,{namespace:o})),e.text!==t.text&&(s=!0,void 0===t.text?i.removeChild(i.firstChild):i.textContent=t.text),t.domNode=i,s=C(t,i,e.children,t.children,r)||s,s=A(i,e.properties,t.properties,r)||s,t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate.apply(t.properties.bind||t.properties,[i,r,t.vnodeSelector,t.properties,t.children]);return s&&t.properties&&t.properties.updateAnimation&&t.properties.updateAnimation(i,t.properties,e.properties),n};let E=(e,t)=>({getLastRender:()=>e,update:r=>{if(e.vnodeSelector!==r.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let o=e;e=r,N(o,r,t)},domNode:e.domNode});e.createDom=S,e.createProjection=E,e.extend=l,e.initPropertiesAndChildren=x,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
